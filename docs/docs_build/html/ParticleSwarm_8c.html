<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pic_dev: ParticleSwarm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pic_dev
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">Particle-in-Cell / CFD development codebase</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ParticleSwarm_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ParticleSwarm.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ParticleSwarm_8h_source.html">ParticleSwarm.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ParticleSwarm.c:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="ParticleSwarm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a3b8cd77851de92f44b3821c6d15fb725"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>&#160;&#160;&#160;1.0e-14</td></tr>
<tr class="separator:a3b8cd77851de92f44b3821c6d15fb725"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3566e0b51587686bc6c1366a67c44af"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#ac3566e0b51587686bc6c1366a67c44af">InitializeSwarm</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:ac3566e0b51587686bc6c1366a67c44af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the DMSwarm object within the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure.  <a href="ParticleSwarm_8c.html#ac3566e0b51587686bc6c1366a67c44af">More...</a><br /></td></tr>
<tr class="separator:ac3566e0b51587686bc6c1366a67c44af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b5741b17ffa7a57d8c1f6636e956d08"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a> (DM swarm, const char *fieldName, PetscInt fieldDim, PetscDataType dtype)</td></tr>
<tr class="memdesc:a1b5741b17ffa7a57d8c1f6636e956d08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a swarm field without finalizing registration.  <a href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">More...</a><br /></td></tr>
<tr class="separator:a1b5741b17ffa7a57d8c1f6636e956d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae3fd559e91d7379302acb6ccd13011"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#aeae3fd559e91d7379302acb6ccd13011">RegisterParticleFields</a> (DM swarm)</td></tr>
<tr class="memdesc:aeae3fd559e91d7379302acb6ccd13011"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers necessary particle fields within the DMSwarm.  <a href="ParticleSwarm_8c.html#aeae3fd559e91d7379302acb6ccd13011">More...</a><br /></td></tr>
<tr class="separator:aeae3fd559e91d7379302acb6ccd13011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fa0cca0aa8b05f2705cdd0e7d37658"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a26fa0cca0aa8b05f2705cdd0e7d37658">InitializeRandomGenerators</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscRandom *randx, PetscRandom *randy, PetscRandom *randz)</td></tr>
<tr class="memdesc:a26fa0cca0aa8b05f2705cdd0e7d37658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes random number generators for assigning particle properties.  <a href="ParticleSwarm_8c.html#a26fa0cca0aa8b05f2705cdd0e7d37658">More...</a><br /></td></tr>
<tr class="separator:a26fa0cca0aa8b05f2705cdd0e7d37658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab723e91906e01ec26aab97de6623000c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#ab723e91906e01ec26aab97de6623000c">InitializeLogicalSpaceRNGs</a> (PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</td></tr>
<tr class="memdesc:ab723e91906e01ec26aab97de6623000c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes random number generators for logical space operations [0.0, 1.0).  <a href="ParticleSwarm_8c.html#ab723e91906e01ec26aab97de6623000c">More...</a><br /></td></tr>
<tr class="separator:ab723e91906e01ec26aab97de6623000c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae333eaf5cdf54d396fb84ef574a4945b"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#ae333eaf5cdf54d396fb84ef574a4945b">DetermineVolumetricInitializationParameters</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, DMDALocalInfo *info, PetscInt xs_gnode, PetscInt ys_gnode, PetscInt zs_gnode, PetscRandom *rand_logic_i_ptr, PetscRandom *rand_logic_j_ptr, PetscRandom *rand_logic_k_ptr, PetscInt *ci_metric_lnode_out, PetscInt *cj_metric_lnode_out, PetscInt *ck_metric_lnode_out, PetscReal *xi_metric_logic_out, PetscReal *eta_metric_logic_out, PetscReal *zta_metric_logic_out, PetscBool *can_place_in_volume_out)</td></tr>
<tr class="memdesc:ae333eaf5cdf54d396fb84ef574a4945b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines cell selection and intra-cell logical coordinates for volumetric initialization (Mode 1).  <a href="ParticleSwarm_8c.html#ae333eaf5cdf54d396fb84ef574a4945b">More...</a><br /></td></tr>
<tr class="separator:ae333eaf5cdf54d396fb84ef574a4945b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95efc9f04a0187f2a1d920952bd610e0"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a95efc9f04a0187f2a1d920952bd610e0">InitializeParticleBasicProperties</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt particlesPerProcess, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, <a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *bboxlist)</td></tr>
<tr class="memdesc:a95efc9f04a0187f2a1d920952bd610e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes basic properties for particles on the local process.  <a href="ParticleSwarm_8c.html#a95efc9f04a0187f2a1d920952bd610e0">More...</a><br /></td></tr>
<tr class="separator:a95efc9f04a0187f2a1d920952bd610e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a836356591a56313ee45df507a984907d"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a836356591a56313ee45df507a984907d">UpdateSwarmFieldValue</a> (const char *fieldName, PetscInt p, PetscInt fieldDim, PetscReal *fieldData)</td></tr>
<tr class="memdesc:a836356591a56313ee45df507a984907d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to update a given particle’s field value.  <a href="ParticleSwarm_8c.html#a836356591a56313ee45df507a984907d">More...</a><br /></td></tr>
<tr class="separator:a836356591a56313ee45df507a984907d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c3c55ea49021ac59eea87b61e942d1"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *fieldName, PetscInt fieldDim)</td></tr>
<tr class="memdesc:a38c3c55ea49021ac59eea87b61e942d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a generic swarm field with point-level updates.  <a href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">More...</a><br /></td></tr>
<tr class="separator:a38c3c55ea49021ac59eea87b61e942d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b3080ee0e5c8e0175ac594a2c497b5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#af2b3080ee0e5c8e0175ac594a2c497b5">AssignInitialPropertiesToSwarm</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt particlesPerProcess, PetscRandom *rand_phys_x, PetscRandom *rand_phys_y, PetscRandom *rand_phys_z, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, <a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *bboxlist)</td></tr>
<tr class="memdesc:af2b3080ee0e5c8e0175ac594a2c497b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes all particle properties in the swarm.  <a href="ParticleSwarm_8c.html#af2b3080ee0e5c8e0175ac594a2c497b5">More...</a><br /></td></tr>
<tr class="separator:af2b3080ee0e5c8e0175ac594a2c497b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc0975a3eec2e2f817d0e3a09040620"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a1cc0975a3eec2e2f817d0e3a09040620">DistributeParticles</a> (PetscInt numParticles, PetscMPIInt rank, PetscMPIInt size, PetscInt *particlesPerProcess, PetscInt *remainder)</td></tr>
<tr class="memdesc:a1cc0975a3eec2e2f817d0e3a09040620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distributes particles evenly across MPI processes, handling any remainders.  <a href="ParticleSwarm_8c.html#a1cc0975a3eec2e2f817d0e3a09040620">More...</a><br /></td></tr>
<tr class="separator:a1cc0975a3eec2e2f817d0e3a09040620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a075e674353bc5b06344aa4c17063babf"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a075e674353bc5b06344aa4c17063babf">FinalizeSwarmSetup</a> (PetscRandom *randx, PetscRandom *randy, PetscRandom *randz, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</td></tr>
<tr class="memdesc:a075e674353bc5b06344aa4c17063babf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes the swarm setup by destroying random generators and logging completion.  <a href="ParticleSwarm_8c.html#a075e674353bc5b06344aa4c17063babf">More...</a><br /></td></tr>
<tr class="separator:a075e674353bc5b06344aa4c17063babf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a063f4fd13a24b248fabd0268c49fd38c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a063f4fd13a24b248fabd0268c49fd38c">CreateParticleSwarm</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt numParticles, PetscInt *particlesPerProcess, <a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *bboxlist)</td></tr>
<tr class="memdesc:a063f4fd13a24b248fabd0268c49fd38c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and initializes a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Swarm.  <a href="ParticleSwarm_8c.html#a063f4fd13a24b248fabd0268c49fd38c">More...</a><br /></td></tr>
<tr class="separator:a063f4fd13a24b248fabd0268c49fd38c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa353055e357151aab1542bbad367c657"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#aa353055e357151aab1542bbad367c657">UnpackSwarmFields</a> (PetscInt i, const PetscInt64 *PIDs, const PetscReal *weights, const PetscReal *positions, const PetscInt *cellIndices, PetscReal *velocities, PetscInt *LocStatus, <a class="el" href="variables__old_8h.html#structParticle">Particle</a> *particle)</td></tr>
<tr class="memdesc:aa353055e357151aab1542bbad367c657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct with data from DMSwarm fields.  <a href="ParticleSwarm_8c.html#aa353055e357151aab1542bbad367c657">More...</a><br /></td></tr>
<tr class="separator:aa353055e357151aab1542bbad367c657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac52b9e4afa9d1f2ba3bf59dc45b610d1"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#ac52b9e4afa9d1f2ba3bf59dc45b610d1">UpdateSwarmFields</a> (PetscInt i, const <a class="el" href="variables__old_8h.html#structParticle">Particle</a> *particle, PetscReal *weights, PetscInt *cellIndices, PetscInt *status_field)</td></tr>
<tr class="memdesc:ac52b9e4afa9d1f2ba3bf59dc45b610d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates DMSwarm fields with data from a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct.  <a href="ParticleSwarm_8c.html#ac52b9e4afa9d1f2ba3bf59dc45b610d1">More...</a><br /></td></tr>
<tr class="separator:ac52b9e4afa9d1f2ba3bf59dc45b610d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412856be59df7252e66bcbdd13cf1718"><td class="memItemLeft" align="right" valign="top">PetscBool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a412856be59df7252e66bcbdd13cf1718">IsParticleInsideBoundingBox</a> (const <a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *bbox, const <a class="el" href="variables__old_8h.html#structParticle">Particle</a> *particle)</td></tr>
<tr class="memdesc:a412856be59df7252e66bcbdd13cf1718"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a particle's location is within a specified bounding box.  <a href="ParticleSwarm_8c.html#a412856be59df7252e66bcbdd13cf1718">More...</a><br /></td></tr>
<tr class="separator:a412856be59df7252e66bcbdd13cf1718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0001e483238e2b600cb9aa23a6e5338c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a0001e483238e2b600cb9aa23a6e5338c">UpdateParticleWeights</a> (PetscReal *d, <a class="el" href="variables__old_8h.html#structParticle">Particle</a> *particle)</td></tr>
<tr class="memdesc:a0001e483238e2b600cb9aa23a6e5338c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a particle's interpolation weights based on distances to cell faces.  <a href="ParticleSwarm_8c.html#a0001e483238e2b600cb9aa23a6e5338c">More...</a><br /></td></tr>
<tr class="separator:a0001e483238e2b600cb9aa23a6e5338c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5488e87ab4fa163467b3db9ce10233a5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#a5488e87ab4fa163467b3db9ce10233a5">PrepareLoadedSwarmForRelocation</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a5488e87ab4fa163467b3db9ce10233a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the location-dependent state of a loaded swarm to force relocation.  <a href="ParticleSwarm_8c.html#a5488e87ab4fa163467b3db9ce10233a5">More...</a><br /></td></tr>
<tr class="separator:a5488e87ab4fa163467b3db9ce10233a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada215a5db25227a8fd2cd2596e7d3e57"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8c.html#ada215a5db25227a8fd2cd2596e7d3e57">InitializeParticleSwarm</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:ada215a5db25227a8fd2cd2596e7d3e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform particle swarm initialization, particle-grid interaction, and related operations.  <a href="ParticleSwarm_8c.html#ada215a5db25227a8fd2cd2596e7d3e57">More...</a><br /></td></tr>
<tr class="separator:ada215a5db25227a8fd2cd2596e7d3e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a3b8cd77851de92f44b3821c6d15fb725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b8cd77851de92f44b3821c6d15fb725">&#9670;&nbsp;</a></span>INTERPOLATION_DISTANCE_TOLERANCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define INTERPOLATION_DISTANCE_TOLERANCE&#160;&#160;&#160;1.0e-14</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00005">5</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a38c3c55ea49021ac59eea87b61e942d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c3c55ea49021ac59eea87b61e942d1">&#9670;&nbsp;</a></span>AssignInitialFieldToSwarm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode AssignInitialFieldToSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>fieldDim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes a generic swarm field with point-level updates. </p>
<p>This field-agnostic function retrieves the specified swarm field (which may be scalar or multi-component) and initializes each particle's entry using a helper that performs conditional updates based on the field name.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the swarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the swarm field to initialize. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldDim</td><td>Dimension of the field (e.g., 1 for scalar, 3 for vector).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00544">544</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    DM             swarm = user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    PetscReal     *fieldData = NULL;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    PetscInt       nLocal;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="comment">// Get the number of local particles</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    ierr = DMSwarmGetLocalSize(swarm, &amp;nLocal); CHKERRQ(ierr);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialFieldToSwarm - %d local particles found.\n&quot;</span>, nLocal);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">// Retrieve the swarm field pointer for the specified fieldName</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    ierr = DMSwarmGetField(swarm, fieldName, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;fieldData); CHKERRQ(ierr);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialFieldToSwarm - Retrieved field &#39;%s&#39;.\n&quot;</span>, fieldName);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// Loop over all particles and update the field using the helper function</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">for</span> (PetscInt p = 0; p &lt; nLocal; p++) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        ierr = <a class="code" href="ParticleSwarm_8c.html#a836356591a56313ee45df507a984907d">UpdateSwarmFieldValue</a>(fieldName, p, fieldDim, fieldData); CHKERRQ(ierr);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    PetscReal disp_data[fieldDim];</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordflow">for</span> (PetscInt d = 0; d &lt; fieldDim; d++) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      disp_data[d] = fieldData[fieldDim* p + d];</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,p, 100,<span class="stringliteral">&quot; Particle %d: %s[%d] = [%.6f, ...,%.6f].\n&quot;</span>, p,fieldName,fieldDim,disp_data[0],disp_data[fieldDim-1]);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// Restore the swarm field pointer</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    ierr = DMSwarmRestoreField(swarm, fieldName, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;fieldData); CHKERRQ(ierr);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialFieldToSwarm - Initialization of field &#39;%s&#39; complete.\n&quot;</span>, fieldName);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a38c3c55ea49021ac59eea87b61e942d1_cgraph.svg" width="431" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a38c3c55ea49021ac59eea87b61e942d1_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="af2b3080ee0e5c8e0175ac594a2c497b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b3080ee0e5c8e0175ac594a2c497b5">&#9670;&nbsp;</a></span>AssignInitialPropertiesToSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode AssignInitialPropertiesToSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_phys_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_phys_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_phys_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bboxlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes all particle properties in the swarm. </p>
<p>This function orchestrates the initialization of particle properties. It first determines the inlet face if surface initialization (Mode 0) is selected by parsing "bcs.dat". Then, it initializes basic particle properties (physical position, <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> ID, and placeholder <a class="el" href="variables__old_8h.html#structCell" title="Defines the vertices of a single hexahedral grid cell.">Cell</a> IDs) by calling <code>InitializeParticleBasicProperties</code>. This call uses the provided <code>rand_logic_i/j/k</code> RNGs, which must be pre-initialized for [0,1). The <code>rand_phys_x/y/z</code> RNGs (physically bounded) are passed but may not be used by <code>InitializeParticleBasicProperties</code> for position setting if all initialization paths use logical-to-physical mapping. Finally, it calls helper functions to initialize other registered swarm fields like "velocity", "weight", and "Psi" (scalar) to default values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particlesPerProcess</td><td>Number of particles assigned to this MPI process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_x</td><td>RNG for physical x-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_y</td><td>RNG for physical y-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_z</td><td>RNG for physical z-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_i</td><td>RNG for i-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_j</td><td>RNG for j-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_k</td><td>RNG for k-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Array of <a class="el" href="variables__old_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures (potentially unused by IPBP).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00606">606</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;{</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// --- 0. Input Validation ---</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (!user || !bboxlist || !rand_logic_i || !rand_logic_j || !rand_logic_k || !rand_phys_x || !rand_phys_y || !rand_phys_z) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// Check all RNGs now as they are passed in</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Null user, bboxlist, or RNG pointer.\n&quot;</span>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Null input detected.&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing swarm with %d particles per process. Mode: %d.\n&quot;</span>,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;              particlesPerProcess, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// --- 1. Parse BCS File for Inlet Information (if Mode 0) ---</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a> == 0) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">if</span>(user-&gt;<a class="code" href="variables__old_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">inletFaceDefined</a> == PETSC_FALSE){</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - ParticleInitialization Mode 0 (Surface Init) selected, but no INLET face was identified from bcs.dat. Cannot proceed.\n&quot;</span>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;ParticleInitialization Mode 0 requires an INLET face to be defined in bcs.dat.&quot;</span>);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - After ParseBCSFileForInlet, identifiedInletBCFace = %d\n&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// --- 2. Initialize Basic Particle Properties (Position, PID, Cell IDs placeholder) ---</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="comment">// The rand_logic_i/j/k are now passed directly.</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// The rand_phys_x/y/z are passed but InitializeParticleBasicProperties (refactored version)</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="comment">// will not use them for setting positions if all its paths use logical-to-physical mapping.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Calling InitializeParticleBasicProperties.\n&quot;</span>);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a95efc9f04a0187f2a1d920952bd610e0">InitializeParticleBasicProperties</a>(user, particlesPerProcess,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                             rand_logic_i, rand_logic_j, rand_logic_k,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                             bboxlist); <span class="comment">// bboxlist passed along</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    CHKERRQ(ierr);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Successfully initialized basic particle properties.\n&quot;</span>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// Note: The logical RNGs (rand_logic_i/j/k) are NOT destroyed here.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="comment">// They were created externally (e.g., by InitializeLogicalSpaceRNGs) and</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// should be destroyed externally (e.g., in FinalizeSwarmSetup).</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// Same for rand_phys_x/y/z.</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="comment">// --- 3. Initialize Other Swarm Fields (Velocity, Weight, Pressure, etc.) ---</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing &#39;velocity&#39; field.\n&quot;</span>);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a>(user, <span class="stringliteral">&quot;velocity&quot;</span>, 3); CHKERRQ(ierr);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - &#39;velocity&#39; field initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing &#39;weight&#39; field.\n&quot;</span>);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a>(user, <span class="stringliteral">&quot;weight&quot;</span>, 3); CHKERRQ(ierr); <span class="comment">// Assuming weight is vec3</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - &#39;weight&#39; field initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing &#39;P&#39; (Pressure) field.\n&quot;</span>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a>(user, <span class="stringliteral">&quot;Psi&quot;</span>, 1); CHKERRQ(ierr);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - &#39;P&#39; field initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Successfully completed all swarm property initialization.\n&quot;</span>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_af2b3080ee0e5c8e0175ac594a2c497b5_cgraph.svg" width="100%" height="511"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_af2b3080ee0e5c8e0175ac594a2c497b5_icgraph.svg" width="516" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a063f4fd13a24b248fabd0268c49fd38c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063f4fd13a24b248fabd0268c49fd38c">&#9670;&nbsp;</a></span>CreateParticleSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode CreateParticleSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>numParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bboxlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and initializes a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Swarm. </p>
<p>This function sets up a DMSwarm within the provided <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure, initializes particle fields, and distributes particles across MPI processes. It ensures that the number of particles is evenly divided among the available MPI ranks. If the total number of particles isn't divisible by the number of processes, the remainder is distributed to the first few ranks. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numParticles</td><td>Total number of particles to create across all MPI processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Pointer to an array of <a class="el" href="variables__old_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures, one per rank.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particlesPerProcess</td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure that <code>numParticles</code> is a positive integer.</li>
<li>The <code>control.dat</code> file should contain necessary PETSc options.</li>
<li>The <code>bboxlist</code> array should be properly populated before calling this function. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00764">764</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                                                                                                               {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    PetscErrorCode ierr;                      <span class="comment">// PETSc error handling variable</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    PetscMPIInt rank, size;                   <span class="comment">// Variables to store MPI rank and size</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    PetscInt remainder = 0;                   <span class="comment">// Remainder of particles after division</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// Validate input parameters</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">if</span> (numParticles &lt;= 0) {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Number of particles must be positive. Given: %d\n&quot;</span>, numParticles);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">return</span> PETSC_ERR_ARG_OUTOFRANGE;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// Insert PETSc options from &quot;control.dat&quot; into the PETSc options database</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">//  ierr = PetscOptionsInsertFile(PETSC_COMM_WORLD, NULL, &quot;control.dat&quot;, PETSC_TRUE); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// LOG_ALLOW(LOCAL,LOG_DEBUG,&quot;CreateParticleSwarm - Inserted options from control.dat\n&quot;);</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Domain dimensions: Min_X=%.2f, Max_X=%.2f,Min_Y=%.2f, Max_Y=%.2f,Min_Z=%.2f, Max_Z=%.2f \n&quot;</span>, </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;           user-&gt;<a class="code" href="variables__old_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">Min_X</a>,user-&gt;<a class="code" href="variables__old_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">Max_X</a>,user-&gt;<a class="code" href="variables__old_8h.html#ac6633daab270004cd266f6e6ac05f588">Min_Y</a>,user-&gt;<a class="code" href="variables__old_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">Max_Y</a>, user-&gt;<a class="code" href="variables__old_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">Min_Z</a>,user-&gt;<a class="code" href="variables__old_8h.html#aecbc2de7a281e906efe25a773b76866c">Max_Z</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// Retrieve MPI rank and size</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD, &amp;size); CHKERRQ(ierr);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Rank %d out of %d processes.\n&quot;</span>, rank, size);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// Distribute particles among MPI processes</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1cc0975a3eec2e2f817d0e3a09040620">DistributeParticles</a>(numParticles, rank, size, particlesPerProcess, &amp;remainder); CHKERRQ(ierr);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">// Initialize the DMSwarm - creates the swarm, sets the type and dimension</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#ac3566e0b51587686bc6c1366a67c44af">InitializeSwarm</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      ierr = DMSwarmSetCellDM(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;CreateParticleSwarm - Associated DMSwarm with Cell DM (user-&gt;da).\n&quot;</span>);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      <span class="comment">// If user-&gt;da is essential for your simulation logic with particles, this should be a fatal error.</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;CreateParticleSwarm - user-&gt;da (Cell DM for Swarm) is NULL. Cell-based swarm operations might fail.\n&quot;</span>);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <span class="comment">// SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONGSTATE, &quot;CreateParticleSwarm - user-&gt;da (Cell DM) is NULL but required.&quot;);</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="comment">// Register particle fields (position, velocity, CellID, weight, etc.)</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#aeae3fd559e91d7379302acb6ccd13011">RegisterParticleFields</a>(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160; </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">// Set the local number of particles for this rank and additional buffer for particle migration</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    ierr = DMSwarmSetLocalSizes(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, *particlesPerProcess, numParticles); CHKERRQ(ierr);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Set local swarm size: %d particles.\n&quot;</span>, *particlesPerProcess);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">// Optionally, LOG_ALLOW detailed DM info in debug mode</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a>() == <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a> &amp;&amp; <a class="code" href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a>(__func__)) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;CreateParticleSwarm - Viewing DMSwarm:\n&quot;</span>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        ierr = DMView(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, PETSC_VIEWER_STDOUT_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Particle swarm creation and initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a063f4fd13a24b248fabd0268c49fd38c_cgraph.svg" width="579" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a063f4fd13a24b248fabd0268c49fd38c_icgraph.svg" width="492" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae333eaf5cdf54d396fb84ef574a4945b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae333eaf5cdf54d396fb84ef574a4945b">&#9670;&nbsp;</a></span>DetermineVolumetricInitializationParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode DetermineVolumetricInitializationParameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DMDALocalInfo *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>xs_gnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ys_gnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>zs_gnode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>ci_metric_lnode_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>cj_metric_lnode_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>ck_metric_lnode_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>xi_metric_logic_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>eta_metric_logic_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>zta_metric_logic_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscBool *&#160;</td>
          <td class="paramname"><em>can_place_in_volume_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determines cell selection and intra-cell logical coordinates for volumetric initialization (Mode 1). </p>
<p>This function is called when <code>simCtx-&gt;ParticleInitialization == 1</code>. It randomly selects an <em>owned cell</em> on the current MPI rank and then generates random intra-cell logical coordinates <code>[0,1)^3</code> within that chosen cell.</p>
<p>The process involves:</p><ol type="1">
<li>Checking if the current MPI rank owns any 3D cells.</li>
<li>If it does, it randomly selects an <em>owned cell index</em> in each logical direction (i, j, k) by scaling a <code>[0,1)</code> random number with the number of owned cells in that direction.</li>
<li>These local owned cell indices are then converted to the <em>local node indices</em> (<code>ci/cj/ck_metric_lnode_out</code>) corresponding to the origin of the selected cell, for use with <code>MetricLogicalToPhysical</code>. This conversion uses <code>xs/ys/zs_gnode</code>.</li>
<li>All three intra-cell logical coordinates (<code>xi/eta/zta_metric_logic_out</code>) for <code>MetricLogicalToPhysical</code> are chosen randomly within the <code>[0,1)</code> range.</li>
<li>A flag (<code>can_place_in_volume_out</code>) indicates if a valid placement could be determined.</li>
</ol>
<p><b>Important Note on <code>DMDALocalInfo info</code> members (same as for surface init):</b></p><ul>
<li><code>info-&gt;xs, info-&gt;ys, info-&gt;ks</code>: Global starting indices of <em>owned cells</em>.</li>
<li><code>info-&gt;mx, info-&gt;my, info-&gt;mz</code>: Number of <em>grid points (nodes)</em> in each local dimension on this process. Therefore, the number of <em>owned cells</em> in a dimension is <code>info-&gt;mX - 1</code> (if <code>info-&gt;mX &gt; 0</code>).</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code>. (Currently not used in this specific helper, but kept for API consistency). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">info</td><td>Pointer to <code>DMDALocalInfo</code> for the current rank's grid portion. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xs_gnode,ys_gnode,zs_gnode</td><td>Local indices (in the ghosted array) of the first <em>owned node</em>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_i_ptr</td><td>Pointer to the RNG for i-dimension tasks [0,1). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_j_ptr</td><td>Pointer to the RNG for j-dimension tasks [0,1). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_k_ptr</td><td>Pointer to the RNG for k-dimension tasks [0,1). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ci_metric_lnode_out</td><td>Pointer to store the local i-node index of the selected cell's origin. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cj_metric_lnode_out</td><td>Pointer to store the local j-node index of the selected cell's origin. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ck_metric_lnode_out</td><td>Pointer to store the local k-node index of the selected cell's origin. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xi_metric_logic_out</td><td>Pointer to store the intra-cell logical xi-coordinate [0,1). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">eta_metric_logic_out</td><td>Pointer to store the intra-cell logical eta-coordinate [0,1). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">zta_metric_logic_out</td><td>Pointer to store the intra-cell logical zeta-coordinate [0,1). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">can_place_in_volume_out</td><td>PETSC_TRUE if placement parameters were successfully determined, PETSC_FALSE otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a PETSc error code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00230">230</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    PetscErrorCode ierr = 0;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    PetscReal      r_val; <span class="comment">// Temporary for random numbers from [0,1) RNGs</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    PetscInt       local_owned_cell_idx_i, local_owned_cell_idx_j, local_owned_cell_idx_k;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    PetscMPIInt    rank_for_logging; <span class="comment">// For logging if needed</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank_for_logging); CHKERRQ(ierr);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    *can_place_in_volume_out = PETSC_FALSE; <span class="comment">// Default to: cannot place</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// Default intra-cell logicals and cell node indices (e.g. if placement fails)</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    *xi_metric_logic_out = 0.5; *eta_metric_logic_out = 0.5; *zta_metric_logic_out = 0.5;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    *ci_metric_lnode_out = xs_gnode; *cj_metric_lnode_out = ys_gnode; *ck_metric_lnode_out = zs_gnode;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// Calculate number of owned cells in each direction from node counts in info</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// Assumes info-&gt;mx, info-&gt;my, info-&gt;mz are node counts on this process for each dimension.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// Number of cells = Number of nodes - 1 (if &gt; 0 nodes).</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    PetscInt num_owned_cells_i = (info-&gt;mx &gt; 1) ? info-&gt;mx - 1 : 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    PetscInt num_owned_cells_j = (info-&gt;my &gt; 1) ? info-&gt;my - 1 : 0;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    PetscInt num_owned_cells_k = (info-&gt;mz &gt; 1) ? info-&gt;mz - 1 : 0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    if (num_owned_cells_i &gt; 0 &amp;&amp; num_owned_cells_j &gt; 0 &amp;&amp; num_owned_cells_k &gt; 0) { <span class="comment">// If rank owns any 3D cells</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        *can_place_in_volume_out = PETSC_TRUE;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// --- 1. Select a Random Owned Cell ---</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment">// The selected index will be a 0-based index relative to the start of this rank&#39;s owned cells.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="comment">// Select random local owned cell index in I-direction</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        ierr = PetscRandomGetValueReal(*rand_logic_i_ptr, &amp;r_val); CHKERRQ(ierr); <span class="comment">// Dereference RNG pointer</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        local_owned_cell_idx_i = (PetscInt)(r_val * num_owned_cells_i);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="comment">// Clamp to be safe: local_owned_cell_idx_i should be in [0, num_owned_cells_i - 1]</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        local_owned_cell_idx_i = PetscMin(PetscMax(0, local_owned_cell_idx_i), num_owned_cells_i - 1);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        *ci_metric_lnode_out = xs_gnode + local_owned_cell_idx_i; <span class="comment">// Convert to local node index for cell origin</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">// Select random local owned cell index in J-direction</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        ierr = PetscRandomGetValueReal(*rand_logic_j_ptr, &amp;r_val); CHKERRQ(ierr); <span class="comment">// Dereference RNG pointer</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        local_owned_cell_idx_j = (PetscInt)(r_val * num_owned_cells_j);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        local_owned_cell_idx_j = PetscMin(PetscMax(0, local_owned_cell_idx_j), num_owned_cells_j - 1);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        *cj_metric_lnode_out = ys_gnode + local_owned_cell_idx_j;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// Select random local owned cell index in K-direction</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        ierr = PetscRandomGetValueReal(*rand_logic_k_ptr, &amp;r_val); CHKERRQ(ierr); <span class="comment">// Dereference RNG pointer</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        local_owned_cell_idx_k = (PetscInt)(r_val * num_owned_cells_k);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        local_owned_cell_idx_k = PetscMin(PetscMax(0, local_owned_cell_idx_k), num_owned_cells_k - 1);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        *ck_metric_lnode_out = zs_gnode + local_owned_cell_idx_k;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;DVP - Rank %d: Selected Cell (Owned Idx: %d,%d,%d -&gt; LNodeStart: %d,%d,%d). OwnedCells(i,j,k): (%d,%d,%d). GhostNodeStarts(xs,ys,zs): (%d,%d,%d) \n&quot;</span>,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  rank_for_logging, local_owned_cell_idx_i, local_owned_cell_idx_j, local_owned_cell_idx_k,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                  *ci_metric_lnode_out, *cj_metric_lnode_out, *ck_metric_lnode_out,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  num_owned_cells_i, num_owned_cells_j, num_owned_cells_k,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                  xs_gnode, ys_gnode, zs_gnode);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="comment">// --- 2. Generate Random Intra-Cell Logical Coordinates [0,1) for MetricLogicalToPhysical ---</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        ierr = PetscRandomGetValueReal(*rand_logic_i_ptr, xi_metric_logic_out);  CHKERRQ(ierr); <span class="comment">// Re-use RNGs</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        ierr = PetscRandomGetValueReal(*rand_logic_j_ptr, eta_metric_logic_out); CHKERRQ(ierr);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        ierr = PetscRandomGetValueReal(*rand_logic_k_ptr, zta_metric_logic_out); CHKERRQ(ierr);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">// Ensure logical coordinates are strictly within [0,1) for robustness with MetricLogicalToPhysical</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        *xi_metric_logic_out  = PetscMin(*xi_metric_logic_out,  1.0 - 1.0e-7);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        *eta_metric_logic_out = PetscMin(*eta_metric_logic_out, 1.0 - 1.0e-7);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        *zta_metric_logic_out = PetscMin(*zta_metric_logic_out, 1.0 - 1.0e-7);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// Ensure they are not negative either (though [0,1) RNGs shouldn&#39;t produce this)</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        *xi_metric_logic_out  = PetscMax(*xi_metric_logic_out,  0.0);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        *eta_metric_logic_out = PetscMax(*eta_metric_logic_out, 0.0);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        *zta_metric_logic_out = PetscMax(*zta_metric_logic_out, 0.0);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="comment">// This rank does not own any 3D cells (e.g., in a 1D or 2D decomposition,</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="comment">// or if the global domain itself is not 3D in terms of cells).</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">// *can_place_in_volume_out remains PETSC_FALSE.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;DVP - Rank %d: Cannot place particle volumetrically. Rank has zero owned cells in at least one dimension (owned cells i,j,k: %d,%d,%d).\n&quot;</span>,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                  rank_for_logging, num_owned_cells_i, num_owned_cells_j, num_owned_cells_k);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_ae333eaf5cdf54d396fb84ef574a4945b_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a1cc0975a3eec2e2f817d0e3a09040620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc0975a3eec2e2f817d0e3a09040620">&#9670;&nbsp;</a></span>DistributeParticles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode DistributeParticles </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>numParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscMPIInt&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscMPIInt&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>remainder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distributes particles evenly across MPI processes, handling any remainders. </p>
<p>This function calculates the number of particles each MPI process should handle, distributing the remainder particles to the first few ranks if necessary.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numParticles</td><td>Total number of particles to create across all MPI processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rank</td><td>MPI rank of the current process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Total number of MPI processes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particlesPerProcess</td><td>Number of particles assigned to the current MPI process. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">remainder</td><td>Remainder particles when dividing numParticles by size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00689">689</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                                                                                                                                                  {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// Calculate the base number of particles per process</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    *particlesPerProcess = numParticles / size;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    *remainder = numParticles % size;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="comment">// Distribute the remainder particles to the first &#39;remainder&#39; ranks</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">if</span> (rank &lt; *remainder) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        *particlesPerProcess += 1;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;DistributeParticles - Rank %d receives an extra particle. Total: %d\n&quot;</span>, rank, *particlesPerProcess);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;DistributeParticles - Rank %d receives %d particles.\n&quot;</span>, rank, *particlesPerProcess);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a1cc0975a3eec2e2f817d0e3a09040620_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a075e674353bc5b06344aa4c17063babf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a075e674353bc5b06344aa4c17063babf">&#9670;&nbsp;</a></span>FinalizeSwarmSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode FinalizeSwarmSetup </td>
          <td>(</td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalizes the swarm setup by destroying random generators and logging completion. </p>
<p>This function cleans up resources by destroying random number generators and LOG_ALLOWs the completion of swarm setup.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">randx</td><td>Random number generator for the x-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randy</td><td>Random number generator for the y-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randz</td><td>Random number generator for the z-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_i</td><td>Random number generator for the xi-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_j</td><td>Random number generator for the eta-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_k</td><td>Random number generator for the zeta-coordinate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00720">720</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                                                                                                                                                               {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    PetscErrorCode ierr;  <span class="comment">// Error code for PETSc functions</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    PetscInt  ParticleInitialization; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-pinit&quot;</span>, &amp;ParticleInitialization, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="comment">// Destroy random number generators to free resources</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="comment">// Physical space</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    ierr = PetscRandomDestroy(randx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    ierr = PetscRandomDestroy(randy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    ierr = PetscRandomDestroy(randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="comment">// Logical space</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    ierr = PetscRandomDestroy(rand_logic_i); CHKERRQ(ierr);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    ierr = PetscRandomDestroy(rand_logic_j); CHKERRQ(ierr);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    ierr = PetscRandomDestroy(rand_logic_k); CHKERRQ(ierr);      </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;FinalizeSwarmSetup - Destroyed all random number generators.\n&quot;</span>);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a075e674353bc5b06344aa4c17063babf_icgraph.svg" width="487" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab723e91906e01ec26aab97de6623000c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab723e91906e01ec26aab97de6623000c">&#9670;&nbsp;</a></span>InitializeLogicalSpaceRNGs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeLogicalSpaceRNGs </td>
          <td>(</td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes random number generators for logical space operations [0.0, 1.0). </p>
<p>This function creates and configures three separate PETSc random number generators, one for each logical dimension (i, j, k or xi, eta, zeta equivalent). Each RNG is configured to produce uniformly distributed real numbers in the interval [0.0, 1.0). These are typically used for selecting owned cells or generating intra-cell logical coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">rand_logic_i</td><td>Pointer to store the RNG for the i-logical dimension. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rand_logic_j</td><td>Pointer to store the RNG for the j-logical dimension. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rand_logic_k</td><td>Pointer to store the RNG for the k-logical dimension.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00158">158</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                                                                                                           {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    PetscMPIInt rank;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// --- RNG for i-logical dimension ---</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, rand_logic_i); CHKERRQ(ierr);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    ierr = PetscRandomSetType((*rand_logic_i), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    ierr = PetscRandomSetInterval(*rand_logic_i, 0.0, 1.0); CHKERRQ(ierr); <span class="comment">// Key change: [0,1)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    ierr = PetscRandomSetSeed(*rand_logic_i, rank + 202401); CHKERRQ(ierr); <span class="comment">// Unique seed</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    ierr = PetscRandomSeed(*rand_logic_i); CHKERRQ(ierr);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeLogicalSpaceRNGs - Initialized RNG for i-logical dimension [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// --- RNG for j-logical dimension ---</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, rand_logic_j); CHKERRQ(ierr);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    ierr = PetscRandomSetType((*rand_logic_j), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    ierr = PetscRandomSetInterval(*rand_logic_j, 0.0, 1.0); CHKERRQ(ierr); <span class="comment">// Key change: [0,1)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ierr = PetscRandomSetSeed(*rand_logic_j, rank + 202402); CHKERRQ(ierr);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    ierr = PetscRandomSeed(*rand_logic_j); CHKERRQ(ierr);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeLogicalSpaceRNGs - Initialized RNG for j-logical dimension [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// --- RNG for k-logical dimension ---</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    ierr = PetscRandomSetType((*rand_logic_k), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    ierr = PetscRandomSetInterval(*rand_logic_k, 0.0, 1.0); CHKERRQ(ierr); <span class="comment">// Key change: [0,1)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    ierr = PetscRandomSetSeed(*rand_logic_k, rank + 202403); CHKERRQ(ierr);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    ierr = PetscRandomSeed(*rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeLogicalSpaceRNGs - Initialized RNG for k-logical dimension [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_ab723e91906e01ec26aab97de6623000c_icgraph.svg" width="100%" height="376"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a95efc9f04a0187f2a1d920952bd610e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95efc9f04a0187f2a1d920952bd610e0">&#9670;&nbsp;</a></span>InitializeParticleBasicProperties()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode InitializeParticleBasicProperties </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bboxlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initializes basic properties for particles on the local process. </p>
<p>This function assigns initial physical positions, <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> IDs (PIDs), and placeholder cell IDs to particles. The method of position initialization depends on <code>simCtx-&gt;ParticleInitialization</code>:</p><ul>
<li>Mode 0 (Surface): Particles are placed on a designated inlet surface if the current rank services that surface. Otherwise, they are placed at (0,0,0) to be migrated to the correct rank later.</li>
<li>Mode 1 (Volumetric): Particles are placed randomly within a cell owned by the current rank.</li>
</ul>
<p>The logical coordinates for placement are generated using provided random number generators. These logical coordinates are then transformed to physical coordinates using <code>MetricLogicalToPhysical</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure, containing simulation settings and grid information. </td></tr>
    <tr><td class="paramname">particlesPerProcess</td><td>The number of particles to initialize on this MPI rank. </td></tr>
    <tr><td class="paramname">rand_logic_i</td><td>Pointer to a PetscRandom generator for the xi logical coordinate. </td></tr>
    <tr><td class="paramname">rand_logic_j</td><td>Pointer to a PetscRandom generator for the eta logical coordinate. </td></tr>
    <tr><td class="paramname">rand_logic_k</td><td>Pointer to a PetscRandom generator for the zeta logical coordinate. </td></tr>
    <tr><td class="paramname">bboxlist</td><td>(Unused in this function for placement) Pointer to the bounding box list; provided for API consistency but not used for determining initial positions here. <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> positions are determined by logical-to-physical mapping based on rank's owned cells. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00341">341</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    DM             swarm = user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    PetscReal      *positions_field = NULL; <span class="comment">// Pointer to swarm field for physical positions (x,y,z)</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    PetscReal      *pos_phy_field = NULL;   <span class="comment">// Pointer to swarm field for physical positions (backup/alternative)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    PetscInt64     *particleIDs = NULL;     <span class="comment">// Pointer to swarm field for Particle IDs</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    PetscInt       *cellIDs_petsc = NULL;   <span class="comment">// Pointer to swarm field for DMSwarm_CellID (i,j,k of containing cell)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    PetscInt       *status_field  = NULL;   <span class="comment">// Pointer to swarm field for DMSwarm_location_status(NEEDS_LOCATION etc)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    PetscMPIInt    rank,size;                    <span class="comment">// MPI rank of the current process, and total number of ranks.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>   ***coor_nodes_local_array; <span class="comment">// Read-only access to local node coordinates (from user-&gt;da)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    Vec            Coor_local;              <span class="comment">// Local vector for node coordinates</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    DMDALocalInfo  info;                    <span class="comment">// Local grid information (node-based) from user-&gt;da</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    PetscInt       xs_gnode_rank, ys_gnode_rank, zs_gnode_rank; <span class="comment">// Local starting node indices (incl. ghosts) of rank&#39;s DA patch</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    PetscInt       IM_nodes_global, JM_nodes_global, KM_nodes_global; <span class="comment">// Global node counts in each direction</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// Variables for surface initialization (Mode 0)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    PetscBool      can_this_rank_service_inlet = PETSC_FALSE;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// --- 1. Input Validation and Basic Setup ---</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (!user || !rand_logic_i || !rand_logic_j || !rand_logic_k) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;InitializeParticleBasicProperties - Null user or RNG pointer.&quot;</span>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD,&amp;size);  CHKERRQ(ierr);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// Get DMDA information for the node-centered coordinate grid (user-&gt;da)</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    ierr = DMGetCoordinatesLocal(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;Coor_local); CHKERRQ(ierr);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span> (!Coor_local) SETERRQ(PETSC_COMM_SELF, PETSC_ERR_PLIB, <span class="stringliteral">&quot;DMGetCoordinatesLocal for user-&gt;da returned NULL Coor_local.&quot;</span>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, Coor_local, (<span class="keywordtype">void</span>*)&amp;coor_nodes_local_array); CHKERRQ(ierr);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    ierr = DMDAGetLocalInfo(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;info); CHKERRQ(ierr);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    ierr = DMDAGetGhostCorners(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;xs_gnode_rank, &amp;ys_gnode_rank, &amp;zs_gnode_rank, NULL, NULL, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    ierr = DMDAGetInfo(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, NULL, &amp;IM_nodes_global, &amp;JM_nodes_global, &amp;KM_nodes_global, NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;InitializeParticleBasicProperties - Rank %d: Initializing %d particles. Mode: %d.\n&quot;</span>,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;              rank, particlesPerProcess, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// --- 2. Pre-computation for Surface Initialization (Mode 0) ---</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a> == 0) { <span class="comment">// Surface initialization</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        ierr = <a class="code" href="Boundaries_8h.html#ab679d620b2d750179fbc2363fc562a1f">CanRankServiceInletFace</a>(user, &amp;info, IM_nodes_global, JM_nodes_global, KM_nodes_global, &amp;can_this_rank_service_inlet); CHKERRQ(ierr);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (can_this_rank_service_inlet) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;InitProps - Rank %d: Will attempt to place particles on inlet face %d.\n&quot;</span>, rank, user-&gt;<a class="code" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a>);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;InitProps - Rank %d: Cannot service inlet face %d. Particles will be at default (0,0,0) and rely on migration.\n&quot;</span>, rank, user-&gt;<a class="code" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// --- 3. Get Access to Swarm Fields ---</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;position&quot;</span>,       NULL, NULL, (<span class="keywordtype">void</span>**)&amp;positions_field); CHKERRQ(ierr);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;pos_phy&quot;</span>,        NULL, NULL, (<span class="keywordtype">void</span>**)&amp;pos_phy_field);   CHKERRQ(ierr);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;DMSwarm_pid&quot;</span>,    NULL, NULL, (<span class="keywordtype">void</span>**)&amp;particleIDs);    CHKERRQ(ierr);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;DMSwarm_CellID&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;cellIDs_petsc);  CHKERRQ(ierr);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;DMSwarm_location_status&quot;</span>,NULL,NULL,(<span class="keywordtype">void</span>**)&amp;status_field); CHKERRQ(ierr);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// --- 4. Determine Starting Global PID for this Rank ---</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    PetscInt particles_per_rank_ideal = simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> / size; <span class="comment">// Assumes user-&gt;size is PETSC_COMM_WORLD size</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    PetscInt remainder_particles = simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> % size;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    PetscInt base_pid_for_rank = rank * particles_per_rank_ideal + PetscMin(rank, remainder_particles);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// This calculation must match how particlesPerProcess was determined (e.g., in DistributeParticles).</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// --- 5. Loop Over Particles to Initialize ---</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">for</span> (PetscInt p = 0; p &lt; particlesPerProcess; p++) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        PetscInt  ci_metric_lnode, cj_metric_lnode, ck_metric_lnode; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        PetscReal xi_metric_logic, eta_metric_logic, zta_metric_logic; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>    phys_coords = {0.0, 0.0, 0.0}; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        PetscBool particle_placed_by_this_rank = PETSC_FALSE; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a> == 0) { <span class="comment">// --- 5.a. Surface Initialization ---</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">if</span> (can_this_rank_service_inlet) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                ierr = <a class="code" href="Boundaries_8h.html#ac07befc354128d23bac8ed5f2612ffdf">GetRandomCellAndLogicOnInletFace</a>(user, &amp;info, xs_gnode_rank, ys_gnode_rank, zs_gnode_rank,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                                        IM_nodes_global, JM_nodes_global, KM_nodes_global,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                                        rand_logic_i, rand_logic_j, rand_logic_k,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                        &amp;ci_metric_lnode, &amp;cj_metric_lnode, &amp;ck_metric_lnode,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                                        &amp;xi_metric_logic, &amp;eta_metric_logic, &amp;zta_metric_logic); CHKERRQ(ierr);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                ierr = <a class="code" href="Metric_8h.html#af0ba1966641e609476ac6fc3d5cdbbfc">MetricLogicalToPhysical</a>(user, coor_nodes_local_array,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                               ci_metric_lnode, cj_metric_lnode, ck_metric_lnode,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                               xi_metric_logic, eta_metric_logic, zta_metric_logic,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                               &amp;phys_coords); CHKERRQ(ierr);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                particle_placed_by_this_rank = PETSC_TRUE;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// --- 5.b. Volumetric Initialization (simCtx-&gt;ParticleInitialization == 1) ---</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            PetscBool can_place_volumetrically;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            ierr = <a class="code" href="ParticleSwarm_8c.html#ae333eaf5cdf54d396fb84ef574a4945b">DetermineVolumetricInitializationParameters</a>(user, &amp;info, xs_gnode_rank, ys_gnode_rank, zs_gnode_rank,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                                               rand_logic_i, rand_logic_j, rand_logic_k,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                                               &amp;ci_metric_lnode, &amp;cj_metric_lnode, &amp;ck_metric_lnode,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                                               &amp;xi_metric_logic, &amp;eta_metric_logic, &amp;zta_metric_logic,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                                               &amp;can_place_volumetrically); CHKERRQ(ierr);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">if</span>(can_place_volumetrically){</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                 ierr = <a class="code" href="Metric_8h.html#af0ba1966641e609476ac6fc3d5cdbbfc">MetricLogicalToPhysical</a>(user, coor_nodes_local_array,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                           ci_metric_lnode, cj_metric_lnode, ck_metric_lnode,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                           xi_metric_logic, eta_metric_logic, zta_metric_logic,</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                           &amp;phys_coords); CHKERRQ(ierr);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                 particle_placed_by_this_rank = PETSC_TRUE;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                 <a class="code" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, p, 1,</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                    <span class="stringliteral">&quot;InitProps - Rank %d: PID %lld (idx %ld) (Volumetric Mode %d) - DetermineVolumetric... returned false. Default Phys: (%.2f,%.2f,%.2f).\n&quot;</span>,</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    rank, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)(base_pid_for_rank + p), (<span class="keywordtype">long</span>)p, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>, phys_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, phys_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, phys_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// --- 5.c. Store Particle Properties ---</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        positions_field[3*p+0] = phys_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        positions_field[3*p+1] = phys_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        positions_field[3*p+2] = phys_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        pos_phy_field[3*p+0]   = phys_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        pos_phy_field[3*p+1]   = phys_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        pos_phy_field[3*p+2]   = phys_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        particleIDs[p]         = (PetscInt64)base_pid_for_rank + p; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        cellIDs_petsc[3*p+0]   = -1; cellIDs_petsc[3*p+1] = -1; cellIDs_petsc[3*p+2] = -1;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    status_field[p]        = <a class="code" href="variables_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="comment">// --- 5.d. Logging for this particle ---</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">if</span> (particle_placed_by_this_rank) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;             <a class="code" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, p, (particlesPerProcess &gt; 20 ? particlesPerProcess/10 : 1), </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="stringliteral">&quot;InitProps - Rank %d: PID %lld (idx %ld) PLACED. Mode %d. CellOriginNode(locDAIdx):(%d,%d,%d). LogicCoords: (%.2e,%.2f,%.2f). PhysCoords: (%.6f,%.6f,%.6f).\n&quot;</span>,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                rank, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)particleIDs[p], (<span class="keywordtype">long</span>)p, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>, </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                ci_metric_lnode, cj_metric_lnode, ck_metric_lnode,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                xi_metric_logic, eta_metric_logic, zta_metric_logic, </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                phys_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, phys_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, phys_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="keywordflow">else</span> { </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            <a class="code" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, p, (particlesPerProcess &gt; 20 ? particlesPerProcess/10 : 1), </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="stringliteral">&quot;InitProps - Rank %d: PID %lld (idx %ld) Mode %d NOT placed by this rank&#39;s logic. Default Phys: (%.2f,%.2f,%.2f). Relies on migration.\n&quot;</span>,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                rank, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)particleIDs[p], (<span class="keywordtype">long</span>)p, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>, </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                phys_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, phys_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, phys_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    } </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// --- 6. Restore Pointers and Cleanup ---</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;position&quot;</span>,       NULL, NULL, (<span class="keywordtype">void</span>**)&amp;positions_field); CHKERRQ(ierr);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;pos_phy&quot;</span>,        NULL, NULL, (<span class="keywordtype">void</span>**)&amp;pos_phy_field);   CHKERRQ(ierr);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;DMSwarm_pid&quot;</span>,    NULL, NULL, (<span class="keywordtype">void</span>**)&amp;particleIDs);    CHKERRQ(ierr);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;DMSwarm_CellID&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;cellIDs_petsc);  CHKERRQ(ierr);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;DMSwarm_location_status&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;status_field); CHKERRQ(ierr);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, Coor_local, (<span class="keywordtype">void</span>*)&amp;coor_nodes_local_array); CHKERRQ(ierr);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;InitializeParticleBasicProperties - Rank %d: Completed processing for %d particles.\n&quot;</span>,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;              rank, particlesPerProcess);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a95efc9f04a0187f2a1d920952bd610e0_cgraph.svg" width="100%" height="473"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a95efc9f04a0187f2a1d920952bd610e0_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ada215a5db25227a8fd2cd2596e7d3e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada215a5db25227a8fd2cd2596e7d3e57">&#9670;&nbsp;</a></span>InitializeParticleSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeParticleSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform particle swarm initialization, particle-grid interaction, and related operations. </p>
<p>This function handles the following tasks:</p><ol type="1">
<li>Initializes the particle swarm using the provided bounding box list (bboxlist) to determine initial placement if ParticleInitialization is 0.</li>
<li>Locates particles within the computational grid.</li>
<li>Updates particle positions based on grid interactions (if such logic exists elsewhere in the code).</li>
<li>Interpolates particle velocities from grid points using trilinear interpolation.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing grid and particle swarm information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Number of particles to initialize in the swarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Pointer to an array of <a class="el" href="variables__old_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures, one per MPI rank.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure that <code>np</code> (number of particles) is positive.</li>
<li>The <code>bboxlist</code> array must be correctly computed and passed in before calling this function.</li>
<li>If ParticleInitialization == 0, particles will be placed at the midpoint of the local bounding box. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l01174">1174</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160; {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    PetscInt particlesPerProcess = 0;         <span class="comment">// Number of particles assigned to the local MPI process.</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    PetscRandom randx,randy,randz;     <span class="comment">// Random number generators[x,y,z]. (used if ParticleInitialization==1).</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    PetscRandom rand_logic_i, rand_logic_j,rand_logic_k; <span class="comment">// RNGs for Logical space.</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    PetscInt    start_step = 0;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    PetscInt    np = simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <a class="code" href="variables__old_8h.html#structBoundingBox">BoundingBox</a>    *bboxlist = simCtx-&gt;<a class="code" href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">bboxlist</a>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <a class="code" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user = simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">mgctx</a>[simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Starting particle swarm Initialization with %d particles.\n&quot;</span>, np);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <span class="comment">// Step 1: Create and initialize the particle swarm</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="comment">// Here we pass in the bboxlist, which will be used by CreateParticleSwarm() and subsequently</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="comment">// by AssignInitialProperties() to position particles if ParticleInitialization == 0.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Creating particle swarm.\n&quot;</span>);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a063f4fd13a24b248fabd0268c49fd38c">CreateParticleSwarm</a>(user, np, &amp;particlesPerProcess,bboxlist); CHKERRQ(ierr);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Particle swarm created successfully.\n&quot;</span>);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-rstart&quot;</span>, &amp;start_step, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">if</span>(start_step == 0){</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <span class="comment">// Create the RNGs</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Initializing physical space RNGs.\n&quot;</span>);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      ierr = <a class="code" href="ParticleSwarm_8c.html#a26fa0cca0aa8b05f2705cdd0e7d37658">InitializeRandomGenerators</a>(user, &amp;randx, &amp;randy, &amp;randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Initializing logical space RNGs [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      ierr = <a class="code" href="ParticleSwarm_8c.html#ab723e91906e01ec26aab97de6623000c">InitializeLogicalSpaceRNGs</a>(&amp;rand_logic_i, &amp;rand_logic_j, &amp;rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="comment">// Assign initial properties to particles</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;      <span class="comment">// The bboxlist array is passed here so that if ParticleInitialization == 0,</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;      <span class="comment">// particles can be placed at the midpoint of the local bounding box corresponding to this rank.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      ierr = <a class="code" href="ParticleSwarm_8c.html#af2b3080ee0e5c8e0175ac594a2c497b5">AssignInitialPropertiesToSwarm</a>(user, particlesPerProcess, &amp;randx, &amp;randy, &amp;randz, &amp;rand_logic_i,&amp;rand_logic_j,&amp;rand_logic_k,bboxlist); CHKERRQ(ierr);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">// Finalize swarm setup by destroying RNGs if ParticleInitialization == 1</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      ierr = <a class="code" href="ParticleSwarm_8c.html#a075e674353bc5b06344aa4c17063babf">FinalizeSwarmSetup</a>(&amp;randx, &amp;randy, &amp;randz, &amp;rand_logic_i, &amp;rand_logic_j, &amp;rand_logic_k); CHKERRQ(ierr);  </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      <span class="comment">// Ensure all ranks complete before proceeding</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot; Particles generated &amp; initialized.\n&quot;</span>);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (start_step &gt; 0){</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot; Particle Swarm status being set at restart [Step %d].\n&quot;</span>,start_step);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      ierr = <a class="code" href="ParticleMotion_8h.html#ae0c7489fc52fda6c92cd1f22c3f50c38">PreCheckAndResizeSwarm</a>(user,start_step,<span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="comment">// --- Read Particle Data (EVERY timestep) ---</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      <span class="comment">// ReadAllSwarmFields should read position and velocity for timestep &#39;ti&#39;</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      ierr = <a class="code" href="io_8h.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a>(user, start_step);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">// Check if the error was specifically a file open error (missing file)</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">if</span> (ierr == PETSC_ERR_FILE_OPEN) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Missing particle data file(s) for timestep %d. Skipping VTK output for this step.\n&quot;</span>,(PetscInt)user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a> );</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;Failed to read swarm fields for timestep %d (Error code: %d). Skipping VTK output for this step.\n&quot;</span>,(PetscInt)user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>  , ierr);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;       }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160; </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="comment">// Ensure  all the swarm fields not read from file are initialized.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      ierr = <a class="code" href="ParticleSwarm_8c.html#a5488e87ab4fa163467b3db9ce10233a5">PrepareLoadedSwarmForRelocation</a>(user);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="comment">// Ensure all ranks complete before proceeding</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot; Particles generated &amp; initialized.\n&quot;</span>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      </div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; }</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_ada215a5db25227a8fd2cd2596e7d3e57_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_ada215a5db25227a8fd2cd2596e7d3e57_icgraph.svg" width="286" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a26fa0cca0aa8b05f2705cdd0e7d37658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26fa0cca0aa8b05f2705cdd0e7d37658">&#9670;&nbsp;</a></span>InitializeRandomGenerators()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeRandomGenerators </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes random number generators for assigning particle properties. </p>
<p>This function creates and configures separate PETSc random number generators for the x, y, and z coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">randx</td><td>Pointer to store the RNG for the x-coordinate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">randy</td><td>Pointer to store the RNG for the y-coordinate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">randz</td><td>Pointer to store the RNG for the z-coordinate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00112">112</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                                                                                                     {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    PetscErrorCode ierr;  <span class="comment">// Error code for PETSc functions</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    PetscMPIInt rank;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// Initialize RNG for x-coordinate</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, randx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    ierr = PetscRandomSetType((*randx), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ierr = PetscRandomSetInterval(*randx, user-&gt;<a class="code" href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, user-&gt;<a class="code" href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    ierr = PetscRandomSetSeed(*randx, rank + 12345); CHKERRQ(ierr);  <span class="comment">// Unique seed per rank</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    ierr = PetscRandomSeed(*randx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeRandomGenerators - Initialized RNG for X-axis.\n&quot;</span>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// Initialize RNG for y-coordinate</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, randy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    ierr = PetscRandomSetType((*randy), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ierr = PetscRandomSetInterval(*randy, user-&gt;<a class="code" href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, user-&gt;<a class="code" href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    ierr = PetscRandomSetSeed(*randy, rank + 67890); CHKERRQ(ierr);  <span class="comment">// Unique seed per rank</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    ierr = PetscRandomSeed(*randy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeRandomGenerators - Initialized RNG for Y-axis.\n&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// Initialize RNG for z-coordinate</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    ierr = PetscRandomSetType((*randz), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    ierr = PetscRandomSetInterval(*randz, user-&gt;<a class="code" href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, user-&gt;<a class="code" href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    ierr = PetscRandomSetSeed(*randz, rank + 54321); CHKERRQ(ierr);  <span class="comment">// Unique seed per rank</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    ierr = PetscRandomSeed(*randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeRandomGenerators - Initialized RNG for Z-axis.\n&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a26fa0cca0aa8b05f2705cdd0e7d37658_icgraph.svg" width="538" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac3566e0b51587686bc6c1366a67c44af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3566e0b51587686bc6c1366a67c44af">&#9670;&nbsp;</a></span>InitializeSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the DMSwarm object within the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure. </p>
<p>This function creates the DMSwarm, sets its type and dimension, and configures basic swarm properties.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00015">15</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                                              {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    PetscErrorCode ierr;  <span class="comment">// Error code for PETSc functions</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// Create the DMSwarm object for particle management</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    ierr = DMCreate(PETSC_COMM_WORLD, &amp;user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    ierr = DMSetType(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, DMSWARM); CHKERRQ(ierr);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    ierr = DMSetDimension(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, 3); CHKERRQ(ierr);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    ierr = DMSwarmSetType(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, DMSWARM_BASIC); CHKERRQ(ierr);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;InitializeSwarm - DMSwarm created and configured.\n&quot;</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_ac3566e0b51587686bc6c1366a67c44af_icgraph.svg" width="663" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a412856be59df7252e66bcbdd13cf1718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a412856be59df7252e66bcbdd13cf1718">&#9670;&nbsp;</a></span>IsParticleInsideBoundingBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscBool IsParticleInsideBoundingBox </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables__old_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if a particle's location is within a specified bounding box. </p>
<p>This function determines whether the given particle's location lies inside the provided bounding box. It performs an axis-aligned bounding box (AABB) check by comparing the particle's coordinates to the minimum and maximum coordinates of the bounding box in each dimension (x, y, z).</p>
<p>logging statements are included to provide detailed information about the function's execution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bbox</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structure containing minimum and maximum coordinates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure containing the particle's location and identifier.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscBool Returns <code>PETSC_TRUE</code> if the particle is inside the bounding box, <code>PETSC_FALSE</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function assumes that the <code>bbox</code> and <code>particle</code> pointers are valid and non-NULL.</li>
<li>The function includes logging statements that start with the function name.</li>
<li>The <code>LOG_ALLOW_SCOPE</code> variable is used to distinguish between <code>GLOBAL</code> and <code>LOCAL</code> LOG_ALLOW outputs.</li>
<li>Be cautious when logging in performance-critical code sections, especially if the function is called frequently. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00964">964</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;{</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">// Function name for logging purposes</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *funcName = <span class="stringliteral">&quot;IsParticleInsideBoundingBox&quot;</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="comment">// Validate input pointers</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">if</span> (!bbox) {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">// LOG_ALLOW error message and return PETSC_FALSE</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;%s: Error - &#39;bbox&#39; pointer is NULL.&quot;</span>, funcName);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">return</span> PETSC_FALSE;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    }</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (!particle) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>,<span class="stringliteral">&quot;%s: Error - &#39;particle&#39; pointer is NULL.&quot;</span>, funcName);</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <span class="keywordflow">return</span> PETSC_FALSE;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <span class="comment">// Extract particle location and bounding box coordinates</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> loc = particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>;</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> min_coords = bbox-&gt;<a class="code" href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> max_coords = bbox-&gt;<a class="code" href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; </div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="comment">// LOG_ALLOW the particle location and bounding box coordinates for debugging</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;%s: Particle PID %ld location: (%.6f, %.6f, %.6f).\n&quot;</span>, funcName, particle-&gt;<a class="code" href="variables__old_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>, loc.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, loc.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, loc.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;%s: BoundingBox min_coords: (%.6f, %.6f, %.6f), max_coords: (%.6f, %.6f, %.6f).\n&quot;</span>,</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        funcName, min_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, min_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, min_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, max_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, max_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, max_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="comment">// Check if the particle&#39;s location is within the bounding box</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">if</span> ((loc.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> &gt;= min_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> &amp;&amp; loc.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> &lt;= max_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>) &amp;&amp;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        (loc.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> &gt;= min_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> &amp;&amp; loc.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> &lt;= max_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>) &amp;&amp;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        (loc.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> &gt;= min_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> &amp;&amp; loc.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> &lt;= max_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) {</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="comment">// Particle is inside the bounding box</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;%s: Particle PID %ld is inside the bounding box.\n&quot;</span>, funcName, particle-&gt;<a class="code" href="variables__old_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="keywordflow">return</span> PETSC_TRUE;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// Particle is outside the bounding box</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;%s: Particle PID %ld is outside the bounding box.\n&quot;</span>, funcName, particle-&gt;<a class="code" href="variables__old_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">return</span> PETSC_FALSE;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5488e87ab4fa163467b3db9ce10233a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5488e87ab4fa163467b3db9ce10233a5">&#9670;&nbsp;</a></span>PrepareLoadedSwarmForRelocation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode PrepareLoadedSwarmForRelocation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the location-dependent state of a loaded swarm to force relocation. </p>
<p>This function is a critical part of the simulation restart procedure. It must be called immediately after <code>ReadAllSwarmFields</code> has populated a swarm from restart files. Its purpose is to invalidate the "location" state of the loaded particles, ensuring that the <code>LocateAllParticlesInGrid_TEST</code> orchestrator performs a fresh, comprehensive search for every particle based on its loaded position.</p>
<p>It does this by performing two actions on every locally-owned particle:</p><ol type="1">
<li>It resets the <code>DMSwarm_CellID</code> field to a sentinel value of <code>(-1, -1, -1)</code>. This invalidates any cell index that might have been loaded or defaulted to 0.</li>
<li>It sets the <code>DMSwarm_location_status</code> field to <code>NEEDS_LOCATION</code>.</li>
</ol>
<p>This guarantees that the location logic will not mistakenly use a stale cell index from a previous run and will instead use the robust "Guess -&gt; Verify" strategy appropriate for particles with unknown locations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure which contains the <code>DMSwarm</code> object that has just been loaded with data from restart files. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a non-zero PETSc error code if field access fails. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l01078">1078</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;{</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    DM             swarm;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    PetscInt       n_local;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    PetscInt      *cell_p;    <span class="comment">// Pointer to the raw data for the CellID field</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    PetscInt      *status_p;  <span class="comment">// Pointer to the raw data for the location_status field</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    PetscInt64    *PIDs;      <span class="comment">// Pointer to the raw data for the Particle ID field.</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    PetscMPIInt   rank,size;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD,&amp;rank);  CHKERRQ(ierr);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD,&amp;size);  CHKERRQ(ierr);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="comment">// --- 1. Input Validation and Setup ---</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (!user || !user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;UserCtx or its DMSwarm is NULL in PrepareLoadedSwarmForRelocation.&quot;</span>);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    swarm = user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">// Get the number of particles on this MPI rank.</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    ierr = DMSwarmGetLocalSize(swarm, &amp;n_local); CHKERRQ(ierr);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="comment">// If there are no local particles, there is nothing to do.</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (n_local == 0) {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    }</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Preparing %d loaded particles for relocation by resetting their CellID and Status.\n&quot;</span>, n_local);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// --- 2. Get Writable Access to Swarm Fields ---</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="comment">// This provides direct pointers to the underlying data arrays for the fields.</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;DMSwarm_CellID&quot;</span>,          NULL, NULL, (<span class="keywordtype">void</span>**)&amp;cell_p);   CHKERRQ(ierr);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;DMSwarm_location_status&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;status_p); CHKERRQ(ierr);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    ierr = DMSwarmGetField(swarm, <span class="stringliteral">&quot;DMSwarm_pid&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;PIDs); CHKERRQ(ierr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160; </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="comment">// --- 3. Determine Starting Global PID for this Rank ---</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    PetscInt particles_per_rank_ideal = simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> / size; <span class="comment">// Assumes user-&gt;size is PETSC_COMM_WORLD size</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    PetscInt remainder_particles = simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> % size;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    PetscInt base_pid_for_rank = rank * particles_per_rank_ideal + PetscMin(rank, remainder_particles);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// This calculation must match how particlesPerProcess was determined (e.g., in DistributeParticles).</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    </div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">// --- 4. Loop Through All Local Particles and Reset State ---</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordflow">for</span> (PetscInt p = 0; p &lt; n_local; ++p) {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="comment">// Reset the 3 components of the cell index vector.</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        cell_p[3*p + 0] = -1;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        cell_p[3*p + 1] = -1;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        cell_p[3*p + 2] = -1;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="comment">// Reset the status to ensure it will be processed by the location algorithm.</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        status_p[p] = (<a class="code" href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a>)<a class="code" href="variables_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">//set the PID for each particle</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    PIDs[p] =  (PetscInt64)base_pid_for_rank + p;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// --- 4. Restore Fields ---</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="comment">// This returns control of the data arrays back to the DMSwarm. It is a mandatory</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="comment">// step to ensure data consistency and prevent memory issues.</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;DMSwarm_CellID&quot;</span>,          NULL, NULL, (<span class="keywordtype">void</span>**)&amp;cell_p);   CHKERRQ(ierr);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;DMSwarm_location_status&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;status_p); CHKERRQ(ierr);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    ierr = DMSwarmRestoreField(swarm, <span class="stringliteral">&quot;DMSwarm_pid&quot;</span>, NULL, NULL, (<span class="keywordtype">void</span>**)&amp;PIDs); CHKERRQ(ierr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Successfully reset location state for all loaded particles.\n&quot;</span>);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a5488e87ab4fa163467b3db9ce10233a5_icgraph.svg" width="587" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aeae3fd559e91d7379302acb6ccd13011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae3fd559e91d7379302acb6ccd13011">&#9670;&nbsp;</a></span>RegisterParticleFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode RegisterParticleFields </td>
          <td>(</td>
          <td class="paramtype">DM&#160;</td>
          <td class="paramname"><em>swarm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers necessary particle fields within the DMSwarm. </p>
<p>This function registers fields such as position, velocity, CellID, and weight for each particle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">swarm</td><td>The DMSwarm object managing the particle swarm.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00064">64</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Register each field using the helper function</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;position&quot;</span>, 3 ,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Registered field &#39;position&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;velocity&quot;</span>, 3, PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;velocity&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;DMSwarm_CellID&quot;</span>, 3, PETSC_INT); CHKERRQ(ierr);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;DMSwarm_CellID&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;weight&quot;</span>, 3,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;weight&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm,<span class="stringliteral">&quot;Psi&quot;</span>, 1,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;P&#39; - Pressure.\n&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm,<span class="stringliteral">&quot;pos_phy&quot;</span>, 3,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;pos_phy&#39; - Physical Position.\n&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    ierr =  <a class="code" href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a>(swarm,<span class="stringliteral">&quot;DMSwarm_location_status&quot;</span>,1,PETSC_INT);CHKERRQ(ierr);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;DMSwarm_location_status&#39; - Status of Location of Particle(located,lost etc).\n&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// Finalize the field registration after all fields have been added</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    ierr = DMSwarmFinalizeFieldRegister(swarm); CHKERRQ(ierr);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;RegisterParticleFields - Finalized field registration.\n&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_aeae3fd559e91d7379302acb6ccd13011_cgraph.svg" width="372" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_aeae3fd559e91d7379302acb6ccd13011_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a1b5741b17ffa7a57d8c1f6636e956d08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b5741b17ffa7a57d8c1f6636e956d08">&#9670;&nbsp;</a></span>RegisterSwarmField()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode RegisterSwarmField </td>
          <td>(</td>
          <td class="paramtype">DM&#160;</td>
          <td class="paramname"><em>swarm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>fieldDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscDataType&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Registers a swarm field without finalizing registration. </p>
<p>This function calls DMSwarmRegisterPetscDatatypeField for the given field, but does not finalize the registration. The finalization is deferred until all fields have been registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">swarm</td><td>[in] The DMSwarm object. </td></tr>
    <tr><td class="paramname">fieldName</td><td>[in] Name of the field to register. </td></tr>
    <tr><td class="paramname">fieldDim</td><td>[in] Dimension of the field (1 for scalar, 3 for vector, etc.). </td></tr>
    <tr><td class="paramname">dtype</td><td>[in] The datatype of the swarm field being registered. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00041">41</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ierr = DMSwarmRegisterPetscDatatypeField(swarm, fieldName, fieldDim, dtype); CHKERRQ(ierr);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// PetscDataTypes is an extern char* [] defined in petscsystypes.h that gives string names for PetscDataType enums</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;RegisterSwarmField - Registered field &#39;%s&#39; with dimension=%d, type=%s.\n&quot;</span>,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;              fieldName, fieldDim, PetscDataTypes[dtype]);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a1b5741b17ffa7a57d8c1f6636e956d08_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aa353055e357151aab1542bbad367c657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa353055e357151aab1542bbad367c657">&#9670;&nbsp;</a></span>UnpackSwarmFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UnpackSwarmFields </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt64 *&#160;</td>
          <td class="paramname"><em>PIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal *&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt *&#160;</td>
          <td class="paramname"><em>cellIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>velocities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>LocStatus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct with data from DMSwarm fields. </p>
<p>This helper function populates a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure using data retrieved from DMSwarm fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Index of the particle in the DMSwarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIDs</td><td>Pointer to the array of particle IDs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Pointer to the array of particle weights. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">positions</td><td>Pointer to the array of particle positions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellIndices</td><td>Pointer to the array of particle cell indices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">velocities</td><td>Pointer to the array of particle velocities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LocStatus</td><td>Pointer to the array of cell location status indicators. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct to initialize.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns <code>0</code> on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00837">837</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                                                               {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    PetscMPIInt rank;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD,&amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (particle == NULL) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Output Particle pointer is NULL. \n&quot;</span>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// logging the start of particle initialization</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;[Rank %d]Unpacking Particle [%d] with PID: %ld.\n&quot;</span>,rank, i, PIDs[i]);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="comment">// Initialize PID</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a> = PIDs[i];</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] PID set to: %ld.\n&quot;</span>, rank,i, particle-&gt;<a class="code" href="variables__old_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// Initialize weights</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = weights[3 * i];</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = weights[3 * i + 1];</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = weights[3 * i + 2];</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] weights set to: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          rank,i, particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// Initialize locations</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = positions[3 * i];</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = positions[3 * i + 1];</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = positions[3 * i + 2];</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] location set to: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;          rank,i, particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, particle-&gt;<a class="code" href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// Initialize velocities (assuming default zero; modify if necessary)</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = velocities[3 * i];</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = velocities[3 * i + 1];</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = velocities[3 * i + 2];</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d]Particle [%d] velocities unpacked to: [%.6f,%.6f,%.6f].\n&quot;</span>,rank, i,particle-&gt;<a class="code" href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>,particle-&gt;<a class="code" href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>,particle-&gt;<a class="code" href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <span class="comment">// Initialize cell indices</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[0] = cellIndices[3 * i];</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[1] = cellIndices[3 * i + 1];</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[2] = cellIndices[3 * i + 2];</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d]Particle [%d] cell indices set to: [%d, %d, %d].\n&quot;</span>,rank,i, particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[0], particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[1], particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[2]);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a88a45e3c57c861d03160f28aaa786414">location_status</a> = (<a class="code" href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a>)LocStatus[i];</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] Status set to: %d.\n&quot;</span>,rank, i, particle-&gt;<a class="code" href="variables__old_8h.html#a88a45e3c57c861d03160f28aaa786414">location_status</a>);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="comment">// The destination_rank is only set by the location search, not read from the swarm,</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">// so we initialize it to a known invalid state.</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#a76cdf3edbcd6aa56f5a2ba8645e999ea">destination_rank</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <span class="comment">// logging the completion of particle initialization</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;[Rank %d]Completed initialization of Particle [%d]. \n&quot;</span>, rank,i);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_aa353055e357151aab1542bbad367c657_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a0001e483238e2b600cb9aa23a6e5338c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0001e483238e2b600cb9aa23a6e5338c">&#9670;&nbsp;</a></span>UpdateParticleWeights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UpdateParticleWeights </td>
          <td>(</td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates a particle's interpolation weights based on distances to cell faces. </p>
<p>This function computes interpolation weights using distances to the six cell faces (<code>d</code>) and updates the <code>weight</code> field of the provided particle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to an array of distances to the six cell faces. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure whose weights are to be updated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, or a non-zero error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l01015">1015</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                                                       {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="comment">// Validate input pointers</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">if</span> (!d || !particle) {</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL,</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="stringliteral">&quot;UpdateParticleWeights - Null pointer argument (d or particle).&quot;</span>);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="comment">// Validate distances</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">for</span> (PetscInt i = <a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>; i &lt; <a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a>; i++) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="keywordflow">if</span> (d[i] &lt;= <a class="code" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                <span class="stringliteral">&quot;UpdateParticleWeights - face distance d[%d] = %f &lt;= %f; &quot;</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                <span class="stringliteral">&quot;clamping to 1e-14 to avoid zero/negative.\n&quot;</span>,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                i, (<span class="keywordtype">double</span>)d[i], <a class="code" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            d[i] = <a class="code" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="comment">// LOG_ALLOW the input distances</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="stringliteral">&quot;UpdateParticleWeights - Calculating weights with distances: &quot;</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        <span class="stringliteral">&quot;[LEFT=%f, RIGHT=%f, BOTTOM=%f, TOP=%f, FRONT=%f, BACK=%f].\n&quot;</span>,</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>]);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="comment">// Compute and update the particle&#39;s weights</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>] / (d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>] + d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>]);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>] / (d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>] + d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>]);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>] / (d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>] + d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>]);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="comment">// LOG_ALLOW the updated weights</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="stringliteral">&quot;UpdateParticleWeights - Updated particle weights: x=%f, y=%f, z=%f.\n&quot;</span>,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a0001e483238e2b600cb9aa23a6e5338c_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ac52b9e4afa9d1f2ba3bf59dc45b610d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac52b9e4afa9d1f2ba3bf59dc45b610d1">&#9670;&nbsp;</a></span>UpdateSwarmFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UpdateSwarmFields </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables__old_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>cellIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>status_field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates DMSwarm fields with data from a <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct. </p>
<p>This helper function writes back the modified <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> data to the corresponding DMSwarm fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Index of the particle in the DMSwarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct containing updated data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">weights</td><td>Pointer to the array of particle weights. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cellIndices</td><td>Pointer to the array of particle cell indices. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">LocStatus</td><td>Pointer to the array of cell location status indicators.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns <code>0</code> on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00909">909</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (particle == NULL) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Input Particle pointer is NULL.\n&quot;</span>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// logging the start of swarm fields update</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Updating DMSwarm fields for Particle [%d].\n&quot;</span>, i);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="comment">// Update weights</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    weights[3 * i]     = particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    weights[3 * i + 1] = particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    weights[3 * i + 2] = particle-&gt;<a class="code" href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Updated weights for Particle [%d]: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        i, weights[3 * i], weights[3 * i + 1], weights[3 * i + 2]);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">// Update cell indices</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    cellIndices[3 * i]     = particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[0];</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    cellIndices[3 * i + 1] = particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[1];</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    cellIndices[3 * i + 2] = particle-&gt;<a class="code" href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">cell</a>[2];</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Updated cell indices for Particle [%d]: [%d, %d, %d].\n&quot;</span>, </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        i, cellIndices[3 * i], cellIndices[3 * i + 1], cellIndices[3 * i + 2]);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    status_field[i] = particle-&gt;<a class="code" href="variables__old_8h.html#a88a45e3c57c861d03160f28aaa786414">location_status</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Updated location status for Particle [%d]: [%d].\n&quot;</span>, </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        i, status_field[i]);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">// logging the completion of swarm fields update</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Completed updating DMSwarm fields for Particle [%d].\n&quot;</span>, i);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_ac52b9e4afa9d1f2ba3bf59dc45b610d1_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a836356591a56313ee45df507a984907d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a836356591a56313ee45df507a984907d">&#9670;&nbsp;</a></span>UpdateSwarmFieldValue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode UpdateSwarmFieldValue </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>fieldDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>fieldData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to update a given particle’s field value. </p>
<p>This function performs conditional, point-level updates for a swarm field based on its name. For example, you might want to initialize the "velocity" field to 0.0, but the "temperature" field to a nonzero default (e.g., 300.0). This function can be extended for other fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the swarm field. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td><a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldDim</td><td>Dimension of the field. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fieldData</td><td>Pointer to the field’s data array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00504">504</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;velocity&quot;</span>) == 0) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="comment">// For velocity, initialize all components to zero</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">for</span> (PetscInt d = 0; d &lt; fieldDim; d++) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      fieldData[fieldDim * p + d] = 0.0;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;temperature&quot;</span>) == 0) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// For temperature, for example, initialize to a default value (e.g., 300.0)</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">for</span> (PetscInt d = 0; d &lt; fieldDim; d++) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      fieldData[fieldDim * p + d] = 300.0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Psi&quot;</span>) == 0) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// For pressure, initialize to a default value (e.g., 101325.0)</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">for</span> (PetscInt d = 0; d &lt; fieldDim; d++) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      fieldData[fieldDim * p + d] = 0.0;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// Default: initialize all components to zero</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">for</span> (PetscInt d = 0; d &lt; fieldDim; d++) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      fieldData[fieldDim * p + d] = 0.0;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8c_a836356591a56313ee45df507a984907d_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="avariables__old_8h_html_a4a7154d09d7dee5e3dd7f0323dfb4ff3"><div class="ttname"><a href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">MGCtx::user</a></div><div class="ttdeci">UserCtx * user</div><div class="ttdoc">Pointer to the main application context for this level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00419">variables.h:419</a></div></div>
<div class="ttc" id="avariables_8h_html_a8c248c162038dffe12e38228bcd06644"><div class="ttname"><a href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">SimCtx::bboxlist</a></div><div class="ttdeci">BoundingBox * bboxlist</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00549">variables.h:549</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_ae333eaf5cdf54d396fb84ef574a4945b"><div class="ttname"><a href="ParticleSwarm_8c.html#ae333eaf5cdf54d396fb84ef574a4945b">DetermineVolumetricInitializationParameters</a></div><div class="ttdeci">static PetscErrorCode DetermineVolumetricInitializationParameters(UserCtx *user, DMDALocalInfo *info, PetscInt xs_gnode, PetscInt ys_gnode, PetscInt zs_gnode, PetscRandom *rand_logic_i_ptr, PetscRandom *rand_logic_j_ptr, PetscRandom *rand_logic_k_ptr, PetscInt *ci_metric_lnode_out, PetscInt *cj_metric_lnode_out, PetscInt *ck_metric_lnode_out, PetscReal *xi_metric_logic_out, PetscReal *eta_metric_logic_out, PetscReal *zta_metric_logic_out, PetscBool *can_place_in_volume_out)</div><div class="ttdoc">Determines cell selection and intra-cell logical coordinates for volumetric initialization (Mode 1).</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00230">ParticleSwarm.c:230</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_ac3566e0b51587686bc6c1366a67c44af"><div class="ttname"><a href="ParticleSwarm_8c.html#ac3566e0b51587686bc6c1366a67c44af">InitializeSwarm</a></div><div class="ttdeci">PetscErrorCode InitializeSwarm(UserCtx *user)</div><div class="ttdoc">Initializes the DMSwarm object within the UserCtx structure.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00015">ParticleSwarm.c:15</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aac8e0dd714804b073dbb32c0ad84b2eb"><div class="ttname"><a href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">UserMG::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdoc">Total number of multigrid levels.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00426">variables.h:426</a></div></div>
<div class="ttc" id="avariables_8h_html_ac9684d6e871566d55c997416270b5b99"><div class="ttname"><a href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">SimCtx::step</a></div><div class="ttdeci">PetscInt step</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00482">variables.h:482</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a></div><div class="ttdeci">@ BOTTOM</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a6b5da58d79c9c0ed6e9368c9677d5260"><div class="ttname"><a href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">BoundingBox::min_coords</a></div><div class="ttdeci">Cmpnts min_coords</div><div class="ttdoc">Minimum x, y, z coordinates of the bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00155">variables.h:155</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a></div><div class="ttdeci">@ LOG_WARNING</div><div class="ttdoc">Non-critical issues that warrant attention.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00030">logging.h:30</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structUserCtx"><div class="ttname"><a href="variables__old_8h.html#structUserCtx">UserCtx</a></div><div class="ttdoc">User-defined context containing data specific to a single computational grid level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00582">variables.h:582</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a075e674353bc5b06344aa4c17063babf"><div class="ttname"><a href="ParticleSwarm_8c.html#a075e674353bc5b06344aa4c17063babf">FinalizeSwarmSetup</a></div><div class="ttdeci">PetscErrorCode FinalizeSwarmSetup(PetscRandom *randx, PetscRandom *randy, PetscRandom *randz, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</div><div class="ttdoc">Finalizes the swarm setup by destroying random generators and logging completion.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00720">ParticleSwarm.c:720</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a></div><div class="ttdeci">@ LEFT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a></div><div class="ttdeci">@ RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="alogging_8h_html_a2ebe7667b52c478f7ff365f296d4c8ae"><div class="ttname"><a href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a></div><div class="ttdeci">#define LOG_ALLOW_SYNC(scope, level, fmt,...)</div><div class="ttdoc">----— DEBUG ---------------------------------------— #define LOG_ALLOW(scope, level,...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00274">logging.h:274</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a88a45e3c57c861d03160f28aaa786414"><div class="ttname"><a href="variables__old_8h.html#a88a45e3c57c861d03160f28aaa786414">Particle::location_status</a></div><div class="ttdeci">ParticleLocationStatus location_status</div><div class="ttdoc">Current state in the location/migration process.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00171">variables.h:171</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00474">variables.h:474</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a1b5741b17ffa7a57d8c1f6636e956d08"><div class="ttname"><a href="ParticleSwarm_8c.html#a1b5741b17ffa7a57d8c1f6636e956d08">RegisterSwarmField</a></div><div class="ttdeci">static PetscErrorCode RegisterSwarmField(DM swarm, const char *fieldName, PetscInt fieldDim, PetscDataType dtype)</div><div class="ttdoc">Registers a swarm field without finalizing registration.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00041">ParticleSwarm.c:41</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a></div><div class="ttdeci">@ BACK</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structBoundingBox"><div class="ttname"><a href="variables__old_8h.html#structBoundingBox">BoundingBox</a></div><div class="ttdoc">Defines a 3D axis-aligned bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00154">variables.h:154</a></div></div>
<div class="ttc" id="avariables_8h_html_a347829443e8a679209e21f7f04f51581"><div class="ttname"><a href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a></div><div class="ttdeci">ParticleLocationStatus</div><div class="ttdoc">Defines the state of a particle with respect to its location and migration status during the iterativ...</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00135">variables.h:135</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a38c3c55ea49021ac59eea87b61e942d1"><div class="ttname"><a href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a></div><div class="ttdeci">static PetscErrorCode AssignInitialFieldToSwarm(UserCtx *user, const char *fieldName, PetscInt fieldDim)</div><div class="ttdoc">Initializes a generic swarm field with point-level updates.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00544">ParticleSwarm.c:544</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ae85e7171c483d180ffe8759fd13b4312"><div class="ttname"><a href="variables__old_8h.html#ae85e7171c483d180ffe8759fd13b4312">UserCtx::bbox</a></div><div class="ttdeci">BoundingBox bbox</div><div class="ttdoc">Bounding box for the local processor's grid domain.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00593">variables.h:593</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_aeae3fd559e91d7379302acb6ccd13011"><div class="ttname"><a href="ParticleSwarm_8c.html#aeae3fd559e91d7379302acb6ccd13011">RegisterParticleFields</a></div><div class="ttdeci">PetscErrorCode RegisterParticleFields(DM swarm)</div><div class="ttdoc">Registers necessary particle fields within the DMSwarm.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00064">ParticleSwarm.c:64</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a063f4fd13a24b248fabd0268c49fd38c"><div class="ttname"><a href="ParticleSwarm_8c.html#a063f4fd13a24b248fabd0268c49fd38c">CreateParticleSwarm</a></div><div class="ttdeci">PetscErrorCode CreateParticleSwarm(UserCtx *user, PetscInt numParticles, PetscInt *particlesPerProcess, BoundingBox *bboxlist)</div><div class="ttdoc">Creates and initializes a Particle Swarm.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00764">ParticleSwarm.c:764</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a></div><div class="ttdeci">@ LOG_ERROR</div><div class="ttdoc">Critical errors that may halt the program.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00029">logging.h:29</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ac6633daab270004cd266f6e6ac05f588"><div class="ttname"><a href="variables__old_8h.html#ac6633daab270004cd266f6e6ac05f588">UserCtx::Min_Y</a></div><div class="ttdeci">PetscReal Min_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a></div><div class="ttdeci">@ TOP</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a76cdf3edbcd6aa56f5a2ba8645e999ea"><div class="ttname"><a href="variables__old_8h.html#a76cdf3edbcd6aa56f5a2ba8645e999ea">Particle::destination_rank</a></div><div class="ttdeci">PetscMPIInt destination_rank</div><div class="ttdoc">Target rank for migration (only valid if status MIGRATING_OUT)</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00172">variables.h:172</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aecbc2de7a281e906efe25a773b76866c"><div class="ttname"><a href="variables__old_8h.html#aecbc2de7a281e906efe25a773b76866c">UserCtx::Max_Z</a></div><div class="ttdeci">PetscReal Max_Z</div><div class="ttdoc">Physical maximum bounds of the grid.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="alogging_8h_html_a2358badbcda33fc9d80ebd6a59d2a2cd"><div class="ttname"><a href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a></div><div class="ttdeci">PetscBool is_function_allowed(const char *functionName)</div><div class="ttdoc">Checks if a given function is in the allow-list.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00159">logging.c:159</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a></div><div class="ttdeci">@ FRONT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="aio_8h_html_a64286adf953993b2a0c5c3fbee40d5a2"><div class="ttname"><a href="io_8h.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a></div><div class="ttdeci">PetscErrorCode ReadAllSwarmFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads multiple fields (positions, velocity, CellID, and weight) into a DMSwarm.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l02318">io.c:2318</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a95efc9f04a0187f2a1d920952bd610e0"><div class="ttname"><a href="ParticleSwarm_8c.html#a95efc9f04a0187f2a1d920952bd610e0">InitializeParticleBasicProperties</a></div><div class="ttdeci">static PetscErrorCode InitializeParticleBasicProperties(UserCtx *user, PetscInt particlesPerProcess, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, BoundingBox *bboxlist)</div><div class="ttdoc">Initializes basic properties for particles on the local process.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00341">ParticleSwarm.c:341</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structCmpnts"><div class="ttname"><a href="variables__old_8h.html#structCmpnts">Cmpnts</a></div><div class="ttdoc">A 3D point or vector with PetscScalar components.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00100">variables.h:100</a></div></div>
<div class="ttc" id="avariables_8h_html_a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780"><div class="ttname"><a href="variables_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a></div><div class="ttdeci">@ UNINITIALIZED</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00140">variables.h:140</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3cf9af789ad3875d496c48112ade0ec"><div class="ttname"><a href="variables__old_8h.html#ad3cf9af789ad3875d496c48112ade0ec">Particle::weights</a></div><div class="ttdeci">Cmpnts weights</div><div class="ttdoc">Interpolation weights within its host cell.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00170">variables.h:170</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a1300c167a3006a58c71fe8759ebf5ef1"><div class="ttname"><a href="variables__old_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">UserCtx::inletFaceDefined</a></div><div class="ttdeci">PetscBool inletFaceDefined</div><div class="ttdoc">Legacy flag for particle system compatibility.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00601">variables.h:601</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a></div><div class="ttdeci">@ NUM_FACES</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a3b8cd77851de92f44b3821c6d15fb725"><div class="ttname"><a href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a></div><div class="ttdeci">#define INTERPOLATION_DISTANCE_TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00005">ParticleSwarm.c:5</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a718a09fbedf450248eaf7019a980e139"><div class="ttname"><a href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">Cmpnts::x</a></div><div class="ttdeci">PetscScalar x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a1cc0975a3eec2e2f817d0e3a09040620"><div class="ttname"><a href="ParticleSwarm_8c.html#a1cc0975a3eec2e2f817d0e3a09040620">DistributeParticles</a></div><div class="ttdeci">PetscErrorCode DistributeParticles(PetscInt numParticles, PetscMPIInt rank, PetscMPIInt size, PetscInt *particlesPerProcess, PetscInt *remainder)</div><div class="ttdoc">Distributes particles evenly across MPI processes, handling any remainders.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00689">ParticleSwarm.c:689</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_af2b3080ee0e5c8e0175ac594a2c497b5"><div class="ttname"><a href="ParticleSwarm_8c.html#af2b3080ee0e5c8e0175ac594a2c497b5">AssignInitialPropertiesToSwarm</a></div><div class="ttdeci">PetscErrorCode AssignInitialPropertiesToSwarm(UserCtx *user, PetscInt particlesPerProcess, PetscRandom *rand_phys_x, PetscRandom *rand_phys_y, PetscRandom *rand_phys_z, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, BoundingBox *bboxlist)</div><div class="ttdoc">Initializes all particle properties in the swarm.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00606">ParticleSwarm.c:606</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a90250e79337972756b8ce1daae2321f9"><div class="ttname"><a href="variables__old_8h.html#a90250e79337972756b8ce1daae2321f9">Particle::cell</a></div><div class="ttdeci">PetscInt cell[3]</div><div class="ttdoc">Computational indices (i, j, k) of the cell containing the particle.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00167">variables.h:167</a></div></div>
<div class="ttc" id="alogging_8h_html_a9585f583c260f40a73f2490914edc689"><div class="ttname"><a href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a></div><div class="ttdeci">LogLevel get_log_level()</div><div class="ttdoc">Retrieves the current logging level from the environment variable LOG_LEVEL.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00049">logging.c:49</a></div></div>
<div class="ttc" id="avariables_8h_html_a41a6127b3c012c516a7dcc56c3696a84"><div class="ttname"><a href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">SimCtx::usermg</a></div><div class="ttdeci">UserMG usermg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00560">variables.h:560</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a836356591a56313ee45df507a984907d"><div class="ttname"><a href="ParticleSwarm_8c.html#a836356591a56313ee45df507a984907d">UpdateSwarmFieldValue</a></div><div class="ttdeci">static PetscErrorCode UpdateSwarmFieldValue(const char *fieldName, PetscInt p, PetscInt fieldDim, PetscReal *fieldData)</div><div class="ttdoc">Helper function to update a given particle’s field value.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00504">ParticleSwarm.c:504</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aaeef1864bb110c26e4b30a9e2c8c116d"><div class="ttname"><a href="variables__old_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">UserCtx::Min_Z</a></div><div class="ttdeci">PetscReal Min_Z</div><div class="ttdoc">Physical minimum bounds of the grid.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="aBoundaries_8h_html_ac07befc354128d23bac8ed5f2612ffdf"><div class="ttname"><a href="Boundaries_8h.html#ac07befc354128d23bac8ed5f2612ffdf">GetRandomCellAndLogicOnInletFace</a></div><div class="ttdeci">PetscErrorCode GetRandomCellAndLogicOnInletFace(UserCtx *user, const DMDALocalInfo *info, PetscInt xs_gnode_rank, PetscInt ys_gnode_rank, PetscInt zs_gnode_rank, PetscInt IM_nodes_global, PetscInt JM_nodes_global, PetscInt KM_nodes_global, PetscRandom *rand_logic_i_ptr, PetscRandom *rand_logic_j_ptr, PetscRandom *rand_logic_k_ptr, PetscInt *ci_metric_lnode_out, PetscInt *cj_metric_lnode_out, PetscInt *ck_metric_lnode_out, PetscReal *xi_metric_logic_out, PetscReal *eta_metric_logic_out, PetscReal *zta_metric_logic_out)</div><div class="ttdoc">Assuming the current rank services the inlet face, this function selects a random cell (owned by this...</div><div class="ttdef"><b>Definition:</b> <a href="Boundaries_8c_source.html#l00225">Boundaries.c:225</a></div></div>
<div class="ttc" id="avariables_8h_html_a5eedf611da6dd4f59cc65753b777b957"><div class="ttname"><a href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">SimCtx::np</a></div><div class="ttdeci">PetscInt np</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00546">variables.h:546</a></div></div>
<div class="ttc" id="aBoundaries_8h_html_ab679d620b2d750179fbc2363fc562a1f"><div class="ttname"><a href="Boundaries_8h.html#ab679d620b2d750179fbc2363fc562a1f">CanRankServiceInletFace</a></div><div class="ttdeci">PetscErrorCode CanRankServiceInletFace(UserCtx *user, const DMDALocalInfo *info, PetscInt IM_nodes_global, PetscInt JM_nodes_global, PetscInt KM_nodes_global, PetscBool *can_service_inlet_out)</div><div class="ttdoc">Determines if the current MPI rank owns any part of the globally defined inlet face,...</div><div class="ttdef"><b>Definition:</b> <a href="Boundaries_8c_source.html#l00024">Boundaries.c:24</a></div></div>
<div class="ttc" id="alogging_8h_html_a1543cd95db1569c7d901fd4b9a3a43d7"><div class="ttname"><a href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a></div><div class="ttdeci">#define LOG_LOOP_ALLOW(scope, level, iterVar, interval, fmt,...)</div><div class="ttdoc">Logs a message inside a loop, but only every interval iterations.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00319">logging.h:319</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ac3ea6849d6d1556f240ace7a6d9a3347"><div class="ttname"><a href="variables__old_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">UserCtx::Max_X</a></div><div class="ttdeci">PetscReal Max_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a5488e87ab4fa163467b3db9ce10233a5"><div class="ttname"><a href="ParticleSwarm_8c.html#a5488e87ab4fa163467b3db9ce10233a5">PrepareLoadedSwarmForRelocation</a></div><div class="ttdeci">PetscErrorCode PrepareLoadedSwarmForRelocation(UserCtx *user)</div><div class="ttdoc">Resets the location-dependent state of a loaded swarm to force relocation.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l01078">ParticleSwarm.c:1078</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a27bce072860da2f1a8a54d94b2b9497f"><div class="ttname"><a href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">UserCtx::identifiedInletBCFace</a></div><div class="ttdeci">BCFace identifiedInletBCFace</div><div class="ttdoc">Legacy field for particle system compatibility.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00602">variables.h:602</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_ab723e91906e01ec26aab97de6623000c"><div class="ttname"><a href="ParticleSwarm_8c.html#ab723e91906e01ec26aab97de6623000c">InitializeLogicalSpaceRNGs</a></div><div class="ttdeci">PetscErrorCode InitializeLogicalSpaceRNGs(PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</div><div class="ttdoc">Initializes random number generators for logical space operations [0.0, 1.0).</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00158">ParticleSwarm.c:158</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00207">logging.h:207</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a3c5226c112cabe2fc24230877bf7cc3c"><div class="ttname"><a href="variables__old_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">UserCtx::Min_X</a></div><div class="ttdeci">PetscReal Min_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables_8h_html_ae3ce8967b15c2e6be9e829b745da4090"><div class="ttname"><a href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">SimCtx::ParticleInitialization</a></div><div class="ttdeci">PetscInt ParticleInitialization</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00550">variables.h:550</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a1675749ea3b2429f00405a1ee3203d18"><div class="ttname"><a href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">UserCtx::swarm</a></div><div class="ttdeci">DM swarm</div><div class="ttdoc">DMSwarm object for particle data.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00647">variables.h:647</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4d66dc20efb64cf45770997139fae524"><div class="ttname"><a href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">BoundingBox::max_coords</a></div><div class="ttdeci">Cmpnts max_coords</div><div class="ttdoc">Maximum x, y, z coordinates of the bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00156">variables.h:156</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0dedc7a71f2bf127463d9bfd4ed41103"><div class="ttname"><a href="variables__old_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">Particle::vel</a></div><div class="ttdeci">Cmpnts vel</div><div class="ttdoc">Physical velocity (vx,vy,vz) of the particle.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00169">variables.h:169</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9f0c002a2c7cde3b6ac843ab9185f4d4"><div class="ttname"><a href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">Cmpnts::z</a></div><div class="ttdeci">PetscScalar z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aecd4cd7f1da07e3f3d6e1fb6cf71a44b"><div class="ttname"><a href="variables__old_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">Particle::PID</a></div><div class="ttdeci">PetscInt64 PID</div><div class="ttdoc">Unique Particle ID.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00166">variables.h:166</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a10f4f7dc00a854759067cf96ab66485a"><div class="ttname"><a href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">UserMG::mgctx</a></div><div class="ttdeci">MGCtx * mgctx</div><div class="ttdoc">Array of multigrid contexts, one for each level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00429">variables.h:429</a></div></div>
<div class="ttc" id="avariables__old_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdoc">DMDA for scalar fields (e.g., Pressure, Nvert).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad032e456f7f4b32b9ac0d94be05de204"><div class="ttname"><a href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">Cmpnts::y</a></div><div class="ttdeci">PetscScalar y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="aMetric_8h_html_af0ba1966641e609476ac6fc3d5cdbbfc"><div class="ttname"><a href="Metric_8h.html#af0ba1966641e609476ac6fc3d5cdbbfc">MetricLogicalToPhysical</a></div><div class="ttdeci">PetscErrorCode MetricLogicalToPhysical(UserCtx *user, const Cmpnts ***X, PetscInt i, PetscInt j, PetscInt k, PetscReal xi, PetscReal eta, PetscReal zta, Cmpnts *Xp)</div><div class="ttdoc">Public wrapper: map (cell index, ξ,η,ζ) to (x,y,z).</div><div class="ttdef"><b>Definition:</b> <a href="Metric_8c_source.html#l00068">Metric.c:68</a></div></div>
<div class="ttc" id="aParticleMotion_8h_html_ae0c7489fc52fda6c92cd1f22c3f50c38"><div class="ttname"><a href="ParticleMotion_8h.html#ae0c7489fc52fda6c92cd1f22c3f50c38">PreCheckAndResizeSwarm</a></div><div class="ttdeci">PetscErrorCode PreCheckAndResizeSwarm(UserCtx *user, PetscInt ti, const char *ext)</div><div class="ttdoc">Checks particle count in the reference file and resizes the swarm if needed.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleMotion_8c_source.html#l01170">ParticleMotion.c:1170</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a71cca12cd9fb0796634a7076eeb9b50b"><div class="ttname"><a href="variables__old_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">Particle::loc</a></div><div class="ttdeci">Cmpnts loc</div><div class="ttdoc">Physical location (x,y,z) of the particle.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00168">variables.h:168</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a69966d928601d61d4f526636f84396c5"><div class="ttname"><a href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">UserCtx::fda</a></div><div class="ttdeci">DM fda</div><div class="ttdoc">DMDA for primary 3-component vector fields (e.g., Velocity).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a26fa0cca0aa8b05f2705cdd0e7d37658"><div class="ttname"><a href="ParticleSwarm_8c.html#a26fa0cca0aa8b05f2705cdd0e7d37658">InitializeRandomGenerators</a></div><div class="ttdeci">PetscErrorCode InitializeRandomGenerators(UserCtx *user, PetscRandom *randx, PetscRandom *randy, PetscRandom *randz)</div><div class="ttdoc">Initializes random number generators for assigning particle properties.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00112">ParticleSwarm.c:112</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a60bfc6b6d761a90da39b0f053bebcb31"><div class="ttname"><a href="variables__old_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">UserCtx::Max_Y</a></div><div class="ttdeci">PetscReal Max_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="ParticleSwarm_8c.html">ParticleSwarm.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
