<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pic_dev: io.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pic_dev
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">Particle-in-Cell / CFD development codebase</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('io_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">io.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of data input/output routines, focusing on grid configuration.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="io_8h_source.html">io.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for io.c:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="io_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;ReadGridGenerationInputs&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;ReadGridFile&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7dd125436244f23eba5c6b06fdd35031"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a7dd125436244f23eba5c6b06fdd35031">ReadGridGenerationInputs</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a7dd125436244f23eba5c6b06fdd35031"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses command-line options for a programmatically generated grid for a SINGLE block.  <a href="io_8c.html#a7dd125436244f23eba5c6b06fdd35031">More...</a><br /></td></tr>
<tr class="separator:a7dd125436244f23eba5c6b06fdd35031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1454fbb30915c3284cbf5ecb100351d1"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a1454fbb30915c3284cbf5ecb100351d1">ReadGridFile</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a1454fbb30915c3284cbf5ecb100351d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets grid dimensions from a file for a SINGLE block using a one-time read cache.  <a href="io_8c.html#a1454fbb30915c3284cbf5ecb100351d1">More...</a><br /></td></tr>
<tr class="separator:a1454fbb30915c3284cbf5ecb100351d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee53553fb7d51eb948f1d4030518860"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#acee53553fb7d51eb948f1d4030518860">FreeBC_ParamList</a> (<a class="el" href="variables_8h.html#a22a9148c380850b8568b82d154446340">BC_Param</a> *head)</td></tr>
<tr class="memdesc:acee53553fb7d51eb948f1d4030518860"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the memory allocated for a linked list of BC_Param structs.  <a href="io_8c.html#acee53553fb7d51eb948f1d4030518860">More...</a><br /></td></tr>
<tr class="separator:acee53553fb7d51eb948f1d4030518860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6896c293521673fcbff33001706d3ec"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ab6896c293521673fcbff33001706d3ec">StringToBCFace</a> (const char *str, <a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a> *face_out)</td></tr>
<tr class="memdesc:ab6896c293521673fcbff33001706d3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a string representation of a face to a BCFace enum.  <a href="io_8c.html#ab6896c293521673fcbff33001706d3ec">More...</a><br /></td></tr>
<tr class="separator:ab6896c293521673fcbff33001706d3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5fc2fe7ae3aa77361c5ab62343358a7"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ad5fc2fe7ae3aa77361c5ab62343358a7">StringToBCType</a> (const char *str, <a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a> *type_out)</td></tr>
<tr class="memdesc:ad5fc2fe7ae3aa77361c5ab62343358a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a string representation of a BC type to a BCType enum.  <a href="io_8c.html#ad5fc2fe7ae3aa77361c5ab62343358a7">More...</a><br /></td></tr>
<tr class="separator:ad5fc2fe7ae3aa77361c5ab62343358a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15bdb2122be30f52df280e1d7204f578"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a15bdb2122be30f52df280e1d7204f578">StringToBCHandlerType</a> (const char *str, <a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a> *handler_out)</td></tr>
<tr class="memdesc:a15bdb2122be30f52df280e1d7204f578"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a string representation of a handler to a BCHandlerType enum.  <a href="io_8c.html#a15bdb2122be30f52df280e1d7204f578">More...</a><br /></td></tr>
<tr class="separator:a15bdb2122be30f52df280e1d7204f578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fe767286174b757deb2d404f2b4843f"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5fe767286174b757deb2d404f2b4843f">ValidateBCHandlerForBCType</a> (<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a> type, <a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a> handler)</td></tr>
<tr class="memdesc:a5fe767286174b757deb2d404f2b4843f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates that a specific handler is compatible with a general BC type.  <a href="io_8c.html#a5fe767286174b757deb2d404f2b4843f">More...</a><br /></td></tr>
<tr class="separator:a5fe767286174b757deb2d404f2b4843f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc5e40cd538efc87ebd94ebdbb2a8e8"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5cc5e40cd538efc87ebd94ebdbb2a8e8">ParseAllBoundaryConditions</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *bcs_input_filename)</td></tr>
<tr class="memdesc:a5cc5e40cd538efc87ebd94ebdbb2a8e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the boundary conditions file to configure the type, handler, and any associated parameters for all 6 global faces of the domain.  <a href="io_8c.html#a5cc5e40cd538efc87ebd94ebdbb2a8e8">More...</a><br /></td></tr>
<tr class="separator:a5cc5e40cd538efc87ebd94ebdbb2a8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d7097c8ad047feb1d460e4694b8b4f"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ab7d7097c8ad047feb1d460e4694b8b4f">CheckDataFile</a> (PetscInt ti, const char *fieldName, const char *ext, PetscBool *fileExists)</td></tr>
<tr class="memdesc:ab7d7097c8ad047feb1d460e4694b8b4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks for a data file's existence in a parallel-safe manner.  <a href="io_8c.html#ab7d7097c8ad047feb1d460e4694b8b4f">More...</a><br /></td></tr>
<tr class="separator:ab7d7097c8ad047feb1d460e4694b8b4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570806d7e0694b5d996e0c6018b48908"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *field_name, Vec field_vec, PetscInt ti, const char *ext)</td></tr>
<tr class="memdesc:a570806d7e0694b5d996e0c6018b48908"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads data for a specific field from a file into the provided vector.  <a href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">More...</a><br /></td></tr>
<tr class="separator:a570806d7e0694b5d996e0c6018b48908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a009dabc71ccfa59f196e1bc045de45"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3a009dabc71ccfa59f196e1bc045de45">ReadSimulationFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt ti)</td></tr>
<tr class="memdesc:a3a009dabc71ccfa59f196e1bc045de45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads simulation fields from files into their respective PETSc vectors.  <a href="io_8c.html#a3a009dabc71ccfa59f196e1bc045de45">More...</a><br /></td></tr>
<tr class="separator:a3a009dabc71ccfa59f196e1bc045de45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f5b76975eea55434d764a23fd42623"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a03f5b76975eea55434d764a23fd42623">ReadStatisticalFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt ti)</td></tr>
<tr class="memdesc:a03f5b76975eea55434d764a23fd42623"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads statistical fields for averaging purposes.  <a href="io_8c.html#a03f5b76975eea55434d764a23fd42623">More...</a><br /></td></tr>
<tr class="separator:a03f5b76975eea55434d764a23fd42623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45ad89f26c78131d2990f09126abba4b"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a45ad89f26c78131d2990f09126abba4b">ReadLESFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt ti)</td></tr>
<tr class="memdesc:a45ad89f26c78131d2990f09126abba4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads LES-related fields.  <a href="io_8c.html#a45ad89f26c78131d2990f09126abba4b">More...</a><br /></td></tr>
<tr class="separator:a45ad89f26c78131d2990f09126abba4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19e2e0b57afae458bae068610141c031"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a19e2e0b57afae458bae068610141c031">ReadRANSFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt ti)</td></tr>
<tr class="memdesc:a19e2e0b57afae458bae068610141c031"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads RANS-related fields.  <a href="io_8c.html#a19e2e0b57afae458bae068610141c031">More...</a><br /></td></tr>
<tr class="separator:a19e2e0b57afae458bae068610141c031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f37cf6ed1f13d0656740b8cff2b4ed8"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *field_name, Vec field_vec, PetscInt ti, const char *ext)</td></tr>
<tr class="memdesc:a3f37cf6ed1f13d0656740b8cff2b4ed8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes data from a specific PETSc vector to a file.  <a href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">More...</a><br /></td></tr>
<tr class="separator:a3f37cf6ed1f13d0656740b8cff2b4ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6228caf497c8e6134362aab6ba62828c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a6228caf497c8e6134362aab6ba62828c">WriteSimulationFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a6228caf497c8e6134362aab6ba62828c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes simulation fields to files.  <a href="io_8c.html#a6228caf497c8e6134362aab6ba62828c">More...</a><br /></td></tr>
<tr class="separator:a6228caf497c8e6134362aab6ba62828c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3515d51bdd91f00faf8e5023bc82534b"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3515d51bdd91f00faf8e5023bc82534b">WriteStatisticalFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a3515d51bdd91f00faf8e5023bc82534b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes statistical fields for averaging purposes.  <a href="io_8c.html#a3515d51bdd91f00faf8e5023bc82534b">More...</a><br /></td></tr>
<tr class="separator:a3515d51bdd91f00faf8e5023bc82534b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fe2d107007076b401d19ba9145a354"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#aa7fe2d107007076b401d19ba9145a354">WriteLESFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:aa7fe2d107007076b401d19ba9145a354"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes LES-related fields.  <a href="io_8c.html#aa7fe2d107007076b401d19ba9145a354">More...</a><br /></td></tr>
<tr class="separator:aa7fe2d107007076b401d19ba9145a354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87768b32e2f93a36633fe104cebcdfe8"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a87768b32e2f93a36633fe104cebcdfe8">WriteRANSFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a87768b32e2f93a36633fe104cebcdfe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes RANS-related fields.  <a href="io_8c.html#a87768b32e2f93a36633fe104cebcdfe8">More...</a><br /></td></tr>
<tr class="separator:a87768b32e2f93a36633fe104cebcdfe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3ac50e182d193208800c89201ff236"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a2c3ac50e182d193208800c89201ff236">WriteSwarmField</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *field_name, PetscInt ti, const char *ext)</td></tr>
<tr class="memdesc:a2c3ac50e182d193208800c89201ff236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes data from a specific field in a PETSc Swarm to a file.  <a href="io_8c.html#a2c3ac50e182d193208800c89201ff236">More...</a><br /></td></tr>
<tr class="separator:a2c3ac50e182d193208800c89201ff236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a105ff5a8b90917a52aab304aefeae05a"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a105ff5a8b90917a52aab304aefeae05a">ReadDataFileToArray</a> (const char *filename, double **data_out, PetscInt *Nout, MPI_Comm comm)</td></tr>
<tr class="separator:a105ff5a8b90917a52aab304aefeae05a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ba0fd207c663927535fbd6ab6e28ba1"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a> (FILE *fp, const void *data, PetscInt num_elements, size_t element_size)</td></tr>
<tr class="memdesc:a1ba0fd207c663927535fbd6ab6e28ba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a data block in appended format for a VTK file, including a 4-byte size prefix.  <a href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">More...</a><br /></td></tr>
<tr class="separator:a1ba0fd207c663927535fbd6ab6e28ba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d20a414e822ac30150e6be7b6d780b2"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a8d20a414e822ac30150e6be7b6d780b2">WriteVTSXMLHeader</a> (FILE *fp, PetscInt mx, PetscInt my, PetscInt mz, PetscInt nnodes, const char *fieldName, PetscInt numComponents, PetscInt boffset, PetscInt *boffsetOut)</td></tr>
<tr class="memdesc:a8d20a414e822ac30150e6be7b6d780b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the XML header portion of a .vts file, defining the structured grid extents and data arrays.  <a href="io_8c.html#a8d20a414e822ac30150e6be7b6d780b2">More...</a><br /></td></tr>
<tr class="separator:a8d20a414e822ac30150e6be7b6d780b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fcae786daf54e7706101dd9b955ed96"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3fcae786daf54e7706101dd9b955ed96">WriteVTSXMLFooter</a> (FILE *fp)</td></tr>
<tr class="memdesc:a3fcae786daf54e7706101dd9b955ed96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes the .vts file by closing the appended data section and the VTKFile XML tag.  <a href="io_8c.html#a3fcae786daf54e7706101dd9b955ed96">More...</a><br /></td></tr>
<tr class="separator:a3fcae786daf54e7706101dd9b955ed96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc8540405ef08976e1bae9cbb5700545"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#adc8540405ef08976e1bae9cbb5700545">WriteVTPXMLHeader</a> (FILE *fp, PetscInt npoints, const char *fieldName, PetscInt numComponents, PetscInt boffset, PetscInt *boffsetOut)</td></tr>
<tr class="memdesc:adc8540405ef08976e1bae9cbb5700545"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the XML header portion of a .vtp file for a point-cloud representation.  <a href="io_8c.html#adc8540405ef08976e1bae9cbb5700545">More...</a><br /></td></tr>
<tr class="separator:adc8540405ef08976e1bae9cbb5700545"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3acbf6495b06ddc31dcd318a6917bcec"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3acbf6495b06ddc31dcd318a6917bcec">WriteVTPXMLFooter</a> (FILE *fp)</td></tr>
<tr class="memdesc:a3acbf6495b06ddc31dcd318a6917bcec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes the .vtp file by closing the appended data section and the VTKFile tag.  <a href="io_8c.html#a3acbf6495b06ddc31dcd318a6917bcec">More...</a><br /></td></tr>
<tr class="separator:a3acbf6495b06ddc31dcd318a6917bcec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb59f67fa68fabd9854709774dee119"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#abeb59f67fa68fabd9854709774dee119">WriteVTKFileHeader</a> (FILE *fp, const <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> *meta, PetscInt boffset, PetscInt *boffsetOut)</td></tr>
<tr class="memdesc:abeb59f67fa68fabd9854709774dee119"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the initial XML header for a VTK file based on the provided metadata.  <a href="io_8c.html#abeb59f67fa68fabd9854709774dee119">More...</a><br /></td></tr>
<tr class="separator:abeb59f67fa68fabd9854709774dee119"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a225e0a333b858e580840be12c245ab10"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a225e0a333b858e580840be12c245ab10">WriteVTKFileFooter</a> (FILE *fp, const <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> *meta)</td></tr>
<tr class="memdesc:a225e0a333b858e580840be12c245ab10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the XML footer for a VTK file based on the provided metadata.  <a href="io_8c.html#a225e0a333b858e580840be12c245ab10">More...</a><br /></td></tr>
<tr class="separator:a225e0a333b858e580840be12c245ab10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4eeaada0c8227f332499bf5fc4d3bc0"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ad4eeaada0c8227f332499bf5fc4d3bc0">CreateVTKFileFromMetadata</a> (const char *filename, const <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> *meta, MPI_Comm comm)</td></tr>
<tr class="memdesc:ad4eeaada0c8227f332499bf5fc4d3bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and writes a VTK file (either .vts or .vtp) based on the provided metadata.  <a href="io_8c.html#ad4eeaada0c8227f332499bf5fc4d3bc0">More...</a><br /></td></tr>
<tr class="separator:ad4eeaada0c8227f332499bf5fc4d3bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3512c89570bb1d27f4765819fad4985"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#aa3512c89570bb1d27f4765819fad4985">VecToArrayOnRank0</a> (Vec inVec, PetscInt *N, double **arrayOut)</td></tr>
<tr class="memdesc:aa3512c89570bb1d27f4765819fad4985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gathers a PETSc vector onto rank 0 as a contiguous array of doubles.  <a href="io_8c.html#aa3512c89570bb1d27f4765819fad4985">More...</a><br /></td></tr>
<tr class="separator:aa3512c89570bb1d27f4765819fad4985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84fff45b8cbd148ed2429ba8fe12428f"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f">ReadSwarmField</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *field_name, PetscInt ti, const char *ext)</td></tr>
<tr class="memdesc:a84fff45b8cbd148ed2429ba8fe12428f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads data from a file into a specified field of a PETSc DMSwarm.  <a href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f">More...</a><br /></td></tr>
<tr class="separator:a84fff45b8cbd148ed2429ba8fe12428f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64286adf953993b2a0c5c3fbee40d5a2"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, PetscInt ti)</td></tr>
<tr class="memdesc:a64286adf953993b2a0c5c3fbee40d5a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads multiple fields (positions, velocity, CellID, and weight) into a DMSwarm.  <a href="io_8c.html#a64286adf953993b2a0c5c3fbee40d5a2">More...</a><br /></td></tr>
<tr class="separator:a64286adf953993b2a0c5c3fbee40d5a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbdec83c0db92b3f9a78ccaf8ec06d60"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#abbdec83c0db92b3f9a78ccaf8ec06d60">ReadPositionsFromFile</a> (PetscInt timeIndex, <a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, double **coordsArray, PetscInt *Ncoords)</td></tr>
<tr class="memdesc:abbdec83c0db92b3f9a78ccaf8ec06d60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads coordinate data (for particles) from file into a PETSc Vec, then gathers it to rank 0.  <a href="io_8c.html#abbdec83c0db92b3f9a78ccaf8ec06d60">More...</a><br /></td></tr>
<tr class="separator:abbdec83c0db92b3f9a78ccaf8ec06d60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b18cb531c659ac173987ed73b1c1d24"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a9b18cb531c659ac173987ed73b1c1d24">ReadFieldDataToRank0</a> (PetscInt timeIndex, const char *fieldName, <a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, double **scalarArray, PetscInt *Nscalars)</td></tr>
<tr class="memdesc:a9b18cb531c659ac173987ed73b1c1d24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads a named field from file into a PETSc Vec, then gathers it to rank 0.  <a href="io_8c.html#a9b18cb531c659ac173987ed73b1c1d24">More...</a><br /></td></tr>
<tr class="separator:a9b18cb531c659ac173987ed73b1c1d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adde32528a690c023bc98c9e56ae2f2fb"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#adde32528a690c023bc98c9e56ae2f2fb">DisplayBanner</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:adde32528a690c023bc98c9e56ae2f2fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Displays a structured banner summarizing the simulation configuration.  <a href="io_8c.html#adde32528a690c023bc98c9e56ae2f2fb">More...</a><br /></td></tr>
<tr class="separator:adde32528a690c023bc98c9e56ae2f2fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3d554435495d0536a7d8c4b1bbbeb0a6"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a> = 0</td></tr>
<tr class="memdesc:a3d554435495d0536a7d8c4b1bbbeb0a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the number of blocks read from the grid file.  <a href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">More...</a><br /></td></tr>
<tr class="separator:a3d554435495d0536a7d8c4b1bbbeb0a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a310ceb96a9cb266916fc9ec5cedb5aa2"><td class="memItemLeft" align="right" valign="top">static PetscInt *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a> = NULL</td></tr>
<tr class="memdesc:a310ceb96a9cb266916fc9ec5cedb5aa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Caches the IM dimensions for all blocks read from the grid file.  <a href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">More...</a><br /></td></tr>
<tr class="separator:a310ceb96a9cb266916fc9ec5cedb5aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1e9e2bb2f9a982f1f13f41d7fc0ad7b"><td class="memItemLeft" align="right" valign="top">static PetscInt *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a> = NULL</td></tr>
<tr class="memdesc:ab1e9e2bb2f9a982f1f13f41d7fc0ad7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Caches the JM dimensions for all blocks read from the grid file.  <a href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">More...</a><br /></td></tr>
<tr class="separator:ab1e9e2bb2f9a982f1f13f41d7fc0ad7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0838ef307b26c3fb18d19f18e2bff5f"><td class="memItemLeft" align="right" valign="top">static PetscInt *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a> = NULL</td></tr>
<tr class="memdesc:ab0838ef307b26c3fb18d19f18e2bff5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Caches the KM dimensions for all blocks read from the grid file.  <a href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">More...</a><br /></td></tr>
<tr class="separator:ab0838ef307b26c3fb18d19f18e2bff5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78f1b2ae6c98930995de7229a02aef6a"><td class="memItemLeft" align="right" valign="top">static PetscBool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a78f1b2ae6c98930995de7229a02aef6a">g_file_has_been_read</a> = PETSC_FALSE</td></tr>
<tr class="memdesc:a78f1b2ae6c98930995de7229a02aef6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A flag to ensure the grid file is read only once.  <a href="io_8c.html#a78f1b2ae6c98930995de7229a02aef6a">More...</a><br /></td></tr>
<tr class="separator:a78f1b2ae6c98930995de7229a02aef6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of data input/output routines, focusing on grid configuration. </p>
<p>This module provides functions to parse grid geometry information, either from command-line options for programmatically generated grids or by reading the header of a grid definition file. </p>

<p class="definition">Definition in file <a class="el" href="io_8c_source.html">io.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;ReadGridGenerationInputs&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00128">128</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;ReadGridFile&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00128">128</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab7d7097c8ad047feb1d460e4694b8b4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7d7097c8ad047feb1d460e4694b8b4f">&#9670;&nbsp;</a></span>CheckDataFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode CheckDataFile </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscBool *&#160;</td>
          <td class="paramname"><em>fileExists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks for a data file's existence in a parallel-safe manner. </p>
<p>Only Rank 0 checks for the file on disk. The result (true or false) is then broadcast to all other processes in the communicator. This ensures all processes make a collective, synchronized decision.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ti</td><td>The time index of the file. </td></tr>
    <tr><td class="paramname">fieldName</td><td>The name of the field. </td></tr>
    <tr><td class="paramname">ext</td><td>The file extension. </td></tr>
    <tr><td class="paramname">fileExists</td><td>[out] The result, which will be identical on all ranks. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00522">522</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;{</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    PetscMPIInt    rank;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    MPI_Comm       comm = PETSC_COMM_WORLD;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    PetscInt       placeholder_int = 0;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    ierr = MPI_Comm_rank(comm, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordtype">char</span> filename[PETSC_MAX_PATH_LEN];</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="comment">// Use the same standardized, rank-independent filename format</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        ierr =  PetscSNPrintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;results/%s%05&quot;</span>PetscInt_FMT<span class="stringliteral">&quot;_%d.%s&quot;</span>, fieldName, ti, placeholder_int, ext); </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        ierr = PetscTestFile(filename, <span class="charliteral">&#39;r&#39;</span>, fileExists); CHKERRQ(ierr);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">if</span> (!(*fileExists)) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;CheckDataFile (Rank 0) - Optional data file &#39;%s&#39; not found.\n&quot;</span>, filename);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="comment">// Broadcast the result from Rank 0 to all other ranks.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// We cast the PetscBool to a PetscMPIInt for MPI_Bcast.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    PetscMPIInt fileExists_int = (rank == 0) ? (PetscMPIInt)(*fileExists) : 0;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    ierr = MPI_Bcast(&amp;fileExists_int, 1, MPI_INT, 0, comm); CHKERRMPI(ierr);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    *fileExists = (PetscBool)fileExists_int;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_ab7d7097c8ad047feb1d460e4694b8b4f_icgraph.svg" width="651" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad4eeaada0c8227f332499bf5fc4d3bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4eeaada0c8227f332499bf5fc4d3bc0">&#9670;&nbsp;</a></span>CreateVTKFileFromMetadata()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt CreateVTKFileFromMetadata </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> *&#160;</td>
          <td class="paramname"><em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and writes a VTK file (either .vts or .vtp) based on the provided metadata. </p>
<p>This function gathers the necessary information from the <code><a class="el" href="variables_8h.html#structVTKMetaData" title="Metadata structure for VTK output (.vts or .vtp files).">VTKMetaData</a></code> structure (e.g., <code>coords</code>, <code>scalarField</code>, <code>vectorField</code>, and connectivity or offsets if it is <code>VTK_POLYDATA</code>). It writes the XML header, followed by the appended binary data blocks in the correct order, and finally the XML footer. The I/O occurs only on <code>rank</code> 0 of the provided <code>MPI_Comm</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>The output file name (e.g., "output.vtp" or "output.vts"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Pointer to a <code><a class="el" href="variables_8h.html#structVTKMetaData" title="Metadata structure for VTK output (.vts or .vtp files).">VTKMetaData</a></code> structure containing all necessary fields. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">comm</td><td>The MPI communicator used for parallel execution.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 on success, or 1 on file-opening failure. Always returns 0 on non-<code>rank</code> 0 processes. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02066">2066</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;{</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Entry point. Filename: %s\n&quot;</span>, filename);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    PetscMPIInt rank, size;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    MPI_Comm_rank(comm, &amp;rank);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    MPI_Comm_size(comm, &amp;size);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - rank=%d, size=%d.\n&quot;</span>, rank, size);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="comment">// 1) Only rank 0 writes the file</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Rank 0 writing file &#39;%s&#39;.\n&quot;</span>, filename);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        FILE *fp = fopen(filename, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keywordflow">if</span> (!fp) {</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - fopen failed for %s.\n&quot;</span>, filename);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        }</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Successfully opened file: %s\n&quot;</span>, filename);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        PetscInt boffset = 0;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        <span class="comment">// 2) Write the XML header =&gt; sets &lt;DataArray ... offset=&quot;...&quot;&gt;</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing header (initial boffset=%d).\n&quot;</span>, boffset);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        <a class="code" href="io_8c.html#abeb59f67fa68fabd9854709774dee119">WriteVTKFileHeader</a>(fp, meta, boffset, &amp;boffset);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Header written (updated boffset=%d).\n&quot;</span>, boffset);</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        <span class="comment">// 3) Immediately write appended data blocks in EXACT order:</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="comment">//    (a) coords (3*npoints doubles)</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#aac5e5bdffa985d12e89f4d6f742a2442">coords</a>) {</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      PetscInt ncoords = 3 * (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a> ? meta-&gt;<a class="code" href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">nnodes</a> : meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;            <span class="keywordflow">if</span> (ncoords &gt; 0) {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing coords block: %d doubles.\n&quot;</span>, ncoords);</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                <a class="code" href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a>(fp, meta-&gt;<a class="code" href="variables_8h.html#aac5e5bdffa985d12e89f4d6f742a2442">coords</a>, ncoords, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                boffset += <span class="keyword">sizeof</span>(PetscInt) + ncoords * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            }</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        }</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="comment">//    (b) scalar or vector field</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a490a85dfc1aa84b470a36827a9cb839d">numScalarFields</a> &gt; 0 &amp;&amp; meta-&gt;<a class="code" href="variables_8h.html#a633005da0b9b59c4c0a6475d2562558a">scalarField</a>) {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      PetscInt nvals = (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a> ? meta-&gt;<a class="code" href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">nnodes</a> : meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing scalar field block: %d doubles.\n&quot;</span>, nvals);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            <a class="code" href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a>(fp, meta-&gt;<a class="code" href="variables_8h.html#a633005da0b9b59c4c0a6475d2562558a">scalarField</a>, nvals, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;            boffset += <span class="keyword">sizeof</span>(PetscInt) + nvals * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a4675755df21ac32ff4f9d13862e8bebb">numVectorFields</a> &gt; 0 &amp;&amp; meta-&gt;<a class="code" href="variables_8h.html#a688b11ccc72940aa35ca84eb6f0ec99b">vectorField</a>) {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      PetscInt nvals = 3 * (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a> ? meta-&gt;<a class="code" href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">nnodes</a> : meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>); <span class="comment">// 3 components</span></div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing vector field block: %d doubles.\n&quot;</span>, nvals);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <a class="code" href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a>(fp, meta-&gt;<a class="code" href="variables_8h.html#a688b11ccc72940aa35ca84eb6f0ec99b">vectorField</a>, nvals, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            boffset += <span class="keyword">sizeof</span>(PetscInt) + nvals * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        <span class="comment">//    (c) connectivity (if polydata)</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a> &amp;&amp; meta-&gt;<a class="code" href="variables_8h.html#a5517bbdee115f97374036e9d29b3b648">connectivity</a>) {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing connectivity block: %d PetscInts.\n&quot;</span>, meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            <a class="code" href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a>(fp, meta-&gt;<a class="code" href="variables_8h.html#a5517bbdee115f97374036e9d29b3b648">connectivity</a>, meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>, <span class="keyword">sizeof</span>(PetscInt));</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            boffset += <span class="keyword">sizeof</span>(PetscInt) + meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a> * <span class="keyword">sizeof</span>(PetscInt);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <span class="comment">//    (d) offsets (if polydata)</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a> &amp;&amp; meta-&gt;<a class="code" href="variables_8h.html#a34b307d2eee4e2ab67a72a0b79ab96ba">offsets</a>) {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing offsets block: %d PetscInts.\n&quot;</span>, meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <a class="code" href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a>(fp, meta-&gt;<a class="code" href="variables_8h.html#a34b307d2eee4e2ab67a72a0b79ab96ba">offsets</a>, meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>, <span class="keyword">sizeof</span>(PetscInt));</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            boffset += <span class="keyword">sizeof</span>(PetscInt) + meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a> * <span class="keyword">sizeof</span>(PetscInt);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;        }</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <span class="comment">// 4) Write footer =&gt; &lt;/AppendedData&gt; &amp; &lt;/VTKFile&gt;</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - Writing footer.\n&quot;</span>);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        <a class="code" href="io_8c.html#a225e0a333b858e580840be12c245ab10">WriteVTKFileFooter</a>(fp, meta);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160; </div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        fclose(fp);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateVTKFileFromMetadata - File &#39;%s&#39; closed.\n&quot;</span>, filename);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_ad4eeaada0c8227f332499bf5fc4d3bc0_cgraph.svg" width="656" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adde32528a690c023bc98c9e56ae2f2fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adde32528a690c023bc98c9e56ae2f2fb">&#9670;&nbsp;</a></span>DisplayBanner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode DisplayBanner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Displays a structured banner summarizing the simulation configuration. </p>
<p>This function prints key simulation parameters to standard output. It is intended to be called ONLY by MPI rank 0. It retrieves global domain bounds from <code>user-&gt;global_domain_bbox</code> and boundary conditions for all faces from <code>user-&gt;face_bc_types</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">StartTime</td><td>Initial simulation time. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">StartStep</td><td>Starting timestep index. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">StepsToRun</td><td>Total number of timesteps to run. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_mpi_procs</td><td>Total number of MPI processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">total_num_particles</td><td>Total number of particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>(If rank 0 needed to compute global_domain_bbox here, otherwise NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns <code>0</code> on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02502">2502</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;{</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    PetscMPIInt    rank;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;    <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>         global_min_coords, global_max_coords;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    PetscReal      StartTime;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    PetscInt       StartStep,StepsToRun,total_num_particles;</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    PetscMPIInt    num_mpi_procs;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160; </div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <span class="comment">// SimCtx *simCtx = user-&gt;simCtx;</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <a class="code" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user = simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">mgctx</a>[simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    num_mpi_procs = simCtx-&gt;<a class="code" href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">size</a>;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    StartTime = simCtx-&gt;<a class="code" href="variables_8h.html#a337c3a9a9bf061e10d71ba990aa6ed29">StartTime</a>;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    StartStep = simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    StepsToRun = simCtx-&gt;<a class="code" href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">StepsToRun</a>;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    total_num_particles = simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    <a class="code" href="variables__old_8h.html#structBoundingBox">BoundingBox</a> *bboxlist_on_rank0 = simCtx-&gt;<a class="code" href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">bboxlist</a>;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160; </div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    <span class="keywordflow">if</span> (!user) SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;DisplayBanner - UserCtx pointer is NULL.&quot;</span>);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160; </div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="comment">// If global_domain_bbox is not pre-populated in UserCtx, compute it here from bboxlist_on_rank0</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;        <span class="comment">// This assumes bboxlist_on_rank0 is valid and contains all local bounding boxes on rank 0.</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        <span class="keywordflow">if</span> (bboxlist_on_rank0 &amp;&amp; num_mpi_procs &gt; 0) {</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            global_min_coords = bboxlist_on_rank0[0].<a class="code" href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>;</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;            global_max_coords = bboxlist_on_rank0[0].<a class="code" href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>;</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            <span class="keywordflow">for</span> (PetscMPIInt p = 1; p &lt; num_mpi_procs; ++p) {</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                global_min_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = PetscMin(global_min_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, bboxlist_on_rank0[p].min_coords.x);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;                global_min_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = PetscMin(global_min_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, bboxlist_on_rank0[p].min_coords.y);</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                global_min_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = PetscMin(global_min_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, bboxlist_on_rank0[p].min_coords.z);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                global_max_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = PetscMax(global_max_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, bboxlist_on_rank0[p].max_coords.x);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                global_max_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = PetscMax(global_max_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, bboxlist_on_rank0[p].max_coords.y);</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                global_max_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = PetscMax(global_max_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, bboxlist_on_rank0[p].max_coords.z);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            }</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <span class="comment">// Optionally store this in user-&gt;global_domain_bbox if it&#39;s useful elsewhere</span></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="comment">// user-&gt;global_domain_bbox.min_coords = global_min_coords;</span></div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            <span class="comment">// user-&gt;global_domain_bbox.max_coords = global_max_coords;</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="comment">// Fallback or warning if bboxlist is not available for global calculation</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(PETSC_COMM_SELF, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;DisplayBanner (Rank 0) - bboxlist not provided or num_mpi_procs &lt;=0; using user-&gt;bbox for domain bounds.\n&quot;</span>);</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        <span class="comment">// global_min_coords = user-&gt;bbox.min_coords; // Use local bbox of rank 0 as fallback</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <span class="comment">// global_max_coords = user-&gt;bbox.max_coords;</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160; </div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;=============================================================\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;                          CASE SUMMARY                       \n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;=============================================================\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Grid Points     : %d X %d X %d\n&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">IM</a>, user-&gt;<a class="code" href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">JM</a>, user-&gt;<a class="code" href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">KM</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;    ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Cells           : %d X %d X %d\n&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">IM</a> - 1, user-&gt;<a class="code" href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">JM</a> - 1, user-&gt;<a class="code" href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">KM</a> - 1); CHKERRQ(ierr);</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Global Domain Bounds (X)    : %.6f to %.6f\n&quot;</span>, (<span class="keywordtype">double</span>)global_min_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, (<span class="keywordtype">double</span>)global_max_coords.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Global Domain Bounds (Y)    : %.6f to %.6f\n&quot;</span>, (<span class="keywordtype">double</span>)global_min_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, (<span class="keywordtype">double</span>)global_max_coords.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Global Domain Bounds (Z)    : %.6f to %.6f\n&quot;</span>, (<span class="keywordtype">double</span>)global_min_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, (<span class="keywordtype">double</span>)global_max_coords.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;-------------------- Boundary Conditions --------------------\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> face_name_width = 17; <span class="comment">// Adjusted for longer names (Zeta,Eta,Xi)</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        <span class="keywordflow">for</span> (PetscInt i_face = 0; i_face &lt; 6; ++i_face) {</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a> current_face = (<a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a>)i_face;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;      <span class="comment">// The BCFaceToString will now return the Xi, Eta, Zeta versions</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span>* face_str = <a class="code" href="logging_8h.html#a9b417fe56a110c0f6a3e64860e3e5cdb">BCFaceToString</a>(current_face); </div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span>* bc_type_str = <a class="code" href="logging_8h.html#a804d193057ea6054b3911ae508808821">BCTypeToString</a>(user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[current_face].<a class="code" href="variables_8h.html#add2b02a12c80adcbe2a4c2e61cdfdd4c">mathematical_type</a>);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            </div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Face %-*s : %s\n&quot;</span>, </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                 face_name_width, face_str, bc_type_str); CHKERRQ(ierr);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        }</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;-------------------------------------------------------------\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Start Time                  : %.4f\n&quot;</span>, (<span class="keywordtype">double</span>)StartTime); CHKERRQ(ierr);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Timestep Size               : %.4f\n&quot;</span>, (<span class="keywordtype">double</span>)simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Starting Step               : %d\n&quot;</span>, StartStep); CHKERRQ(ierr);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Total Steps to Run          : %d\n&quot;</span>, StepsToRun); CHKERRQ(ierr);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Number of MPI Processes     : %d\n&quot;</span>, num_mpi_procs); CHKERRQ(ierr);</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        ierr = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot; Number of Particles         : %d\n&quot;</span>, total_num_particles); CHKERRQ(ierr);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    ierr = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot; Reynolds Number             : %le\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    ierr = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot; Stanton Number              : %le\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">st</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    ierr = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot; CFL Number                  : %le\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#aaf69cd924766117c45ba60fcf2ed452e">cfl</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    ierr = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot; Von-Neumann Number          : %le\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#aebf75baa2defdbe4f6dcce0b6620cad4">vnn</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Particle Initialization Mode: %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a> == 0) {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;            <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">inletFaceDefined</a>) {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Particles Initialized At    : %s (Enum Val: %d)\n&quot;</span>, <a class="code" href="logging_8h.html#a9b417fe56a110c0f6a3e64860e3e5cdb">BCFaceToString</a>(user-&gt;<a class="code" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a>), user-&gt;<a class="code" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Particles Initialized At    : --- (No INLET face identified)\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;            }</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        }</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Field Initialization Mode   : %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a> == 1) {</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot; Constant Velocity           : x - %.4f, y - %.4f, z - %.4f \n&quot;</span>, (<span class="keywordtype">double</span>)simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>,(<span class="keywordtype">double</span>)simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>,(<span class="keywordtype">double</span>)simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> ); CHKERRQ(ierr);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;    </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;=============================================================\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        ierr = PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;\n&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;    }</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_adde32528a690c023bc98c9e56ae2f2fb_cgraph.svg" width="299" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_adde32528a690c023bc98c9e56ae2f2fb_icgraph.svg" width="231" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acee53553fb7d51eb948f1d4030518860"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acee53553fb7d51eb948f1d4030518860">&#9670;&nbsp;</a></span>FreeBC_ParamList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FreeBC_ParamList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#a22a9148c380850b8568b82d154446340">BC_Param</a> *&#160;</td>
          <td class="paramname"><em>head</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the memory allocated for a linked list of BC_Param structs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">head</td><td>A pointer to the head of the linked list to be freed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00229">229</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                      {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> *current = head;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">while</span> (current != NULL) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> *next = current-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        PetscFree(current-&gt;<a class="code" href="variables__old_8h.html#a4bfb8b974034685bf15ce4bd848d72bd">key</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        PetscFree(current-&gt;<a class="code" href="variables__old_8h.html#a8a071b3601cf05db4562a8989ef7e22f">value</a>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        PetscFree(current);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        current = next;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_acee53553fb7d51eb948f1d4030518860_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a5cc5e40cd538efc87ebd94ebdbb2a8e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cc5e40cd538efc87ebd94ebdbb2a8e8">&#9670;&nbsp;</a></span>ParseAllBoundaryConditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ParseAllBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>bcs_input_filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the boundary conditions file to configure the type, handler, and any associated parameters for all 6 global faces of the domain. </p>
<p>This function performs the following steps:</p><ol type="1">
<li>On MPI rank 0, it reads the specified configuration file line-by-line.</li>
<li>It parses each line for <code>&lt;Face&gt; &lt;Type&gt; &lt;Handler&gt; [param=value]...</code> format.</li>
<li>It validates the parsed strings and stores the configuration, including a linked list of parameters, in a temporary array.</li>
<li>It then serializes this configuration and broadcasts it to all other MPI ranks.</li>
<li>All ranks (including rank 0) then deserialize the broadcasted data to populate their local <code>user-&gt;boundary_faces</code> array identically.</li>
<li>It also sets legacy fields in <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> for compatibility with other modules.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>The main <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> struct where the final configuration for all ranks will be stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bcs_input_filename</td><td>The path to the boundary conditions configuration file. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00339">339</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    PetscMPIInt    rank;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Temporary storage for rank 0 to build the configuration before broadcasting.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="variables_8h.html#structBoundaryFaceConfig">BoundaryFaceConfig</a> configs_rank0[6];</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        FILE *file;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordtype">char</span> line_buffer[1024];</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">// Initialize the temporary config array with safe defaults on rank 0.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            configs_rank0[i].<a class="code" href="variables_8h.html#a43d81caf7c9b0dfc29d388df974ebb31">face_id</a> = (<a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a>)i;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            configs_rank0[i].<a class="code" href="variables_8h.html#add2b02a12c80adcbe2a4c2e61cdfdd4c">mathematical_type</a> = <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            configs_rank0[i].<a class="code" href="variables_8h.html#a499ad2619c29a9aee2d01e859c8942f6">handler_type</a> = <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            configs_rank0[i].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a> = NULL;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            configs_rank0[i].<a class="code" href="variables_8h.html#afd962f86b7e71fb2cb7ba60eb76058e8">handler</a> = NULL; <span class="comment">// Handler object is not created here.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Parsing BC configuration from &#39;%s&#39; on rank 0... \n&quot;</span>, bcs_input_filename);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        file = fopen(bcs_input_filename, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">if</span> (!file) SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FILE_OPEN, <span class="stringliteral">&quot;Could not open BCs file &#39;%s&#39;.&quot;</span>, bcs_input_filename);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">while</span> (fgets(line_buffer, <span class="keyword">sizeof</span>(line_buffer), file)) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="keywordtype">char</span> *current_pos = line_buffer;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="keywordflow">while</span> (isspace((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)*current_pos)) current_pos++; <span class="comment">// Skip leading whitespace</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">if</span> (*current_pos == <span class="charliteral">&#39;#&#39;</span> || *current_pos == <span class="charliteral">&#39;\0&#39;</span> || *current_pos == <span class="charliteral">&#39;\n&#39;</span> || *current_pos == <span class="charliteral">&#39;\r&#39;</span>) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordtype">char</span> *face_str = strtok(current_pos, <span class="stringliteral">&quot; \t\n\r&quot;</span>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keywordtype">char</span> *type_str = strtok(NULL, <span class="stringliteral">&quot; \t\n\r&quot;</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordtype">char</span> *handler_str = strtok(NULL, <span class="stringliteral">&quot; \t\n\r&quot;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">if</span> (!face_str || !type_str || !handler_str) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Malformed line in bcs.dat, skipping: %s \n&quot;</span>, line_buffer);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a>      face_enum;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a>      type_enum;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a> handler_enum;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span>* handler_name_for_log;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="comment">// --- Convert strings to enums and validate ---</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            ierr = <a class="code" href="io_8c.html#ab6896c293521673fcbff33001706d3ec">StringToBCFace</a>(face_str, &amp;face_enum); CHKERRQ(ierr);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            ierr = <a class="code" href="io_8c.html#ad5fc2fe7ae3aa77361c5ab62343358a7">StringToBCType</a>(type_str, &amp;type_enum); CHKERRQ(ierr);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            ierr = <a class="code" href="io_8c.html#a15bdb2122be30f52df280e1d7204f578">StringToBCHandlerType</a>(handler_str, &amp;handler_enum); CHKERRQ(ierr);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            ierr = <a class="code" href="io_8c.html#a5fe767286174b757deb2d404f2b4843f">ValidateBCHandlerForBCType</a>(type_enum, handler_enum);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <span class="keywordflow">if</span> (ierr) SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONG, <span class="stringliteral">&quot;Validation failed: Handler &#39;%s&#39; is not valid for Type &#39;%s&#39; on Face &#39;%s&#39;.\n&quot;</span>, handler_str, type_str, face_str);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="comment">// Store the core types for the corresponding face</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            configs_rank0[face_enum].<a class="code" href="variables_8h.html#add2b02a12c80adcbe2a4c2e61cdfdd4c">mathematical_type</a> = type_enum;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            configs_rank0[face_enum].<a class="code" href="variables_8h.html#a499ad2619c29a9aee2d01e859c8942f6">handler_type</a> = handler_enum;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            handler_name_for_log = <a class="code" href="logging_8h.html#ab17ab5ac0ff52ba6a344790a496f6111">BCHandlerTypeToString</a>(handler_enum); <span class="comment">// Assumes this utility exists</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  Parsed Face &#39;%s&#39;: Type=%s, Handler=%s \n&quot;</span>, face_str, type_str, handler_name_for_log);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="comment">// --- Parse optional key=value parameters for this face ---</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <a class="code" href="io_8c.html#acee53553fb7d51eb948f1d4030518860">FreeBC_ParamList</a>(configs_rank0[face_enum].params); <span class="comment">// Clear any previous (default) params</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            configs_rank0[face_enum].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a> = NULL;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> **param_next_ptr = &amp;configs_rank0[face_enum].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a>; <span class="comment">// Pointer to the &#39;next&#39; pointer to build the list</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordtype">char</span>* token;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">while</span> ((token = strtok(NULL, <span class="stringliteral">&quot; \t\n\r&quot;</span>)) != NULL) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <span class="keywordtype">char</span>* equals_ptr = strchr(token, <span class="charliteral">&#39;=&#39;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">if</span> (!equals_ptr) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Malformed parameter &#39;%s&#39; on face &#39;%s&#39;, skipping. \n&quot;</span>, token, face_str);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                *equals_ptr = <span class="charliteral">&#39;\0&#39;</span>; <span class="comment">// Temporarily split the string at &#39;=&#39; to separate key and value</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="keywordtype">char</span>* key_str = token;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keywordtype">char</span>* value_str = equals_ptr + 1;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> *new_param;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                ierr = PetscMalloc1(1, &amp;new_param); CHKERRQ(ierr);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                ierr = PetscStrallocpy(key_str, &amp;new_param-&gt;<a class="code" href="variables__old_8h.html#a4bfb8b974034685bf15ce4bd848d72bd">key</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                ierr = PetscStrallocpy(value_str, &amp;new_param-&gt;<a class="code" href="variables__old_8h.html#a8a071b3601cf05db4562a8989ef7e22f">value</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                new_param-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a> = NULL;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                *param_next_ptr = new_param;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                param_next_ptr = &amp;new_param-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;    - Found param: [%s] = [%s] \n&quot;</span>, new_param-&gt;<a class="code" href="variables__old_8h.html#a4bfb8b974034685bf15ce4bd848d72bd">key</a>, new_param-&gt;<a class="code" href="variables__old_8h.html#a8a071b3601cf05db4562a8989ef7e22f">value</a>);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        fclose(file);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// =========================================================================</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">//               BROADCASTING THE CONFIGURATION FROM RANK 0</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// =========================================================================</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// This is a critical step to ensure all processes have the same configuration.</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d broadcasting/receiving BC configuration.\n&quot;</span>, rank);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="comment">// --- Broadcast simple enums ---</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i] = configs_rank0[i]; <span class="comment">// Rank 0 populates its final struct</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        ierr = MPI_Bcast(&amp;user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#add2b02a12c80adcbe2a4c2e61cdfdd4c">mathematical_type</a>, 1, MPI_INT, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        ierr = MPI_Bcast(&amp;user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a499ad2619c29a9aee2d01e859c8942f6">handler_type</a>, 1, MPI_INT, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">// --- Serialize and Broadcast the parameter linked list ---</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        PetscInt n_params = 0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> (rank == 0) { <span class="comment">// On rank 0, count the number of parameters to send</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> *p = user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a>; p; p = p-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a>) n_params++;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        ierr = MPI_Bcast(&amp;n_params, 1, MPI_INT, 0, PETSC_COMM_WORLD);CHKERRQ(ierr);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (rank != 0) { <span class="comment">// Non-root ranks need to receive and build the list</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <a class="code" href="io_8c.html#acee53553fb7d51eb948f1d4030518860">FreeBC_ParamList</a>(user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a>); <span class="comment">// Ensure list is empty before building</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a> = NULL;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> **param_next_ptr = &amp;user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n_params; j++) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordtype">char</span> key_buf[256] = {0}, val_buf[256] = {0};</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="comment">// On rank 0, navigate to the j-th param and copy its data to buffers</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> *p = user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a9a3319252101456c548a87c13881a795">params</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; j; k++) p = p-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                strncpy(key_buf, p-&gt;<a class="code" href="variables__old_8h.html#a4bfb8b974034685bf15ce4bd848d72bd">key</a>, 255);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                strncpy(val_buf, p-&gt;<a class="code" href="variables__old_8h.html#a8a071b3601cf05db4562a8989ef7e22f">value</a>, 255);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            ierr = MPI_Bcast(key_buf, 256, MPI_CHAR, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            ierr = MPI_Bcast(val_buf, 256, MPI_CHAR, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            <span class="keywordflow">if</span> (rank != 0) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="comment">// On non-root ranks, deserialize: create a new node and append it</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                <a class="code" href="variables__old_8h.html#structBC__Param__s">BC_Param</a> *new_param;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                ierr = PetscMalloc1(1, &amp;new_param); CHKERRQ(ierr);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                ierr = PetscStrallocpy(key_buf, &amp;new_param-&gt;<a class="code" href="variables__old_8h.html#a4bfb8b974034685bf15ce4bd848d72bd">key</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                ierr = PetscStrallocpy(val_buf, &amp;new_param-&gt;<a class="code" href="variables__old_8h.html#a8a071b3601cf05db4562a8989ef7e22f">value</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                new_param-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a> = NULL;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                *param_next_ptr = new_param;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                param_next_ptr = &amp;new_param-&gt;<a class="code" href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">next</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                 <span class="comment">// On rank 0, just advance the pointer for the next iteration</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                 param_next_ptr = &amp;((*param_next_ptr)-&gt;next);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#a43d81caf7c9b0dfc29d388df974ebb31">face_id</a> = (<a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a>)i; <span class="comment">// Ensure face_id is set on all ranks</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// --- Set legacy fields for compatibility with particle system ---</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">inletFaceDefined</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;6; i++) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">boundary_faces</a>[i].<a class="code" href="variables_8h.html#add2b02a12c80adcbe2a4c2e61cdfdd4c">mathematical_type</a> == <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a>) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            user-&gt;<a class="code" href="variables__old_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">inletFaceDefined</a> = PETSC_TRUE;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            user-&gt;<a class="code" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> = (<a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a>)i;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Inlet face for particle initialization identified as Face %d.\n&quot;</span>, i);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="keywordflow">break</span>; <span class="comment">// Found the first one, stop looking</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// Rank 0 can now free the linked lists it created, as they have been broadcast.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">// Or, if user-&gt;boundary_faces was used directly, this is not needed.</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a5cc5e40cd538efc87ebd94ebdbb2a8e8_cgraph.svg" width="479" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a5cc5e40cd538efc87ebd94ebdbb2a8e8_icgraph.svg" width="559" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a64286adf953993b2a0c5c3fbee40d5a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64286adf953993b2a0c5c3fbee40d5a2">&#9670;&nbsp;</a></span>ReadAllSwarmFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadAllSwarmFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads multiple fields (positions, velocity, CellID, and weight) into a DMSwarm. </p>
<p>This function is analogous to <a class="el" href="io_8c.html#a3a009dabc71ccfa59f196e1bc045de45" title="Reads simulation fields from files into their respective PETSc vectors.">ReadSimulationFields()</a> but targets a DMSwarm. Each Swarm field is read from a separate file using <a class="el" href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f" title="Reads data from a file into a specified field of a PETSc DMSwarm.">ReadSwarmField()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the DMSwarm (user-&gt;swarm). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<p>Reads multiple fields (positions, velocity, etc.) into a DMSwarm.</p>
<p>ASSUMES the swarm has already been resized (if necessary) by a function like PreCheckAndResizeSwarm to match the particle count in the input files for the current timestep.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the DMSwarm (user-&gt;swarm). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. Handles missing optional files as warnings. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02318">2318</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;{</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;  PetscInt nGlobal;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  PetscBool fileExists;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160; </div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  ierr = DMSwarmGetSize(user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, &amp;nGlobal); CHKERRQ(ierr); <span class="comment">// Get final size</span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Reading DMSwarm fields for timestep %d (expected size %d).\n&quot;</span>, ti, nGlobal);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="comment">// If the swarm is empty after potential resize, we might still technically proceed</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  <span class="comment">// but ReadSwarmField might do nothing or error depending on implementation.</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="comment">// It&#39;s safer to just return if empty.</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <span class="keywordflow">if</span> (nGlobal == 0) {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Swarm is empty for timestep %d. Nothing to read.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      PetscFunctionReturn(0);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; </div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <span class="comment">// 1) Read positions (required, should succeed now)</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  ierr = <a class="code" href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f">ReadSwarmField</a>(user, <span class="stringliteral">&quot;position&quot;</span>, ti, <span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;  <span class="keywordflow">if</span> (ierr == PETSC_ERR_FILE_OPEN) {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      <span class="comment">// This shouldn&#39;t happen if PreCheckAndResizeSwarm ran successfully, but handle defensively.</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Position file missing for step %d, but PreCheck succeeded? Inconsistent state.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      PetscFunctionReturn(PETSC_ERR_PLIB);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Failed to read position field for step %d (Error %d), even though size should match.\n&quot;</span>, ti, ierr);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      CHKERRQ(ierr); <span class="comment">// Treat other errors as fatal</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;       <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Successfully read position field for step %d.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  }</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="comment">// 2) Read velocity</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  ierr = <a class="code" href="io_8c.html#ab7d7097c8ad047feb1d460e4694b8b4f">CheckDataFile</a>(ti, <span class="stringliteral">&quot;velocity&quot;</span>, <span class="stringliteral">&quot;dat&quot;</span>, &amp;fileExists);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="keywordflow">if</span>(fileExists) ierr = <a class="code" href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f">ReadSwarmField</a>(user, <span class="stringliteral">&quot;velocity&quot;</span>, ti, <span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;   <span class="keywordflow">if</span> (ierr == PETSC_ERR_FILE_OPEN) { <span class="comment">// Handle potentially missing file as warning</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Velocity file for step %d not found. Velocity data may be invalid/uninitialized.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;       <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Failed to read velocity field for step %d (Error %d). File might be corrupt or size incorrect despite pre-check.\n&quot;</span>, ti, ierr);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;       CHKERRQ(ierr); <span class="comment">// Treat other errors as fatal</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;   } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Successfully read velocity field for step %d.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;   }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="comment">// 3) Read pos_phy</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  ierr = <a class="code" href="io_8c.html#ab7d7097c8ad047feb1d460e4694b8b4f">CheckDataFile</a>(ti, <span class="stringliteral">&quot;pos_phy&quot;</span>, <span class="stringliteral">&quot;dat&quot;</span>, &amp;fileExists); </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="keywordflow">if</span>(fileExists) ierr = <a class="code" href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f">ReadSwarmField</a>(user, <span class="stringliteral">&quot;pos_phy&quot;</span>, ti, <span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;   <span class="keywordflow">if</span> (ierr == PETSC_ERR_FILE_OPEN) { <span class="comment">// Handle potentially missing file as warning</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Physical position file for step %d not found. physical position data may be invalid/uninitialized.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;       <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Failed to read physical position field for step %d (Error %d). File might be corrupt or size incorrect despite pre-check.\n&quot;</span>, ti, ierr);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;       CHKERRQ(ierr); <span class="comment">// Treat other errors as fatal</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;   } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Successfully read physical position field for step %d.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;   }</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;   </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;  <span class="comment">// 3) Read CellID (Optional)</span></div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <span class="comment">// ierr = CheckDataFile(ti, &quot;velocity&quot;, ext, &amp;fileExists); </span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="comment">// if(fileExists)ierr = ReadSwarmField(user, &quot;DMSwarm_CellID&quot;, ti, &quot;dat&quot;);</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="comment">// if (ierr == PETSC_ERR_FILE_OPEN) { LOG_ALLOW(GLOBAL, LOG_WARNING, &quot;ReadAllSwarmFields - CellID file for step %d not found.\n&quot;, ti); }</span></div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="comment">// else CHKERRQ(ierr); // Treat other errors as fatal unless CellID read can also fail gracefully</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="comment">// 4) Read weight (Optional)</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;  <span class="comment">// ierr = ReadSwarmField(user, &quot;weight&quot;, ti, &quot;dat&quot;);</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="comment">// if (ierr == PETSC_ERR_FILE_OPEN) { LOG_ALLOW(GLOBAL, LOG_WARNING, &quot;ReadAllSwarmFields - Weight file for step %d not found.\n&quot;, ti); }</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;  <span class="comment">// else CHKERRQ(ierr);</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadAllSwarmFields - Finished reading DMSwarm fields for timestep %d.\n&quot;</span>, ti);</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a64286adf953993b2a0c5c3fbee40d5a2_cgraph.svg" width="508" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a64286adf953993b2a0c5c3fbee40d5a2_icgraph.svg" width="488" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a105ff5a8b90917a52aab304aefeae05a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a105ff5a8b90917a52aab304aefeae05a">&#9670;&nbsp;</a></span>ReadDataFileToArray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt ReadDataFileToArray </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>data_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>Nout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MPI_Comm&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01467">1467</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;{</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">/* STEP 0: Prepare local variables &amp; log function entry */</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    PetscMPIInt    rank, size;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    FILE  *fp = NULL;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    PetscInt    N   = 0;            <span class="comment">/* number of lines/values read on rank 0 */</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordtype">double</span> *array = NULL;      <span class="comment">/* pointer to local array on each rank */</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    PetscInt    fileExistsFlag = 0; <span class="comment">/* 0 = doesn&#39;t exist, 1 = does exist */</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;              <span class="stringliteral">&quot;ReadDataFileToArray - Start reading from file: %s\n&quot;</span>,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;              filename);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">/* Basic error checking: data_out, Nout must be non-null. */</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordflow">if</span> (!filename || !data_out || !Nout) {</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                  <span class="stringliteral">&quot;ReadDataFileToArray - Null pointer argument provided.\n&quot;</span>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">/* Determine rank/size for coordinating I/O. */</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    MPI_Comm_rank(comm, &amp;rank);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    MPI_Comm_size(comm, &amp;size);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="comment">/* STEP 1: On rank 0, check if file can be opened. */</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        <span class="keywordflow">if</span> (fp) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;            fileExistsFlag = 1;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            fclose(fp);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">/* STEP 2: Broadcast file existence to all ranks. */</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">// In ReadDataFileToArray:</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    ierr = MPI_Bcast(&amp;fileExistsFlag, 1, MPI_INT, 0, comm); CHKERRQ(ierr);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordflow">if</span> (!fileExistsFlag) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <span class="comment">/* If file does not exist, log &amp; return. */</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                      <span class="stringliteral">&quot;ReadDataFileToArray - File &#39;%s&#39; not found.\n&quot;</span>,</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                      filename);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">return</span> 2;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">/* STEP 3: Rank 0 re-opens and reads the file, counting lines, etc. */</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="keywordflow">if</span> (!fp) {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                      <span class="stringliteral">&quot;ReadDataFileToArray - File &#39;%s&#39; could not be opened for reading.\n&quot;</span>,</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                      filename);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordflow">return</span> 3;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        }</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <span class="comment">/* (3a) Count lines first. */</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;            <span class="keywordtype">char</span> line[256];</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(line), fp)) {</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                N++;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;                  <span class="stringliteral">&quot;ReadDataFileToArray - File &#39;%s&#39; has %d lines.\n&quot;</span>,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;                  filename, N);</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="comment">/* (3b) Allocate array on rank 0. */</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        array = (<span class="keywordtype">double</span>*)malloc(N * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        <span class="keywordflow">if</span> (!array) {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            fclose(fp);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                      <span class="stringliteral">&quot;ReadDataFileToArray - malloc failed for array.\n&quot;</span>);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            <span class="keywordflow">return</span> 4;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <span class="comment">/* (3c) Rewind &amp; read values into array. */</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        rewind(fp);</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        {</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;            PetscInt i = 0;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;            <span class="keywordtype">char</span> line[256];</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;            <span class="keywordflow">while</span> (fgets(line, <span class="keyword">sizeof</span>(line), fp)) {</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                <span class="keywordtype">double</span> val;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                <span class="keywordflow">if</span> (sscanf(line, <span class="stringliteral">&quot;%lf&quot;</span>, &amp;val) == 1) {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    array[i++] = val;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            }</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        }</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        fclose(fp);</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                  <span class="stringliteral">&quot;ReadDataFileToArray - Successfully read %d values from &#39;%s&#39;.\n&quot;</span>,</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                  N, filename);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="comment">/* STEP 4: Broadcast the integer N to all ranks. */</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    ierr = MPI_Bcast(&amp;N, 1, MPI_INT, 0, comm); CHKERRQ(ierr);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="comment">/* STEP 5: Each rank allocates an array to receive the broadcast if rank&gt;0. */</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordflow">if</span> (rank) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        array = (<span class="keywordtype">double</span>*)malloc(N * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="keywordflow">if</span> (!array) {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                      <span class="stringliteral">&quot;ReadDataFileToArray - malloc failed on rank %d.\n&quot;</span>,</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                      rank);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            <span class="keywordflow">return</span> 5;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    }</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">/* STEP 6: Broadcast the actual data from rank 0 to all. */</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    ierr = MPI_Bcast(array, N, MPI_DOUBLE, 0, comm); CHKERRQ(ierr);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">/* STEP 7: Assign outputs on all ranks. */</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    *data_out = array;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    *Nout     = N;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;              <span class="stringliteral">&quot;ReadDataFileToArray - Done. Provided array of length=%d to all ranks.\n&quot;</span>,</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;              N);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">/* success */</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a570806d7e0694b5d996e0c6018b48908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570806d7e0694b5d996e0c6018b48908">&#9670;&nbsp;</a></span>ReadFieldData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadFieldData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>field_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads data for a specific field from a file into the provided vector. </p>
<p>This function uses the field name to construct the file path and reads the data from the corresponding file into the provided PETSc vector.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the field (e.g., "ufield", "vfield", "pfield"). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">field_vec</td><td>PETSc vector to store the field data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext</td><td>File extension (e.g., "dat").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00584">584</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;{</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   PetscErrorCode ierr;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="keywordtype">char</span>           filename[PETSC_MAX_PATH_LEN];</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   MPI_Comm       comm;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   PetscMPIInt    rank,size;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   PetscFunctionBeginUser;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   ierr = PetscObjectGetComm((PetscObject)field_vec,&amp;comm);CHKERRQ(ierr);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   ierr = MPI_Comm_rank(comm,&amp;rank);CHKERRQ(ierr);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   ierr = MPI_Comm_size(comm,&amp;size);CHKERRQ(ierr);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   <span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">    * Compose &lt;results&gt;/&lt;field_name&gt;&lt;step with 5 digits&gt;_0.&lt;ext&gt;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">    * (all restart files are written by rank-0 with that naming scheme).</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">    * ------------------------------------------------------------------ */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;   ierr = PetscSNPrintf(filename,<span class="keyword">sizeof</span>(filename),</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                        <span class="stringliteral">&quot;results/%s%05&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;_0.%s&quot;</span>,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        field_name,ti,ext);CHKERRQ(ierr);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;   <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;             <span class="stringliteral">&quot;ReadFieldData - Attempting to read &lt;%s&gt; on rank %d/%d\n&quot;</span>,</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;             filename,(<span class="keywordtype">int</span>)rank,(<span class="keywordtype">int</span>)size);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="comment">/* ======================================================================</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">    * 1.  SERIAL JOB  – just hand the Vec to VecLoad()</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">    * ==================================================================== */</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordflow">if</span>(size==1)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      PetscViewer viewer;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      PetscBool   found;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      Vec temp_vec;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      PetscInt expectedSize,loadedSize;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      ierr = PetscTestFile(filename,<span class="charliteral">&#39;r&#39;</span>,&amp;found);CHKERRQ(ierr);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <span class="keywordflow">if</span>(!found) SETERRQ(comm,PETSC_ERR_FILE_OPEN,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                         <span class="stringliteral">&quot;Restart file not found: %s&quot;</span>,filename);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      ierr = PetscViewerBinaryOpen(PETSC_COMM_SELF,filename,FILE_MODE_READ,&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">// ---- START MODIFICATION ----</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="comment">// DO NOT load directly into field_vec, as this can resize it, which is</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// illegal for DMSwarm &quot;view&quot; vectors. Instead, load into a temporary vector.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      ierr = VecCreate(PETSC_COMM_SELF, &amp;temp_vec); CHKERRQ(ierr);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      ierr = VecLoad(temp_vec,viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      ierr = PetscViewerDestroy(&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="comment">// Sanity check: ensure the file size matches the expected vector size.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      ierr = VecGetSize(field_vec, &amp;expectedSize);CHKERRQ(ierr);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      ierr = VecGetSize(temp_vec, &amp;loadedSize);CHKERRQ(ierr);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">if</span> (loadedSize != expectedSize) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;         SETERRQ(comm,PETSC_ERR_FILE_UNEXPECTED,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                 <span class="stringliteral">&quot;File %s holds %d entries – expected %d for field &#39;%s&#39;&quot;</span>,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                 filename, loadedSize, expectedSize, field_name);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="comment">// Now, safely copy the data from the temporary vector to the final destination.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      ierr = VecCopy(temp_vec, field_vec);CHKERRQ(ierr);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="comment">// Clean up the temporary vector.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      ierr = VecDestroy(&amp;temp_vec);CHKERRQ(ierr);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="comment">// ---- END MODIFICATION ----</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="comment">/* create EMPTY sequential Vec – VecLoad() will size it correctly   */</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">      ierr = VecCreate(PETSC_COMM_SELF,&amp;seq_vec);CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">      ierr = VecSetType(seq_vec,VECSEQ);CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">      ierr = PetscViewerBinaryOpen(PETSC_COMM_SELF,filename,</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">                                   FILE_MODE_READ,&amp;viewer);CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">      ierr = VecLoad(field_vec,viewer);CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">      ierr = PetscViewerDestroy(&amp;viewer);CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">      */</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="stringliteral">&quot;ReadFieldData - Loaded &lt;%s&gt; (serial path)\n&quot;</span>,filename);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      PetscFunctionReturn(0);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;   }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;   <span class="comment">/* ======================================================================</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">    * 2.  PARALLEL JOB</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">    * ==================================================================== */</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   PetscInt globalSize;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   ierr = VecGetSize(field_vec,&amp;globalSize);CHKERRQ(ierr);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   <span class="comment">/* -------------------- rank-0 : read the sequential file -------------- */</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;   Vec            seq_vec = NULL;      <span class="comment">/* only valid on rank-0            */</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;   <span class="keyword">const</span> PetscScalar *seqArray = NULL; <span class="comment">/* borrowed pointer on rank-0 only */</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   <span class="keywordflow">if</span>(rank==0)</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;   {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      PetscViewer viewer;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      PetscBool   found;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      ierr = PetscTestFile(filename,<span class="charliteral">&#39;r&#39;</span>,&amp;found);CHKERRQ(ierr);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      <span class="keywordflow">if</span>(!found) SETERRQ(PETSC_COMM_SELF,PETSC_ERR_FILE_OPEN,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                         <span class="stringliteral">&quot;Restart file not found: %s&quot;</span>,filename);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="comment">/* create EMPTY sequential Vec – VecLoad() will size it correctly   */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      ierr = VecCreate(PETSC_COMM_SELF,&amp;seq_vec);CHKERRQ(ierr);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      ierr = VecSetType(seq_vec,VECSEQ);CHKERRQ(ierr);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      ierr = PetscViewerBinaryOpen(PETSC_COMM_SELF,filename,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                   FILE_MODE_READ,&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      ierr = VecLoad(seq_vec,viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      ierr = PetscViewerDestroy(&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      <span class="comment">/* size sanity-check */</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      PetscInt loaded;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      ierr = VecGetSize(seq_vec,&amp;loaded);CHKERRQ(ierr);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">if</span>(loaded != globalSize)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;         SETERRQ(comm,PETSC_ERR_FILE_UNEXPECTED,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                 <span class="stringliteral">&quot;File %s holds %d entries – expected %d&quot;</span>,</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                 filename,loaded,globalSize);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="comment">/* borrow array for later Bcast */</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      ierr = VecGetArrayRead(seq_vec,&amp;seqArray);CHKERRQ(ierr);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <span class="stringliteral">&quot;ReadFieldData - Rank 0 successfully loaded &lt;%s&gt;\n&quot;</span>,filename);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="comment">/* -------------------- everybody : broadcast raw data ----------------- */</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   PetscScalar *buffer = NULL;               <span class="comment">/* receives the full field    */</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;   <span class="keywordflow">if</span>(rank==0)</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="comment">/* shallow-copy: const-cast is safe, we do not modify the data        */</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      buffer = (PetscScalar *)seqArray;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   { <span class="comment">/* non-root ranks allocate a receive buffer                           */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      ierr = PetscMalloc1(globalSize,&amp;buffer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   ierr = MPI_Bcast(buffer, (<span class="keywordtype">int</span>)globalSize, MPIU_SCALAR, 0, comm);CHKERRQ(ierr);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   <span class="comment">/* -------------------- copy my slice into field_vec ------------------- */</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   PetscInt  rstart,rend,loc;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   PetscScalar *locArray;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   ierr = VecGetOwnershipRange(field_vec,&amp;rstart,&amp;rend);CHKERRQ(ierr);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   loc  = rend - rstart;                    <span class="comment">/* local length               */</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   ierr = VecGetArray(field_vec,&amp;locArray);CHKERRQ(ierr);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   ierr = PetscMemcpy(locArray,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                      buffer + rstart,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                      loc*<span class="keyword">sizeof</span>(PetscScalar));CHKERRQ(ierr);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;   ierr = VecRestoreArray(field_vec,&amp;locArray);CHKERRQ(ierr);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   <span class="comment">/* -------------------- tidy up ---------------------------------------- */</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;   <span class="keywordflow">if</span>(rank==0)</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      ierr = VecRestoreArrayRead(seq_vec,&amp;seqArray);CHKERRQ(ierr);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      ierr = VecDestroy(&amp;seq_vec);CHKERRQ(ierr);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;   }</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="keywordflow">else</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      ierr = PetscFree(buffer);CHKERRQ(ierr);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;   }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;   <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;             <span class="stringliteral">&quot;ReadFieldData - Loaded &lt;%s&gt; (parallel path)\n&quot;</span>,filename);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   PetscFunctionReturn(0);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a570806d7e0694b5d996e0c6018b48908_icgraph.svg" width="100%" height="556"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a9b18cb531c659ac173987ed73b1c1d24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b18cb531c659ac173987ed73b1c1d24">&#9670;&nbsp;</a></span>ReadFieldDataToRank0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadFieldDataToRank0 </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>timeIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>scalarArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>Nscalars</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads a named field from file into a PETSc Vec, then gathers it to rank 0. </p>
<p>This function wraps <code>ReadFieldData</code> and <code>VecToArrayOnRank0</code> into a single step. The gathered data is stored in <code>scalarArray</code> on rank 0, with its length in <code>Nscalars</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">timeIndex</td><td>The time index used to construct file names. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the field to be read (e.g., "velocity"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the user context. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">scalarArray</td><td>On rank 0, a newly allocated array holding the field data. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Nscalars</td><td>On rank 0, length of <code>scalarArray</code>. On other ranks, 0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, or non-zero on failures. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02450">2450</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;{</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160; </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  Vec            fieldVec;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadFieldDataWrapper - Creating field Vec.\n&quot;</span>);</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  ierr = VecCreate(PETSC_COMM_WORLD, &amp;fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  ierr = VecSetFromOptions(fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, fieldName, fieldVec, timeIndex, <span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>,</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;              <span class="stringliteral">&quot;ReadFieldDataWrapper - Error reading field &#39;%s&#39; (ti=%d).\n&quot;</span>,</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;              fieldName, timeIndex);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    PetscFunctionReturn(ierr);</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  }</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadFieldDataWrapper - Gathering field Vec to rank 0.\n&quot;</span>);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;  ierr = <a class="code" href="io_8c.html#aa3512c89570bb1d27f4765819fad4985">VecToArrayOnRank0</a>(fieldVec, Nscalars, scalarArray);CHKERRQ(ierr);</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;  ierr = VecDestroy(&amp;fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; </div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            <span class="stringliteral">&quot;ReadFieldDataWrapper - Successfully gathered field &#39;%s&#39;. Nscalars=%d.\n&quot;</span>,</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            fieldName, *Nscalars);</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a9b18cb531c659ac173987ed73b1c1d24_cgraph.svg" width="384" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1454fbb30915c3284cbf5ecb100351d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1454fbb30915c3284cbf5ecb100351d1">&#9670;&nbsp;</a></span>ReadGridFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadGridFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets grid dimensions from a file for a SINGLE block using a one-time read cache. </p>
<p>This function uses a static-variable pattern to ensure the grid file header is read only once, collectively, by all processes. The first time any process calls this function, it triggers a collective operation where rank 0 reads the file and broadcasts the dimensions for all blocks. This data is stored in static "cached" arrays.</p>
<p>On every call (including the first), the function retrieves the dimensions for the specific block (identified by <code>user-&gt;_this</code>) from the cached arrays and populates the <code>IM</code>, <code>JM</code>, and <code>KM</code> fields of the provided <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Pointer to the <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> for a specific block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a PETSc error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00145">145</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;{</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    PetscInt block_index = user-&gt;<a class="code" href="variables__old_8h.html#a4f7c5fd8843d026101b193e9236e1192">_this</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// --- One-Time Read and Broadcast Logic ---</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="io_8c.html#a78f1b2ae6c98930995de7229a02aef6a">g_file_has_been_read</a>) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;First call to ReadGridFile. Reading and broadcasting grid file header from &#39;%s&#39;...\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        PetscMPIInt rank = simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        PetscInt    nblk = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            FILE *fd = fopen(simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">if</span> (!fd) SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FILE_OPEN, <span class="stringliteral">&quot;Cannot open file: %s&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            fscanf(fd, <span class="stringliteral">&quot;%d\n&quot;</span>, &amp;<a class="code" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="comment">// ---- Read first token; decide whether it is the header or nblk ----</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordtype">char</span> firstTok[32] = {0};</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">if</span> (fscanf(fd, <span class="stringliteral">&quot;%31s&quot;</span>, firstTok) != 1)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FILE_READ, <span class="stringliteral">&quot;Empty grid file: %s&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">if</span> (strcmp(firstTok, <span class="stringliteral">&quot;FDFGRID&quot;</span>) == 0) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="comment">// Header is present – read nblk from the next line</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keywordflow">if</span> (fscanf(fd, <span class="stringliteral">&quot;%d&quot;</span>, &amp;<a class="code" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a>) != 1)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FILE_READ, <span class="stringliteral">&quot;Expected number of blocks after \&quot;FDFGRID\&quot; in %s&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="comment">// No header – the token we just read is actually nblk</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <a class="code" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a> = (PetscInt)strtol(firstTok, NULL, 10);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            }       </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a> != nblk) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FILE_UNEXPECTED, <span class="stringliteral">&quot;Mismatch: -nblk is %d but grid file specifies %d blocks.&quot;</span>, nblk, <a class="code" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            ierr = PetscMalloc3(nblk, &amp;<a class="code" href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a>, nblk, &amp;<a class="code" href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a>, nblk, &amp;<a class="code" href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; nblk; ++i) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                <span class="keywordflow">if</span> (fscanf(fd, <span class="stringliteral">&quot;%d %d %d\n&quot;</span>, &amp;<a class="code" href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a>[i], &amp;<a class="code" href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a>[i], &amp;<a class="code" href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a>[i]) != 3) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FILE_READ, <span class="stringliteral">&quot;Expected 3 integers for block %d in %s&quot;</span>, i, simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            fclose(fd);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// Broadcast nblk to verify (optional, good practice)</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        ierr = MPI_Bcast(&amp;<a class="code" href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a>, 1, MPI_INT, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="comment">// Allocate on other ranks before receiving the broadcast</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span> (rank != 0) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            ierr = PetscMalloc3(nblk, &amp;<a class="code" href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a>, nblk, &amp;<a class="code" href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a>, nblk, &amp;<a class="code" href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="comment">// Broadcast the data arrays</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        ierr = MPI_Bcast(<a class="code" href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a>, nblk, MPI_INT, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        ierr = MPI_Bcast(<a class="code" href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a>, nblk, MPI_INT, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        ierr = MPI_Bcast(<a class="code" href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a>, nblk, MPI_INT, 0, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="io_8c.html#a78f1b2ae6c98930995de7229a02aef6a">g_file_has_been_read</a> = PETSC_TRUE;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Grid file header read and broadcast complete.\n&quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// --- Per-Block Assignment Logic (runs on every call) ---</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">IM</a> = <a class="code" href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a>[block_index];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">JM</a> = <a class="code" href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a>[block_index];</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">KM</a> = <a class="code" href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a>[block_index];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Set file inputs for Block %d: IM=%d, JM=%d, KM=%d\n&quot;</span>,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;              simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, block_index, user-&gt;<a class="code" href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">IM</a>, user-&gt;<a class="code" href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">JM</a>, user-&gt;<a class="code" href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">KM</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a1454fbb30915c3284cbf5ecb100351d1_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a7dd125436244f23eba5c6b06fdd35031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd125436244f23eba5c6b06fdd35031">&#9670;&nbsp;</a></span>ReadGridGenerationInputs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadGridGenerationInputs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses command-line options for a programmatically generated grid for a SINGLE block. </p>
<p>This function is responsible for reading all per-block array options related to grid geometry, such as dimensions (<code>-im</code>), domain bounds (<code>-xMins</code>, <code>-xMaxs</code>), and stretching ratios (<code>-rxs</code>). It reads the entire array for each option, then uses the block index stored in <code>user-&gt;_this</code> to select the correct value and populate the fields of the provided <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>Pointer to the <code><a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> for a specific block. The function will populate the geometric fields (<code>IM</code>, <code>Min_X</code>, <code>rx</code>, etc.) within this struct. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a PETSc error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00047">47</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a>         *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    PetscInt       nblk = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    PetscInt       block_index = user-&gt;<a class="code" href="variables__old_8h.html#a4f7c5fd8843d026101b193e9236e1192">_this</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    PetscBool      found;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// Temporary arrays to hold the parsed values for ALL blocks</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    PetscInt  *IMs = NULL, *JMs = NULL, *KMs = NULL, *cgrids = NULL;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    PetscReal *xMins = NULL, *xMaxs = NULL, *rxs = NULL;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    PetscReal *yMins = NULL, *yMaxs = NULL, *rys = NULL;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    PetscReal *zMins = NULL, *zMaxs = NULL, *rzs = NULL;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Reading generated grid inputs for block %d.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, block_index);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (block_index &gt;= nblk) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_OUTOFRANGE, <span class="stringliteral">&quot;Block index %d is out of range for nblk=%d&quot;</span>, block_index, nblk);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// --- Allocate temporary storage for all array options ---</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    ierr = PetscMalloc4(nblk, &amp;IMs, nblk, &amp;JMs, nblk, &amp;KMs, nblk, &amp;cgrids); CHKERRQ(ierr);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    ierr = PetscMalloc6(nblk, &amp;xMins, nblk, &amp;xMaxs, nblk, &amp;rxs, nblk, &amp;yMins, nblk, &amp;yMaxs, nblk, &amp;rys); CHKERRQ(ierr);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    ierr = PetscMalloc3(nblk, &amp;zMins, nblk, &amp;zMaxs, nblk, &amp;rzs); CHKERRQ(ierr);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// --- Set default values for the temporary arrays ---</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; nblk; ++i) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        IMs[i] = 10; JMs[i] = 10; KMs[i] = 10; cgrids[i] = 0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        xMins[i] = 0.0; xMaxs[i] = 1.0; rxs[i] = 1.0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        yMins[i] = 0.0; yMaxs[i] = 1.0; rys[i] = 1.0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        zMins[i] = 0.0; zMaxs[i] = 1.0; rzs[i] = 1.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// --- Parse the array options from the command line / control file ---</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    PetscInt count;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    count = nblk; ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-im&quot;</span>, IMs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    count = nblk; ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-jm&quot;</span>, JMs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    count = nblk; ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-km&quot;</span>, KMs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-xMins&quot;</span>, xMins, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-xMaxs&quot;</span>, xMaxs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-rxs&quot;</span>, rxs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-yMins&quot;</span>, yMins, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-yMaxs&quot;</span>, yMaxs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-rys&quot;</span>, rys, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-zMins&quot;</span>, zMins, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-zMaxs&quot;</span>, zMaxs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    count = nblk; ierr = PetscOptionsGetRealArray(NULL, NULL, <span class="stringliteral">&quot;-rzs&quot;</span>, rzs, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    count = nblk; ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-cgrids&quot;</span>, cgrids, &amp;count, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// --- Assign the parsed values to the specific UserCtx struct passed in ---</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">IM</a> = IMs[block_index];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">JM</a> = JMs[block_index];</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">KM</a> = KMs[block_index];</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">Min_X</a> = xMins[block_index];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">Max_X</a> = xMaxs[block_index];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#ade80a8abea8047bfe4b83bd9363df589">rx</a> = rxs[block_index];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#ac6633daab270004cd266f6e6ac05f588">Min_Y</a> = yMins[block_index];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">Max_Y</a> = yMaxs[block_index];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a540dc135c4299ebf7fcbb33ecd8ca096">ry</a> = rys[block_index];</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">Min_Z</a> = zMins[block_index];</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#aecbc2de7a281e906efe25a773b76866c">Max_Z</a> = zMaxs[block_index];</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a94c6d4cf5f0820de35ff6ee1909fd0d6">rz</a> = rzs[block_index];</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a1d31f361d6e2d535a91d757c14eba7f4">cgrid</a> = cgrids[block_index];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Block %d grid generation inputs set: IM=%d, JM=%d, KM=%d\n&quot;</span>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;              simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, block_index, user-&gt;<a class="code" href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">IM</a>, user-&gt;<a class="code" href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">JM</a>, user-&gt;<a class="code" href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">KM</a>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Block %d bounds: X=[%.2f, %.2f], Y=[%.2f, %.2f], Z=[%.2f, %.2f]\n&quot;</span>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;              simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, block_index, user-&gt;<a class="code" href="variables__old_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">Min_X</a>, user-&gt;<a class="code" href="variables__old_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">Max_X</a>, user-&gt;<a class="code" href="variables__old_8h.html#ac6633daab270004cd266f6e6ac05f588">Min_Y</a>, user-&gt;<a class="code" href="variables__old_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">Max_Y</a>, user-&gt;<a class="code" href="variables__old_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">Min_Z</a>, user-&gt;<a class="code" href="variables__old_8h.html#aecbc2de7a281e906efe25a773b76866c">Max_Z</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// --- Clean up temporary storage ---</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    ierr = PetscFree4(IMs, JMs, KMs, cgrids); CHKERRQ(ierr);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    ierr = PetscFree6(xMins, xMaxs, rxs, yMins, yMaxs, rys); CHKERRQ(ierr);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    ierr = PetscFree3(zMins, zMaxs, rzs); CHKERRQ(ierr);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a7dd125436244f23eba5c6b06fdd35031_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a45ad89f26c78131d2990f09126abba4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45ad89f26c78131d2990f09126abba4b">&#9670;&nbsp;</a></span>ReadLESFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadLESFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads LES-related fields. </p>
<p>Reads LES-related fields used in turbulence modeling.</p>
<p>This function reads LES-related fields such as Cs (Smagorinsky constant) into their respective PETSc vectors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00849">849</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;{</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    Vec Cs;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadLESFields - Starting to read LES fields.\n&quot;</span>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    VecDuplicate(user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;Cs);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;cs&quot;</span>, Cs, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    DMGlobalToLocalBegin(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, Cs, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a66d4c14737a74d07d188e3e7f2dfee6d">lCs</a>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    DMGlobalToLocalEnd(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, Cs, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a66d4c14737a74d07d188e3e7f2dfee6d">lCs</a>);</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    VecDestroy(&amp;Cs);</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadLESFields - Finished reading LES fields.\n&quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a45ad89f26c78131d2990f09126abba4b_cgraph.svg" width="290" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a45ad89f26c78131d2990f09126abba4b_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="abbdec83c0db92b3f9a78ccaf8ec06d60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbdec83c0db92b3f9a78ccaf8ec06d60">&#9670;&nbsp;</a></span>ReadPositionsFromFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadPositionsFromFile </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>timeIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>coordsArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>Ncoords</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads coordinate data (for particles) from file into a PETSc Vec, then gathers it to rank 0. </p>
<p>This function uses <code>ReadFieldData</code> to fill a PETSc Vec with coordinate data, then leverages <code>VecToArrayOnRank0</code> to gather that data into a contiguous array (valid on rank 0 only).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">timeIndex</td><td>The time index used to construct file names. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the user context. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coordsArray</td><td>On rank 0, will point to a newly allocated array holding the coordinates. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Ncoords</td><td>On rank 0, the length of <code>coordsArray</code>. On other ranks, 0.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, or non-zero on failures. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02402">2402</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;{</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160; </div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  Vec            coordsVec;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadPositionsFromFile - Creating coords Vec.\n&quot;</span>);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  ierr = VecCreate(PETSC_COMM_WORLD, &amp;coordsVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  ierr = VecSetFromOptions(coordsVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  <span class="comment">// For example: &quot;position&quot; is the name of the coordinate data</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;position&quot;</span>, coordsVec, timeIndex, <span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>,</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;              <span class="stringliteral">&quot;ReadPositionsFromFile - Error reading position data (ti=%d).\n&quot;</span>,</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;              timeIndex);</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    PetscFunctionReturn(ierr);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  }</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;ReadPositions - Gathering coords Vec to rank 0.\n&quot;</span>);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  ierr = <a class="code" href="io_8c.html#aa3512c89570bb1d27f4765819fad4985">VecToArrayOnRank0</a>(coordsVec, Ncoords, coordsArray);CHKERRQ(ierr);</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160; </div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;  ierr = VecDestroy(&amp;coordsVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            <span class="stringliteral">&quot;ReadPositionsFromFile - Successfully gathered coordinates. Ncoords=%d.\n&quot;</span>, *Ncoords);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_abbdec83c0db92b3f9a78ccaf8ec06d60_cgraph.svg" width="383" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a19e2e0b57afae458bae068610141c031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19e2e0b57afae458bae068610141c031">&#9670;&nbsp;</a></span>ReadRANSFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadRANSFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads RANS-related fields. </p>
<p>Reads RANS-related fields for turbulence modeling.</p>
<p>This function reads RANS-related fields such as K_Omega into their respective PETSc vectors.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00878">878</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;{</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadRANSFields - Starting to read RANS fields.\n&quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; </div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;kfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a45bbda2dfda6edd94e9d1dcd5adfc2e1">K_Omega</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    VecCopy(user-&gt;<a class="code" href="variables__old_8h.html#a45bbda2dfda6edd94e9d1dcd5adfc2e1">K_Omega</a>, user-&gt;<a class="code" href="variables__old_8h.html#a3697ef486c46316e97aa05a22aeaa92f">K_Omega_o</a>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    DMGlobalToLocalBegin(user-&gt;<a class="code" href="variables__old_8h.html#a9cdfbedb7b32291fa3d60cc698f07c1c">fda2</a>, user-&gt;<a class="code" href="variables__old_8h.html#a45bbda2dfda6edd94e9d1dcd5adfc2e1">K_Omega</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#aa39fcddc08427c8d30e28c5a8a37f981">lK_Omega</a>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    DMGlobalToLocalEnd(user-&gt;<a class="code" href="variables__old_8h.html#a9cdfbedb7b32291fa3d60cc698f07c1c">fda2</a>, user-&gt;<a class="code" href="variables__old_8h.html#a45bbda2dfda6edd94e9d1dcd5adfc2e1">K_Omega</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#aa39fcddc08427c8d30e28c5a8a37f981">lK_Omega</a>);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    DMGlobalToLocalBegin(user-&gt;<a class="code" href="variables__old_8h.html#a9cdfbedb7b32291fa3d60cc698f07c1c">fda2</a>, user-&gt;<a class="code" href="variables__old_8h.html#a3697ef486c46316e97aa05a22aeaa92f">K_Omega_o</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#aa0dc186d7733ea4041c5c3cac181b9ce">lK_Omega_o</a>);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    DMGlobalToLocalEnd(user-&gt;<a class="code" href="variables__old_8h.html#a9cdfbedb7b32291fa3d60cc698f07c1c">fda2</a>, user-&gt;<a class="code" href="variables__old_8h.html#a3697ef486c46316e97aa05a22aeaa92f">K_Omega_o</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#aa0dc186d7733ea4041c5c3cac181b9ce">lK_Omega_o</a>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadRANSFields - Finished reading RANS fields.\n&quot;</span>);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a19e2e0b57afae458bae068610141c031_cgraph.svg" width="303" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a19e2e0b57afae458bae068610141c031_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a3a009dabc71ccfa59f196e1bc045de45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a009dabc71ccfa59f196e1bc045de45">&#9670;&nbsp;</a></span>ReadSimulationFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadSimulationFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads simulation fields from files into their respective PETSc vectors. </p>
<p>Reads binary field data for velocity, pressure, and other required vectors.</p>
<p>This function reads contravariant velocity, Cartesian velocity, pressure, and node state fields from their respective binary files. It also conditionally reads LES, RANS, and statistical fields if they are enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00768">768</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;{</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadSimulationFields - Starting to read simulation fields.\n&quot;</span>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// Read Cartesian velocity field</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;ufield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="comment">// Read contravariant velocity field</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;vfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">// Read pressure field</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;pfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// Read node state field (nvert)</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;nvfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ab7d6dffd5a35c03211c65aca209c909e">Nvert_o</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160; </div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">// Read Particle Count field</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;ParticleCount&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#aa194db376ea0f68ec7090718804488ab">ParticleCount</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// Process LES fields if enabled</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">les</a>) {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      ierr = <a class="code" href="io_8c.html#a45ad89f26c78131d2990f09126abba4b">ReadLESFields</a>(user,ti); CHKERRQ(ierr);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="comment">// Process RANS fields if enabled</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">rans</a>) {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      ierr = <a class="code" href="io_8c.html#a19e2e0b57afae458bae068610141c031">ReadRANSFields</a>(user,ti); CHKERRQ(ierr);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="comment">// Process statistical fields if averaging is enabled</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a61f9f685923b2b7b99434b6100cc10d7">averaging</a>) {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      ierr = <a class="code" href="io_8c.html#a03f5b76975eea55434d764a23fd42623">ReadStatisticalFields</a>(user,ti); CHKERRQ(ierr);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadSimulationFields - Finished reading simulation fields.\n&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160; </div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a3a009dabc71ccfa59f196e1bc045de45_cgraph.svg" width="543" height="162"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a3a009dabc71ccfa59f196e1bc045de45_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a03f5b76975eea55434d764a23fd42623"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f5b76975eea55434d764a23fd42623">&#9670;&nbsp;</a></span>ReadStatisticalFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadStatisticalFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads statistical fields for averaging purposes. </p>
<p>Reads statistical fields used for time-averaged simulations.</p>
<p>This function reads data for fields such as Ucat_sum, Ucat_cross_sum, Ucat_square_sum, and P_sum, used for statistical analysis during simulation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00822">822</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;{</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadStatisticalFields - Starting to read statistical fields.\n&quot;</span>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;su0&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ab17892f7348a15501be2ac3896e7d345">Ucat_sum</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;su1&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ad78de239c377f8290aa9a5979006d50f">Ucat_cross_sum</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;su2&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a75b5725be5540b27c16fb4672da3b352">Ucat_square_sum</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, <span class="stringliteral">&quot;sp&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a7766fff7f21998c052d5948977cbd2bb">P_sum</a>, ti, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;ReadStatisticalFields - Finished reading statistical fields.\n&quot;</span>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a03f5b76975eea55434d764a23fd42623_cgraph.svg" width="332" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a03f5b76975eea55434d764a23fd42623_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a84fff45b8cbd148ed2429ba8fe12428f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84fff45b8cbd148ed2429ba8fe12428f">&#9670;&nbsp;</a></span>ReadSwarmField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ReadSwarmField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads data from a file into a specified field of a PETSc DMSwarm. </p>
<p>This function is the counterpart to <a class="el" href="io_8c.html#a2c3ac50e182d193208800c89201ff236" title="Writes data from a specific field in a PETSc Swarm to a file.">WriteSwarmField()</a>. It creates a global PETSc vector that references the specified DMSwarm field, uses <a class="el" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908" title="Reads data for a specific field from a file into the provided vector.">ReadFieldData()</a> to read the data from a file, and then destroys the global vector reference.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure (containing <code>user-&gt;swarm</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the DMSwarm field to read into (must be previously declared/allocated). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index used to construct the input file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext</td><td>File extension (e.g., "dat" or "bin").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Compatible with PETSc 3.14.x. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02268">2268</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;{</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  DM             swarm;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  Vec            fieldVec;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160; </div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  PetscFunctionBegin;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160; </div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  swarm = user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot; ReadSwarmField Begins \n&quot;</span>);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160; </div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <span class="comment">/* 2) Create a global vector that references the specified Swarm field. */</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  ierr = DMSwarmCreateGlobalVectorFromField(swarm, field_name, &amp;fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160; </div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot; Vector created from Field \n&quot;</span>);</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="comment">/* 3) Use the ReadFieldData() function to read data into fieldVec. */</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  ierr = <a class="code" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a>(user, field_name, fieldVec, ti, ext);CHKERRQ(ierr);</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="comment">/* 4) Destroy the global vector reference. */</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  ierr = DMSwarmDestroyGlobalVectorFromField(swarm, field_name, &amp;fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a84fff45b8cbd148ed2429ba8fe12428f_cgraph.svg" width="306" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a84fff45b8cbd148ed2429ba8fe12428f_icgraph.svg" width="667" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab6896c293521673fcbff33001706d3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6896c293521673fcbff33001706d3ec">&#9670;&nbsp;</a></span>StringToBCFace()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode StringToBCFace </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a> *&#160;</td>
          <td class="paramname"><em>face_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a string representation of a face to a BCFace enum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">str</td><td>The input string (e.g., "-Xi", "+Zeta"). Case-insensitive. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">face_out</td><td>The resulting BCFace enum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00246">246</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                                 {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span>      (strcasecmp(str, <span class="stringliteral">&quot;-Xi&quot;</span>)   == 0) *face_out = <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;+Xi&quot;</span>)   == 0) *face_out = <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;-Eta&quot;</span>)  == 0) *face_out = <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;+Eta&quot;</span>)  == 0) *face_out = <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;-Zeta&quot;</span>) == 0) *face_out = <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d">BC_FACE_NEG_Z</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;+Zeta&quot;</span>) == 0) *face_out = <a class="code" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e">BC_FACE_POS_Z</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">else</span> SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_UNKNOWN_TYPE, <span class="stringliteral">&quot;Unknown face specifier: %s&quot;</span>, str);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_ab6896c293521673fcbff33001706d3ec_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a15bdb2122be30f52df280e1d7204f578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15bdb2122be30f52df280e1d7204f578">&#9670;&nbsp;</a></span>StringToBCHandlerType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode StringToBCHandlerType </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a> *&#160;</td>
          <td class="paramname"><em>handler_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a string representation of a handler to a BCHandlerType enum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">str</td><td>The input string (e.g., "noslip", "constant_velocity"). Case-insensitive. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">handler_out</td><td>The resulting BCHandlerType enum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00280">280</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                                                  {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span>      (strcasecmp(str, <span class="stringliteral">&quot;noslip&quot;</span>)              == 0) *handler_out = <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;constant_velocity&quot;</span>)   == 0) *handler_out = <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;conservation&quot;</span>)        == 0) *handler_out = <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32">BC_HANDLER_OUTLET_CONSERVATION</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;allcopy&quot;</span>)             == 0) *handler_out = <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;parabolic&quot;</span>)           == 0) *handler_out = <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// ... add other BCHandlerTypes here ...</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">else</span> SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_UNKNOWN_TYPE, <span class="stringliteral">&quot;Unknown BC Handler string: %s&quot;</span>, str);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a15bdb2122be30f52df280e1d7204f578_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ad5fc2fe7ae3aa77361c5ab62343358a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5fc2fe7ae3aa77361c5ab62343358a7">&#9670;&nbsp;</a></span>StringToBCType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode StringToBCType </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a> *&#160;</td>
          <td class="paramname"><em>type_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a string representation of a BC type to a BCType enum. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">str</td><td>The input string (e.g., "WALL", "INLET"). Case-insensitive. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">type_out</td><td>The resulting BCType enum. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00263">263</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                                                 {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span>      (strcasecmp(str, <span class="stringliteral">&quot;WALL&quot;</span>)      == 0) *type_out = <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;SYMMETRY&quot;</span>)  == 0) *type_out = <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e">SYMMETRY</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;INLET&quot;</span>)     == 0) *type_out = <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;OUTLET&quot;</span>)    == 0) *type_out = <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(str, <span class="stringliteral">&quot;NOGRAD&quot;</span>)    == 0) *type_out = <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// ... add other BCTypes here ...</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">else</span> SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_UNKNOWN_TYPE, <span class="stringliteral">&quot;Unknown BC Type string: %s&quot;</span>, str);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_ad5fc2fe7ae3aa77361c5ab62343358a7_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a5fe767286174b757deb2d404f2b4843f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fe767286174b757deb2d404f2b4843f">&#9670;&nbsp;</a></span>ValidateBCHandlerForBCType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ValidateBCHandlerForBCType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a>&#160;</td>
          <td class="paramname"><em>handler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Validates that a specific handler is compatible with a general BC type. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>The general BCType. </td></tr>
    <tr><td class="paramname">handler</td><td>The specific BCHandlerType. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if compatible, error code otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00297">297</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                                              {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a>:</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">if</span>(handler != <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a>) <span class="keywordflow">return</span> PETSC_ERR_ARG_WRONG;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a>:</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordflow">if</span> (handler != <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a> &amp;&amp; handler != <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462">BC_HANDLER_WALL_MOVING</a>) <span class="keywordflow">return</span> PETSC_ERR_ARG_WRONG;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a>:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> (handler != <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a> &amp;&amp; handler != <a class="code" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a>) <span class="keywordflow">return</span> PETSC_ERR_ARG_WRONG;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">// ... add other validation cases here ...</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// Combination is valid</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a5fe767286174b757deb2d404f2b4843f_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aa3512c89570bb1d27f4765819fad4985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3512c89570bb1d27f4765819fad4985">&#9670;&nbsp;</a></span>VecToArrayOnRank0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode VecToArrayOnRank0 </td>
          <td>(</td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>inVec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>arrayOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gathers a PETSc vector onto rank 0 as a contiguous array of doubles. </p>
<p>Gathers the contents of a distributed PETSc Vec into a single array on rank 0.</p>
<p>This function retrieves the local portions of the input vector <code>inVec</code> from all MPI ranks via <code>MPI_Gatherv</code> and assembles them into a single array on rank 0. The global size of the vector is stored in <code>N</code>, and a pointer to the newly allocated array is returned in <code>arrayOut</code> (valid only on rank 0).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">inVec</td><td>The PETSc vector to gather. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">N</td><td>The global size of the vector (output). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">arrayOut</td><td>On rank 0, points to the newly allocated array of size <code>N</code>. On other ranks, it is set to NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, or a non-zero PETSc error code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02160">2160</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;{</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    PetscErrorCode    ierr;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    MPI_Comm          comm;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    PetscMPIInt       rank, size;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    PetscInt          globalSize, localSize;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keyword">const</span> PetscScalar *localArr = NULL;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    </div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    <span class="comment">// Log entry into the function</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;VecToArrayOnRank0 - Start gathering vector onto rank 0.\n&quot;</span>);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    <span class="comment">/* Get MPI comm, rank, size */</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    ierr = PetscObjectGetComm((PetscObject)inVec, &amp;comm);CHKERRQ(ierr);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    ierr = MPI_Comm_rank(comm, &amp;rank);CHKERRQ(ierr);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    ierr = MPI_Comm_size(comm, &amp;size);CHKERRQ(ierr);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    <span class="comment">/* Get global size (for the entire Vec) */</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    ierr = VecGetSize(inVec, &amp;globalSize);CHKERRQ(ierr);</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    *N = globalSize;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="comment">/* Get local size (portion on this rank) */</span></div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    ierr = VecGetLocalSize(inVec, &amp;localSize);CHKERRQ(ierr);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    <span class="comment">// Log vector sizes and process info</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;              <span class="stringliteral">&quot;VecToArrayOnRank0 - rank=%d of %d, globalSize=%d, localSize=%d.\n&quot;</span>,</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;              rank, size, globalSize, localSize);</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="comment">/* Access the local array data */</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    ierr = VecGetArrayRead(inVec, &amp;localArr);CHKERRQ(ierr);</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160; </div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">       We&#39;ll gather the local chunks via MPI_Gatherv:</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">       - First, gather all local sizes into recvcounts[] on rank 0.</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">       - Then set up a displacement array (displs[]) to place each chunk in the correct spot.</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">       - Finally, gather the actual data.</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    PetscMPIInt *recvcounts = NULL;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    PetscMPIInt *displs     = NULL;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        recvcounts = (PetscMPIInt *) malloc(size * <span class="keyword">sizeof</span>(PetscMPIInt));</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;        displs     = (PetscMPIInt *) malloc(size * <span class="keyword">sizeof</span>(PetscMPIInt));</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <span class="comment">/* Convert localSize (PetscInt) to PetscMPIInt for MPI calls */</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    PetscMPIInt localSizeMPI = (PetscMPIInt)localSize;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="comment">/* Gather local sizes to rank 0 */</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;    ierr = MPI_Gather(&amp;localSizeMPI, 1, MPI_INT,</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                      recvcounts,      1, MPI_INT,</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                      0, comm);CHKERRQ(ierr);</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;    <span class="comment">/* On rank 0, build displacements and allocate the big array */</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        displs[0] = 0;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        <span class="keywordflow">for</span> (PetscMPIInt i = 1; i &lt; size; i++) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            displs[i] = displs[i - 1] + recvcounts[i - 1];</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="comment">/* Allocate a buffer for the entire (global) array */</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        *arrayOut = (<span class="keywordtype">double</span> *) malloc(globalSize * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        <span class="keywordflow">if</span> (!(*arrayOut)) SETERRQ(comm, PETSC_ERR_MEM, <span class="stringliteral">&quot;Failed to allocate array on rank 0.&quot;</span>);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="comment">/* On other ranks, we do not allocate anything */</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        *arrayOut = NULL;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    }</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160; </div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="comment">/* Gather the actual data (assuming real scalars =&gt; MPI_DOUBLE) */</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    ierr = MPI_Gatherv((<span class="keywordtype">void</span> *) localArr,         <span class="comment">/* sendbuf on this rank */</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                       localSizeMPI, MPI_DOUBLE,  <span class="comment">/* how many, and type */</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                       (rank == 0 ? *arrayOut : NULL),  <span class="comment">/* recvbuf on rank 0 */</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                       (rank == 0 ? recvcounts : NULL),</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                       (rank == 0 ? displs    : NULL),</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                       MPI_DOUBLE, 0, comm);CHKERRQ(ierr);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="comment">/* Restore local array (cleanup) */</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    ierr = VecRestoreArrayRead(inVec, &amp;localArr);CHKERRQ(ierr);</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160; </div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        free(recvcounts);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        free(displs);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="comment">// Log successful completion</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;VecToArrayOnRank0 - Successfully gathered data on rank 0.\n&quot;</span>);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_aa3512c89570bb1d27f4765819fad4985_icgraph.svg" width="384" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3f37cf6ed1f13d0656740b8cff2b4ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f37cf6ed1f13d0656740b8cff2b4ed8">&#9670;&nbsp;</a></span>WriteFieldData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteFieldData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>field_vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes data from a specific PETSc vector to a file. </p>
<p>This function uses the field name to construct the file path and writes the data from the provided PETSc vector to the corresponding file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the field (e.g., "ufield", "vfield", "pfield"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_vec</td><td>PETSc vector containing the field data to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext</td><td>File extension (e.g., "dat").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<p>Writes data from a specific PETSc vector to a single, sequential file.</p>
<p>This function is now parallel-safe.</p><ul>
<li>In PARALLEL: All processes send their local data to Rank 0. Rank 0 assembles the data into a temporary sequential vector and writes it to a single file.</li>
<li>In SERIAL: It performs a direct, simple write.</li>
</ul>
<p>This ensures the output file is always in a simple, portable format.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the field (e.g., "position"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_vec</td><td>The parallel PETSc vector containing the data to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index for constructing the file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext</td><td>File extension (e.g., "dat").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<p>Dump a <b>distributed</b> PETSc Vec to the <em>single</em> sequential file format used by our restart / post-processing tools.</p>
<p>The companion of <a class="el" href="io_8c.html#a570806d7e0694b5d996e0c6018b48908" title="Reads data for a specific field from a file into the provided vector.">ReadFieldData()</a>: it always produces <b>one</b> file (e.g. <code>results/ufield00006_0.dat</code>) regardless of how many MPI ranks are running.</p>
<p><b>Behaviour</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"># MPI ranks </th><th class="markdownTableHeadNone">Strategy  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">Direct <code>VecView()</code> into the file.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">&gt; 1 </td><td class="markdownTableBodyNone"><code>VecScatterCreateToZero()</code> gathers the distributed Vec onto <b>rank 0</b>.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Rank 0 writes the sequential Vec; all other ranks allocate no storage.  </td></tr>
</table>
<p>The routine never alters or destroys the parallel Vec passed in; the gather buffer is created and freed internally.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Simulation context (used only for logging). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Logical field name (forms part of the filename). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_vec</td><td>Distributed PETSc Vec to write. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Timestep index used in the filename. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext</td><td>File extension (<code>"dat"</code> in our workflow).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success or a PETSc error code. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00990">990</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;{</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    MPI_Comm       comm;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    PetscMPIInt    rank, size;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keyword">const</span> PetscInt placeholder_int = 0;                    <span class="comment">/* keep legacy name */</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordtype">char</span>           filename[PETSC_MAX_PATH_LEN];</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="comment">/* ------------------------------------------------------------ */</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="comment">/*                  Basic communicator information              */</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">/* ------------------------------------------------------------ */</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    ierr = PetscObjectGetComm((PetscObject)field_vec,&amp;comm);CHKERRQ(ierr);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    ierr = MPI_Comm_rank(comm,&amp;rank);CHKERRQ(ierr);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    ierr = MPI_Comm_size(comm,&amp;size);CHKERRQ(ierr);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    ierr = PetscSNPrintf(filename,<span class="keyword">sizeof</span>(filename),</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                         <span class="stringliteral">&quot;results/%s%05&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;_%d.%s&quot;</span>,</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                         field_name,ti,placeholder_int,ext);CHKERRQ(ierr);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;              <span class="stringliteral">&quot;WriteFieldData - Preparing to write &lt;%s&gt; on rank %d/%d\n&quot;</span>,</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;              filename,rank,size);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">/* ------------------------------------------------------------ */</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="comment">/*                       1.  Serial path                        */</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">/* ------------------------------------------------------------ */</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">if</span> (size == 1) {</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        PetscViewer viewer;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        ierr = PetscViewerBinaryOpen(comm,filename,</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                     FILE_MODE_WRITE,&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        ierr = VecView(field_vec,viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        ierr = PetscViewerDestroy(&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                  <span class="stringliteral">&quot;WriteFieldData - Wrote &lt;%s&gt; (serial path)\n&quot;</span>,filename);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">/* ------------------------------------------------------------ */</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="comment">/*                      2.  Parallel path                       */</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">/* ------------------------------------------------------------ */</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    VecScatter scatter;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    Vec        seq_vec=NULL;               <span class="comment">/* created by PETSc, lives only on rank 0 */</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">/* 2.1  Create gather context and buffer                        */</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    ierr = VecScatterCreateToZero(field_vec,&amp;scatter,&amp;seq_vec);CHKERRQ(ierr);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="comment">/* 2.2  Gather distributed → sequential (on rank 0)             */</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    ierr = VecScatterBegin(scatter,field_vec,seq_vec,</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                           INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    ierr = VecScatterEnd  (scatter,field_vec,seq_vec,</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                           INSERT_VALUES,SCATTER_FORWARD);CHKERRQ(ierr);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">/* 2.3  Rank 0 writes the file                                  */</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">if</span> (rank == 0) {</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        PetscViewer viewer;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="comment">/* (optional) value diagnostics */</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        PetscReal vmin,vmax;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        ierr = VecMin(seq_vec,NULL,&amp;vmin);CHKERRQ(ierr);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        ierr = VecMax(seq_vec,NULL,&amp;vmax);CHKERRQ(ierr);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                  <span class="stringliteral">&quot;WriteFieldData - &lt;%s&gt; range = [%.4e … %.4e]\n&quot;</span>,</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                  field_name,(<span class="keywordtype">double</span>)vmin,(<span class="keywordtype">double</span>)vmax);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        ierr = PetscViewerBinaryOpen(PETSC_COMM_SELF,filename,</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                                     FILE_MODE_WRITE,&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        ierr = VecView(seq_vec,viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        ierr = PetscViewerDestroy(&amp;viewer);CHKERRQ(ierr);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                  <span class="stringliteral">&quot;WriteFieldData - Wrote &lt;%s&gt; (parallel path)\n&quot;</span>,filename);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">/* 2.4  Cleanup                                                 */</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    ierr = VecScatterDestroy(&amp;scatter);CHKERRQ(ierr);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    ierr = VecDestroy(&amp;seq_vec);CHKERRQ(ierr);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160; </div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a3f37cf6ed1f13d0656740b8cff2b4ed8_icgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aa7fe2d107007076b401d19ba9145a354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7fe2d107007076b401d19ba9145a354">&#9670;&nbsp;</a></span>WriteLESFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteLESFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes LES-related fields. </p>
<p>This function writes LES-related fields such as Cs (Smagorinsky constant) to their respective binary files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01303">1303</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    Vec Cs;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteLESFields - Starting to write LES fields.\n&quot;</span>);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    VecDuplicate(user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;Cs);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    DMLocalToGlobalBegin(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, user-&gt;<a class="code" href="variables__old_8h.html#a66d4c14737a74d07d188e3e7f2dfee6d">lCs</a>, INSERT_VALUES, Cs);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    DMLocalToGlobalEnd(user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, user-&gt;<a class="code" href="variables__old_8h.html#a66d4c14737a74d07d188e3e7f2dfee6d">lCs</a>, INSERT_VALUES, Cs);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;cs&quot;</span>, Cs, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    VecDestroy(&amp;Cs);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteLESFields - Finished writing LES fields.\n&quot;</span>);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_aa7fe2d107007076b401d19ba9145a354_cgraph.svg" width="295" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_aa7fe2d107007076b401d19ba9145a354_icgraph.svg" width="639" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a87768b32e2f93a36633fe104cebcdfe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87768b32e2f93a36633fe104cebcdfe8">&#9670;&nbsp;</a></span>WriteRANSFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteRANSFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes RANS-related fields. </p>
<p>This function writes RANS-related fields such as K_Omega to their respective binary files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01333">1333</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;{</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160; </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteRANSFields - Starting to write RANS fields.\n&quot;</span>);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;kfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a45bbda2dfda6edd94e9d1dcd5adfc2e1">K_Omega</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteRANSFields - Finished writing RANS fields.\n&quot;</span>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160; </div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a87768b32e2f93a36633fe104cebcdfe8_cgraph.svg" width="308" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a87768b32e2f93a36633fe104cebcdfe8_icgraph.svg" width="652" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6228caf497c8e6134362aab6ba62828c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6228caf497c8e6134362aab6ba62828c">&#9670;&nbsp;</a></span>WriteSimulationFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteSimulationFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes simulation fields to files. </p>
<p>This function writes contravariant velocity, Cartesian velocity, pressure, and node state fields to their respective binary files. It also conditionally writes LES, RANS, and statistical fields if they are enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01220">1220</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;{</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteSimulationFields - Starting to write simulation fields.\n&quot;</span>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="comment">// Write contravariant velocity field</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;vfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160; </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">// Write Cartesian velocity field</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;ufield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="comment">// Write pressure field</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;pfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="comment">// Write node state field (nvert)</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;nvfield&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="comment">// Write ParticleCountPerCell if enabled.</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>&gt;0){</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;ParticleCount&quot;</span>,user-&gt;<a class="code" href="variables__old_8h.html#aa194db376ea0f68ec7090718804488ab">ParticleCount</a>,simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>,<span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="comment">// Write LES fields if enabled</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">les</a>) {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        ierr = <a class="code" href="io_8c.html#aa7fe2d107007076b401d19ba9145a354">WriteLESFields</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">// Write RANS fields if enabled</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">rans</a>) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        ierr = <a class="code" href="io_8c.html#a87768b32e2f93a36633fe104cebcdfe8">WriteRANSFields</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">// Write statistical fields if averaging is enabled</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a61f9f685923b2b7b99434b6100cc10d7">averaging</a>) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        ierr = <a class="code" href="io_8c.html#a3515d51bdd91f00faf8e5023bc82534b">WriteStatisticalFields</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteSimulationFields - Finished writing simulation fields.\n&quot;</span>);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a6228caf497c8e6134362aab6ba62828c_cgraph.svg" width="548" height="162"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a6228caf497c8e6134362aab6ba62828c_icgraph.svg" width="474" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3515d51bdd91f00faf8e5023bc82534b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3515d51bdd91f00faf8e5023bc82534b">&#9670;&nbsp;</a></span>WriteStatisticalFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteStatisticalFields </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes statistical fields for averaging purposes. </p>
<p>This function writes data for fields such as Ucat_sum, Ucat_cross_sum, Ucat_square_sum, and P_sum to their respective binary files.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01275">1275</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;{</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteStatisticalFields - Starting to write statistical fields.\n&quot;</span>);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;su0&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ab17892f7348a15501be2ac3896e7d345">Ucat_sum</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;su1&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#ad78de239c377f8290aa9a5979006d50f">Ucat_cross_sum</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;su2&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a75b5725be5540b27c16fb4672da3b352">Ucat_square_sum</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, <span class="stringliteral">&quot;sp&quot;</span>, user-&gt;<a class="code" href="variables__old_8h.html#a7766fff7f21998c052d5948977cbd2bb">P_sum</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteStatisticalFields - Finished writing statistical fields.\n&quot;</span>);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a3515d51bdd91f00faf8e5023bc82534b_cgraph.svg" width="336" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="io_8c_a3515d51bdd91f00faf8e5023bc82534b_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a2c3ac50e182d193208800c89201ff236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c3ac50e182d193208800c89201ff236">&#9670;&nbsp;</a></span>WriteSwarmField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteSwarmField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ext</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes data from a specific field in a PETSc Swarm to a file. </p>
<p>This function retrieves the Swarm from the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> (i.e., <code>user-&gt;swarm</code>) and creates a global PETSc vector from the specified Swarm field. It then calls the existing <a class="el" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8" title="Writes data from a specific PETSc vector to a file.">WriteFieldData()</a> function to handle the actual I/O operation. After writing the data, the function destroys the temporary global vector to avoid memory leaks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context and the PetscSwarm (as <code>user-&gt;swarm</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">field_name</td><td>Name of the Swarm field to be written (e.g., "my_field"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ti</td><td>Time index used to construct the output file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ext</td><td>File extension (e.g., "dat", "bin").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Compatible with PETSc 3.14.4 and newer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01367">1367</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  Vec            fieldVec;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  DM     swarm;  </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  PetscFunctionBeginUser; <span class="comment">/* PETSc macro indicating start of function */</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">/* </span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">   * 1) Retrieve the PetscSwarm from the user context.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">   *    Ensure user-&gt;swarm is initialized and not NULL.</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  swarm = user-&gt;<a class="code" href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>;      </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="comment">/* </span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">   * 2) Create a global vector from the specified swarm field.</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="comment">   *    This function is available in PETSc 3.14.4.</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="comment">   *    It provides a read/write &quot;view&quot; of the swarm field as a global Vec.</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="stringliteral">&quot;WriteSwarmField - Attempting to create global vector from field: %s\n&quot;</span>,</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            field_name);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  ierr = DMSwarmCreateGlobalVectorFromField(swarm, field_name, &amp;fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="comment">   * 3) Use your existing WriteFieldData() to write the global vector to a file.</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="comment">   *    The field name, time index, and extension are passed along for naming.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="stringliteral">&quot;WriteSwarmField - Calling WriteFieldData for field: %s\n&quot;</span>,</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;            field_name);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  ierr = <a class="code" href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a>(user, field_name, fieldVec, ti, ext);CHKERRQ(ierr);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment">   * 4) Destroy the global vector once the data is successfully written.</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="comment">   *    This step is crucial for avoiding memory leaks. </span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="comment">   *    DMSwarmDestroyGlobalVectorFromField() is also available in PETSc 3.14.4.</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            <span class="stringliteral">&quot;WriteSwarmField - Destroying the global vector for field: %s\n&quot;</span>,</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            field_name);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;  ierr = DMSwarmDestroyGlobalVectorFromField(swarm, field_name, &amp;fieldVec);CHKERRQ(ierr);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="comment">/* Log and return success. */</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <span class="stringliteral">&quot;WriteSwarmField - Successfully wrote swarm data for field: %s\n&quot;</span>,</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            field_name);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  PetscFunctionReturn(0); <span class="comment">/* PETSc macro indicating end of function */</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a2c3ac50e182d193208800c89201ff236_cgraph.svg" width="310" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a2c3ac50e182d193208800c89201ff236_icgraph.svg" width="442" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1ba0fd207c663927535fbd6ab6e28ba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ba0fd207c663927535fbd6ab6e28ba1">&#9670;&nbsp;</a></span>WriteVTKAppendedBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteVTKAppendedBlock </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>num_elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>element_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a data block in appended format for a VTK file, including a 4-byte size prefix. </p>
<p>This function writes the size of the data block (in bytes) as a 4-byte integer, followed immediately by the raw data bytes. It returns 0 on success, or 1 on error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fp</td><td>File pointer to write to (must be open for binary write). </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the data to be written. </td></tr>
    <tr><td class="paramname">num_elements</td><td>Number of elements in the data array. </td></tr>
    <tr><td class="paramname">element_size</td><td>Size (in bytes) of each element.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 if successful, non-zero otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01608">1608</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                                                                                                             {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">// Log the function call with parameters</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="comment">// LOG_ALLOW_SYNC(LOCAL,LOG_INFO,&quot;WriteVTKAppendedBlock - Called with %d elements, each of size %zu bytes.\n&quot;,num_elements, element_size);</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="comment">// Calculate the block size</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    PetscInt block_size = num_elements * (PetscInt)element_size;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">// LOG_ALLOW_SYNC(LOCAL, LOG_DEBUG, &quot;WriteVTKAppendedBlock - Calculated block size: %d bytes.\n&quot;, block_size);</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="comment">// Write the block size as a 4-byte integer</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">if</span> (fwrite(&amp;block_size, <span class="keyword">sizeof</span>(PetscInt), 1, fp) != 1) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;[ERROR] Failed to write block size.\n&quot;</span>);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="comment">//    LOG_ALLOW_SYNC(LOCAL, LOG_ERROR, &quot;WriteVTKAppendedBlock - Error writing block size.\n&quot;);</span></div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;    }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// Write the actual data</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <span class="keywordflow">if</span> (fwrite(data, element_size, num_elements, fp) != (<span class="keywordtype">size_t</span>)num_elements) {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;[ERROR] Failed to write data block.\n&quot;</span>);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="comment">//   LOG_ALLOW_SYNC(LOCAL, LOG_ERROR, &quot;WriteVTKAppendedBlock - Error writing data block.\n&quot;);</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="comment">// Log success</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">// LOG_ALLOW_SYNC(LOCAL, LOG_INFO, &quot;WriteVTKAppendedBlock - Successfully wrote block of %d bytes.\n&quot;, block_size);</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// Success</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a1ba0fd207c663927535fbd6ab6e28ba1_icgraph.svg" width="451" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a225e0a333b858e580840be12c245ab10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a225e0a333b858e580840be12c245ab10">&#9670;&nbsp;</a></span>WriteVTKFileFooter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt WriteVTKFileFooter </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> *&#160;</td>
          <td class="paramname"><em>meta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes the XML footer for a VTK file based on the provided metadata. </p>
<p>This function currently handles only <code>VTK_POLYDATA</code>. If the file type is <code>VTK_POLYDATA</code>, it delegates to <code>WriteVTPXMLFooter</code>. Otherwise, it logs a warning and returns -1 (indicating that other file types are not yet implemented).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer (open for writing) to which the footer will be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Pointer to a <code><a class="el" href="variables_8h.html#structVTKMetaData" title="Metadata structure for VTK output (.vts or .vtp files).">VTKMetaData</a></code> structure containing the fileType (e.g., <code>VTK_POLYDATA</code> or <code>VTK_STRUCTURED</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 or the value from <code>WriteVTPXMLFooter</code> on success, or -1 if the file type is not handled. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l02037">2037</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;{</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    <span class="comment">// Log the entry into this function</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;              <span class="stringliteral">&quot;WriteVTKFileFooter - Called with fileType=%d.\n&quot;</span>, meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a>);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a>) {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;WriteVTKFileFooter - Writing VTP XML footer.\n&quot;</span>);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="io_8c.html#a3acbf6495b06ddc31dcd318a6917bcec">WriteVTPXMLFooter</a>(fp);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;WriteVTKFileFooter - Writing VTS XML footer.\n&quot;</span>);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="io_8c.html#a3fcae786daf54e7706101dd9b955ed96">WriteVTSXMLFooter</a>(fp);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    }</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a225e0a333b858e580840be12c245ab10_cgraph.svg" width="356" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a225e0a333b858e580840be12c245ab10_icgraph.svg" width="414" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abeb59f67fa68fabd9854709774dee119"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb59f67fa68fabd9854709774dee119">&#9670;&nbsp;</a></span>WriteVTKFileHeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt WriteVTKFileHeader </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> *&#160;</td>
          <td class="paramname"><em>meta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>boffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>boffsetOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes the initial XML header for a VTK file based on the provided metadata. </p>
<p>This function writes the XML header for VTK output. It now supports both polydata (VTK_POLYDATA) and structured grid (VTK_STRUCTURED) file types. For each type, the function determines whether to write a scalar or vector field header by inspecting the metadata. For polydata, it calls <code>WriteVTPXMLHeader</code> and for structured grids, it calls <code>WriteVTSXMLHeader</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer (open for writing) to which the header will be written. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">meta</td><td>Pointer to a <code><a class="el" href="variables_8h.html#structVTKMetaData" title="Metadata structure for VTK output (.vts or .vtp files).">VTKMetaData</a></code> structure containing fileType, number of points, grid dimensions, field names, and other necessary information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">boffset</td><td>Current byte offset in the appended data section. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">boffsetOut</td><td>Updated byte offset after writing any header-related data.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 on success, or -1 if the fileType is not handled.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function uses PETSc-style logging (LOG_ALLOW) to trace its execution. For structured grid output, it assumes that grid dimensions (mx, my, mz) and the number of nodes (nnodes) have been set in the metadata. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01927">1927</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;{</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *fieldName = NULL;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    PetscInt numComponents = 1;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">     * Log the entry into this function with the key metadata parameters.</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="comment">     *-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;              <span class="stringliteral">&quot;WriteVTKFileHeader - Entered: fileType=%d, npoints=%d, scalarField=%s, vectorField=%s, &quot;</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;              <span class="stringliteral">&quot;numVectorFields=%d, mx=%d, my=%d, mz=%d, nnodes=%d.\n&quot;</span>,</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;              meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a>, meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>, meta-&gt;<a class="code" href="variables_8h.html#a8ddb585dea9b8a24eb1428c6fb1745bb">scalarFieldName</a>, meta-&gt;<a class="code" href="variables_8h.html#a63a15e7ba17f59ff0fb668fd880f128a">vectorFieldName</a>,</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;              meta-&gt;<a class="code" href="variables_8h.html#a4675755df21ac32ff4f9d13862e8bebb">numVectorFields</a>, meta-&gt;<a class="code" href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">mx</a>, meta-&gt;<a class="code" href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">my</a>, meta-&gt;<a class="code" href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">mz</a>, meta-&gt;<a class="code" href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">nnodes</a>);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a>) {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="comment">/*===================================================================</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">         * Polydata Branch: VTK_POLYDATA</span></div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">         *===================================================================*/</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteVTKFileHeader - Processing VTK_POLYDATA output.\n&quot;</span>);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="comment">/* Determine the field type for polydata:</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment">         * If a vector field is available, use it (with 3 components);</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment">         * otherwise, use the scalar field (with 1 component).</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a4675755df21ac32ff4f9d13862e8bebb">numVectorFields</a> &gt; 0 &amp;&amp; meta-&gt;<a class="code" href="variables_8h.html#a63a15e7ba17f59ff0fb668fd880f128a">vectorFieldName</a>) {</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            fieldName = meta-&gt;<a class="code" href="variables_8h.html#a63a15e7ba17f59ff0fb668fd880f128a">vectorFieldName</a>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            numComponents = 3;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                      <span class="stringliteral">&quot;WriteVTKFileHeader - Using vector field &#39;%s&#39; with 3 components for polydata.\n&quot;</span>,</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                      fieldName);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            fieldName = meta-&gt;<a class="code" href="variables_8h.html#a8ddb585dea9b8a24eb1428c6fb1745bb">scalarFieldName</a>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;            numComponents = 1;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                      <span class="stringliteral">&quot;WriteVTKFileHeader - Using scalar field &#39;%s&#39; with 1 component for polydata.\n&quot;</span>,</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                      fieldName);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        <span class="comment">/* Log the call to the polydata header-writing function */</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                  <span class="stringliteral">&quot;WriteVTKFileHeader - Calling WriteVTPXMLHeader with boffset=%d.\n&quot;</span>, boffset);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="io_8c.html#adc8540405ef08976e1bae9cbb5700545">WriteVTPXMLHeader</a>(fp,</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;                                 meta-&gt;<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>,</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;                                 fieldName,</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                                 numComponents,</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                                 boffset,</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                                 boffsetOut);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> == <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a>) {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="comment">/*===================================================================</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="comment">         * Structured Grid Branch: VTK_STRUCTURED</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;<span class="comment">         *===================================================================*/</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;WriteVTKFileHeader - Processing VTK_STRUCTURED output.\n&quot;</span>);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">/* Determine the field type for structured grid:</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">         * If a vector field is available, use it (with 3 components);</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;<span class="comment">         * otherwise, use the scalar field (with 1 component).</span></div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="keywordflow">if</span> (meta-&gt;<a class="code" href="variables_8h.html#a4675755df21ac32ff4f9d13862e8bebb">numVectorFields</a> &gt; 0 &amp;&amp; meta-&gt;<a class="code" href="variables_8h.html#a63a15e7ba17f59ff0fb668fd880f128a">vectorFieldName</a>) {</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            fieldName = meta-&gt;<a class="code" href="variables_8h.html#a63a15e7ba17f59ff0fb668fd880f128a">vectorFieldName</a>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            numComponents = 3;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                      <span class="stringliteral">&quot;WriteVTKFileHeader - Using vector field &#39;%s&#39; with 3 components for structured grid.\n&quot;</span>,</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                      fieldName);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            fieldName = meta-&gt;<a class="code" href="variables_8h.html#a8ddb585dea9b8a24eb1428c6fb1745bb">scalarFieldName</a>;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            numComponents = 1;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                      <span class="stringliteral">&quot;WriteVTKFileHeader - Using scalar field &#39;%s&#39; with 1 component for structured grid.\n&quot;</span>,</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                      fieldName);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        }</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="comment">/* Log the grid dimensions and number of nodes, then call the structured grid header-writing function */</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                  <span class="stringliteral">&quot;WriteVTKFileHeader - Calling WriteVTSXMLHeader with boffset=%d, grid dimensions (%d, %d, %d) and nnodes=%d.\n&quot;</span>,</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                  boffset, meta-&gt;<a class="code" href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">mx</a>, meta-&gt;<a class="code" href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">my</a>, meta-&gt;<a class="code" href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">mz</a>, meta-&gt;<a class="code" href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">nnodes</a>);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="io_8c.html#a8d20a414e822ac30150e6be7b6d780b2">WriteVTSXMLHeader</a>(fp,</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                                 meta-&gt;<a class="code" href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">mx</a>,</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                                 meta-&gt;<a class="code" href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">my</a>,</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                                 meta-&gt;<a class="code" href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">mz</a>,</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                                 meta-&gt;<a class="code" href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">nnodes</a>,</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                                 fieldName,</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                                 numComponents,</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                                 boffset,</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                                 boffsetOut);</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="comment">/*-------------------------------------------------------------------</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment">         * Unsupported File Type: Log a warning and return an error.</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">         *-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                  <span class="stringliteral">&quot;WriteVTKFileHeader - Unsupported file type %d encountered.\n&quot;</span>, meta-&gt;<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a>);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_abeb59f67fa68fabd9854709774dee119_cgraph.svg" width="368" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_abeb59f67fa68fabd9854709774dee119_icgraph.svg" width="419" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3acbf6495b06ddc31dcd318a6917bcec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3acbf6495b06ddc31dcd318a6917bcec">&#9670;&nbsp;</a></span>WriteVTPXMLFooter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt WriteVTPXMLFooter </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finalizes the .vtp file by closing the appended data section and the VTKFile tag. </p>
<p>This function writes the closing XML tags for the appended data section and completes the overall VTK structure, ensuring a well-formed .vtp file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer to the .vtp file (open for writing).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01891">1891</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;{</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <span class="comment">// Log the function entry</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;WriteVTPXMLFooter - Closing VTP XML.\n&quot;</span>);</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="comment">// no stray prPetscInts or data -&gt; directly close</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;\n  &lt;/AppendedData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;&lt;/VTKFile&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="comment">// Log successful completion</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;WriteVTPXMLFooter - Completed writing VTP XML footer.\n&quot;</span>);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a3acbf6495b06ddc31dcd318a6917bcec_icgraph.svg" width="612" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adc8540405ef08976e1bae9cbb5700545"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc8540405ef08976e1bae9cbb5700545">&#9670;&nbsp;</a></span>WriteVTPXMLHeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt WriteVTPXMLHeader </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>npoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>numComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>boffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>boffsetOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes the XML header portion of a .vtp file for a point-cloud representation. </p>
<p>This function sets up the appended data sections for point coordinates, a named field (e.g., velocity) with a specified number of components, and the connectivity data for each point as a vertex. The byte offset for the appended data is updated after each section, ensuring correct placement of raw binary data in the final output file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer for writing the XML header (already open). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npoints</td><td>Number of points in the point-cloud. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the point data field (e.g., "velocity"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>Number of components in the fieldName array (e.g., 3 for velocity). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">boffset</td><td>Current byte offset into the appended data section. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">boffsetOut</td><td>Updated byte offset after writing the header information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 on success.</dd></dl>
<p>Writes the XML header portion of a .vtp file for a point-cloud representation.</p>
<p>This function sets up the appended data sections for point coordinates, a named field (e.g., velocity) with a specified number of components, and the connectivity/offsets data for each point as a vertex. The byte offset for the appended data is updated after each section. The data type for connectivity and offsets ("Int32" or "Int64") is now determined dynamically based on the size of PetscInt during compilation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer for writing the XML header (already open). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npoints</td><td>Number of points in the point-cloud. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the point data field (e.g., "velocity"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>Number of components in the fieldName array (e.g., 3 for velocity). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">boffset</td><td>Current byte offset into the appended data section. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">boffsetOut</td><td>Updated byte offset after writing the header information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01784">1784</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;{</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    <span class="comment">// Log function entry with parameters</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Called with npoints=%d, fieldName=%s, numComponents=%d, boffset=%d.\n&quot;</span>,</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;              npoints, fieldName, numComponents, boffset);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="comment">// Determine data types based on compilation settings</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *precision     = <span class="stringliteral">&quot;Float64&quot;</span>; <span class="comment">// Assuming coordinates and field data are doubles</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *int_type_str  = (<span class="keyword">sizeof</span>(PetscInt) == 8) ? <span class="stringliteral">&quot;Int64&quot;</span> : <span class="stringliteral">&quot;Int32&quot;</span>; <span class="comment">// Dynamic check for PetscInt size</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">// Pre-calculate byte sizes for data blocks</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    PetscInt points_bytes       = npoints * 3 * <span class="keyword">sizeof</span>(double); <span class="comment">// 3 components, double precision</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    PetscInt field_data_bytes   = npoints * numComponents * <span class="keyword">sizeof</span>(double); <span class="comment">// numComponents, double precision</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    PetscInt connectivity_bytes = npoints * <span class="keyword">sizeof</span>(PetscInt); <span class="comment">// Based on actual PetscInt size</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    PetscInt offsets_bytes      = npoints * <span class="keyword">sizeof</span>(PetscInt); <span class="comment">// Based on actual PetscInt size</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Determined types: precision=%s, int_type=%s (sizeof(PetscInt)=%zu)\n&quot;</span>,</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;              precision, int_type_str, <span class="keyword">sizeof</span>(PetscInt));</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">// 1) Standard XML + &lt;VTKFile&gt; opening</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;&lt;VTKFile type=\&quot;PolyData\&quot; version=\&quot;1.0\&quot; byte_order=\&quot;LittleEndian\&quot;&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;  &lt;PolyData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    <span class="comment">// For simple point-cloud =&gt; #Verts = npoints</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    fprintf(fp,</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <span class="stringliteral">&quot;    &lt;Piece NumberOfPoints=\&quot;%d\&quot; NumberOfVerts=\&quot;%d\&quot; NumberOfLines=\&quot;0\&quot; NumberOfPolys=\&quot;0\&quot; NumberOfStrips=\&quot;0\&quot;&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            npoints, npoints);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="comment">// 2) Points =&gt; offset=boffset</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;Points&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;%s\&quot; Name=\&quot;Position\&quot; NumberOfComponents=\&quot;3\&quot; &quot;</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                <span class="stringliteral">&quot;format=\&quot;appended\&quot; offset=\&quot;%d\&quot;/&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                precision, boffset);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    boffset += <span class="keyword">sizeof</span>(PetscInt) + points_bytes; <span class="comment">// Increment by size prefix + actual data bytes</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Updated offset to %d after Points (%d bytes data).\n&quot;</span>, boffset, points_bytes);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;/Points&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="comment">// 3) PointData =&gt; e.g. &quot;velocity&quot; =&gt; next offset</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;PointData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    fprintf(fp,</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;%s\&quot; Name=\&quot;%s\&quot; NumberOfComponents=\&quot;%d\&quot; &quot;</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <span class="stringliteral">&quot;format=\&quot;appended\&quot; offset=\&quot;%d\&quot;/&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            precision, fieldName, numComponents, boffset);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    boffset += <span class="keyword">sizeof</span>(PetscInt) + field_data_bytes; <span class="comment">// Increment by size prefix + actual data bytes</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Updated offset to %d after PointData (&#39;%s&#39;, %d bytes data).\n&quot;</span>, boffset, fieldName, field_data_bytes);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;/PointData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="comment">// 4) Verts =&gt; connectivity + offsets</span></div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;Verts&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="comment">// Use the dynamically determined integer type string</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    fprintf(fp,</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;%s\&quot; Name=\&quot;connectivity\&quot; format=\&quot;appended\&quot; offset=\&quot;%d\&quot;/&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            int_type_str, boffset);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    boffset += <span class="keyword">sizeof</span>(PetscInt) + connectivity_bytes; <span class="comment">// Increment by size prefix + actual data bytes</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Updated offset to %d after connectivity (%s, %d bytes data).\n&quot;</span>, boffset, int_type_str, connectivity_bytes);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">// Use the dynamically determined integer type string</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    fprintf(fp,</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;            <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;%s\&quot; Name=\&quot;offsets\&quot; format=\&quot;appended\&quot; offset=\&quot;%d\&quot;/&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            int_type_str, boffset);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    boffset += <span class="keyword">sizeof</span>(PetscInt) + offsets_bytes; <span class="comment">// Increment by size prefix + actual data bytes</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Updated offset to %d after offsets (%s, %d bytes data).\n&quot;</span>, boffset, int_type_str, offsets_bytes);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;/Verts&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="comment">// 5) Close out the piece + PolyData</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;    &lt;/Piece&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;  &lt;/PolyData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="comment">// 6) &lt;AppendedData encoding=&quot;raw&quot;&gt; + underscore</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="comment">//    =&gt; all binary must follow AFTER this line</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;  &lt;AppendedData encoding=\&quot;raw\&quot;&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;_&quot;</span>); <span class="comment">// This underscore MUST be present before the binary data blocks</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160; </div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">// Assign the final calculated offset to the output parameter</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    *boffsetOut = boffset;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="comment">// Log function completion</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;              <span class="stringliteral">&quot;WriteVTPXMLHeader - Completed writing VTP XML header. Final calculated boffset (before actual data write)=%d.\n&quot;</span>,</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;              boffset);</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keywordflow">return</span> 0; <span class="comment">// Success</span></div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_adc8540405ef08976e1bae9cbb5700545_icgraph.svg" width="624" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3fcae786daf54e7706101dd9b955ed96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fcae786daf54e7706101dd9b955ed96">&#9670;&nbsp;</a></span>WriteVTSXMLFooter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt WriteVTSXMLFooter </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finalizes the .vts file by closing the appended data section and the VTKFile XML tag. </p>
<p>This function writes the closing XML tags for the appended data section and the overall VTK file, ensuring a well-formed .vts file structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer (already open) for writing the .vts footer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscInt Returns 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01733">1733</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;{</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;              <span class="stringliteral">&quot;WriteVTSXMLFooter - Closing .vts XML.\n&quot;</span>);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;\n &lt;/AppendedData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;&lt;/VTKFile&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">// Log completion</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;              <span class="stringliteral">&quot;WriteVTSXMLFooter - Successfully wrote .vts footer.\n&quot;</span>);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a3fcae786daf54e7706101dd9b955ed96_icgraph.svg" width="612" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8d20a414e822ac30150e6be7b6d780b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d20a414e822ac30150e6be7b6d780b2">&#9670;&nbsp;</a></span>WriteVTSXMLHeader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt WriteVTSXMLHeader </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>mx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>my</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>mz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nnodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>numComponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>boffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>boffsetOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Writes the XML header portion of a .vts file, defining the structured grid extents and data arrays. </p>
<p>This function prPetscInts XML tags for the grid, including whole and piece extents, configures the file's byte order and floating-point precision, and sets up appended data sections (for points and a single scalar field). The offsets in the appended data are updated accordingly.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fp</td><td>File pointer (already open) for writing the .vts header. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mx</td><td>Number of cells in the x-direction (plus ghost cells). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">my</td><td>Number of cells in the y-direction (plus ghost cells). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mz</td><td>Number of cells in the z-direction (plus ghost cells). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnodes</td><td>Total number of grid nodes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the scalar field written to PointData. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numComponents</td><td>Number of components in the fieldName array (e.g., 3 for velocity). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">boffset</td><td>Current byte offset in the appended data section. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">boffsetOut</td><td>Updated byte offset after writing the header information.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, non-zero on failure (though no explicit failure cases are handled here). </dd></dl>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l01657">1657</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;{</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="comment">// Log the entry into this function and the parameters</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;              <span class="stringliteral">&quot;WriteVTSXMLHeader - Writing .vts header (fieldName=%s, numComponents=%d,boffset=%d,mx=%d, my=%d, mz=%d, nnodes=%d).\n&quot;</span>,fieldName,numComponents,boffset,</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;              mx, my, mz, nnodes);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">// Set XML configuration strings</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *byte_order = <span class="stringliteral">&quot;LittleEndian&quot;</span>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *precision  = <span class="stringliteral">&quot;Float64&quot;</span>;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="comment">// Begin XML header</span></div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;&lt;?xml version=\&quot;1.0\&quot;?&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;&lt;VTKFile type=\&quot;StructuredGrid\&quot; version=\&quot;0.1\&quot; byte_order=\&quot;%s\&quot;&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            byte_order);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;  &lt;StructuredGrid WholeExtent=\&quot;%d %d %d %d %d %d\&quot;&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            0, mx-1, 0, my-1, 0, mz-1);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;    &lt;Piece Extent=\&quot;%d %d %d %d %d %d\&quot;&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;            0, mx-1, 0, my-1, 0, mz-1);</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="comment">// Points section</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;Points&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;%s\&quot; Name=\&quot;Position\&quot; NumberOfComponents=\&quot;3\&quot; &quot;</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                <span class="stringliteral">&quot;format=\&quot;appended\&quot; offset=\&quot;%d\&quot; /&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;            precision, boffset);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    boffset += (PetscInt)<span class="keyword">sizeof</span>(PetscInt) + 3 * nnodes * (PetscInt)<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;              <span class="stringliteral">&quot;WriteVTSXMLHeader - Updated offset to %d after Points.\n&quot;</span>, boffset);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;/Points&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">// PointData =&gt; &quot;ufield,vfield,p</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;PointData Scalars=\&quot;%s\&quot;&gt;\n&quot;</span>, fieldName);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;        &lt;DataArray type=\&quot;%s\&quot; Name=\&quot;%s\&quot; NumberOfComponents=\&quot;%d\&quot; &quot;</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                <span class="stringliteral">&quot;format=\&quot;appended\&quot; offset=\&quot;%d\&quot; /&gt;\n&quot;</span>,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;            precision, fieldName, numComponents,boffset);</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    boffset += (PetscInt)<span class="keyword">sizeof</span>(PetscInt) + nnodes * numComponents * (PetscInt)<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;              <span class="stringliteral">&quot;WriteVTSXMLHeader - Updated offset to %d after PointData.\n&quot;</span>, boffset);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;      &lt;/PointData&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="comment">// Close the piece and structured grid tags</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;    &lt;/Piece&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;  &lt;/StructuredGrid&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    <span class="comment">// Open the appended data section</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;  &lt;AppendedData encoding=\&quot;raw\&quot;&gt;\n&quot;</span>);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    fprintf(fp, <span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">// Return new offset</span></div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    *boffsetOut = boffset;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="comment">// Log successful completion</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;              <span class="stringliteral">&quot;WriteVTSXMLHeader - Completed writing .vts header. New boffset=%d.\n&quot;</span>, boffset);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="io_8c_a8d20a414e822ac30150e6be7b6d780b2_icgraph.svg" width="624" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a78f1b2ae6c98930995de7229a02aef6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78f1b2ae6c98930995de7229a02aef6a">&#9670;&nbsp;</a></span>g_file_has_been_read</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscBool g_file_has_been_read = PETSC_FALSE</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A flag to ensure the grid file is read only once. </p>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00025">25</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
<a id="a310ceb96a9cb266916fc9ec5cedb5aa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a310ceb96a9cb266916fc9ec5cedb5aa2">&#9670;&nbsp;</a></span>g_IMs_from_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt* g_IMs_from_file = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Caches the IM dimensions for all blocks read from the grid file. </p>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00019">19</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
<a id="ab1e9e2bb2f9a982f1f13f41d7fc0ad7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">&#9670;&nbsp;</a></span>g_JMs_from_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt* g_JMs_from_file = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Caches the JM dimensions for all blocks read from the grid file. </p>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00021">21</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
<a id="ab0838ef307b26c3fb18d19f18e2bff5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0838ef307b26c3fb18d19f18e2bff5f">&#9670;&nbsp;</a></span>g_KMs_from_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt* g_KMs_from_file = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Caches the KM dimensions for all blocks read from the grid file. </p>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00023">23</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
<a id="a3d554435495d0536a7d8c4b1bbbeb0a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d554435495d0536a7d8c4b1bbbeb0a6">&#9670;&nbsp;</a></span>g_nblk_from_file</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt g_nblk_from_file = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stores the number of blocks read from the grid file. </p>

<p class="definition">Definition at line <a class="el" href="io_8c_source.html#l00017">17</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="avariables__old_8h_html_a4a7154d09d7dee5e3dd7f0323dfb4ff3"><div class="ttname"><a href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">MGCtx::user</a></div><div class="ttdeci">UserCtx * user</div><div class="ttdoc">Pointer to the main application context for this level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00419">variables.h:419</a></div></div>
<div class="ttc" id="aio_8c_html_ad5fc2fe7ae3aa77361c5ab62343358a7"><div class="ttname"><a href="io_8c.html#ad5fc2fe7ae3aa77361c5ab62343358a7">StringToBCType</a></div><div class="ttdeci">PetscErrorCode StringToBCType(const char *str, BCType *type_out)</div><div class="ttdoc">Converts a string representation of a BC type to a BCType enum.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00263">io.c:263</a></div></div>
<div class="ttc" id="avariables_8h_html_a8c248c162038dffe12e38228bcd06644"><div class="ttname"><a href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">SimCtx::bboxlist</a></div><div class="ttdeci">BoundingBox * bboxlist</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00549">variables.h:549</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a1d31f361d6e2d535a91d757c14eba7f4"><div class="ttname"><a href="variables__old_8h.html#a1d31f361d6e2d535a91d757c14eba7f4">UserCtx::cgrid</a></div><div class="ttdeci">PetscInt cgrid</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00597">variables.h:597</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aac8e0dd714804b073dbb32c0ad84b2eb"><div class="ttname"><a href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">UserMG::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdoc">Total number of multigrid levels.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00426">variables.h:426</a></div></div>
<div class="ttc" id="alogging_8h_html_ab17ab5ac0ff52ba6a344790a496f6111"><div class="ttname"><a href="logging_8h.html#ab17ab5ac0ff52ba6a344790a496f6111">BCHandlerTypeToString</a></div><div class="ttdeci">const char * BCHandlerTypeToString(BCHandlerType handler_type)</div><div class="ttdoc">Converts a BCHandlerType enum to its string representation.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00689">logging.c:689</a></div></div>
<div class="ttc" id="avariables_8h_html_ac9684d6e871566d55c997416270b5b99"><div class="ttname"><a href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">SimCtx::step</a></div><div class="ttdeci">PetscInt step</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00482">variables.h:482</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ade80a8abea8047bfe4b83bd9363df589"><div class="ttname"><a href="variables__old_8h.html#ade80a8abea8047bfe4b83bd9363df589">UserCtx::rx</a></div><div class="ttdeci">PetscReal rx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00596">variables.h:596</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="avariables_8h_html_a61f9f685923b2b7b99434b6100cc10d7"><div class="ttname"><a href="variables_8h.html#a61f9f685923b2b7b99434b6100cc10d7">SimCtx::averaging</a></div><div class="ttdeci">PetscBool averaging</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00543">variables.h:543</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a6b5da58d79c9c0ed6e9368c9677d5260"><div class="ttname"><a href="variables__old_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">BoundingBox::min_coords</a></div><div class="ttdeci">Cmpnts min_coords</div><div class="ttdoc">Minimum x, y, z coordinates of the bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00155">variables.h:155</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a></div><div class="ttdeci">@ LOG_WARNING</div><div class="ttdoc">Non-critical issues that warrant attention.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00030">logging.h:30</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structUserCtx"><div class="ttname"><a href="variables__old_8h.html#structUserCtx">UserCtx</a></div><div class="ttdoc">User-defined context containing data specific to a single computational grid level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00582">variables.h:582</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a></div><div class="ttdeci">@ BC_FACE_POS_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00202">variables.h:202</a></div></div>
<div class="ttc" id="avariables_8h_html_a6a5533a086f46652d5587ae84ec62c9f"><div class="ttname"><a href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">SimCtx::StartStep</a></div><div class="ttdeci">PetscInt StartStep</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00484">variables.h:484</a></div></div>
<div class="ttc" id="avariables_8h_html_structBoundaryFaceConfig"><div class="ttname"><a href="variables_8h.html#structBoundaryFaceConfig">BoundaryFaceConfig</a></div><div class="ttdoc">Holds the complete configuration for one of the six boundary faces.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00263">variables.h:263</a></div></div>
<div class="ttc" id="aio_8c_html_a3acbf6495b06ddc31dcd318a6917bcec"><div class="ttname"><a href="io_8c.html#a3acbf6495b06ddc31dcd318a6917bcec">WriteVTPXMLFooter</a></div><div class="ttdeci">static PetscInt WriteVTPXMLFooter(FILE *fp)</div><div class="ttdoc">Finalizes the .vtp file by closing the appended data section and the VTKFile tag.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01891">io.c:1891</a></div></div>
<div class="ttc" id="avariables_8h_html_a490a85dfc1aa84b470a36827a9cb839d"><div class="ttname"><a href="variables_8h.html#a490a85dfc1aa84b470a36827a9cb839d">VTKMetaData::numScalarFields</a></div><div class="ttdeci">PetscInt numScalarFields</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00454">variables.h:454</a></div></div>
<div class="ttc" id="alogging_8h_html_a2ebe7667b52c478f7ff365f296d4c8ae"><div class="ttname"><a href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a></div><div class="ttdeci">#define LOG_ALLOW_SYNC(scope, level, fmt,...)</div><div class="ttdoc">----— DEBUG ---------------------------------------— #define LOG_ALLOW(scope, level,...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00274">logging.h:274</a></div></div>
<div class="ttc" id="avariables_8h_html_aebf75baa2defdbe4f6dcce0b6620cad4"><div class="ttname"><a href="variables_8h.html#aebf75baa2defdbe4f6dcce0b6620cad4">SimCtx::vnn</a></div><div class="ttdeci">PetscReal vnn</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00510">variables.h:510</a></div></div>
<div class="ttc" id="avariables_8h_html_a43d81caf7c9b0dfc29d388df974ebb31"><div class="ttname"><a href="variables_8h.html#a43d81caf7c9b0dfc29d388df974ebb31">BoundaryFaceConfig::face_id</a></div><div class="ttdeci">BCFace face_id</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00264">variables.h:264</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00474">variables.h:474</a></div></div>
<div class="ttc" id="aio_8c_html_a45ad89f26c78131d2990f09126abba4b"><div class="ttname"><a href="io_8c.html#a45ad89f26c78131d2990f09126abba4b">ReadLESFields</a></div><div class="ttdeci">PetscErrorCode ReadLESFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads LES-related fields.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00849">io.c:849</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structBoundingBox"><div class="ttname"><a href="variables__old_8h.html#structBoundingBox">BoundingBox</a></div><div class="ttdoc">Defines a 3D axis-aligned bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00154">variables.h:154</a></div></div>
<div class="ttc" id="avariables_8h_html_a7947f7b4cd08e551b6d2a79c8b513d9c"><div class="ttname"><a href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">SimCtx::grid_file</a></div><div class="ttdeci">char grid_file[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00528">variables.h:528</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a45bbda2dfda6edd94e9d1dcd5adfc2e1"><div class="ttname"><a href="variables__old_8h.html#a45bbda2dfda6edd94e9d1dcd5adfc2e1">UserCtx::K_Omega</a></div><div class="ttdeci">Vec K_Omega</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00632">variables.h:632</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa194db376ea0f68ec7090718804488ab"><div class="ttname"><a href="variables__old_8h.html#aa194db376ea0f68ec7090718804488ab">UserCtx::ParticleCount</a></div><div class="ttdeci">Vec ParticleCount</div><div class="ttdoc">Eulerian field to count particles per cell.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00649">variables.h:649</a></div></div>
<div class="ttc" id="aio_8c_html_a87768b32e2f93a36633fe104cebcdfe8"><div class="ttname"><a href="io_8c.html#a87768b32e2f93a36633fe104cebcdfe8">WriteRANSFields</a></div><div class="ttdeci">PetscErrorCode WriteRANSFields(UserCtx *user)</div><div class="ttdoc">Writes RANS-related fields.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01333">io.c:1333</a></div></div>
<div class="ttc" id="aio_8c_html_ab7d7097c8ad047feb1d460e4694b8b4f"><div class="ttname"><a href="io_8c.html#ab7d7097c8ad047feb1d460e4694b8b4f">CheckDataFile</a></div><div class="ttdeci">static PetscErrorCode CheckDataFile(PetscInt ti, const char *fieldName, const char *ext, PetscBool *fileExists)</div><div class="ttdoc">Checks for a data file's existence in a parallel-safe manner.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00522">io.c:522</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a></div><div class="ttdeci">@ BC_HANDLER_INLET_PARABOLIC</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00224">variables.h:224</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a></div><div class="ttdeci">@ BC_HANDLER_NOGRAD_COPY_GHOST</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00222">variables.h:222</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a></div><div class="ttdeci">@ BC_FACE_NEG_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00202">variables.h:202</a></div></div>
<div class="ttc" id="aio_8c_html_ab6896c293521673fcbff33001706d3ec"><div class="ttname"><a href="io_8c.html#ab6896c293521673fcbff33001706d3ec">StringToBCFace</a></div><div class="ttdeci">PetscErrorCode StringToBCFace(const char *str, BCFace *face_out)</div><div class="ttdoc">Converts a string representation of a face to a BCFace enum.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00246">io.c:246</a></div></div>
<div class="ttc" id="aio_8c_html_a3f37cf6ed1f13d0656740b8cff2b4ed8"><div class="ttname"><a href="io_8c.html#a3f37cf6ed1f13d0656740b8cff2b4ed8">WriteFieldData</a></div><div class="ttdeci">PetscErrorCode WriteFieldData(UserCtx *user, const char *field_name, Vec field_vec, PetscInt ti, const char *ext)</div><div class="ttdoc">Writes data from a specific PETSc vector to a file.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00990">io.c:990</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="avariables_8h_html_a1284d7ce4801cbe00fa3068be7682014"><div class="ttname"><a href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">VTKMetaData::npoints</a></div><div class="ttdeci">PetscInt npoints</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00451">variables.h:451</a></div></div>
<div class="ttc" id="aio_8c_html_a8d20a414e822ac30150e6be7b6d780b2"><div class="ttname"><a href="io_8c.html#a8d20a414e822ac30150e6be7b6d780b2">WriteVTSXMLHeader</a></div><div class="ttdeci">static PetscInt WriteVTSXMLHeader(FILE *fp, PetscInt mx, PetscInt my, PetscInt mz, PetscInt nnodes, const char *fieldName, PetscInt numComponents, PetscInt boffset, PetscInt *boffsetOut)</div><div class="ttdoc">Writes the XML header portion of a .vts file, defining the structured grid extents and data arrays.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01657">io.c:1657</a></div></div>
<div class="ttc" id="aio_8c_html_acee53553fb7d51eb948f1d4030518860"><div class="ttname"><a href="io_8c.html#acee53553fb7d51eb948f1d4030518860">FreeBC_ParamList</a></div><div class="ttdeci">void FreeBC_ParamList(BC_Param *head)</div><div class="ttdoc">Frees the memory allocated for a linked list of BC_Param structs.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00229">io.c:229</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a7766fff7f21998c052d5948977cbd2bb"><div class="ttname"><a href="variables__old_8h.html#a7766fff7f21998c052d5948977cbd2bb">UserCtx::P_sum</a></div><div class="ttdeci">Vec P_sum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="aio_8c_html_a78f1b2ae6c98930995de7229a02aef6a"><div class="ttname"><a href="io_8c.html#a78f1b2ae6c98930995de7229a02aef6a">g_file_has_been_read</a></div><div class="ttdeci">static PetscBool g_file_has_been_read</div><div class="ttdoc">A flag to ensure the grid file is read only once.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00025">io.c:25</a></div></div>
<div class="ttc" id="avariables_8h_html_afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9"><div class="ttname"><a href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a></div><div class="ttdeci">@ VTK_STRUCTURED</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00444">variables.h:444</a></div></div>
<div class="ttc" id="aio_8c_html_a3515d51bdd91f00faf8e5023bc82534b"><div class="ttname"><a href="io_8c.html#a3515d51bdd91f00faf8e5023bc82534b">WriteStatisticalFields</a></div><div class="ttdeci">PetscErrorCode WriteStatisticalFields(UserCtx *user)</div><div class="ttdoc">Writes statistical fields for averaging purposes.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01275">io.c:1275</a></div></div>
<div class="ttc" id="aio_8c_html_aa3512c89570bb1d27f4765819fad4985"><div class="ttname"><a href="io_8c.html#aa3512c89570bb1d27f4765819fad4985">VecToArrayOnRank0</a></div><div class="ttdeci">PetscErrorCode VecToArrayOnRank0(Vec inVec, PetscInt *N, double **arrayOut)</div><div class="ttdoc">Gathers a PETSc vector onto rank 0 as a contiguous array of doubles.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l02160">io.c:2160</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a></div><div class="ttdeci">@ OUTLET</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00212">variables.h:212</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a540dc135c4299ebf7fcbb33ecd8ca096"><div class="ttname"><a href="variables__old_8h.html#a540dc135c4299ebf7fcbb33ecd8ca096">UserCtx::ry</a></div><div class="ttdeci">PetscReal ry</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00596">variables.h:596</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a5a73aa2bc6be44bc1ff8847cf0a1b6af"><div class="ttname"><a href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">UserCtx::P</a></div><div class="ttdeci">Vec P</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a></div><div class="ttdeci">@ LOG_ERROR</div><div class="ttdoc">Critical errors that may halt the program.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00029">logging.h:29</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ac6633daab270004cd266f6e6ac05f588"><div class="ttname"><a href="variables__old_8h.html#ac6633daab270004cd266f6e6ac05f588">UserCtx::Min_Y</a></div><div class="ttdeci">PetscReal Min_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a66d4c14737a74d07d188e3e7f2dfee6d"><div class="ttname"><a href="variables__old_8h.html#a66d4c14737a74d07d188e3e7f2dfee6d">UserCtx::lCs</a></div><div class="ttdeci">Vec lCs</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00632">variables.h:632</a></div></div>
<div class="ttc" id="avariables_8h_html_a34b307d2eee4e2ab67a72a0b79ab96ba"><div class="ttname"><a href="variables_8h.html#a34b307d2eee4e2ab67a72a0b79ab96ba">VTKMetaData::offsets</a></div><div class="ttdeci">PetscInt * offsets</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00458">variables.h:458</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ab17892f7348a15501be2ac3896e7d345"><div class="ttname"><a href="variables__old_8h.html#ab17892f7348a15501be2ac3896e7d345">UserCtx::Ucat_sum</a></div><div class="ttdeci">Vec Ucat_sum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="avariables_8h_html_afd5de2425dd1a26c88befe95285b607f"><div class="ttname"><a href="variables_8h.html#afd5de2425dd1a26c88befe95285b607f">VTKMetaData::nnodes</a></div><div class="ttdeci">PetscInt nnodes</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00451">variables.h:451</a></div></div>
<div class="ttc" id="aio_8c_html_ab0838ef307b26c3fb18d19f18e2bff5f"><div class="ttname"><a href="io_8c.html#ab0838ef307b26c3fb18d19f18e2bff5f">g_KMs_from_file</a></div><div class="ttdeci">static PetscInt * g_KMs_from_file</div><div class="ttdoc">Caches the KM dimensions for all blocks read from the grid file.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00023">io.c:23</a></div></div>
<div class="ttc" id="avariables_8h_html_add2b02a12c80adcbe2a4c2e61cdfdd4c"><div class="ttname"><a href="variables_8h.html#add2b02a12c80adcbe2a4c2e61cdfdd4c">BoundaryFaceConfig::mathematical_type</a></div><div class="ttdeci">BCType mathematical_type</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00265">variables.h:265</a></div></div>
<div class="ttc" id="avariables_8h_html_a3279024cc316f957e89c05949a1ab441"><div class="ttname"><a href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">SimCtx::rans</a></div><div class="ttdeci">PetscInt rans</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00539">variables.h:539</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a1f49c003091a0c03ca2ca9ee905ccf98"><div class="ttname"><a href="variables__old_8h.html#a1f49c003091a0c03ca2ca9ee905ccf98">BC_Param_s::next</a></div><div class="ttdeci">struct BC_Param_s * next</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00240">variables.h:240</a></div></div>
<div class="ttc" id="avariables_8h_html_aaf69cd924766117c45ba60fcf2ed452e"><div class="ttname"><a href="variables_8h.html#aaf69cd924766117c45ba60fcf2ed452e">SimCtx::cfl</a></div><div class="ttdeci">PetscReal cfl</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00510">variables.h:510</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aecbc2de7a281e906efe25a773b76866c"><div class="ttname"><a href="variables__old_8h.html#aecbc2de7a281e906efe25a773b76866c">UserCtx::Max_Z</a></div><div class="ttdeci">PetscReal Max_Z</div><div class="ttdoc">Physical maximum bounds of the grid.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad1904cdee33ebeffba809c883f7e9641"><div class="ttname"><a href="variables__old_8h.html#ad1904cdee33ebeffba809c883f7e9641">UserCtx::IM</a></div><div class="ttdeci">PetscInt IM</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00591">variables.h:591</a></div></div>
<div class="ttc" id="avariables_8h_html_afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57"><div class="ttname"><a href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a></div><div class="ttdeci">@ VTK_POLYDATA</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00445">variables.h:445</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08fa"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a></div><div class="ttdeci">BCType</div><div class="ttdoc">Defines the general mathematical/physical category of a boundary.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00207">variables.h:207</a></div></div>
<div class="ttc" id="aio_8c_html_aa7fe2d107007076b401d19ba9145a354"><div class="ttname"><a href="io_8c.html#aa7fe2d107007076b401d19ba9145a354">WriteLESFields</a></div><div class="ttdeci">PetscErrorCode WriteLESFields(UserCtx *user)</div><div class="ttdoc">Writes LES-related fields.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01303">io.c:1303</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4f7c5fd8843d026101b193e9236e1192"><div class="ttname"><a href="variables__old_8h.html#a4f7c5fd8843d026101b193e9236e1192">UserCtx::_this</a></div><div class="ttdeci">PetscInt _this</div><div class="ttdoc">Legacy block index, for multi-block contexts.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00595">variables.h:595</a></div></div>
<div class="ttc" id="aio_8c_html_a1ba0fd207c663927535fbd6ab6e28ba1"><div class="ttname"><a href="io_8c.html#a1ba0fd207c663927535fbd6ab6e28ba1">WriteVTKAppendedBlock</a></div><div class="ttdeci">PetscErrorCode WriteVTKAppendedBlock(FILE *fp, const void *data, PetscInt num_elements, size_t element_size)</div><div class="ttdoc">Writes a data block in appended format for a VTK file, including a 4-byte size prefix.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01608">io.c:1608</a></div></div>
<div class="ttc" id="avariables_8h_html_afd962f86b7e71fb2cb7ba60eb76058e8"><div class="ttname"><a href="variables_8h.html#afd962f86b7e71fb2cb7ba60eb76058e8">BoundaryFaceConfig::handler</a></div><div class="ttdeci">BoundaryCondition * handler</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00268">variables.h:268</a></div></div>
<div class="ttc" id="aio_8c_html_adc8540405ef08976e1bae9cbb5700545"><div class="ttname"><a href="io_8c.html#adc8540405ef08976e1bae9cbb5700545">WriteVTPXMLHeader</a></div><div class="ttdeci">static PetscInt WriteVTPXMLHeader(FILE *fp, PetscInt npoints, const char *fieldName, PetscInt numComponents, PetscInt boffset, PetscInt *boffsetOut)</div><div class="ttdoc">Writes the XML header portion of a .vtp file for a point-cloud representation.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01784">io.c:1784</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structBC__Param__s"><div class="ttname"><a href="variables__old_8h.html#structBC__Param__s">BC_Param_s</a></div><div class="ttdoc">A node in a linked list for storing key-value parameters from the bcs.dat file.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00237">variables.h:237</a></div></div>
<div class="ttc" id="avariables_8h_html_a22580e0e52ca8ddccc76d24c96f00e4a"><div class="ttname"><a href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">SimCtx::block_number</a></div><div class="ttdeci">PetscInt block_number</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00523">variables.h:523</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="avariables_8h_html_a499ad2619c29a9aee2d01e859c8942f6"><div class="ttname"><a href="variables_8h.html#a499ad2619c29a9aee2d01e859c8942f6">BoundaryFaceConfig::handler_type</a></div><div class="ttdeci">BCHandlerType handler_type</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00266">variables.h:266</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a></div><div class="ttdeci">@ INLET</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00211">variables.h:211</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a></div><div class="ttdeci">@ NOGRAD</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00217">variables.h:217</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa55a2a246e904b3569075eb4de0092a6"><div class="ttname"><a href="variables__old_8h.html#aa55a2a246e904b3569075eb4de0092a6">UserCtx::JM</a></div><div class="ttdeci">PetscInt JM</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00591">variables.h:591</a></div></div>
<div class="ttc" id="avariables_8h_html_a8ddb585dea9b8a24eb1428c6fb1745bb"><div class="ttname"><a href="variables_8h.html#a8ddb585dea9b8a24eb1428c6fb1745bb">VTKMetaData::scalarFieldName</a></div><div class="ttdeci">const char * scalarFieldName</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00453">variables.h:453</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structCmpnts"><div class="ttname"><a href="variables__old_8h.html#structCmpnts">Cmpnts</a></div><div class="ttdoc">A 3D point or vector with PetscScalar components.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00100">variables.h:100</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462">BC_HANDLER_WALL_MOVING</a></div><div class="ttdeci">@ BC_HANDLER_WALL_MOVING</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00223">variables.h:223</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a></div><div class="ttdeci">@ BC_FACE_NEG_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00201">variables.h:201</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a1300c167a3006a58c71fe8759ebf5ef1"><div class="ttname"><a href="variables__old_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">UserCtx::inletFaceDefined</a></div><div class="ttdeci">PetscBool inletFaceDefined</div><div class="ttdoc">Legacy flag for particle system compatibility.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00601">variables.h:601</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32">BC_HANDLER_OUTLET_CONSERVATION</a></div><div class="ttdeci">@ BC_HANDLER_OUTLET_CONSERVATION</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00226">variables.h:226</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ada2db2a63cf3a9fe7ad2abf01cedc818"><div class="ttname"><a href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">UserCtx::Nvert</a></div><div class="ttdeci">Vec Nvert</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables_8h_html_aedca60f0134d0716305127acad94d9d1"><div class="ttname"><a href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">VTKMetaData::mx</a></div><div class="ttdeci">PetscInt mx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00451">variables.h:451</a></div></div>
<div class="ttc" id="alogging_8h_html_a804d193057ea6054b3911ae508808821"><div class="ttname"><a href="logging_8h.html#a804d193057ea6054b3911ae508808821">BCTypeToString</a></div><div class="ttdeci">const char * BCTypeToString(BCType type)</div><div class="ttdoc">Helper function to convert BCType enum to a string representation.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00662">logging.c:662</a></div></div>
<div class="ttc" id="avariables_8h_html_ad87ed7266a1bc272ab8d4cea4e39d4d2"><div class="ttname"><a href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">SimCtx::les</a></div><div class="ttdeci">PetscInt les</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00539">variables.h:539</a></div></div>
<div class="ttc" id="avariables_8h_html_a19aa807b9181b13618527d6c4eb6fa89"><div class="ttname"><a href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">SimCtx::rank</a></div><div class="ttdeci">PetscMPIInt rank</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00477">variables.h:477</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a718a09fbedf450248eaf7019a980e139"><div class="ttname"><a href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">Cmpnts::x</a></div><div class="ttdeci">PetscScalar x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="avariables_8h_html_a4675755df21ac32ff4f9d13862e8bebb"><div class="ttname"><a href="variables_8h.html#a4675755df21ac32ff4f9d13862e8bebb">VTKMetaData::numVectorFields</a></div><div class="ttdeci">PetscInt numVectorFields</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00457">variables.h:457</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa39fcddc08427c8d30e28c5a8a37f981"><div class="ttname"><a href="variables__old_8h.html#aa39fcddc08427c8d30e28c5a8a37f981">UserCtx::lK_Omega</a></div><div class="ttdeci">Vec lK_Omega</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00632">variables.h:632</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e">SYMMETRY</a></div><div class="ttdeci">@ SYMMETRY</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00210">variables.h:210</a></div></div>
<div class="ttc" id="avariables_8h_html_aac5e5bdffa985d12e89f4d6f742a2442"><div class="ttname"><a href="variables_8h.html#aac5e5bdffa985d12e89f4d6f742a2442">VTKMetaData::coords</a></div><div class="ttdeci">PetscScalar * coords</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00452">variables.h:452</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a></div><div class="ttdeci">@ BC_HANDLER_WALL_NOSLIP</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00223">variables.h:223</a></div></div>
<div class="ttc" id="aio_8c_html_a3d554435495d0536a7d8c4b1bbbeb0a6"><div class="ttname"><a href="io_8c.html#a3d554435495d0536a7d8c4b1bbbeb0a6">g_nblk_from_file</a></div><div class="ttdeci">static PetscInt g_nblk_from_file</div><div class="ttdoc">Stores the number of blocks read from the grid file.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00017">io.c:17</a></div></div>
<div class="ttc" id="alogging_8h_html_a9b417fe56a110c0f6a3e64860e3e5cdb"><div class="ttname"><a href="logging_8h.html#a9b417fe56a110c0f6a3e64860e3e5cdb">BCFaceToString</a></div><div class="ttdeci">const char * BCFaceToString(BCFace face)</div><div class="ttdoc">Helper function to convert BCFace enum to a string representation.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00645">logging.c:645</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a91ffa8462250c687df3e3aa4e16897bb"><div class="ttname"><a href="variables__old_8h.html#a91ffa8462250c687df3e3aa4e16897bb">UserCtx::boundary_faces</a></div><div class="ttdeci">BoundaryFaceConfig boundary_faces[6]</div><div class="ttdoc">The new, primary BC configuration array.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00600">variables.h:600</a></div></div>
<div class="ttc" id="avariables_8h_html_a41a6127b3c012c516a7dcc56c3696a84"><div class="ttname"><a href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">SimCtx::usermg</a></div><div class="ttdeci">UserMG usermg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00560">variables.h:560</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa1823d873982755996b7335f43732af4"><div class="ttname"><a href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">UserCtx::Ucat</a></div><div class="ttdeci">Vec Ucat</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="aio_8c_html_a310ceb96a9cb266916fc9ec5cedb5aa2"><div class="ttname"><a href="io_8c.html#a310ceb96a9cb266916fc9ec5cedb5aa2">g_IMs_from_file</a></div><div class="ttdeci">static PetscInt * g_IMs_from_file</div><div class="ttdoc">Caches the IM dimensions for all blocks read from the grid file.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00019">io.c:19</a></div></div>
<div class="ttc" id="avariables_8h_html_a688b11ccc72940aa35ca84eb6f0ec99b"><div class="ttname"><a href="variables_8h.html#a688b11ccc72940aa35ca84eb6f0ec99b">VTKMetaData::vectorField</a></div><div class="ttdeci">PetscScalar * vectorField</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00455">variables.h:455</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aaeef1864bb110c26e4b30a9e2c8c116d"><div class="ttname"><a href="variables__old_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">UserCtx::Min_Z</a></div><div class="ttdeci">PetscReal Min_Z</div><div class="ttdoc">Physical minimum bounds of the grid.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="aio_8c_html_a3fcae786daf54e7706101dd9b955ed96"><div class="ttname"><a href="io_8c.html#a3fcae786daf54e7706101dd9b955ed96">WriteVTSXMLFooter</a></div><div class="ttdeci">static PetscInt WriteVTSXMLFooter(FILE *fp)</div><div class="ttdoc">Finalizes the .vts file by closing the appended data section and the VTKFile XML tag.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01733">io.c:1733</a></div></div>
<div class="ttc" id="avariables_8h_html_a5eedf611da6dd4f59cc65753b777b957"><div class="ttname"><a href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">SimCtx::np</a></div><div class="ttdeci">PetscInt np</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00546">variables.h:546</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d">BC_FACE_NEG_Z</a></div><div class="ttdeci">@ BC_FACE_NEG_Z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00203">variables.h:203</a></div></div>
<div class="ttc" id="aio_8c_html_a225e0a333b858e580840be12c245ab10"><div class="ttname"><a href="io_8c.html#a225e0a333b858e580840be12c245ab10">WriteVTKFileFooter</a></div><div class="ttdeci">static PetscInt WriteVTKFileFooter(FILE *fp, const VTKMetaData *meta)</div><div class="ttdoc">Writes the XML footer for a VTK file based on the provided metadata.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l02037">io.c:2037</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ac3ea6849d6d1556f240ace7a6d9a3347"><div class="ttname"><a href="variables__old_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">UserCtx::Max_X</a></div><div class="ttdeci">PetscReal Max_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables_8h_html_a633005da0b9b59c4c0a6475d2562558a"><div class="ttname"><a href="variables_8h.html#a633005da0b9b59c4c0a6475d2562558a">VTKMetaData::scalarField</a></div><div class="ttdeci">PetscScalar * scalarField</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00452">variables.h:452</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a27bce072860da2f1a8a54d94b2b9497f"><div class="ttname"><a href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">UserCtx::identifiedInletBCFace</a></div><div class="ttdeci">BCFace identifiedInletBCFace</div><div class="ttdoc">Legacy field for particle system compatibility.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00602">variables.h:602</a></div></div>
<div class="ttc" id="aio_8c_html_abeb59f67fa68fabd9854709774dee119"><div class="ttname"><a href="io_8c.html#abeb59f67fa68fabd9854709774dee119">WriteVTKFileHeader</a></div><div class="ttdeci">static PetscInt WriteVTKFileHeader(FILE *fp, const VTKMetaData *meta, PetscInt boffset, PetscInt *boffsetOut)</div><div class="ttdoc">Writes the initial XML header for a VTK file based on the provided metadata.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01927">io.c:1927</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a></div><div class="ttdeci">@ BC_FACE_POS_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00201">variables.h:201</a></div></div>
<div class="ttc" id="avariables_8h_html_ad09da84b8a2e17ea5eae96dcb66c38aa"><div class="ttname"><a href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">SimCtx::size</a></div><div class="ttdeci">PetscMPIInt size</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00478">variables.h:478</a></div></div>
<div class="ttc" id="avariables_8h_html_a3ff353812541b8ebba309e8d3ba6674b"><div class="ttname"><a href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">SimCtx::st</a></div><div class="ttdeci">PetscReal st</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00510">variables.h:510</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9cdfbedb7b32291fa3d60cc698f07c1c"><div class="ttname"><a href="variables__old_8h.html#a9cdfbedb7b32291fa3d60cc698f07c1c">UserCtx::fda2</a></div><div class="ttdeci">DM fda2</div><div class="ttdoc">DMDA for 2-component vector fields (e.g., k-omega).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="aio_8c_html_a84fff45b8cbd148ed2429ba8fe12428f"><div class="ttname"><a href="io_8c.html#a84fff45b8cbd148ed2429ba8fe12428f">ReadSwarmField</a></div><div class="ttdeci">PetscErrorCode ReadSwarmField(UserCtx *user, const char *field_name, PetscInt ti, const char *ext)</div><div class="ttdoc">Reads data from a file into a specified field of a PETSc DMSwarm.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l02268">io.c:2268</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00207">logging.h:207</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a3c5226c112cabe2fc24230877bf7cc3c"><div class="ttname"><a href="variables__old_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">UserCtx::Min_X</a></div><div class="ttdeci">PetscReal Min_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables_8h_html_a7f393eb4fff178f989abb357f98b35a8"><div class="ttname"><a href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">VTKMetaData::fileType</a></div><div class="ttdeci">VTKFileType fileType</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00450">variables.h:450</a></div></div>
<div class="ttc" id="aio_8c_html_a03f5b76975eea55434d764a23fd42623"><div class="ttname"><a href="io_8c.html#a03f5b76975eea55434d764a23fd42623">ReadStatisticalFields</a></div><div class="ttdeci">PetscErrorCode ReadStatisticalFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads statistical fields for averaging purposes.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00822">io.c:822</a></div></div>
<div class="ttc" id="avariables_8h_html_a9a3319252101456c548a87c13881a795"><div class="ttname"><a href="variables_8h.html#a9a3319252101456c548a87c13881a795">BoundaryFaceConfig::params</a></div><div class="ttdeci">BC_Param * params</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00267">variables.h:267</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a></div><div class="ttdeci">@ WALL</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00210">variables.h:210</a></div></div>
<div class="ttc" id="avariables_8h_html_a5517bbdee115f97374036e9d29b3b648"><div class="ttname"><a href="variables_8h.html#a5517bbdee115f97374036e9d29b3b648">VTKMetaData::connectivity</a></div><div class="ttdeci">PetscInt * connectivity</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00458">variables.h:458</a></div></div>
<div class="ttc" id="aio_8c_html_ab1e9e2bb2f9a982f1f13f41d7fc0ad7b"><div class="ttname"><a href="io_8c.html#ab1e9e2bb2f9a982f1f13f41d7fc0ad7b">g_JMs_from_file</a></div><div class="ttdeci">static PetscInt * g_JMs_from_file</div><div class="ttdoc">Caches the JM dimensions for all blocks read from the grid file.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00021">io.c:21</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a94c6d4cf5f0820de35ff6ee1909fd0d6"><div class="ttname"><a href="variables__old_8h.html#a94c6d4cf5f0820de35ff6ee1909fd0d6">UserCtx::rz</a></div><div class="ttdeci">PetscReal rz</div><div class="ttdoc">Grid stretching ratios.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00596">variables.h:596</a></div></div>
<div class="ttc" id="avariables_8h_html_ae3ce8967b15c2e6be9e829b745da4090"><div class="ttname"><a href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">SimCtx::ParticleInitialization</a></div><div class="ttdeci">PetscInt ParticleInitialization</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00550">variables.h:550</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a1675749ea3b2429f00405a1ee3203d18"><div class="ttname"><a href="variables__old_8h.html#a1675749ea3b2429f00405a1ee3203d18">UserCtx::swarm</a></div><div class="ttdeci">DM swarm</div><div class="ttdoc">DMSwarm object for particle data.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00647">variables.h:647</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4d66dc20efb64cf45770997139fae524"><div class="ttname"><a href="variables__old_8h.html#a4d66dc20efb64cf45770997139fae524">BoundingBox::max_coords</a></div><div class="ttdeci">Cmpnts max_coords</div><div class="ttdoc">Maximum x, y, z coordinates of the bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00156">variables.h:156</a></div></div>
<div class="ttc" id="avariables_8h_html_a4897d17394963da4ac73b9856fac48c5"><div class="ttname"><a href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">SimCtx::ren</a></div><div class="ttdeci">PetscReal ren</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00510">variables.h:510</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ab7d6dffd5a35c03211c65aca209c909e"><div class="ttname"><a href="variables__old_8h.html#ab7d6dffd5a35c03211c65aca209c909e">UserCtx::Nvert_o</a></div><div class="ttdeci">Vec Nvert_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00612">variables.h:612</a></div></div>
<div class="ttc" id="avariables_8h_html_a55ce12cdec83e590169b333b5dc84009"><div class="ttname"><a href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">SimCtx::StepsToRun</a></div><div class="ttdeci">PetscInt StepsToRun</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00485">variables.h:485</a></div></div>
<div class="ttc" id="avariables_8h_html_a53b044b8b0e4a4dc8c8fa05387af564c"><div class="ttname"><a href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">SimCtx::dt</a></div><div class="ttdeci">PetscReal dt</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00488">variables.h:488</a></div></div>
<div class="ttc" id="aio_8c_html_a570806d7e0694b5d996e0c6018b48908"><div class="ttname"><a href="io_8c.html#a570806d7e0694b5d996e0c6018b48908">ReadFieldData</a></div><div class="ttdeci">PetscErrorCode ReadFieldData(UserCtx *user, const char *field_name, Vec field_vec, PetscInt ti, const char *ext)</div><div class="ttdoc">Reads data for a specific field from a file into the provided vector.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00584">io.c:584</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a75b5725be5540b27c16fb4672da3b352"><div class="ttname"><a href="variables__old_8h.html#a75b5725be5540b27c16fb4672da3b352">UserCtx::Ucat_square_sum</a></div><div class="ttdeci">Vec Ucat_square_sum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9f0c002a2c7cde3b6ac843ab9185f4d4"><div class="ttname"><a href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">Cmpnts::z</a></div><div class="ttdeci">PetscScalar z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a10f4f7dc00a854759067cf96ab66485a"><div class="ttname"><a href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">UserMG::mgctx</a></div><div class="ttdeci">MGCtx * mgctx</div><div class="ttdoc">Array of multigrid contexts, one for each level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00429">variables.h:429</a></div></div>
<div class="ttc" id="avariables__old_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdoc">DMDA for scalar fields (e.g., Pressure, Nvert).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="avariables_8h_html_ae8abc82ec45317291825e3ffeeba80ac"><div class="ttname"><a href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">VTKMetaData::my</a></div><div class="ttdeci">PetscInt my</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00451">variables.h:451</a></div></div>
<div class="ttc" id="avariables_8h_html_acd88a3cbaf780ca17e0f8da6ef455f4f"><div class="ttname"><a href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">VTKMetaData::mz</a></div><div class="ttdeci">PetscInt mz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00451">variables.h:451</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a3697ef486c46316e97aa05a22aeaa92f"><div class="ttname"><a href="variables__old_8h.html#a3697ef486c46316e97aa05a22aeaa92f">UserCtx::K_Omega_o</a></div><div class="ttdeci">Vec K_Omega_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00632">variables.h:632</a></div></div>
<div class="ttc" id="aio_8c_html_a5fe767286174b757deb2d404f2b4843f"><div class="ttname"><a href="io_8c.html#a5fe767286174b757deb2d404f2b4843f">ValidateBCHandlerForBCType</a></div><div class="ttdeci">PetscErrorCode ValidateBCHandlerForBCType(BCType type, BCHandlerType handler)</div><div class="ttdoc">Validates that a specific handler is compatible with a general BC type.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00297">io.c:297</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a></div><div class="ttdeci">BCHandlerType</div><div class="ttdoc">Defines the specific computational &quot;strategy&quot; for a boundary handler.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00221">variables.h:221</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad032e456f7f4b32b9ac0d94be05de204"><div class="ttname"><a href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">Cmpnts::y</a></div><div class="ttdeci">PetscScalar y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a69c3a361d1aac3bdc14f971bda57e032"><div class="ttname"><a href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">UserCtx::Ucont</a></div><div class="ttdeci">Vec Ucont</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4bfb8b974034685bf15ce4bd848d72bd"><div class="ttname"><a href="variables__old_8h.html#a4bfb8b974034685bf15ce4bd848d72bd">BC_Param_s::key</a></div><div class="ttdeci">char * key</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00238">variables.h:238</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa0dc186d7733ea4041c5c3cac181b9ce"><div class="ttname"><a href="variables__old_8h.html#aa0dc186d7733ea4041c5c3cac181b9ce">UserCtx::lK_Omega_o</a></div><div class="ttdeci">Vec lK_Omega_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00632">variables.h:632</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e">BC_FACE_POS_Z</a></div><div class="ttdeci">@ BC_FACE_POS_Z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00203">variables.h:203</a></div></div>
<div class="ttc" id="avariables_8h_html_a337c3a9a9bf061e10d71ba990aa6ed29"><div class="ttname"><a href="variables_8h.html#a337c3a9a9bf061e10d71ba990aa6ed29">SimCtx::StartTime</a></div><div class="ttdeci">PetscReal StartTime</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00487">variables.h:487</a></div></div>
<div class="ttc" id="aio_8c_html_a15bdb2122be30f52df280e1d7204f578"><div class="ttname"><a href="io_8c.html#a15bdb2122be30f52df280e1d7204f578">StringToBCHandlerType</a></div><div class="ttdeci">PetscErrorCode StringToBCHandlerType(const char *str, BCHandlerType *handler_out)</div><div class="ttdoc">Converts a string representation of a handler to a BCHandlerType enum.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00280">io.c:280</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbaf"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a></div><div class="ttdeci">BCFace</div><div class="ttdoc">Identifies the six logical faces of a structured computational block.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00200">variables.h:200</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a3f5ec0e4536c9ccaa3d663f14d47f904"><div class="ttname"><a href="variables__old_8h.html#a3f5ec0e4536c9ccaa3d663f14d47f904">UserCtx::KM</a></div><div class="ttdeci">PetscInt KM</div><div class="ttdoc">Global grid dimensions (number of cells in i,j,k).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00591">variables.h:591</a></div></div>
<div class="ttc" id="aio_8c_html_a19e2e0b57afae458bae068610141c031"><div class="ttname"><a href="io_8c.html#a19e2e0b57afae458bae068610141c031">ReadRANSFields</a></div><div class="ttdeci">PetscErrorCode ReadRANSFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads RANS-related fields.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00878">io.c:878</a></div></div>
<div class="ttc" id="avariables_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d"><div class="ttname"><a href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a></div><div class="ttdeci">@ BC_HANDLER_INLET_CONSTANT_VELOCITY</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00225">variables.h:225</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad78de239c377f8290aa9a5979006d50f"><div class="ttname"><a href="variables__old_8h.html#ad78de239c377f8290aa9a5979006d50f">UserCtx::Ucat_cross_sum</a></div><div class="ttdeci">Vec Ucat_cross_sum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="avariables_8h_html_a63a15e7ba17f59ff0fb668fd880f128a"><div class="ttname"><a href="variables_8h.html#a63a15e7ba17f59ff0fb668fd880f128a">VTKMetaData::vectorFieldName</a></div><div class="ttdeci">const char * vectorFieldName</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00456">variables.h:456</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a8a071b3601cf05db4562a8989ef7e22f"><div class="ttname"><a href="variables__old_8h.html#a8a071b3601cf05db4562a8989ef7e22f">BC_Param_s::value</a></div><div class="ttdeci">char * value</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00239">variables.h:239</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a60bfc6b6d761a90da39b0f053bebcb31"><div class="ttname"><a href="variables__old_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">UserCtx::Max_Y</a></div><div class="ttdeci">PetscReal Max_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables_8h_html_ac503944447b87fc650e0ffa74a780b36"><div class="ttname"><a href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">SimCtx::InitialConstantContra</a></div><div class="ttdeci">Cmpnts InitialConstantContra</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00512">variables.h:512</a></div></div>
<div class="ttc" id="avariables_8h_html_a483945572b5ab1461a864ee1e3eb1d37"><div class="ttname"><a href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">SimCtx::FieldInitialization</a></div><div class="ttdeci">PetscInt FieldInitialization</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00511">variables.h:511</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="io_8c.html">io.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
