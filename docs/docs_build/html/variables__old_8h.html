<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pic_dev: variables_old.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">pic_dev
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">Particle-in-Cell / CFD development codebase</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('variables__old_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">variables_old.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;petscvec.h&quot;</code><br />
<code>#include &quot;petscdmda.h&quot;</code><br />
<code>#include &quot;petscksp.h&quot;</code><br />
<code>#include &quot;petscsnes.h&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for variables_old.h:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="variables__old_8h__incl.svg" width="100%" height="384"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="variables__old_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structCmpnts"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td></tr>
<tr class="memdesc:structCmpnts"><td class="mdescLeft">&#160;</td><td class="mdescRight">A 3D point or vector with PetscScalar components.  <a href="variables__old_8h.html#structCmpnts">More...</a><br /></td></tr>
<tr class="separator:structCmpnts"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structCmpnts2"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structCmpnts2">Cmpnts2</a></td></tr>
<tr class="memdesc:structCmpnts2"><td class="mdescLeft">&#160;</td><td class="mdescRight">A 2D point or vector with PetscScalar components.  <a href="variables__old_8h.html#structCmpnts2">More...</a><br /></td></tr>
<tr class="separator:structCmpnts2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structCpt2D"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structCpt2D">Cpt2D</a></td></tr>
<tr class="memdesc:structCpt2D"><td class="mdescLeft">&#160;</td><td class="mdescRight">A 2D vector of PETSc real numbers (for geometry/coordinates).  <a href="variables__old_8h.html#structCpt2D">More...</a><br /></td></tr>
<tr class="separator:structCpt2D"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structFlowWave"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structFlowWave">FlowWave</a></td></tr>
<tr class="memdesc:structFlowWave"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a single point in a time-varying flow waveform.  <a href="variables__old_8h.html#structFlowWave">More...</a><br /></td></tr>
<tr class="separator:structFlowWave"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structBCS"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structBCS">BCS</a></td></tr>
<tr class="memdesc:structBCS"><td class="mdescLeft">&#160;</td><td class="mdescRight">Legacy boundary condition data.  <a href="variables__old_8h.html#structBCS">More...</a><br /></td></tr>
<tr class="separator:structBCS"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structBoundingBox"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a></td></tr>
<tr class="memdesc:structBoundingBox"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a 3D axis-aligned bounding box.  <a href="variables__old_8h.html#structBoundingBox">More...</a><br /></td></tr>
<tr class="separator:structBoundingBox"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structCell"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structCell">Cell</a></td></tr>
<tr class="memdesc:structCell"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the vertices of a single hexahedral grid cell.  <a href="variables__old_8h.html#structCell">More...</a><br /></td></tr>
<tr class="separator:structCell"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structParticle"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structParticle">Particle</a></td></tr>
<tr class="memdesc:structParticle"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a particle's core properties for Lagrangian tracking.  <a href="variables__old_8h.html#structParticle">More...</a><br /></td></tr>
<tr class="separator:structParticle"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structRankNeighbors"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structRankNeighbors">RankNeighbors</a></td></tr>
<tr class="memdesc:structRankNeighbors"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores the MPI ranks of neighboring subdomains.  <a href="variables__old_8h.html#structRankNeighbors">More...</a><br /></td></tr>
<tr class="separator:structRankNeighbors"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structRankCellInfo"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structRankCellInfo">RankCellInfo</a></td></tr>
<tr class="memdesc:structRankCellInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">A lean struct to hold the global cell ownership range for a single MPI rank.  <a href="variables__old_8h.html#structRankCellInfo">More...</a><br /></td></tr>
<tr class="separator:structRankCellInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structMigrationInfo"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structMigrationInfo">MigrationInfo</a></td></tr>
<tr class="memdesc:structMigrationInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information needed to migrate a single particle between MPI ranks.  <a href="variables__old_8h.html#structMigrationInfo">More...</a><br /></td></tr>
<tr class="separator:structMigrationInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structBC__Param__s"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structBC__Param__s">BC_Param_s</a></td></tr>
<tr class="memdesc:structBC__Param__s"><td class="mdescLeft">&#160;</td><td class="mdescRight">A node in a linked list for storing key-value parameters from the bcs.dat file.  <a href="variables__old_8h.html#structBC__Param__s">More...</a><br /></td></tr>
<tr class="separator:structBC__Param__s"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structBCContext"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structBCContext">BCContext</a></td></tr>
<tr class="memdesc:structBCContext"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides execution context for a boundary condition handler.  <a href="variables__old_8h.html#structBCContext">More...</a><br /></td></tr>
<tr class="separator:structBCContext"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBoundaryCondition__s.html">BoundaryCondition_s</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The "virtual table" struct for a boundary condition handler object.  <a href="structBoundaryCondition__s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structBoundaryFaceConfig__s"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structBoundaryFaceConfig__s">BoundaryFaceConfig_s</a></td></tr>
<tr class="memdesc:structBoundaryFaceConfig__s"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the complete configuration for one of the six boundary faces.  <a href="variables__old_8h.html#structBoundaryFaceConfig__s">More...</a><br /></td></tr>
<tr class="separator:structBoundaryFaceConfig__s"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structIBMInfo"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a></td></tr>
<tr class="memdesc:structIBMInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds interpolation and distance information for a single IBM point.  <a href="variables__old_8h.html#structIBMInfo">More...</a><br /></td></tr>
<tr class="separator:structIBMInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structIBMNodes"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a></td></tr>
<tr class="memdesc:structIBMNodes"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a collection of nodes forming a surface for the IBM.  <a href="variables__old_8h.html#structIBMNodes">More...</a><br /></td></tr>
<tr class="separator:structIBMNodes"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structIBMVNodes"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structIBMVNodes">IBMVNodes</a></td></tr>
<tr class="memdesc:structIBMVNodes"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a collection of nodes forming a volume for the IBM.  <a href="variables__old_8h.html#structIBMVNodes">More...</a><br /></td></tr>
<tr class="separator:structIBMVNodes"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structnode"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structnode">node</a></td></tr>
<tr class="memdesc:structnode"><td class="mdescLeft">&#160;</td><td class="mdescRight">A generic C-style linked list node for integers.  <a href="variables__old_8h.html#structnode">More...</a><br /></td></tr>
<tr class="separator:structnode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structlist"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structlist">list</a></td></tr>
<tr class="memdesc:structlist"><td class="mdescLeft">&#160;</td><td class="mdescRight">Head of a generic C-style linked list.  <a href="variables__old_8h.html#structlist">More...</a><br /></td></tr>
<tr class="separator:structlist"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structlist__node"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structlist__node">list_node</a></td></tr>
<tr class="memdesc:structlist__node"><td class="mdescLeft">&#160;</td><td class="mdescRight">A generic C-style linked list node for indices.  <a href="variables__old_8h.html#structlist__node">More...</a><br /></td></tr>
<tr class="separator:structlist__node"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structIBMListNode"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structIBMListNode">IBMListNode</a></td></tr>
<tr class="memdesc:structIBMListNode"><td class="mdescLeft">&#160;</td><td class="mdescRight">A linked list node containing IBM interpolation info.  <a href="variables__old_8h.html#structIBMListNode">More...</a><br /></td></tr>
<tr class="separator:structIBMListNode"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structIBMList"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structIBMList">IBMList</a></td></tr>
<tr class="memdesc:structIBMList"><td class="mdescLeft">&#160;</td><td class="mdescRight">Head of a linked list for IBM data.  <a href="variables__old_8h.html#structIBMList">More...</a><br /></td></tr>
<tr class="separator:structIBMList"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSurfElmtInfo"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structSurfElmtInfo">SurfElmtInfo</a></td></tr>
<tr class="memdesc:structSurfElmtInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">Information about a surface element for FSI calculations.  <a href="variables__old_8h.html#structSurfElmtInfo">More...</a><br /></td></tr>
<tr class="separator:structSurfElmtInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structFSInfo"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a></td></tr>
<tr class="memdesc:structFSInfo"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds all data related to the state and motion of a body in FSI.  <a href="variables__old_8h.html#structFSInfo">More...</a><br /></td></tr>
<tr class="separator:structFSInfo"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structCstart"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structCstart">Cstart</a></td></tr>
<tr class="memdesc:structCstart"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines prescribed body motion using splines.  <a href="variables__old_8h.html#structCstart">More...</a><br /></td></tr>
<tr class="separator:structCstart"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structMGCtx"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structMGCtx">MGCtx</a></td></tr>
<tr class="memdesc:structMGCtx"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context for Multigrid operations.  <a href="variables__old_8h.html#structMGCtx">More...</a><br /></td></tr>
<tr class="separator:structMGCtx"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structUserMG"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a></td></tr>
<tr class="memdesc:structUserMG"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-level context for managing the entire multigrid hierarchy.  <a href="variables__old_8h.html#structUserMG">More...</a><br /></td></tr>
<tr class="separator:structUserMG"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structPostProcessParams"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structPostProcessParams">PostProcessParams</a></td></tr>
<tr class="memdesc:structPostProcessParams"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parameters controlling post-processing output actions.  <a href="variables__old_8h.html#structPostProcessParams">More...</a><br /></td></tr>
<tr class="separator:structPostProcessParams"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:struct__n__VTKMetaData"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#struct__n__VTKMetaData">_n_VTKMetaData</a></td></tr>
<tr class="memdesc:struct__n__VTKMetaData"><td class="mdescLeft">&#160;</td><td class="mdescRight">Metadata structure for VTK output (.vts or .vtp files).  <a href="variables__old_8h.html#struct__n__VTKMetaData">More...</a><br /></td></tr>
<tr class="separator:struct__n__VTKMetaData"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structUserCtx"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a></td></tr>
<tr class="memdesc:structUserCtx"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined context containing data specific to a single computational grid level.  <a href="variables__old_8h.html#structUserCtx">More...</a><br /></td></tr>
<tr class="separator:structUserCtx"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af0af02fbd08daea87f3523a3754981f0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#af0af02fbd08daea87f3523a3754981f0">COEF_TIME_ACCURACY</a>&#160;&#160;&#160;1.5</td></tr>
<tr class="memdesc:af0af02fbd08daea87f3523a3754981f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Coefficient controlling the temporal accuracy scheme (e.g., 1.5 for BDF2).  <a href="variables__old_8h.html#af0af02fbd08daea87f3523a3754981f0">More...</a><br /></td></tr>
<tr class="separator:af0af02fbd08daea87f3523a3754981f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10a62bce766452804bad64d119e127f7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a10a62bce766452804bad64d119e127f7">MAX_POINT_DATA_FIELDS</a>&#160;&#160;&#160;10</td></tr>
<tr class="memdesc:a10a62bce766452804bad64d119e127f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the maximum number of data fields for VTK point data.  <a href="variables__old_8h.html#a10a62bce766452804bad64d119e127f7">More...</a><br /></td></tr>
<tr class="separator:a10a62bce766452804bad64d119e127f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a22a9148c380850b8568b82d154446340"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structBC__Param__s">BC_Param_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a22a9148c380850b8568b82d154446340">BC_Param</a></td></tr>
<tr class="separator:a22a9148c380850b8568b82d154446340"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2af32ff12b47d8e9e02b3adca2c262"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structBoundaryCondition__s.html">BoundaryCondition_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#afc2af32ff12b47d8e9e02b3adca2c262">BoundaryCondition</a></td></tr>
<tr class="separator:afc2af32ff12b47d8e9e02b3adca2c262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf3537b955823a1cc6f6028d6747053d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structBoundaryFaceConfig__s">BoundaryFaceConfig_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#adf3537b955823a1cc6f6028d6747053d">BoundaryFaceConfig</a></td></tr>
<tr class="separator:adf3537b955823a1cc6f6028d6747053d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af80dea40db36357149fbf3f19bdb1e"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a8af80dea40db36357149fbf3f19bdb1e">UserCtx</a></td></tr>
<tr class="memdesc:a8af80dea40db36357149fbf3f19bdb1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined context containing all simulation data, parameters, and configurations.  <a href="variables__old_8h.html#a8af80dea40db36357149fbf3f19bdb1e">More...</a><br /></td></tr>
<tr class="separator:a8af80dea40db36357149fbf3f19bdb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4aeda155dbe167f1c1cf38cb65bf324"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structnode">node</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#af4aeda155dbe167f1c1cf38cb65bf324">node</a></td></tr>
<tr class="memdesc:af4aeda155dbe167f1c1cf38cb65bf324"><td class="mdescLeft">&#160;</td><td class="mdescRight">A generic C-style linked list node for integers.  <a href="variables__old_8h.html#af4aeda155dbe167f1c1cf38cb65bf324">More...</a><br /></td></tr>
<tr class="separator:af4aeda155dbe167f1c1cf38cb65bf324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa89b8bc105d9a09d4e7c06e8b34078a7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structlist">list</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a></td></tr>
<tr class="memdesc:aa89b8bc105d9a09d4e7c06e8b34078a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Head of a generic C-style linked list.  <a href="variables__old_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">More...</a><br /></td></tr>
<tr class="separator:aa89b8bc105d9a09d4e7c06e8b34078a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaaacd4affdea8751e35bff19e7e5191"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structlist__node">list_node</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#adaaacd4affdea8751e35bff19e7e5191">Node_List</a></td></tr>
<tr class="memdesc:adaaacd4affdea8751e35bff19e7e5191"><td class="mdescLeft">&#160;</td><td class="mdescRight">A generic C-style linked list node for indices.  <a href="variables__old_8h.html#adaaacd4affdea8751e35bff19e7e5191">More...</a><br /></td></tr>
<tr class="separator:adaaacd4affdea8751e35bff19e7e5191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4222faf080077cd7e5703d7bd83cf992"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structIBMListNode">IBMListNode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a4222faf080077cd7e5703d7bd83cf992">IBMListNode</a></td></tr>
<tr class="memdesc:a4222faf080077cd7e5703d7bd83cf992"><td class="mdescLeft">&#160;</td><td class="mdescRight">A linked list node containing IBM interpolation info.  <a href="variables__old_8h.html#a4222faf080077cd7e5703d7bd83cf992">More...</a><br /></td></tr>
<tr class="separator:a4222faf080077cd7e5703d7bd83cf992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48835bb3e95726270d15ae238f08a699"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#structIBMList">IBMList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a48835bb3e95726270d15ae238f08a699">IBMList</a></td></tr>
<tr class="memdesc:a48835bb3e95726270d15ae238f08a699"><td class="mdescLeft">&#160;</td><td class="mdescRight">Head of a linked list for IBM data.  <a href="variables__old_8h.html#a48835bb3e95726270d15ae238f08a699">More...</a><br /></td></tr>
<tr class="separator:a48835bb3e95726270d15ae238f08a699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7273b619c47098a1c963da9d6fd54d7"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="variables__old_8h.html#struct__n__VTKMetaData">_n_VTKMetaData</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ac7273b619c47098a1c963da9d6fd54d7">VTKMetaData</a></td></tr>
<tr class="memdesc:ac7273b619c47098a1c963da9d6fd54d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Metadata structure for VTK output (.vts or .vtp files).  <a href="variables__old_8h.html#ac7273b619c47098a1c963da9d6fd54d7">More...</a><br /></td></tr>
<tr class="separator:ac7273b619c47098a1c963da9d6fd54d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a347829443e8a679209e21f7f04f51581"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a> { <br />
&#160;&#160;<a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a">NEEDS_LOCATION</a>, 
<a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253">ACTIVE_AND_LOCATED</a>, 
<a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329">MIGRATING_OUT</a>, 
<a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317">LOST</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a>, 
<a class="el" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a">NEEDS_LOCATION</a>, 
<a class="el" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253">ACTIVE_AND_LOCATED</a>, 
<a class="el" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329">MIGRATING_OUT</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317">LOST</a>, 
<a class="el" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a>
<br />
 }</td></tr>
<tr class="separator:a347829443e8a679209e21f7f04f51581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3fc1d97a3c41ea9d58d0ab14f75294f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294f">Face</a> { <br />
&#160;&#160;<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a> = 0, 
<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>, 
<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>, 
<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>, 
<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>, 
<a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a>, 
<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a> = 0, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>, 
<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>, 
<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>, 
<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>, 
<a class="el" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a>
<br />
 }</td></tr>
<tr class="memdesc:ad3fc1d97a3c41ea9d58d0ab14f75294f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerates the six faces of a cubic cell for distance calculations.  <a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294f">More...</a><br /></td></tr>
<tr class="separator:ad3fc1d97a3c41ea9d58d0ab14f75294f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4c17936462d8236c21005c4cf6bbaf"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a> { <br />
&#160;&#160;<a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a> = 0, 
<a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a> = 1, 
<a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a> = 2, 
<a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a> = 3, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d">BC_FACE_NEG_Z</a> = 4, 
<a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e">BC_FACE_POS_Z</a> = 5, 
<a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a> = 0, 
<a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a> = 1, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a> = 2, 
<a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a> = 3, 
<a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d">BC_FACE_NEG_Z</a> = 4, 
<a class="el" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e">BC_FACE_POS_Z</a> = 5
<br />
 }</td></tr>
<tr class="memdesc:afc4c17936462d8236c21005c4cf6bbaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies the six logical faces of a structured computational block.  <a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbaf">More...</a><br /></td></tr>
<tr class="separator:afc4c17936462d8236c21005c4cf6bbaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a00003814ee8095a2c39d1d5cba08fa"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a> { <br />
&#160;&#160;<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faac4f816c9f2b363c7e2c959807809bd94">WALLFUNCTION</a> = -1, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544">INTERFACE</a> = 0, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a> = 1, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa21ba3bc4a36398f4c11fba2c3db9e877">MOVING_WALL</a> = 2, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e">SYMMETRY</a> = 3, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a> = 4, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757">FARFIELD</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58">PERIODIC</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa9ee1404b18b6acf6db149de82f6d677d">CHARACTERISTIC_BC</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa847f2dd2cd88b336cf5a621f8393fcba">ANALYTICAL_VORTEX</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faaf450e16147ffcf97341b35890aa4056c">JUNCTION</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa7ea5c9eb9cab9f86765ccf12e2bd0413">ANNULUS</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faadd03a62c8db17bc188262f525a1f4871">OGRID</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa9331c56dedc775b064f31ce6981f56c1">RHEOLOGY</a>, 
<a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa605159e8a4c32319fd69b5d151369d93">UNDEFINED</a> = 0, 
<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a>, 
<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a>, 
<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e">SYMMETRY</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a>, 
<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a>, 
<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757">FARFIELD</a>, 
<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58">PERIODIC</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544">INTERFACE</a>
<br />
 }</td></tr>
<tr class="memdesc:a0a00003814ee8095a2c39d1d5cba08fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the general mathematical/physical category of a boundary.  <a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">More...</a><br /></td></tr>
<tr class="separator:a0a00003814ee8095a2c39d1d5cba08fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a466f572ad4e3d8b6f5eb03bceaad2ca1"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a> { <br />
&#160;&#160;<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453">BC_HANDLER_UNDEFINED</a> = 0, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462">BC_HANDLER_WALL_MOVING</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b">BC_HANDLER_SYMMETRY_PLANE</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576">BC_HANDLER_INLET_PULSANTILE_FLUX</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079">BC_HANDLER_INLET_DEVELOPED_PROFILE</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32">BC_HANDLER_OUTLET_CONSERVATION</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077">BC_HANDLER_OUTLET_PRESSURE</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f">BC_HANDLER_FARFIELD_NONREFLECTING</a>, 
<br />
&#160;&#160;<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d">BC_HANDLER_PERIODIC</a>, 
<a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7">BC_HANDLER_INTERFACE_OVERSET</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453">BC_HANDLER_UNDEFINED</a> = 0, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462">BC_HANDLER_WALL_MOVING</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b">BC_HANDLER_SYMMETRY_PLANE</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576">BC_HANDLER_INLET_PULSANTILE_FLUX</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079">BC_HANDLER_INLET_DEVELOPED_PROFILE</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32">BC_HANDLER_OUTLET_CONSERVATION</a>, 
<br />
&#160;&#160;<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077">BC_HANDLER_OUTLET_PRESSURE</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f">BC_HANDLER_FARFIELD_NONREFLECTING</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d">BC_HANDLER_PERIODIC</a>, 
<a class="el" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7">BC_HANDLER_INTERFACE_OVERSET</a>
<br />
 }</td></tr>
<tr class="memdesc:a466f572ad4e3d8b6f5eb03bceaad2ca1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the specific computational "strategy" for a boundary handler.  <a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">More...</a><br /></td></tr>
<tr class="separator:a466f572ad4e3d8b6f5eb03bceaad2ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afef259795cd298f0d543f574536e4dd7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7">VTKFileType</a> { <a class="el" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a>, 
<a class="el" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a>, 
<a class="el" href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a>, 
<a class="el" href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a>
 }</td></tr>
<tr class="memdesc:afef259795cd298f0d543f574536e4dd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enumerates the type of VTK file to be written.  <a href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7">More...</a><br /></td></tr>
<tr class="separator:afef259795cd298f0d543f574536e4dd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aecc25fa839846bfc3dfd097458c0d495"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#aecc25fa839846bfc3dfd097458c0d495">initlist</a> (<a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a> *ilist)</td></tr>
<tr class="separator:aecc25fa839846bfc3dfd097458c0d495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af045b58df4ca4babe828ab4d56b7fec1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#af045b58df4ca4babe828ab4d56b7fec1">insertnode</a> (<a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a> *ilist, PetscInt Node)</td></tr>
<tr class="separator:af045b58df4ca4babe828ab4d56b7fec1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaf7eb2d12267231f3cf08c3c24de666"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#acaf7eb2d12267231f3cf08c3c24de666">destroy</a> (<a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a> *ilist)</td></tr>
<tr class="separator:acaf7eb2d12267231f3cf08c3c24de666"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897af499c583fc011aecd975a78f0d6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a897af499c583fc011aecd975a78f0d6c">InitIBMList</a> (<a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *ilist)</td></tr>
<tr class="separator:a897af499c583fc011aecd975a78f0d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9191fb960803f52c32b3a01d054fdf4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a9191fb960803f52c32b3a01d054fdf4a">AddIBMNode</a> (<a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *ilist, <a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a> ibm_intp)</td></tr>
<tr class="separator:a9191fb960803f52c32b3a01d054fdf4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48f2874f8a3f8b460966ec88db35bfd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a48f2874f8a3f8b460966ec88db35bfd3">DestroyIBMList</a> (<a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *ilist)</td></tr>
<tr class="separator:a48f2874f8a3f8b460966ec88db35bfd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b8a7e554df144af1f673ac19aefda6"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a29b8a7e554df144af1f673ac19aefda6">ibm_read_tecplot</a> (<a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, PetscInt nt, PetscBool flg)</td></tr>
<tr class="separator:a29b8a7e554df144af1f673ac19aefda6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e47a27559b32ae8f448e053ca300fe"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a52e47a27559b32ae8f448e053ca300fe">ibm_read_ucd</a> (<a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, PetscInt ibi)</td></tr>
<tr class="separator:a52e47a27559b32ae8f448e053ca300fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae47c3bf1d511544e5b1515fedf6d19ae"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ae47c3bf1d511544e5b1515fedf6d19ae">ibm_search_advanced</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, PetscInt ibi)</td></tr>
<tr class="separator:ae47c3bf1d511544e5b1515fedf6d19ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7960ddea53706ec458c3894653fa30a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ae7960ddea53706ec458c3894653fa30a">ibm_interpolation_advanced</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, PetscInt ibi, PetscInt Add_dUndt)</td></tr>
<tr class="separator:ae7960ddea53706ec458c3894653fa30a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29920cd4a8d12fbb64fd79845120d7de"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a29920cd4a8d12fbb64fd79845120d7de">FsiInitialize</a> (PetscInt n_elmt, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi, PetscInt ibi)</td></tr>
<tr class="separator:a29920cd4a8d12fbb64fd79845120d7de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c40d1283bc7686edd12fb2eb651e51e"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a0c40d1283bc7686edd12fb2eb651e51e">Struc_Solver</a> (<a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *usermg, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi, <a class="el" href="variables__old_8h.html#structCstart">Cstart</a> *cstart, PetscInt itr_sc, PetscInt tistart, PetscBool *DoSCLoop)</td></tr>
<tr class="separator:a0c40d1283bc7686edd12fb2eb651e51e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1450af65e49d15d25e9ad8c0e2f5d16a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a1450af65e49d15d25e9ad8c0e2f5d16a">Calc_forces_SI</a> (<a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *FSinfo, <a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, PetscInt ti, PetscInt ibi, PetscInt bi)</td></tr>
<tr class="separator:a1450af65e49d15d25e9ad8c0e2f5d16a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fcb995c42e7146b27f5f1882ac920c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a26fcb995c42e7146b27f5f1882ac920c">CollisionDetectionOfParticles</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi)</td></tr>
<tr class="separator:a26fcb995c42e7146b27f5f1882ac920c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a606c9c7fe576cda6af28d2b458e6acdd"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a606c9c7fe576cda6af28d2b458e6acdd">Flow_Solver</a> (<a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *usermg, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi)</td></tr>
<tr class="separator:a606c9c7fe576cda6af28d2b458e6acdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acabfa3f2386d9f9ff2a32591ab17c9ef"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#acabfa3f2386d9f9ff2a32591ab17c9ef">ImplicitMomentumSolver</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi)</td></tr>
<tr class="separator:acabfa3f2386d9f9ff2a32591ab17c9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89ae58d48076ba82dc70438b5e389bf5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a89ae58d48076ba82dc70438b5e389bf5">RungeKutta</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi)</td></tr>
<tr class="memdesc:a89ae58d48076ba82dc70438b5e389bf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advances the momentum equations for ALL blocks by one time step using an explicit 4-stage, 4th-order Runge-Kutta scheme.  <a href="variables__old_8h.html#a89ae58d48076ba82dc70438b5e389bf5">More...</a><br /></td></tr>
<tr class="separator:a89ae58d48076ba82dc70438b5e389bf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c89e1512c34f710f01f417760194b7f"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a8c89e1512c34f710f01f417760194b7f">Implicit_SNES</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *fsi)</td></tr>
<tr class="separator:a8c89e1512c34f710f01f417760194b7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a113dcc9ca606d914c3d021a4d85fc"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a34a113dcc9ca606d914c3d021a4d85fc">Projection</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a34a113dcc9ca606d914c3d021a4d85fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the projection step to enforce an incompressible velocity field.  <a href="variables__old_8h.html#a34a113dcc9ca606d914c3d021a4d85fc">More...</a><br /></td></tr>
<tr class="separator:a34a113dcc9ca606d914c3d021a4d85fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef563a812c1c384e6c3cadff3b6449a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a2ef563a812c1c384e6c3cadff3b6449a">PoissonSolver_Hypre</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, <a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a> *ibminfo)</td></tr>
<tr class="separator:a2ef563a812c1c384e6c3cadff3b6449a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfdf6d56006b1b5f68d400deb6cf0959"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#acfdf6d56006b1b5f68d400deb6cf0959">PoissonSolver_MG</a> (<a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *usermg)</td></tr>
<tr class="memdesc:acfdf6d56006b1b5f68d400deb6cf0959"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solves the pressure-Poisson equation using a geometric multigrid method.  <a href="variables__old_8h.html#acfdf6d56006b1b5f68d400deb6cf0959">More...</a><br /></td></tr>
<tr class="separator:acfdf6d56006b1b5f68d400deb6cf0959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa156b8badceb595be2544f8d7885626b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#aa156b8badceb595be2544f8d7885626b">K_Omega_IC</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:aa156b8badceb595be2544f8d7885626b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7099f2ad08892d7a4327e6a4e442c4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ae7099f2ad08892d7a4327e6a4e442c4f">Solve_K_Omega</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:ae7099f2ad08892d7a4327e6a4e442c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab37f8a0517cf55932174fa327e7ab072"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ab37f8a0517cf55932174fa327e7ab072">Compute_Smagorinsky_Constant_1</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, Vec Ucont, Vec Ucat)</td></tr>
<tr class="separator:ab37f8a0517cf55932174fa327e7ab072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74ed1b371c557b826d503a1627351eec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a74ed1b371c557b826d503a1627351eec">wall_function</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, double sc, double sb, <a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> Ua, <a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> Uc, <a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *Ub, PetscReal *ustar, double nx, double ny, double nz)</td></tr>
<tr class="separator:a74ed1b371c557b826d503a1627351eec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a444d8f7af8f98024e8079aed3e9448e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a444d8f7af8f98024e8079aed3e9448e3">Compute_du_dxyz</a> (double csi0, double csi1, double csi2, double eta0, double eta1, double eta2, double zet0, double zet1, double zet2, double ajc, double dudc, double dvdc, double dwdc, double dude, double dvde, double dwde, double dudz, double dvdz, double dwdz, double *du_dx, double *dv_dx, double *dw_dx, double *du_dy, double *dv_dy, double *dw_dy, double *du_dz, double *dv_dz, double *dw_dz)</td></tr>
<tr class="separator:a444d8f7af8f98024e8079aed3e9448e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a0a7cb4587034d295f6c7f23d70465"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ae8a0a7cb4587034d295f6c7f23d70465">FormFunction1</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, Vec Rhs)</td></tr>
<tr class="memdesc:ae8a0a7cb4587034d295f6c7f23d70465"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the Right-Hand-Side (RHS) of the momentum equations.  <a href="variables__old_8h.html#ae8a0a7cb4587034d295f6c7f23d70465">More...</a><br /></td></tr>
<tr class="separator:ae8a0a7cb4587034d295f6c7f23d70465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accdc3f1a3e5c7e95c6bdde11cde3b236"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#accdc3f1a3e5c7e95c6bdde11cde3b236">Divergence</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:accdc3f1a3e5c7e95c6bdde11cde3b236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd96cff4b9e15e03cdff9f5ea695dec"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#adcd96cff4b9e15e03cdff9f5ea695dec">FormBCS</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:adcd96cff4b9e15e03cdff9f5ea695dec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a865d8d58260f9c51a44a9e18d0d5663b"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a865d8d58260f9c51a44a9e18d0d5663b">Block_Interface_U</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:a865d8d58260f9c51a44a9e18d0d5663b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0509f331636f9e16ad145ca2e36f98"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a2f0509f331636f9e16ad145ca2e36f98">InletRead</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:a2f0509f331636f9e16ad145ca2e36f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4358d23da72e420bdd351a340b1d51d2"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a4358d23da72e420bdd351a340b1d51d2">MG_Initial</a> (<a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *usermg, <a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm)</td></tr>
<tr class="separator:a4358d23da72e420bdd351a340b1d51d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a520f896b0af92aa116cbdab4ea8af8e5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a520f896b0af92aa116cbdab4ea8af8e5">MG_Finalize</a> (<a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *usermg)</td></tr>
<tr class="separator:a520f896b0af92aa116cbdab4ea8af8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf6d598a9ff81ff311063c0297bf2ea0"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#abf6d598a9ff81ff311063c0297bf2ea0">Implicit_DMMG</a> (<a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *usermg)</td></tr>
<tr class="separator:abf6d598a9ff81ff311063c0297bf2ea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0e61d0e37192570f9ce90ac19220f8"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a8d0e61d0e37192570f9ce90ac19220f8">ibm_surface_VTKOut</a> (<a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *ibm, PetscInt ibi, PetscInt ti)</td></tr>
<tr class="separator:a8d0e61d0e37192570f9ce90ac19220f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace787c32c54dcbb56d4dad5a885c0936"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#ace787c32c54dcbb56d4dad5a885c0936">Ucont_P_Binary_Output</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:ace787c32c54dcbb56d4dad5a885c0936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec5d71bbdc8575c50a4c970b6541566"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a4ec5d71bbdc8575c50a4c970b6541566">KE_Output</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:a4ec5d71bbdc8575c50a4c970b6541566"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a16a7f73a80ca8b7474d0e13fec876c9f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a16a7f73a80ca8b7474d0e13fec876c9f">i_periodic</a></td></tr>
<tr class="separator:a16a7f73a80ca8b7474d0e13fec876c9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ebc4b2aa9f7a85a08bee74e63413ff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a73ebc4b2aa9f7a85a08bee74e63413ff">j_periodic</a></td></tr>
<tr class="separator:a73ebc4b2aa9f7a85a08bee74e63413ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbfa4d897c8528d0949dd1dd77be163f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#abbfa4d897c8528d0949dd1dd77be163f">k_periodic</a></td></tr>
<tr class="memdesc:abbfa4d897c8528d0949dd1dd77be163f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Periodicity flags for the main grid.  <a href="variables__old_8h.html#abbfa4d897c8528d0949dd1dd77be163f">More...</a><br /></td></tr>
<tr class="separator:abbfa4d897c8528d0949dd1dd77be163f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af184533da5928ad08e8f3e2aaa97df89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#af184533da5928ad08e8f3e2aaa97df89">ii_periodic</a></td></tr>
<tr class="separator:af184533da5928ad08e8f3e2aaa97df89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86dd9a8db04235acbf59b7e45df616a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a86dd9a8db04235acbf59b7e45df616a7">jj_periodic</a></td></tr>
<tr class="separator:a86dd9a8db04235acbf59b7e45df616a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb2967be157af973bf692f2b5c62e65d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#acb2967be157af973bf692f2b5c62e65d">kk_periodic</a></td></tr>
<tr class="memdesc:acb2967be157af973bf692f2b5c62e65d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Periodicity flags for a secondary grid/context.  <a href="variables__old_8h.html#acb2967be157af973bf692f2b5c62e65d">More...</a><br /></td></tr>
<tr class="separator:acb2967be157af973bf692f2b5c62e65d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6646696f78da622f98f412c48ffecff9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a6646696f78da622f98f412c48ffecff9">les</a></td></tr>
<tr class="memdesc:a6646696f78da622f98f412c48ffecff9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to enable Large Eddy Simulation.  <a href="variables__old_8h.html#a6646696f78da622f98f412c48ffecff9">More...</a><br /></td></tr>
<tr class="separator:a6646696f78da622f98f412c48ffecff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45aaac6d22d918755aa24acf785b1241"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a45aaac6d22d918755aa24acf785b1241">wallfunction</a></td></tr>
<tr class="memdesc:a45aaac6d22d918755aa24acf785b1241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to enable wall function models.  <a href="variables__old_8h.html#a45aaac6d22d918755aa24acf785b1241">More...</a><br /></td></tr>
<tr class="separator:a45aaac6d22d918755aa24acf785b1241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab0b5c9c94575762f583129a64d1adc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a8ab0b5c9c94575762f583129a64d1adc">rans</a></td></tr>
<tr class="memdesc:a8ab0b5c9c94575762f583129a64d1adc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to enable Reynolds-Averaged Navier-Stokes models.  <a href="variables__old_8h.html#a8ab0b5c9c94575762f583129a64d1adc">More...</a><br /></td></tr>
<tr class="separator:a8ab0b5c9c94575762f583129a64d1adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0869ece14dd9e44bafd4e7714d5be952"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a0869ece14dd9e44bafd4e7714d5be952">i_homo_filter</a></td></tr>
<tr class="separator:a0869ece14dd9e44bafd4e7714d5be952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10349ff47cf37e14fe5b8e592cff37cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a10349ff47cf37e14fe5b8e592cff37cc">j_homo_filter</a></td></tr>
<tr class="separator:a10349ff47cf37e14fe5b8e592cff37cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3694edd9b37a04a5f0918e7db6e48ad7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a3694edd9b37a04a5f0918e7db6e48ad7">k_homo_filter</a></td></tr>
<tr class="memdesc:a3694edd9b37a04a5f0918e7db6e48ad7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for applying a homogeneous filter in each direction.  <a href="variables__old_8h.html#a3694edd9b37a04a5f0918e7db6e48ad7">More...</a><br /></td></tr>
<tr class="separator:a3694edd9b37a04a5f0918e7db6e48ad7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92ac2d2ceed26829501edf7e35fa4c86"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a92ac2d2ceed26829501edf7e35fa4c86">testfilter_ik</a></td></tr>
<tr class="separator:a92ac2d2ceed26829501edf7e35fa4c86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281cbf74d081b7a33f1d6ff7bf936e0d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a281cbf74d081b7a33f1d6ff7bf936e0d">testfilter_1d</a></td></tr>
<tr class="memdesc:a281cbf74d081b7a33f1d6ff7bf936e0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flags for specific test filters.  <a href="variables__old_8h.html#a281cbf74d081b7a33f1d6ff7bf936e0d">More...</a><br /></td></tr>
<tr class="separator:a281cbf74d081b7a33f1d6ff7bf936e0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f57403f8650934f8b2bc977a7728a93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="variables__old_8h.html#a1f57403f8650934f8b2bc977a7728a93">clark</a></td></tr>
<tr class="memdesc:a1f57403f8650934f8b2bc977a7728a93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag for Clark model formulation.  <a href="variables__old_8h.html#a1f57403f8650934f8b2bc977a7728a93">More...</a><br /></td></tr>
<tr class="separator:a1f57403f8650934f8b2bc977a7728a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structCmpnts" id="structCmpnts"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structCmpnts">&#9670;&nbsp;</a></span>Cmpnts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Cmpnts</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A 3D point or vector with PetscScalar components. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00100">100</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a718a09fbedf450248eaf7019a980e139"></a>PetscScalar</td>
<td class="fieldname">
x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad032e456f7f4b32b9ac0d94be05de204"></a>PetscScalar</td>
<td class="fieldname">
y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9f0c002a2c7cde3b6ac843ab9185f4d4"></a>PetscScalar</td>
<td class="fieldname">
z</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structCmpnts2" id="structCmpnts2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structCmpnts2">&#9670;&nbsp;</a></span>Cmpnts2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Cmpnts2</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A 2D point or vector with PetscScalar components. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00105">105</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ad0e3d11b96bb6cbf3035c45023ceb317"></a>PetscScalar</td>
<td class="fieldname">
x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abfdfa452fab8c46819cf94fd12013eee"></a>PetscScalar</td>
<td class="fieldname">
y</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structCpt2D" id="structCpt2D"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structCpt2D">&#9670;&nbsp;</a></span>Cpt2D</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Cpt2D</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A 2D vector of PETSc real numbers (for geometry/coordinates). </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00110">110</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a781a42e0d33e5b145d05b47f01730bda"></a>PetscReal</td>
<td class="fieldname">
x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a567a983d2643dd40d933b55858374faa"></a>PetscReal</td>
<td class="fieldname">
y</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structFlowWave" id="structFlowWave"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structFlowWave">&#9670;&nbsp;</a></span>FlowWave</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct FlowWave</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Represents a single point in a time-varying flow waveform. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00115">115</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a1e86b1d217c1a2f5c34a9e41fff86a0d"></a>PetscReal</td>
<td class="fieldname">
f</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a850ba8e785192ccf52d4230fc81a223a"></a>PetscReal</td>
<td class="fieldname">
t</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structBCS" id="structBCS"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structBCS">&#9670;&nbsp;</a></span>BCS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct BCS</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Legacy boundary condition data. </p>
<p>Likely superseded by the newer BC system. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00120">120</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a6ef13ed6ab8f82c44bd8a81739ff90e2"></a>Vec</td>
<td class="fieldname">
Ubcs</td>
<td class="fielddoc">
Boundary condition velocity values. (Comment: "An ugly hack, waste of memory") </td></tr>
<tr><td class="fieldtype">
<a id="afbf649648426b009265d74fade4665ca"></a>Vec</td>
<td class="fieldname">
Uch</td>
<td class="fielddoc">
Characteristic velocity for boundary conditions. </td></tr>
</table>

</div>
</div>
<a name="structBoundingBox" id="structBoundingBox"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structBoundingBox">&#9670;&nbsp;</a></span>BoundingBox</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct BoundingBox</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Defines a 3D axis-aligned bounding box. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00154">154</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for BoundingBox:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structBoundingBox__coll__graph.svg" width="150" height="142"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a4d66dc20efb64cf45770997139fae524"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
max_coords</td>
<td class="fielddoc">
Maximum x, y, z coordinates of the bounding box. </td></tr>
<tr><td class="fieldtype">
<a id="a6b5da58d79c9c0ed6e9368c9677d5260"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
min_coords</td>
<td class="fielddoc">
Minimum x, y, z coordinates of the bounding box. </td></tr>
</table>

</div>
</div>
<a name="structCell" id="structCell"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structCell">&#9670;&nbsp;</a></span>Cell</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Cell</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Defines the vertices of a single hexahedral grid cell. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00160">160</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for Cell:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structCell__coll__graph.svg" width="104" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a994289a1b1801d93075b37b69c129e82"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
vertices[8]</td>
<td class="fielddoc">
Coordinates of the eight vertices of the cell. </td></tr>
</table>

</div>
</div>
<a name="structParticle" id="structParticle"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structParticle">&#9670;&nbsp;</a></span>Particle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Particle</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Defines a particle's core properties for Lagrangian tracking. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00165">165</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for Particle:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structParticle__coll__graph.svg" width="99" height="156"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a90250e79337972756b8ce1daae2321f9"></a>PetscInt</td>
<td class="fieldname">
cell[3]</td>
<td class="fielddoc">
Computational indices (i, j, k) of the cell containing the particle. </td></tr>
<tr><td class="fieldtype">
<a id="a76cdf3edbcd6aa56f5a2ba8645e999ea"></a>PetscMPIInt</td>
<td class="fieldname">
destination_rank</td>
<td class="fielddoc">
Target rank for migration (only valid if status MIGRATING_OUT) </td></tr>
<tr><td class="fieldtype">
<a id="a71cca12cd9fb0796634a7076eeb9b50b"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
loc</td>
<td class="fielddoc">
Physical location (x,y,z) of the particle. </td></tr>
<tr><td class="fieldtype">
<a id="a88a45e3c57c861d03160f28aaa786414"></a><a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a></td>
<td class="fieldname">
location_status</td>
<td class="fielddoc">
Current state in the location/migration process. </td></tr>
<tr><td class="fieldtype">
<a id="aecd4cd7f1da07e3f3d6e1fb6cf71a44b"></a>PetscInt64</td>
<td class="fieldname">
PID</td>
<td class="fielddoc">
Unique <a class="el" href="variables__old_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> ID. </td></tr>
<tr><td class="fieldtype">
<a id="a0dedc7a71f2bf127463d9bfd4ed41103"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
vel</td>
<td class="fielddoc">
Physical velocity (vx,vy,vz) of the particle. </td></tr>
<tr><td class="fieldtype">
<a id="ad3cf9af789ad3875d496c48112ade0ec"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
weights</td>
<td class="fielddoc">
Interpolation weights within its host cell. </td></tr>
</table>

</div>
</div>
<a name="structRankNeighbors" id="structRankNeighbors"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structRankNeighbors">&#9670;&nbsp;</a></span>RankNeighbors</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct RankNeighbors</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Stores the MPI ranks of neighboring subdomains. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00176">176</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a9419886ec15f30fb98c71804d563796c"></a>PetscMPIInt</td>
<td class="fieldname">
rank_xm</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a37acd97196e51bd7e58e2d2fafc3344a"></a>PetscMPIInt</td>
<td class="fieldname">
rank_xp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a358dc1518de03e8f825de1397787f513"></a>PetscMPIInt</td>
<td class="fieldname">
rank_ym</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1efe628456af87df55800c7ffce30a24"></a>PetscMPIInt</td>
<td class="fieldname">
rank_yp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a02bb9f73a617ff6f0e5d21da2bd045c6"></a>PetscMPIInt</td>
<td class="fieldname">
rank_zm</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac5abbee1a0f657e18deac2dbaef2ad74"></a>PetscMPIInt</td>
<td class="fieldname">
rank_zp</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structRankCellInfo" id="structRankCellInfo"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structRankCellInfo">&#9670;&nbsp;</a></span>RankCellInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct RankCellInfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A lean struct to hold the global cell ownership range for a single MPI rank. </p>
<p>A lean struct to hold the global cell ownership range for a single MPI rank. This is used to build a map of the entire domain's decomposition, allowing any rank to quickly look up which rank owns a specific global cell index. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00183">183</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7b338865846c21925fbb6b968cdf385f"></a>PetscInt</td>
<td class="fieldname">
xm_cell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a19272b97c7c160d257dbe0fc8da2f2d8"></a>PetscInt</td>
<td class="fieldname">
xs_cell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a823852c48e9bdaa32c354ae7b41f29d7"></a>PetscInt</td>
<td class="fieldname">
ym_cell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a118b3648071bd642f8d066878ba920a7"></a>PetscInt</td>
<td class="fieldname">
ys_cell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4b91bc588672c42d8917bf335d1a754e"></a>PetscInt</td>
<td class="fieldname">
zm_cell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4d6a4d14075dd0718f49111d91c61e1d"></a>PetscInt</td>
<td class="fieldname">
zs_cell</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structMigrationInfo" id="structMigrationInfo"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structMigrationInfo">&#9670;&nbsp;</a></span>MigrationInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct MigrationInfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Information needed to migrate a single particle between MPI ranks. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00189">189</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a4381464fc6d367c0619eea12d6c28dfe"></a>PetscInt</td>
<td class="fieldname">
local_index</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1cdcc47d6f4f2e4a3a7da51ee1be2e80"></a>PetscInt</td>
<td class="fieldname">
target_rank</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structBC__Param__s" id="structBC__Param__s"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structBC__Param__s">&#9670;&nbsp;</a></span>BC_Param_s</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct BC_Param_s</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A node in a linked list for storing key-value parameters from the bcs.dat file. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00237">237</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for BC_Param_s:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structBC__Param__s__coll__graph.svg" width="171" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a4bfb8b974034685bf15ce4bd848d72bd"></a>char *</td>
<td class="fieldname">
key</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1f49c003091a0c03ca2ca9ee905ccf98"></a>struct <a class="el" href="variables__old_8h.html#structBC__Param__s">BC_Param_s</a> *</td>
<td class="fieldname">
next</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8a071b3601cf05db4562a8989ef7e22f"></a>char *</td>
<td class="fieldname">
value</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structBCContext" id="structBCContext"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structBCContext">&#9670;&nbsp;</a></span>BCContext</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct BCContext</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Provides execution context for a boundary condition handler. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00244">244</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for BCContext:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structBCContext__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a663e18542c597f233fc52cd8160d1941"></a><a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a></td>
<td class="fieldname">
face_id</td>
<td class="fielddoc">
The geometric face (0-5) being processed. </td></tr>
<tr><td class="fieldtype">
<a id="a67073836fe3437c15b804e6ea630653f"></a>const PetscReal *</td>
<td class="fieldname">
global_inflow_sum</td>
<td class="fielddoc">
Pointer to total domain inflow for the current step. </td></tr>
<tr><td class="fieldtype">
<a id="abf77fc1392b5bd173bab4413c0361587"></a>const PetscReal *</td>
<td class="fieldname">
global_outflow_sum</td>
<td class="fielddoc">
Pointer to total measured domain outflow for the current step. </td></tr>
<tr><td class="fieldtype">
<a id="a538d58a50bae41e392b09c36aae0cce8"></a><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *</td>
<td class="fieldname">
user</td>
<td class="fielddoc">
Access to all global simulation data. </td></tr>
</table>

</div>
</div>
<a name="structBoundaryFaceConfig__s" id="structBoundaryFaceConfig__s"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structBoundaryFaceConfig__s">&#9670;&nbsp;</a></span>BoundaryFaceConfig_s</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct BoundaryFaceConfig_s</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Holds the complete configuration for one of the six boundary faces. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00290">290</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for BoundaryFaceConfig_s:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structBoundaryFaceConfig__s__coll__graph.svg" width="343" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7ff34fac84452aef5e784978275be644"></a><a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a></td>
<td class="fieldname">
face_id</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a138be633993eda056c765a3ec15b45aa"></a><a class="el" href="structBoundaryCondition.html">BoundaryCondition</a> *</td>
<td class="fieldname">
handler</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af36c376704a9ed57b35a55cd54ab0dfc"></a><a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a></td>
<td class="fieldname">
handler_type</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa75154a6c025d4a4f287f1427a682829"></a><a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a></td>
<td class="fieldname">
mathematical_type</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab1992b5fec005bf2a4c5259cdb68a5ad"></a><a class="el" href="variables_8h.html#a22a9148c380850b8568b82d154446340">BC_Param</a> *</td>
<td class="fieldname">
params</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structIBMInfo" id="structIBMInfo"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structIBMInfo">&#9670;&nbsp;</a></span>IBMInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct IBMInfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Holds interpolation and distance information for a single IBM point. </p>
<p>Holds interpolation and distance information for a single point in the Immersed Boundary Method (IBM). </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00276">276</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for IBMInfo:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structIBMInfo__coll__graph.svg" width="84" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a6d4491402016b06d429f96689e263204"></a>PetscInt</td>
<td class="fieldname">
cell</td>
<td class="fielddoc">
Index of the cell containing the closest point. </td></tr>
<tr><td class="fieldtype">
<a id="a3c1b7ac3d2b3d08224e6e95576f95991"></a>PetscReal</td>
<td class="fieldname">
cr1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5b7d6d6b9628d5aa57238698477d86cc"></a>PetscReal</td>
<td class="fieldname">
cr11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9d0dd0e12a61189dc943cb9430488846"></a>PetscReal</td>
<td class="fieldname">
cr2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a377119b64862dfe3ec0ac531064d51e2"></a>PetscReal</td>
<td class="fieldname">
cr22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aebe08cc075e1d1ffa673f6c51341ea20"></a>PetscReal</td>
<td class="fieldname">
cr3</td>
<td class="fielddoc">
Interpolation coefficients for the stencil points. </td></tr>
<tr><td class="fieldtype">
<a id="a1cc6a21720f7785284d098913b45fcfd"></a>PetscReal</td>
<td class="fieldname">
cr33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4530b5fc69b23c7f7c142029b022e338"></a>PetscReal</td>
<td class="fieldname">
cs1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af481f382403e30810b231a27d3ef6170"></a>PetscReal</td>
<td class="fieldname">
cs11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a36b990cd4495ece021ee4f224b1745d5"></a>PetscReal</td>
<td class="fieldname">
cs2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5f194810b4c6737911d4216bc51a6fdc"></a>PetscReal</td>
<td class="fieldname">
cs22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad9adfd1fb377835ce8c1edde8a7f00c7"></a>PetscReal</td>
<td class="fieldname">
cs3</td>
<td class="fielddoc">
Coefficients related to the closest surface point. </td></tr>
<tr><td class="fieldtype">
<a id="abfaf220ddcdd02329fe69a6941f5451c"></a>PetscReal</td>
<td class="fieldname">
cs33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab792c7aca97cad542d840baedbdda721"></a>PetscReal</td>
<td class="fieldname">
ct1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a732780026644b7058b7027d80adc224b"></a>PetscReal</td>
<td class="fieldname">
ct11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa556d1dda225f888ea2b3f72b140a31c"></a>PetscReal</td>
<td class="fieldname">
ct2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae3a4e02e02e09e2f54e5afb8c3e652a0"></a>PetscReal</td>
<td class="fieldname">
ct22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa18634f591acfd68242f522ea62ee46a"></a>PetscReal</td>
<td class="fieldname">
ct3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4dbf08510cb5935676d9192f38424cec"></a>PetscReal</td>
<td class="fieldname">
ct33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4423313e4a1b9839d05f35db523b0ff2"></a>PetscReal</td>
<td class="fieldname">
d_i</td>
<td class="fielddoc">
Distance to the interception point on grid cells. </td></tr>
<tr><td class="fieldtype">
<a id="a959aee3b023e1d274fb29fffb50b611d"></a>PetscReal</td>
<td class="fieldname">
d_ii</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0f29852410b26ff88af42ff0f7e537ba"></a>PetscReal</td>
<td class="fieldname">
d_s</td>
<td class="fielddoc">
Shortest distance to a solid surface. </td></tr>
<tr><td class="fieldtype">
<a id="a684d9086b162387634a0a87b681f40eb"></a>PetscReal</td>
<td class="fieldname">
d_ss</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a144452238410e7e6ebd65ed09af08a76"></a>PetscInt</td>
<td class="fieldname">
i1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afcc0a57611796906677e5d3b60bd3d8b"></a>PetscInt</td>
<td class="fieldname">
i11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af9fcd46831de17b988c18507b754b25f"></a>PetscInt</td>
<td class="fieldname">
i2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a12f019efb6847d8d767ab857f4bacaa3"></a>PetscInt</td>
<td class="fieldname">
i22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a15304e5887c1560946e07cdd28cf9508"></a>PetscInt</td>
<td class="fieldname">
i3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abb2c018d27e86a45cca91a99ab1335d5"></a>PetscInt</td>
<td class="fieldname">
i33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2700ecd9a5bde842b04997d72b8669ca"></a>PetscInt</td>
<td class="fieldname">
ii1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa765fd97d972e2b147a97607461f427d"></a>PetscInt</td>
<td class="fieldname">
ii11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad072ad20881f5c1762daf18415c459e2"></a>PetscInt</td>
<td class="fieldname">
ii2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0566223b8d7f9eea351f4a4d1a815a9e"></a>PetscInt</td>
<td class="fieldname">
ii22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="acf701512b9b3512b57ef00b1b5857a5d"></a>PetscInt</td>
<td class="fieldname">
ii3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af660fc861bf5e47a9d048495c4f7ab65"></a>PetscInt</td>
<td class="fieldname">
ii33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a87eb36c461ab6c92dbc508f0fc24e0b7"></a>PetscInt</td>
<td class="fieldname">
iimode</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a19d328a61e38b2fa31fc4b9b0ec43a17"></a>PetscInt</td>
<td class="fieldname">
imode</td>
<td class="fielddoc">
Interception mode/scheme identifier. </td></tr>
<tr><td class="fieldtype">
<a id="a96b196e35f88ec27e59dcba134e08936"></a>PetscInt</td>
<td class="fieldname">
j1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a14c33e7c31379bc7d5e88860ad56b8ad"></a>PetscInt</td>
<td class="fieldname">
j11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0aab84937c9a4303e99a8dff54f84a35"></a>PetscInt</td>
<td class="fieldname">
j2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad23ced398209a0a896b685cc1b94600a"></a>PetscInt</td>
<td class="fieldname">
j22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a16e4cc744c1a98bbb56d85fa713e7d48"></a>PetscInt</td>
<td class="fieldname">
j3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a844439dc97e57608c01371a0418e57a2"></a>PetscInt</td>
<td class="fieldname">
j33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a36c97c156e0787e99101a35850b49996"></a>PetscInt</td>
<td class="fieldname">
jj1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0be7db48fae92982e2efa0d4393e1a48"></a>PetscInt</td>
<td class="fieldname">
jj11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2c14a0feb76f4435a0f674b8d44a05b5"></a>PetscInt</td>
<td class="fieldname">
jj2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5ca17961be19c92a1e7769615ec4b757"></a>PetscInt</td>
<td class="fieldname">
jj22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a51b7c19d61de5f2e9b6fb010c86dcf4d"></a>PetscInt</td>
<td class="fieldname">
jj3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a84903c7d9799343a079d67eb947d8857"></a>PetscInt</td>
<td class="fieldname">
jj33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a51a0319819f280cc36c44d1b7f0792e4"></a>PetscInt</td>
<td class="fieldname">
k1</td>
<td class="fielddoc">
Grid indices of the 1st interpolation stencil point. </td></tr>
<tr><td class="fieldtype">
<a id="aede9da04a26441a1e2e7dc3b675da566"></a>PetscInt</td>
<td class="fieldname">
k11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aaa7f4a94b784bd0510400a6a27d05b5b"></a>PetscInt</td>
<td class="fieldname">
k2</td>
<td class="fielddoc">
Grid indices of the 2nd interpolation stencil point. </td></tr>
<tr><td class="fieldtype">
<a id="a1162728d02b81602acb21d3e77011cc3"></a>PetscInt</td>
<td class="fieldname">
k22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5a94240e2099180e6efaf05b28470913"></a>PetscInt</td>
<td class="fieldname">
k3</td>
<td class="fielddoc">
Grid indices of the 3rd interpolation stencil point. </td></tr>
<tr><td class="fieldtype">
<a id="a581f30235ca7690c77a106c473b0b45e"></a>PetscInt</td>
<td class="fieldname">
k33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa79837cc1b7f5a58a7313b99c780d816"></a>PetscInt</td>
<td class="fieldname">
kk1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad8478f80c28f661dadf938f6f3558ac1"></a>PetscInt</td>
<td class="fieldname">
kk11</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a68790c5303b8382a4407461a5a397e5e"></a>PetscInt</td>
<td class="fieldname">
kk2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1a4fedb395bb0aa06b18249287cfb289"></a>PetscInt</td>
<td class="fieldname">
kk22</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad0b918df35726143ee09371e5346b048"></a>PetscInt</td>
<td class="fieldname">
kk3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad60bebfd1b92202cb065487e3ba11fc7"></a>PetscInt</td>
<td class="fieldname">
kk33</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="acdb1a448331de8dc922c08a9653b2488"></a>PetscInt</td>
<td class="fieldname">
ni</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae46fec194df4075a1deea495407a8b00"></a>PetscInt</td>
<td class="fieldname">
nj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a828d54731bd2f0f127137de1a3667cf3"></a>PetscInt</td>
<td class="fieldname">
nk</td>
<td class="fielddoc">
Grid indices of the closest point on the solid surface. </td></tr>
<tr><td class="fieldtype">
<a id="a30e64eb05a9f354b44e85859f2648e4b"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
pmin</td>
<td class="fielddoc">
Coordinates of the closest point. </td></tr>
<tr><td class="fieldtype">
<a id="a60779054120e65c1c050f97f8f59691f"></a>PetscInt</td>
<td class="fieldname">
smode</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1028f6ccb6a46dc2bae2def199996ade"></a>PetscInt</td>
<td class="fieldname">
ssmode</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structIBMNodes" id="structIBMNodes"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structIBMNodes">&#9670;&nbsp;</a></span>IBMNodes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct IBMNodes</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Represents a collection of nodes forming a surface for the IBM. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00301">301</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for IBMNodes:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structIBMNodes__coll__graph.svg" width="99" height="171"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ac9b6c27c030c67d3e48c217b3176f64f"></a>PetscReal *</td>
<td class="fieldname">
Bvel_u</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a253e535c1ae16fb8fb70e93ef374dc51"></a>PetscReal *</td>
<td class="fieldname">
Bvel_v</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae1905f667c0938afad233db51f283bf7"></a>PetscReal *</td>
<td class="fieldname">
Bvel_w</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a653906698a03394cf66070a82a13b0a5"></a>PetscReal *</td>
<td class="fieldname">
CCp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa5a24e2c8937e4836753555fafd02418"></a>PetscReal *</td>
<td class="fieldname">
cent_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0e136f27f1e8cabd1b59ac378b80e342"></a>PetscReal *</td>
<td class="fieldname">
cent_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a595de4a482235c9b7fba38592754982f"></a>PetscReal *</td>
<td class="fieldname">
cent_z</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a75f215324f7272515ef9fee1f2e1a5e0"></a>PetscReal *</td>
<td class="fieldname">
cf</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8f9af06d10a302eec610c55b64ba1068"></a>PetscReal *</td>
<td class="fieldname">
cfsum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a952a9e0e2a5352bd50dcad8a60304bb1"></a>PetscReal *</td>
<td class="fieldname">
dA</td>
<td class="fielddoc">
Area of an element. </td></tr>
<tr><td class="fieldtype">
<a id="a9129f89c6f806be61916a939853f333d"></a>PetscInt</td>
<td class="fieldname">
n_elmt</td>
<td class="fielddoc">
Number of elements (triangles) in the surface mesh. </td></tr>
<tr><td class="fieldtype">
<a id="afe83433d7e6734e63f739cbd0304988f"></a>PetscInt</td>
<td class="fieldname">
n_v</td>
<td class="fielddoc">
Number of vertices in the surface mesh. </td></tr>
<tr><td class="fieldtype">
<a id="aff26156e55bd47794818d4951c106d88"></a>PetscInt</td>
<td class="fieldname">
nbnumber</td>
<td class="fielddoc">
Body number identifier. </td></tr>
<tr><td class="fieldtype">
<a id="a064b9093871501787bf412a5cab018ba"></a>PetscReal *</td>
<td class="fieldname">
nf_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8528c1dc1d92fae68e90d355eab9ae78"></a>PetscReal *</td>
<td class="fieldname">
nf_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9ae22aa9dbda22c34f18afd5d06f7d3f"></a>PetscReal *</td>
<td class="fieldname">
nf_z</td>
<td class="fielddoc">
Normal vector for each element. </td></tr>
<tr><td class="fieldtype">
<a id="a96617b9963af54eff8582ab79321a151"></a>PetscReal *</td>
<td class="fieldname">
ns_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4818627f2e956b54b6d5e7c41f734385"></a>PetscReal *</td>
<td class="fieldname">
ns_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7fd88b4b75b114bd09c30f46839abe01"></a>PetscReal *</td>
<td class="fieldname">
ns_z</td>
<td class="fielddoc">
Azimuthal direction vector. </td></tr>
<tr><td class="fieldtype">
<a id="a713aad5023e709cc0100cbaff4a52c59"></a>PetscReal *</td>
<td class="fieldname">
nt_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7f526d93d4f27f1e474c65a9f33eec06"></a>PetscReal *</td>
<td class="fieldname">
nt_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af3896c0533f26f68e878788c5e9669d9"></a>PetscReal *</td>
<td class="fieldname">
nt_z</td>
<td class="fielddoc">
Tangent direction vector. </td></tr>
<tr><td class="fieldtype">
<a id="aee16ac93b11b43fbb710303e6fa3a6f1"></a>PetscInt *</td>
<td class="fieldname">
nv1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9a0a20f44e94151a7a5136712bbf52e1"></a>PetscInt *</td>
<td class="fieldname">
nv2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a51df9a3bbf97e05f9bfed0af1b05d837"></a>PetscInt *</td>
<td class="fieldname">
nv3</td>
<td class="fielddoc">
Node indices defining each triangle. </td></tr>
<tr><td class="fieldtype">
<a id="a951a7b307ca6f283098026ef73b65739"></a>PetscReal *</td>
<td class="fieldname">
pres</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5ff5a42371c73f38d5260e2ac21b7239"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
qvec</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac325a6d95a4d51700b3da2777ad53eed"></a>PetscReal *</td>
<td class="fieldname">
radvec</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a49ee2eb7ac1b3cd1a53aa7d92679666e"></a>PetscReal *</td>
<td class="fieldname">
tau0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afb3886d58c74ed6eb0e5ff208a6d8860"></a>PetscReal *</td>
<td class="fieldname">
tauN</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0b2d843e7833be26890ffa4de06c80d7"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
u</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a527e6b332c27519b8b8130092c2152b0"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
uold</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af9f4d9e8e8d826b857c4a29003dfb75e"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
urm1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac54a5efc28cf0f30fbbb1605833828e8"></a>PetscReal *</td>
<td class="fieldname">
x_bp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa6401400f22a49bd880fb7f6745ad49a"></a>PetscReal *</td>
<td class="fieldname">
x_bp0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa48837277ffb61a29ba1a9a686a83b67"></a>PetscReal</td>
<td class="fieldname">
x_bp_in[101][3270]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9907282cfa63172e506b7560c354d79a"></a>PetscReal *</td>
<td class="fieldname">
x_bp_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a73d51597c7f8f691d93d3cf23240a3a1"></a>PetscReal</td>
<td class="fieldname">
x_max</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa9168bfa15123891002ebb7fa222abb2"></a>PetscReal</td>
<td class="fieldname">
x_min</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad57f70fc0d23d6543fbd98ebe6d6f89a"></a>PetscReal *</td>
<td class="fieldname">
y_bp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a79c735475b93c39f175e9817a9dacf79"></a>PetscReal *</td>
<td class="fieldname">
y_bp0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af135ac4bcd339e85332712456986fc67"></a>PetscReal</td>
<td class="fieldname">
y_bp_in[101][3270]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af16b78cef0005281b274cc303a0278bd"></a>PetscReal *</td>
<td class="fieldname">
y_bp_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a720143f2539ae0ef7f6bb1488c17c210"></a>PetscReal</td>
<td class="fieldname">
y_max</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6268b577b839220f3817e3ee4b85ade4"></a>PetscReal</td>
<td class="fieldname">
y_min</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abdf92321f120b14430aa70aa2a3cc470"></a>PetscReal *</td>
<td class="fieldname">
z_bp</td>
<td class="fielddoc">
Current coordinates of surface nodes. </td></tr>
<tr><td class="fieldtype">
<a id="aa19e9c43d4a0fd0c94f2ff9195ff523e"></a>PetscReal *</td>
<td class="fieldname">
z_bp0</td>
<td class="fielddoc">
Initial coordinates of surface nodes. </td></tr>
<tr><td class="fieldtype">
<a id="a9c32246a8f293507fcc53185b57f3a3c"></a>PetscReal</td>
<td class="fieldname">
z_bp_in[101][3270]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="adf44355ff2cffe830cc062cf12e96e02"></a>PetscReal *</td>
<td class="fieldname">
z_bp_o</td>
<td class="fielddoc">
Old (previous step) coordinates. </td></tr>
<tr><td class="fieldtype">
<a id="a9dd176b13af511a881bef5a6a43e7bab"></a>PetscReal</td>
<td class="fieldname">
z_max</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af3288397d6e8bb845c98bec35ddf86ec"></a>PetscReal</td>
<td class="fieldname">
z_min</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structIBMVNodes" id="structIBMVNodes"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structIBMVNodes">&#9670;&nbsp;</a></span>IBMVNodes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct IBMVNodes</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Represents a collection of nodes forming a volume for the IBM. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00321">321</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for IBMVNodes:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structIBMVNodes__coll__graph.svg" width="108" height="156"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a8022ade03ed2a95b116a52f63182ddbf"></a>PetscReal *</td>
<td class="fieldname">
cent_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a23ada9b03c94aa508eacf2e6ce6d4717"></a>PetscReal *</td>
<td class="fieldname">
cent_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a57e90cd9e29a38fdb0816ce4042fa5fc"></a>PetscReal *</td>
<td class="fieldname">
cent_z</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae0a8ce18aa734ae9c741821c96f70409"></a>PetscReal *</td>
<td class="fieldname">
dV0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a82661dfcc8a0f5067751c8aaa671588a"></a>PetscReal</td>
<td class="fieldname">
I_inv[3][3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7d17170523cf307573c9257fe126cc62"></a>PetscReal</td>
<td class="fieldname">
J[3][3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a11f501721553b2dfb318e0350bbf3461"></a>PetscInt</td>
<td class="fieldname">
n_elmt</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad7104dcdbc189a60ba55f24729baff40"></a>PetscInt</td>
<td class="fieldname">
n_v</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a22d348bdf7bb570279d926019d255547"></a>PetscInt</td>
<td class="fieldname">
nbnumber</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a58447cc1b4990f3c31782df9c63c9aa8"></a>PetscInt *</td>
<td class="fieldname">
nv1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad207a8a40f1723caf3c919e89a8b6e7b"></a>PetscInt *</td>
<td class="fieldname">
nv2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7fe23c1f24c12c23bc6436d41204750b"></a>PetscInt *</td>
<td class="fieldname">
nv3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7be82e91a70fac22e4b964da7ffa0ad3"></a>PetscInt *</td>
<td class="fieldname">
nv4</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4002ca4941bc692fb54083aa325c417b"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
u</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad7014b3dc4fc7917a25981f1cb452908"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
uold</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a042de1127487e0957e2d1f3f7f4daf84"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *</td>
<td class="fieldname">
urm1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a542f2811dc7768841a815597efcbf530"></a>PetscReal</td>
<td class="fieldname">
V</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a199976769f9fa7620bc0e237b960be6c"></a>PetscReal *</td>
<td class="fieldname">
x_bp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4eab7fe908c09405d2bc6ad0f2223d6f"></a>PetscReal *</td>
<td class="fieldname">
x_bp0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac5d802c999939b4e7759ff7ddba7da94"></a>PetscReal *</td>
<td class="fieldname">
x_bp_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7378f41aa866944660faaf49e3998629"></a>PetscReal</td>
<td class="fieldname">
x_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a17d741fdd879164aca55e8fadb476d30"></a>PetscReal *</td>
<td class="fieldname">
y_bp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4b84c3b4a462add33a503bf14c2fa52d"></a>PetscReal *</td>
<td class="fieldname">
y_bp0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7144216940cfffcc3a4ea6cfd2a5aca7"></a>PetscReal *</td>
<td class="fieldname">
y_bp_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a01bc2acbb2432c4845b03b5d1e1587ca"></a>PetscReal</td>
<td class="fieldname">
y_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6a15e6ffd3c8c5ae08724dd367c02ad2"></a>PetscReal *</td>
<td class="fieldname">
z_bp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5a51d05117d20d2fc96b94278389224d"></a>PetscReal *</td>
<td class="fieldname">
z_bp0</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2c52b434242bf2d64a631325fcf9213e"></a>PetscReal *</td>
<td class="fieldname">
z_bp_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a966e15c1a836145f951d5d767cd709a8"></a>PetscReal</td>
<td class="fieldname">
z_c</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structnode" id="structnode"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structnode">&#9670;&nbsp;</a></span>node</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct node</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A generic C-style linked list node for integers. </p>

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00002">2</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for node:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structnode__coll__graph.svg" width="123" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a111a569ab2765add9b91c9f94cf9f063"></a>struct <a class="el" href="variables__old_8h.html#structnode">node</a> *</td>
<td class="fieldname">
next</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a67c35e6b366d28db7510776d6d187d35"></a>PetscInt</td>
<td class="fieldname">
Node</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structlist" id="structlist"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structlist">&#9670;&nbsp;</a></span>list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct list</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Head of a generic C-style linked list. </p>

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00007">7</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for list:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structlist__coll__graph.svg" width="123" height="127"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a33be93b070fc9c810103ca3b646d16a5"></a><a class="el" href="variables__old_8h.html#structnode">node</a> *</td>
<td class="fieldname">
head</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structlist__node" id="structlist__node"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structlist__node">&#9670;&nbsp;</a></span>list_node</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct list_node</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A generic C-style linked list node for indices. </p>

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00048">48</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for list_node:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structlist__node__coll__graph.svg" width="150" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aa505a95bfac2ff1d51138d6869b243bc"></a>PetscInt</td>
<td class="fieldname">
index</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad7161aa64a7b9659180387062bf096c2"></a>struct <a class="el" href="variables__old_8h.html#structlist__node">list_node</a> *</td>
<td class="fieldname">
next</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structIBMListNode" id="structIBMListNode"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structIBMListNode">&#9670;&nbsp;</a></span>IBMListNode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct IBMListNode</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>A linked list node containing IBM interpolation info. </p>

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00053">53</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for IBMListNode:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structIBMListNode__coll__graph.svg" width="172" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="aa213f23946307ee6f278543f23fb28de"></a><a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a></td>
<td class="fieldname">
ibm_intp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5222a315981e705b07b070e49cb31f9d"></a>struct <a class="el" href="variables__old_8h.html#structIBMListNode">IBMListNode</a> *</td>
<td class="fieldname">
next</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structIBMList" id="structIBMList"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structIBMList">&#9670;&nbsp;</a></span>IBMList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct IBMList</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Head of a linked list for IBM data. </p>

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00058">58</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for IBMList:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structIBMList__coll__graph.svg" width="172" height="306"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a02a65fc528fb6c4e468c54686cde3171"></a><a class="el" href="variables__old_8h.html#structIBMListNode">IBMListNode</a> *</td>
<td class="fieldname">
head</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structSurfElmtInfo" id="structSurfElmtInfo"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSurfElmtInfo">&#9670;&nbsp;</a></span>SurfElmtInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SurfElmtInfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Information about a surface element for FSI calculations. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00364">364</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="abed8c38ece8b7df81a42fb25504e1cb7"></a>PetscInt</td>
<td class="fieldname">
Clsnbpt_i</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a445822c9f8dc96cdedb865f361d60d13"></a>PetscInt</td>
<td class="fieldname">
Clsnbpt_j</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8b70604f680bdca8ab0c6c6b74338289"></a>PetscInt</td>
<td class="fieldname">
Clsnbpt_k</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7a96d7dc00559395ccb529a2d6e0d87a"></a>PetscInt</td>
<td class="fieldname">
FoundAroundcell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1536da2c5af577c2cd38f3039dfbe664"></a>PetscInt</td>
<td class="fieldname">
icell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a70dac0c6d4e2a4aeb550f541b09889cd"></a>PetscInt</td>
<td class="fieldname">
jcell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a538649b393e17d66ca7bb3329c0d9934"></a>PetscInt</td>
<td class="fieldname">
kcell</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3a7fe4d50a0d4a998f188634e6f642e3"></a>PetscInt</td>
<td class="fieldname">
n_P</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8a782cd2fb7f3a7924564660dfdf54e5"></a>PetscInt</td>
<td class="fieldname">
Need3rdPoint</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0558fc1654cbecb738a248096df36c3c"></a>PetscReal</td>
<td class="fieldname">
P</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3f14f8ea462d3febe02e72d3e19dcc46"></a>PetscReal</td>
<td class="fieldname">
Tow_wn</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad10a788b2dbe5b267e985bfcdccadf9e"></a>PetscReal</td>
<td class="fieldname">
Tow_ws</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3c3055f7293e045b33e855aac4f4390c"></a>PetscReal</td>
<td class="fieldname">
Tow_wt</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structFSInfo" id="structFSInfo"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structFSInfo">&#9670;&nbsp;</a></span>FSInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct FSInfo</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Holds all data related to the state and motion of a body in FSI. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00374">374</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for FSInfo:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structFSInfo__coll__graph.svg" width="211" height="216"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a8a4b79122937428989b73e4137b625e2"></a>PetscReal</td>
<td class="fieldname">
a_c[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad66d4a2ad50b87f8150be135c95d2c3b"></a>PetscReal</td>
<td class="fieldname">
A_tot</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad86ac8a5672a5ec23d44229bbc2e5f34"></a>PetscReal</td>
<td class="fieldname">
acc[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3ce1742bba2780099f0aac00fd848b89"></a>PetscReal</td>
<td class="fieldname">
alpha[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a78d9c3f94b95f552e7b97557d97c8925"></a>PetscReal</td>
<td class="fieldname">
atk</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af82c226d2e3807e6b8f7e9aee68080ac"></a>PetscReal</td>
<td class="fieldname">
atk_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a118d882a728be584dfb957e1ea6e2235"></a>PetscReal</td>
<td class="fieldname">
clone</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a03d777d3d310e154f385ad53f5ec168c"></a>PetscInt</td>
<td class="fieldname">
CV_ye</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a31670fd5fc1904aaac6ced4c61a348d9"></a>PetscInt</td>
<td class="fieldname">
CV_ys</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af8094d9eee5f0ec6bdc1e6b386ec5761"></a>PetscInt</td>
<td class="fieldname">
CV_ze</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2990557269af36d6a44a4ec49d77f328"></a>PetscInt</td>
<td class="fieldname">
CV_zs</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8bdc1b4d7f77ab5ac8e0b2d1997e8ced"></a>PetscReal</td>
<td class="fieldname">
damp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a35395f3898a386ab185de98f037cc7b2"></a>PetscReal</td>
<td class="fieldname">
dS[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1dfb6ba340b679e97b698aadf40fb454"></a>PetscReal</td>
<td class="fieldname">
dS_o[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aaf569bf303015bd308e91d31be13f14c"></a><a class="el" href="variables__old_8h.html#structSurfElmtInfo">SurfElmtInfo</a> *</td>
<td class="fieldname">
elmtinfo</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0c4ba18da41c3d919781481a05180217"></a>PetscReal</td>
<td class="fieldname">
F_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aae407b84a9de02689047e5b961079d60"></a>PetscReal</td>
<td class="fieldname">
F_x_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8a700f93518c516142caeef16912fb51"></a>PetscReal</td>
<td class="fieldname">
F_x_real</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af6cfdc97d987e8d90883d58a2792f17f"></a>PetscReal</td>
<td class="fieldname">
F_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6bd798f598c2a1a7f2b97f48b393705a"></a>PetscReal</td>
<td class="fieldname">
F_y_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2a897f43c291635e2daf139fd950445e"></a>PetscReal</td>
<td class="fieldname">
F_y_real</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a48f923588f9d3db58b1a1c154b88d173"></a>PetscReal</td>
<td class="fieldname">
F_z</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a26bc148edca57aca054dcaefbca212ee"></a>PetscReal</td>
<td class="fieldname">
F_z_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aad7b5a318729a622045014d04afb6baf"></a>PetscReal</td>
<td class="fieldname">
F_z_real</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6c3855c91eb533165aa5ef1bc4d02218"></a><a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a> *</td>
<td class="fieldname">
fsi_intp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7dc59f289e753ee04d73cf367b979d4a"></a>PetscReal</td>
<td class="fieldname">
I_inv[3][3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a39719dabfca161d9661354371112fa9e"></a>PetscReal</td>
<td class="fieldname">
L_n[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a91ad138a27b52ed1cc99be10ad3c36df"></a>PetscReal</td>
<td class="fieldname">
L_o[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a211cb304553a8a91a460c1cecf1cdfbf"></a>PetscReal</td>
<td class="fieldname">
L_r[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afaa477e09956689f6c4d9fac52486140"></a>PetscReal</td>
<td class="fieldname">
M_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa5b1f010fa7601ad8ced83e783d887bd"></a>PetscReal</td>
<td class="fieldname">
M_x_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad4b20afd149e2b40adbb9f103c243bad"></a>PetscReal</td>
<td class="fieldname">
M_x_real</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0a8fc1277d37a602447fcfebad675767"></a>PetscReal</td>
<td class="fieldname">
M_x_rm2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0070d1b5f2f362834ec76fa50d95380a"></a>PetscReal</td>
<td class="fieldname">
M_x_rm3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac9e66520d42d0567fa40815b97f0884b"></a>PetscReal</td>
<td class="fieldname">
M_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abdfaecd588a7eb05e1c5ad4efea4cc3c"></a>PetscReal</td>
<td class="fieldname">
M_y_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4d09eacb57ee5af30df2418a3f0797c4"></a>PetscReal</td>
<td class="fieldname">
M_y_real</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a66de21fccb7e2cbddbf78fe3f23cf13e"></a>PetscReal</td>
<td class="fieldname">
M_y_rm2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6dd778afbbfb579a642b091dc3d9c6cc"></a>PetscReal</td>
<td class="fieldname">
M_y_rm3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a29159ff2db07028dbf1ebb4137742ae1"></a>PetscReal</td>
<td class="fieldname">
M_z</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af4079d410d6dbde38737fddf6811e7f4"></a>PetscReal</td>
<td class="fieldname">
M_z_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a47bc6b0115ad25318d87f6f879d39eb1"></a>PetscReal</td>
<td class="fieldname">
M_z_real</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a96b6057c02478050fa483fe313ebe346"></a>PetscReal</td>
<td class="fieldname">
M_z_rm2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a49fbc5b949fe0887bb61d464fbe0d999"></a>PetscReal</td>
<td class="fieldname">
M_z_rm3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5a19d4b5a15e0ce7dd21b9c2afe89428"></a>PetscReal</td>
<td class="fieldname">
Max_xbc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2b873f2fe4c95cf92542aa6a76285859"></a>PetscReal</td>
<td class="fieldname">
Max_ybc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a908b1d341a44cb49aed881b89ccf899d"></a>PetscReal</td>
<td class="fieldname">
Max_zbc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a923899120ed35db5d8345c060aba7a65"></a>PetscReal</td>
<td class="fieldname">
Mdpdn_x</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3395faee43e7f9bc2beeccf8efedfb4a"></a>PetscReal</td>
<td class="fieldname">
Mdpdn_x_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abdac9673f63a9b17b934d49d19d34634"></a>PetscReal</td>
<td class="fieldname">
Mdpdn_y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a48c2daae60977d85ab162f40a6d61393"></a>PetscReal</td>
<td class="fieldname">
Mdpdn_y_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac9ef203e40b4d98ebce11bd4d6638b51"></a>PetscReal</td>
<td class="fieldname">
Mdpdn_z</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6a81dbd04b71dc5447ea82c1f2a729a3"></a>PetscReal</td>
<td class="fieldname">
Mdpdn_z_old</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae0d426101af2ccd4ba9188806b874f23"></a>PetscReal</td>
<td class="fieldname">
Min_xbc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a80d2f761eede821b51a9f0724d578e19"></a>PetscReal</td>
<td class="fieldname">
Min_ybc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af3262b46369acfec9eb907421ae22dd5"></a>PetscReal</td>
<td class="fieldname">
Min_zbc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1c01cb18fa8ff821edf759f6fada11a4"></a>PetscReal</td>
<td class="fieldname">
mu_s</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2257a41c901dbb676af020f0714f82d3"></a>PetscInt</td>
<td class="fieldname">
pbc[3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ade8304e550bf61af7a8a35a86f3f5426"></a>PetscReal</td>
<td class="fieldname">
Power</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a811944c29cb04a637d55b4a01a607a5a"></a>PetscReal</td>
<td class="fieldname">
q[4]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a12f9a4c96cb4503986bdedf9b32a8773"></a>PetscReal</td>
<td class="fieldname">
q_r[4]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a297dfd8cfa2bd6284aeb6d290f290f93"></a>PetscReal</td>
<td class="fieldname">
R[3][3]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6abd39a4f598c19d83e494665dfb0aaf"></a>PetscReal</td>
<td class="fieldname">
red_vel</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9f3f3356fb0a98f6099d36dbafeed75b"></a>PetscReal</td>
<td class="fieldname">
S_ang_n[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6b99a928d61bbe5d98cbee681ac07575"></a>PetscReal</td>
<td class="fieldname">
S_ang_o[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2d2f7c2e7702bce9dc1486b3fd7a3cc0"></a>PetscReal</td>
<td class="fieldname">
S_ang_r[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a225d6a20f4e6bf94ce430a4f56f98acf"></a>PetscReal</td>
<td class="fieldname">
S_ang_rm1[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1e70589f00b9d530a108b81f0c6c9eab"></a>PetscReal</td>
<td class="fieldname">
S_new[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3460b2f2e73fcb7f619faedef244151d"></a>PetscReal</td>
<td class="fieldname">
S_old[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a808de35743964af8b2bd3af6f00f094b"></a>PetscReal</td>
<td class="fieldname">
S_real[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6fe9266681e404822bb9967b0da559ad"></a>PetscReal</td>
<td class="fieldname">
S_realm1[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af38951f8e14a5ca57340a2a9391bc61d"></a>PetscReal</td>
<td class="fieldname">
x_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af192b3a8bb33232a33a081c08f18f32d"></a>PetscReal</td>
<td class="fieldname">
y_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af51f46329e769f915515e1b68e3fb8b3"></a>PetscReal</td>
<td class="fieldname">
z_c</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structCstart" id="structCstart"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structCstart">&#9670;&nbsp;</a></span>Cstart</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Cstart</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Defines prescribed body motion using splines. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00404">404</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a3c873d7c4829ae18c321a737c0577d95"></a>PetscReal *</td>
<td class="fieldname">
head_ang</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a101afdb332372a459452ca98f3e17409"></a>Mat</td>
<td class="fieldname">
Mphi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae0e64a651f864cdca956686ff2629743"></a>PetscInt</td>
<td class="fieldname">
n_midp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4547fe8dd2da7f56eb4b998fa6822c97"></a>PetscInt</td>
<td class="fieldname">
n_subit</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abe9471a10ce3fd8ca6d0b38998095fa1"></a>PetscInt</td>
<td class="fieldname">
n_time</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa2ddfe036c821826e06d19b3bbadfbc6"></a>PetscReal *</td>
<td class="fieldname">
s1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a210724d6fff79db2ab3cde0054222de8"></a>PetscReal *</td>
<td class="fieldname">
s2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a93d7121a5062bf3227036d6490795997"></a>PetscReal *</td>
<td class="fieldname">
s3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a546705d9094e8812085572a69ccd4d59"></a>PetscReal *</td>
<td class="fieldname">
st1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abecc3599584a28c534fc3492707e8f90"></a>PetscReal *</td>
<td class="fieldname">
st2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a347f8ba890bf83e5299c372d1b291358"></a>PetscReal *</td>
<td class="fieldname">
st3</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af63da39dea1f01eb845a57a003d4bad6"></a>PetscReal *</td>
<td class="fieldname">
x_com</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9dbc4de8c7cc0989e48ca90841b586ab"></a>PetscReal *</td>
<td class="fieldname">
x_midp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2b91a4b05dbd722d9bb5656bc43d6792"></a>PetscReal</td>
<td class="fieldname">
xmax</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a40467caea1532693e5662a0812d74c1c"></a>PetscReal</td>
<td class="fieldname">
xmin</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a234f67a093e1aa8c5bba171329a56e6b"></a>PetscReal *</td>
<td class="fieldname">
y_com</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afe6ef22c15698fad2b0c6b6af001b3a1"></a>PetscReal *</td>
<td class="fieldname">
y_midp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aef835e2403a6d800363d11121d43b186"></a>PetscReal</td>
<td class="fieldname">
ymax</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7e32a8507b0794c78280fc79da5aa780"></a>PetscReal</td>
<td class="fieldname">
ymin</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a357b70bd433f740fbfffa36e2aa07cad"></a>PetscReal *</td>
<td class="fieldname">
z_midp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac648e2d15bfe275b3aaf59c4e7824f3c"></a>PetscReal</td>
<td class="fieldname">
zmax</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a33628369387df2e86d86d6ec3c4c099b"></a>PetscReal</td>
<td class="fieldname">
zmin</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structMGCtx" id="structMGCtx"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structMGCtx">&#9670;&nbsp;</a></span>MGCtx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct MGCtx</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Context for Multigrid operations. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00418">418</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for MGCtx:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structMGCtx__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ab0d238ded511fffbc230f137f2ac30ff"></a>DM</td>
<td class="fieldname">
packer</td>
<td class="fielddoc">
DMDA for packing/unpacking fields. </td></tr>
<tr><td class="fieldtype">
<a id="a6174aa2a9e98d6a6aa1d332aa58f0ffe"></a>PetscInt</td>
<td class="fieldname">
thislevel</td>
<td class="fielddoc">
The current grid level (0 is finest). </td></tr>
<tr><td class="fieldtype">
<a id="a4a7154d09d7dee5e3dd7f0323dfb4ff3"></a><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *</td>
<td class="fieldname">
user</td>
<td class="fielddoc">
Pointer to the main application context for this level. </td></tr>
</table>

</div>
</div>
<a name="structUserMG" id="structUserMG"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structUserMG">&#9670;&nbsp;</a></span>UserMG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct UserMG</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>User-level context for managing the entire multigrid hierarchy. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00425">425</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for UserMG:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structUserMG__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ad8d0e4be4001d491cbb8fccdd03803d4"></a>PetscBool</td>
<td class="fieldname">
isc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac9199af6c5bffa86ce1ba076ee15f59a"></a>PetscBool</td>
<td class="fieldname">
jsc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa2740545fceacde9a9d1c1a6d073c711"></a>PetscBool</td>
<td class="fieldname">
ksc</td>
<td class="fielddoc">
Local starting indices (legacy?). </td></tr>
<tr><td class="fieldtype">
<a id="a10f4f7dc00a854759067cf96ab66485a"></a><a class="el" href="variables__old_8h.html#structMGCtx">MGCtx</a> *</td>
<td class="fieldname">
mgctx</td>
<td class="fielddoc">
Array of multigrid contexts, one for each level. </td></tr>
<tr><td class="fieldtype">
<a id="aac8e0dd714804b073dbb32c0ad84b2eb"></a>PetscInt</td>
<td class="fieldname">
mglevels</td>
<td class="fielddoc">
Total number of multigrid levels. </td></tr>
<tr><td class="fieldtype">
<a id="a0477d0c6078aecd8d2298d0708b2a05b"></a>DM</td>
<td class="fieldname">
packer</td>
<td class="fielddoc">
DM for field packing. </td></tr>
<tr><td class="fieldtype">
<a id="a2daea7c5d04c32762e3c41c7a79b7d54"></a>SNES</td>
<td class="fieldname">
snespacker</td>
<td class="fielddoc">
SNES context for the packed system. </td></tr>
<tr><td class="fieldtype">
<a id="a6a05385b56536662b2a243afe2a4504d"></a>PetscInt</td>
<td class="fieldname">
thislevel</td>
<td class="fielddoc">
Current level being operated on. </td></tr>
</table>

</div>
</div>
<a name="structPostProcessParams" id="structPostProcessParams"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structPostProcessParams">&#9670;&nbsp;</a></span>PostProcessParams</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct PostProcessParams</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Parameters controlling post-processing output actions. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00435">435</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a76d29089d00d89348f32bbf0e2981497"></a>PetscInt</td>
<td class="fieldname">
endTime</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7a84e77a3939f035f12edca094fab273"></a>char</td>
<td class="fieldname">
eulerianExt[8]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a864af9a6798cc160cdc8b926df038d5d"></a>char</td>
<td class="fieldname">
eulerianPrefix[20]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab954ff749a6b034b8cef53a508787b24"></a>PetscBool</td>
<td class="fieldname">
outputParticles</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aea601d0f9779b5eb45a9e4eea042bf59"></a>char</td>
<td class="fieldname">
particleExt[8]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aac37bc86f4ab3541b295329556695bb8"></a>char</td>
<td class="fieldname">
particlePrefix[20]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae3da627fc17587b06d6c2a737ff6442c"></a>PetscInt</td>
<td class="fieldname">
startTime</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5dca17e57a0f1464e2442f0c2452d497"></a>PetscInt</td>
<td class="fieldname">
timeStep</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="struct__n__VTKMetaData" id="struct__n__VTKMetaData"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct__n__VTKMetaData">&#9670;&nbsp;</a></span>_n_VTKMetaData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct _n_VTKMetaData</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Metadata structure for VTK output (.vts or .vtp files). </p>
<p>This struct is used for both Eulerian grid data and Lagrangian (particle) data. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00511">511</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ad21137f52964267d816e0020ea6a0ea6"></a>PetscInt *</td>
<td class="fieldname">
connectivity</td>
<td class="fielddoc">
Connectivity array for cells/lines. </td></tr>
<tr><td class="fieldtype">
<a id="a445c7da9d7981f28ffc4c241f30edb0d"></a>PetscScalar *</td>
<td class="fieldname">
coords</td>
<td class="fielddoc">
Coordinates array (3 components per point/node). </td></tr>
<tr><td class="fieldtype">
<a id="a983be781e6cfd81eafb89b8ef08826e0"></a><a class="el" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7">VTKFileType</a></td>
<td class="fieldname">
fileType</td>
<td class="fielddoc">
Type of VTK file to generate. </td></tr>
<tr><td class="fieldtype">
<a id="a069b0fbbde1a2d9985c8424606907066"></a>PetscInt</td>
<td class="fieldname">
mx</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae38be6693714a396f8589dd25466141e"></a>PetscInt</td>
<td class="fieldname">
my</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a22b3e3aeafde9936ee6293530647dc71"></a>PetscInt</td>
<td class="fieldname">
mz</td>
<td class="fielddoc">
Grid dimensions (for structured). </td></tr>
<tr><td class="fieldtype">
<a id="ae12214b25a1542511fd271172d682d8a"></a>PetscInt</td>
<td class="fieldname">
nnodes</td>
<td class="fielddoc">
Total number of structured grid nodes. </td></tr>
<tr><td class="fieldtype">
<a id="a7e565ef8d8c9775e515048e5a4717801"></a>PetscInt</td>
<td class="fieldname">
npoints</td>
<td class="fielddoc">
Number of particle points (for polydata). </td></tr>
<tr><td class="fieldtype">
<a id="a3cec1fcb259be5aa0f997b4a9f6dcea5"></a>PetscInt</td>
<td class="fieldname">
numScalarFields</td>
<td class="fielddoc">
Number of scalar fields. </td></tr>
<tr><td class="fieldtype">
<a id="a3f7933c8a2713d595cc451076c75f8b7"></a>PetscInt</td>
<td class="fieldname">
numVectorFields</td>
<td class="fielddoc">
Number of vector fields. </td></tr>
<tr><td class="fieldtype">
<a id="a695df85111e540560a039646a1b6ec55"></a>PetscInt *</td>
<td class="fieldname">
offsets</td>
<td class="fielddoc">
Offsets array for variable-size cells. </td></tr>
<tr><td class="fieldtype">
<a id="afe4c857bebd944f98fbec29de7afd4a0"></a>PetscScalar *</td>
<td class="fieldname">
scalarField</td>
<td class="fielddoc">
Pointer to scalar data array. </td></tr>
<tr><td class="fieldtype">
<a id="ae59785d86bd3e1d5d10beb6b43625bbe"></a>const char *</td>
<td class="fieldname">
scalarFieldName</td>
<td class="fielddoc">
Name of the scalar field. </td></tr>
<tr><td class="fieldtype">
<a id="a064a37174c4b3bceadafa7a8f41d92af"></a>PetscScalar *</td>
<td class="fieldname">
vectorField</td>
<td class="fielddoc">
Interleaved x,y,z vector field data. </td></tr>
<tr><td class="fieldtype">
<a id="abd950ce7d801a16ffba3ea58e488aa16"></a>const char *</td>
<td class="fieldname">
vectorFieldName</td>
<td class="fielddoc">
Name of the vector field (e.g., "Velocity"). </td></tr>
</table>

</div>
</div>
<a name="structUserCtx" id="structUserCtx"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structUserCtx">&#9670;&nbsp;</a></span>UserCtx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct UserCtx</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>User-defined context containing data specific to a single computational grid level. </p>
<p>User-defined context containing all simulation data, parameters, and configurations.</p>
<p>This is the primary data structure passed to low-level numerical and solver functions.</p>
<p>This is the primary data structure passed throughout the application. </p>

<p class="definition">Definition at line <a class="el" href="variables_8h_source.html#l00582">582</a> of file <a class="el" href="variables_8h_source.html">variables.h</a>.</p>
</div><div class="dynheader">
Collaboration diagram for UserCtx:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structUserCtx__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a4f7c5fd8843d026101b193e9236e1192"></a>PetscInt</td>
<td class="fieldname">
_this</td>
<td class="fielddoc">
Legacy block index, for multi-block contexts. </td></tr>
<tr><td class="fieldtype">
<a id="a555f83bde847a6f7bde6e372ca74dd4b"></a>Mat</td>
<td class="fieldname">
A</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a04b7e7d757be63c56b7b26068f24dda6"></a>Vec</td>
<td class="fieldname">
Aj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aea94c48d31a4107860ddca95a404a81c"></a>AO</td>
<td class="fieldname">
ao</td>
<td class="fielddoc">
Application Ordering context for renumbering. </td></tr>
<tr><td class="fieldtype">
<a id="a4068c0c41b20ccacea4d915f4d98798b"></a>PetscErrorCode</td>
<td class="fieldname">
aotopetsc</td>
<td class="fielddoc">
Legacy error code for AO to PETSc mapping. </td></tr>
<tr><td class="fieldtype">
<a id="a498cbec4c463ef775a82870456c71e47"></a>PetscReal</td>
<td class="fieldname">
AreaIntfcSum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6ce549f53d6eb121d6b944046e6d1fc6"></a>PetscReal</td>
<td class="fieldname">
AreaOutSum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a41951f47cfbe9c08def29998a76dc791"></a>PetscBool</td>
<td class="fieldname">
assignedA</td>
<td class="fielddoc">
Flag indicating if matrix A has been assigned. </td></tr>
<tr><td class="fieldtype">
<a id="a8d5dfbb54c592f6508f6f810225796a5"></a>PetscBool</td>
<td class="fieldname">
averaging</td>
<td class="fielddoc">
Flag to enable statistical averaging. </td></tr>
<tr><td class="fieldtype">
<a id="afb0db0163f5987323372d58a89e3efa1"></a>Vec</td>
<td class="fieldname">
B</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aab39e294cdaf3e4307d4a862904dcb8d"></a>Vec</td>
<td class="fieldname">
B2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae85e7171c483d180ffe8759fd13b4312"></a><a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a></td>
<td class="fieldname">
bbox</td>
<td class="fielddoc">
Bounding box for the local processor's grid domain. </td></tr>
<tr><td class="fieldtype">
<a id="a77c29afd999c79749fc4a0163da98d2e"></a><a class="el" href="variables__old_8h.html#structBCS">BCS</a></td>
<td class="fieldname">
Bcs</td>
<td class="fielddoc">
Legacy boundary condition structure. </td></tr>
<tr><td class="fieldtype">
<a id="a771c8e564dcfe2d27c913ef90bbe9337"></a>PetscInt</td>
<td class="fieldname">
bctype[6]</td>
<td class="fielddoc">
Legacy integer array for BC types per face. </td></tr>
<tr><td class="fieldtype">
<a id="a91ffa8462250c687df3e3aa4e16897bb"></a><a class="el" href="variables_8h.html#structBoundaryFaceConfig">BoundaryFaceConfig</a></td>
<td class="fieldname">
boundary_faces[6]</td>
<td class="fielddoc">
The new, primary BC configuration array. </td></tr>
<tr><td class="fieldtype">
<a id="a1a70c447c3541b9dd9958b221937874a"></a>Mat</td>
<td class="fieldname">
C</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae4c80df0c905413fce073c20672de5b2"></a>PetscReal</td>
<td class="fieldname">
cdisx</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a50936ba698e6fbe731cb559739ef930e"></a>PetscReal</td>
<td class="fieldname">
cdisy</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab71c96ec3bb179e4c85d960cc26830b7"></a>PetscReal</td>
<td class="fieldname">
cdisz</td>
<td class="fielddoc">
Central differencing dissipation parameters. </td></tr>
<tr><td class="fieldtype">
<a id="ad744b47ca3c5f3df2d1b737e432d6f07"></a>Vec</td>
<td class="fieldname">
Cent</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a77888fe1930df923549faaf5951455ba"></a>Vec</td>
<td class="fieldname">
Centx</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="addaea1781031d3f9ff945d87e8c5b728"></a>Vec</td>
<td class="fieldname">
Centy</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3998b7b5dad8340caf395c5da62230b7"></a>Vec</td>
<td class="fieldname">
Centz</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa09d08a0df9a0fdcbe733f507224d19f"></a>PetscReal</td>
<td class="fieldname">
cfl</td>
<td class="fielddoc">
Courant-Friedrichs-Lewy number. </td></tr>
<tr><td class="fieldtype">
<a id="a1d31f361d6e2d535a91d757c14eba7f4"></a>PetscInt</td>
<td class="fieldname">
cgrid</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5924ed7c71c227e348c1ae65d3e904d0"></a>Vec</td>
<td class="fieldname">
CS</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a439159b21d7cef43314ba3334fa8383d"></a>Vec</td>
<td class="fieldname">
Csi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af031acb43b014d5ac788aa9003491e75"></a>DM</td>
<td class="fieldname">
da</td>
<td class="fielddoc">
DMDA for scalar fields (e.g., Pressure, Nvert). </td></tr>
<tr><td class="fieldtype">
<a id="a7fb47de7893b318ba4e4e12ed46c0712"></a>DM *</td>
<td class="fieldname">
da_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3f7d6c40e13da36f13d6b34c4a304950"></a>DM *</td>
<td class="fieldname">
da_f</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a20af12b0539b3aea56d902876dc46854"></a>PetscInt</td>
<td class="fieldname">
df</td>
<td class="fielddoc">
Grid flags (e.g., coarse grid, degrees of freedom). </td></tr>
<tr><td class="fieldtype">
<a id="ad1d32cf4271935b197aa738d114d2838"></a>PetscInt</td>
<td class="fieldname">
dispnn[10]</td>
<td class="fielddoc">
Legacy probing/interface data. </td></tr>
<tr><td class="fieldtype">
<a id="ae72f68a8a5203175800cae93895523e3"></a>PetscInt</td>
<td class="fieldname">
dispx[10]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a58f30e1633acc254a99d5703e08350f9"></a>PetscInt</td>
<td class="fieldname">
dispy[10]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3e54eb5b151dfc2d897be4bc0690ebf9"></a>PetscInt</td>
<td class="fieldname">
dispz[10]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3f6bbba18dc8ab4b0822d88e7eb8b0ff"></a>Vec</td>
<td class="fieldname">
Distance</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="adc7bf52b3dc6cc76a72f93c08985ecc8"></a>PetscReal</td>
<td class="fieldname">
dt</td>
<td class="fielddoc">
Time step size. </td></tr>
<tr><td class="fieldtype">
<a id="a1af485d698958254e5e16f3039beb2f0"></a>Vec</td>
<td class="fieldname">
Dt</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="acd9e51c61887bb8ee092591d32c103f4"></a>Vec</td>
<td class="fieldname">
dUcont</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a82b959b40847f013f22cffed145b49b1"></a>Vec</td>
<td class="fieldname">
DUold</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8f4b905ecaadd9a0fe0b36faa1e3aa53"></a>Vec</td>
<td class="fieldname">
Eta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a759b537582b0cd1129b782225e5d05e3"></a><a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a></td>
<td class="fieldname">
face_bc_types[6]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a69966d928601d61d4f526636f84396c5"></a>DM</td>
<td class="fieldname">
fda</td>
<td class="fielddoc">
DMDA for primary 3-component vector fields (e.g., Velocity). </td></tr>
<tr><td class="fieldtype">
<a id="a9cdfbedb7b32291fa3d60cc698f07c1c"></a>DM</td>
<td class="fieldname">
fda2</td>
<td class="fielddoc">
DMDA for 2-component vector fields (e.g., k-omega). </td></tr>
<tr><td class="fieldtype">
<a id="a4b1611fb64047bff57fead0af5788aba"></a>PetscInt</td>
<td class="fieldname">
FieldInitialization</td>
<td class="fielddoc">
Flag controlling how fields are initially set. </td></tr>
<tr><td class="fieldtype">
<a id="ae2e89aa1d161279b0a9693e134b5d258"></a>PetscReal</td>
<td class="fieldname">
FluxInSum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa26cfafb620f75f7cf36a184604455ae"></a>PetscReal</td>
<td class="fieldname">
FluxIntfcSum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad29bf4d78039031aef92981faa325c94"></a>PetscReal</td>
<td class="fieldname">
FluxIntpSum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8d7eafe257f9b01d7b50aad4e26fc6bf"></a>PetscReal</td>
<td class="fieldname">
FluxOutSum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a73473ad34e03df67b43afcdd63beec50"></a>Vec</td>
<td class="fieldname">
Forcing</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae6003d999d4a3b9537275c16aada5757"></a>Vec</td>
<td class="fieldname">
Gid</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aee5539e762516e4d03308c3d8d901c2a"></a>Vec</td>
<td class="fieldname">
Gidm</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1a3194ed3e85b9a28cf30368e771d3f5"></a><a class="el" href="variables__old_8h.html#structBoundingBox">BoundingBox</a></td>
<td class="fieldname">
global_domain_bbox</td>
<td class="fielddoc">
Bounding box for the entire global domain. </td></tr>
<tr><td class="fieldtype">
<a id="accf2da0245f804c37780b4653a16f9f3"></a>PetscInt</td>
<td class="fieldname">
GridOrientation</td>
<td class="fielddoc">
Integerer that determines Whether grid is right-handed (+1) or left-handed (-1) i.e normals are facing outward or inward. </td></tr>
<tr><td class="fieldtype">
<a id="a0a9771638133dcba2d6819c8ee4ea7b6"></a>Vec</td>
<td class="fieldname">
GridSpace</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abbf9f36d259bcdf12c831721e70390ee"></a>Vec</td>
<td class="fieldname">
IAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a13b32409008534ad8de4861ad1ed227f"></a><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *</td>
<td class="fieldname">
ibm</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a43a386850e721a3b06253e02bc684574"></a><a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a> *</td>
<td class="fieldname">
ibm_intp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a278e5e6cc17514d8703247f85c664a01"></a><a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *</td>
<td class="fieldname">
ibmlist</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa06620cbd0e391feffb62d34b6b00698"></a>PetscInt</td>
<td class="fieldname">
ibmnumber</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9d9e92084d58808e9a52a80fa9d82092"></a>Vec</td>
<td class="fieldname">
ICsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a27bce072860da2f1a8a54d94b2b9497f"></a><a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a></td>
<td class="fieldname">
identifiedInletBCFace</td>
<td class="fielddoc">
Legacy field for particle system compatibility. </td></tr>
<tr><td class="fieldtype">
<a id="ac5732c2758b2261759350a77978bc8c5"></a>PetscInt *</td>
<td class="fieldname">
idx_from</td>
<td class="fielddoc">
Legacy index mapping data. </td></tr>
<tr><td class="fieldtype">
<a id="a3bfdfbc3022c8bc7f58ec9113275586f"></a>Vec</td>
<td class="fieldname">
IEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad1904cdee33ebeffba809c883f7e9641"></a>PetscInt</td>
<td class="fieldname">
IM</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a91ad9a6de6bddeb2fce6bdeea16b16fc"></a><a class="el" href="variables__old_8h.html#structFlowWave">FlowWave</a> *</td>
<td class="fieldname">
inflow</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="acd99423029a666652ee1f5bf573619bc"></a>DMDALocalInfo</td>
<td class="fieldname">
info</td>
<td class="fielddoc">
Cached local grid info for the current rank. </td></tr>
<tr><td class="fieldtype">
<a id="aeab5ca8965e79d955ecfac0bd22ae87c"></a><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a></td>
<td class="fieldname">
InitialConstantContra</td>
<td class="fielddoc">
A constant contravariant velocity vector. </td></tr>
<tr><td class="fieldtype">
<a id="ac3ae7b401938becf3f4a67c248a37e87"></a>PetscReal</td>
<td class="fieldname">
InitialConstantNvert</td>
<td class="fielddoc">
A constant nvert value. </td></tr>
<tr><td class="fieldtype">
<a id="a16419bcca616f72acd5305d088c8dcf7"></a>PetscReal</td>
<td class="fieldname">
InitialConstantPressure</td>
<td class="fielddoc">
A constant pressure value. </td></tr>
<tr><td class="fieldtype">
<a id="a1300c167a3006a58c71fe8759ebf5ef1"></a>PetscBool</td>
<td class="fieldname">
inletFaceDefined</td>
<td class="fielddoc">
Legacy flag for particle system compatibility. </td></tr>
<tr><td class="fieldtype">
<a id="ae92f89d2a9bd0f76888128d5ddc3f239"></a>Vec</td>
<td class="fieldname">
inletU</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae654d70fed62bd519ebd171116f761ac"></a>PetscInt</td>
<td class="fieldname">
inttype[7]</td>
<td class="fielddoc">
Legacy integer array for interface types. </td></tr>
<tr><td class="fieldtype">
<a id="aa2eddc56f0c5ab15a10baa5affe124b7"></a>PetscInt</td>
<td class="fieldname">
ip[10]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a03772da847da737415fd5a86a97147bd"></a>PetscInt</td>
<td class="fieldname">
isc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1b3b1253b4ab3e94ac4829673b2d9259"></a>ISColoring</td>
<td class="fieldname">
iscoloring</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a10b35985e1b292914c9f83d4b4b105d7"></a>Vec</td>
<td class="fieldname">
Itfc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5ec6c821940cd29b2bf8424bf404572f"></a>PetscInt *</td>
<td class="fieldname">
itfchostB</td>
<td class="fielddoc">
Host cell data for interpolation. </td></tr>
<tr><td class="fieldtype">
<a id="a7aef0500b65c05e4b6c28e3312123c6a"></a>PetscInt *</td>
<td class="fieldname">
itfchostI</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac9f9bdaed63981b8a3a5aafbcd9d17ef"></a>PetscInt *</td>
<td class="fieldname">
itfchostJ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab5b4301a8021ce0da7626891fe869d71"></a>PetscInt *</td>
<td class="fieldname">
itfchostK</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af5e9212db4af7ec636b81b6b173f3c3e"></a>PetscReal *</td>
<td class="fieldname">
itfchostx</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8276e0ec591d2b30bb25c3c1fa350613"></a>PetscReal *</td>
<td class="fieldname">
itfchosty</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6dd4b5a57cb032c298d1186fa523691f"></a>PetscReal *</td>
<td class="fieldname">
itfchostz</td>
<td class="fielddoc">
Host cell coordinates. </td></tr>
<tr><td class="fieldtype">
<a id="a1b6cabe4c545559c6f885a20899b6f9e"></a>PetscInt *</td>
<td class="fieldname">
itfcI</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad7f07fa07118e1167e7b6eeeaf56361e"></a>PetscInt *</td>
<td class="fieldname">
itfcJ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1da36f0065850f9a82b3ebd107d6bf41"></a>PetscInt *</td>
<td class="fieldname">
itfcK</td>
<td class="fielddoc">
Indices of interface points. </td></tr>
<tr><td class="fieldtype">
<a id="a58d78014d267f5cf24e28a14e231fc08"></a>PetscInt</td>
<td class="fieldname">
itfcptsnumber</td>
<td class="fielddoc">
Number of interface points. </td></tr>
<tr><td class="fieldtype">
<a id="a151eed139e2016d1ce229794ae8a7436"></a>Vec</td>
<td class="fieldname">
ItfcQ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3791d5150655979c702ff538e0c2d0a5"></a>Vec</td>
<td class="fieldname">
IZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a62e01a8ae4d53d5615a76e770837f7e1"></a>Mat</td>
<td class="fieldname">
J</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6efa69c82c1b3e60286636f7d58196eb"></a>Mat</td>
<td class="fieldname">
J2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac07ad1cd425926ccddebaca19310d090"></a>Vec</td>
<td class="fieldname">
JAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0d160d8dbe2ebacbdf86c7c40edf6c68"></a>Vec</td>
<td class="fieldname">
JCsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a14137f3f169b2ebe384683ea9a8b7f6d"></a>Vec</td>
<td class="fieldname">
JEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa55a2a246e904b3569075eb4de0092a6"></a>PetscInt</td>
<td class="fieldname">
JM</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a450edb9f70f6369eea32d4eac9379c9a"></a>PetscInt</td>
<td class="fieldname">
jp[10]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5fd8588302a68eca03d086e01e8972c1"></a>PetscInt</td>
<td class="fieldname">
jsc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a733ad785db194e51ad86c1613844ba31"></a>Vec</td>
<td class="fieldname">
JZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a45bbda2dfda6edd94e9d1dcd5adfc2e1"></a>Vec</td>
<td class="fieldname">
K_Omega</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3697ef486c46316e97aa05a22aeaa92f"></a>Vec</td>
<td class="fieldname">
K_Omega_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0d51f086ccdc81656ddea875d523173e"></a>Vec</td>
<td class="fieldname">
KAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ada60dbb4f918fda297a992a4228b1166"></a>Vec</td>
<td class="fieldname">
KCsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac29b95b05aa4bc3539389113c408d19e"></a>Vec</td>
<td class="fieldname">
KEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3f5ec0e4536c9ccaa3d663f14d47f904"></a>PetscInt</td>
<td class="fieldname">
KM</td>
<td class="fielddoc">
Global grid dimensions (number of cells in i,j,k). </td></tr>
<tr><td class="fieldtype">
<a id="a288d7dc0cfd2f9bf0432a1bd78f40dbe"></a><a class="el" href="variables__old_8h.html#structCmpnts2">Cmpnts2</a> **</td>
<td class="fieldname">
komega_plane</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8ee4981cac0d30c36697a6884047430f"></a>PetscInt</td>
<td class="fieldname">
kp[10]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3e8bcd710c619c329608b6f7da5f1ea1"></a>PetscInt</td>
<td class="fieldname">
ksc</td>
<td class="fielddoc">
Starting corner indices for the local subdomain. </td></tr>
<tr><td class="fieldtype">
<a id="a9ee9ea93420e5cadbe2e830a9166d0fc"></a>PetscInt *</td>
<td class="fieldname">
KSKE</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad4fcce0981f153a693d86659b81531a3"></a>KSP</td>
<td class="fieldname">
ksp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad6b708fb886f2f7b49f28d4466af5fa0"></a>Vec</td>
<td class="fieldname">
KZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="acb5123619f6844033498dbbd1f46b8d0"></a>Vec</td>
<td class="fieldname">
lAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a091373565c3562df29b6e1dc33a78c68"></a>Vec</td>
<td class="fieldname">
lCent</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a66d4c14737a74d07d188e3e7f2dfee6d"></a>Vec</td>
<td class="fieldname">
lCs</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9693ebf5c9ea601d5ebaf6d24cc60721"></a>Vec</td>
<td class="fieldname">
lCsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3a4f052a75d9b1e1954b144454bc1e01"></a>PetscBool</td>
<td class="fieldname">
les</td>
<td class="fielddoc">
Flag to enable Large Eddy Simulation. </td></tr>
<tr><td class="fieldtype">
<a id="ad4296b10d8eb7b065165582f5cc85897"></a>Vec</td>
<td class="fieldname">
lEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="adb1ab562c3eeb252073769024a60a693"></a>Vec</td>
<td class="fieldname">
lF1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a97d71af54bbd6d215c8d3838b574d799"></a>Vec</td>
<td class="fieldname">
lGridSpace</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4d561e219e8bc40951d121cce66d93ce"></a>Vec</td>
<td class="fieldname">
lIAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="acbf784310453bd7aec02838cdef24a66"></a>Vec</td>
<td class="fieldname">
lICsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2276cb159119246bfadea1c234dee31b"></a>Vec</td>
<td class="fieldname">
lIEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a02123df27bc12354bdea511d975bb1f2"></a>Vec</td>
<td class="fieldname">
lItfc</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af546894ac5a644334303dc3145b57442"></a>Vec</td>
<td class="fieldname">
lItfcKO</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a94804222fd6e45c35a8e2dfd13b110c8"></a>Vec</td>
<td class="fieldname">
lItfcQ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2db602ea5fce7cec91f19f507f922a74"></a>Vec</td>
<td class="fieldname">
lIZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae8527c7cba1c5764994053481722eb01"></a>Vec</td>
<td class="fieldname">
lJAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a63b70d5ad8338013a2888928d4106f63"></a>Vec</td>
<td class="fieldname">
lJCsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a96938d329a797441f228ecddd8e8e607"></a>Vec</td>
<td class="fieldname">
lJEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab7a460d0a7eaa2d76d0b6267310c3184"></a>Vec</td>
<td class="fieldname">
lJZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa39fcddc08427c8d30e28c5a8a37f981"></a>Vec</td>
<td class="fieldname">
lK_Omega</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa0dc186d7733ea4041c5c3cac181b9ce"></a>Vec</td>
<td class="fieldname">
lK_Omega_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aee8a3f32f3bdc0dda2f862651708c0f4"></a>Vec</td>
<td class="fieldname">
lKAj</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa0f10efbfba88094aa07cee1cdb0baff"></a>Vec</td>
<td class="fieldname">
lKCsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a508de73c1c5929cbee04a94091f2799e"></a>Vec</td>
<td class="fieldname">
lKEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8e6283b2989fae5d0a235baa570e929f"></a>Vec</td>
<td class="fieldname">
lKZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a03986a09ee62f493e37ed318022de706"></a>Vec</td>
<td class="fieldname">
lLM</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a24fbad67fea2e552e8934aea603c2be1"></a>Vec</td>
<td class="fieldname">
lMAreaCsi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af3c55194261d385d83c0b3cdaab5d6cf"></a>Vec</td>
<td class="fieldname">
lMAreaEta</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a39fb6fb65f4a9dbb49a7e89ffcb8d6e3"></a>Vec</td>
<td class="fieldname">
lMAreaZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa443b96894cce0f21780d7513bfad7d0"></a>Vec</td>
<td class="fieldname">
lMM</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a49018af9037f5684e87107c9145e7475"></a>Vec</td>
<td class="fieldname">
lNFace</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab6cb121c652637a106dea6e974dbca22"></a>Vec</td>
<td class="fieldname">
lNM</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9338cb4f3fbc319695a259d0dc09c002"></a>Vec</td>
<td class="fieldname">
lNu_t</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2f213dcdaf9617bfb44e4f22857f2e56"></a>Vec</td>
<td class="fieldname">
lNvert</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9b9e67bbc48d48f825de0639526c0a4f"></a>Vec *</td>
<td class="fieldname">
lNvert_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="adb95ee773b807cc6ec5e19c725f72afb"></a>Vec</td>
<td class="fieldname">
lNvert_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af840bcb7f2d37807376a1729e10b5897"></a>int</td>
<td class="fieldname">
local_Phi2_size</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a20f3ccaa01ba2d6b04d9f8ff8f514756"></a>PetscInt</td>
<td class="fieldname">
LoggingFrequency</td>
<td class="fielddoc">
Frequency for detailed logging. </td></tr>
<tr><td class="fieldtype">
<a id="a95078248cc49ce19d5d05b14e1701888"></a>Vec</td>
<td class="fieldname">
lP</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7a1cf0e107351a96b27ae00160e60271"></a>Vec</td>
<td class="fieldname">
lPhi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab5bc7ac272910a646da01962c027bd9e"></a>Vec</td>
<td class="fieldname">
lS</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a66d43c63dc568c9d34002ad7b34e2da9"></a>Vec</td>
<td class="fieldname">
lSx</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a54c77fefc7144eeeb9e0dce33a60f40f"></a>Vec</td>
<td class="fieldname">
lSy</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aeed6422bc0a062002ae8ed7f40fb5cd0"></a>Vec</td>
<td class="fieldname">
lSz</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ace2eeedc863d73caaf51bb83aa993e44"></a>Vec</td>
<td class="fieldname">
lUcat</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac8ba12826d60a51ec54fa7c047d806e1"></a>Vec</td>
<td class="fieldname">
lUcont</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7be157e6d32861b8732814e08ce17ae2"></a>Vec</td>
<td class="fieldname">
lUcont_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4a1d73fcab703005ec80b7d68674506e"></a>Vec</td>
<td class="fieldname">
lUcont_rm1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a58d3237c97d6f16130867370858d5bad"></a>Vec</td>
<td class="fieldname">
lUstar</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af411e023b9922e66767b647746dd8192"></a>Vec</td>
<td class="fieldname">
lVcont</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aaba3ddf8cadc309150d30d2aecf0e41f"></a>PetscReal</td>
<td class="fieldname">
LVOUT</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aed9ab153dffa3b12312aa5f82ea0aee1"></a>Vec</td>
<td class="fieldname">
lWcat</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a414751d7a391a78834cdce87b52a066f"></a>Vec</td>
<td class="fieldname">
lZet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac7fe45d6981f75ebd6bdbaf3982fa017"></a>MatFDColoring</td>
<td class="fieldname">
matfdcoloring</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac3ea6849d6d1556f240ace7a6d9a3347"></a>PetscReal</td>
<td class="fieldname">
Max_X</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a60bfc6b6d761a90da39b0f053bebcb31"></a>PetscReal</td>
<td class="fieldname">
Max_Y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aecbc2de7a281e906efe25a773b76866c"></a>PetscReal</td>
<td class="fieldname">
Max_Z</td>
<td class="fielddoc">
Physical maximum bounds of the grid. </td></tr>
<tr><td class="fieldtype">
<a id="a1a81a690145500f4d561fb9f84c5f64b"></a>PetscInt</td>
<td class="fieldname">
mglevels</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a002ff82be9c8b5efe85e0df7627381ee"></a>PetscMPIInt *</td>
<td class="fieldname">
miglist</td>
<td class="fielddoc">
List of ranks for particle migration. </td></tr>
<tr><td class="fieldtype">
<a id="a3c5226c112cabe2fc24230877bf7cc3c"></a>PetscReal</td>
<td class="fieldname">
Min_X</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac6633daab270004cd266f6e6ac05f588"></a>PetscReal</td>
<td class="fieldname">
Min_Y</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aaeef1864bb110c26e4b30a9e2c8c116d"></a>PetscReal</td>
<td class="fieldname">
Min_Z</td>
<td class="fielddoc">
Physical minimum bounds of the grid. </td></tr>
<tr><td class="fieldtype">
<a id="ac5212e2fb1eeb3323ab8c063aef6a498"></a>Mat</td>
<td class="fieldname">
MP</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad397aa8cb29c2ca1d2335b897e2f7690"></a>Mat</td>
<td class="fieldname">
MR</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae0a7a10f0bc2adac4b621178b64aa6f6"></a>PetscBool</td>
<td class="fieldname">
multinullspace</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9cab223a43076fdf079c5ea4f8501f08"></a>PetscInt</td>
<td class="fieldname">
n_ranks</td>
<td class="fielddoc">
Total number of MPI ranks. </td></tr>
<tr><td class="fieldtype">
<a id="a55c4aa98c35ababe3fda4da7af6bc3e4"></a>PetscInt</td>
<td class="fieldname">
nblk</td>
<td class="fielddoc">
Number of grid blocks in the simulation. </td></tr>
<tr><td class="fieldtype">
<a id="a58c51750e5a9172516dd2af41fd5fd42"></a><a class="el" href="variables__old_8h.html#structRankNeighbors">RankNeighbors</a></td>
<td class="fieldname">
neighbors</td>
<td class="fielddoc">
MPI ranks of neighboring subdomains. </td></tr>
<tr><td class="fieldtype">
<a id="afbc4b660ecb72ae899890466a194c411"></a>Vec</td>
<td class="fieldname">
nhostQ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa3970c2de8de0c97410e2137a7b14b61"></a>Vec</td>
<td class="fieldname">
nhostU</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9458ae2fd01569ea1ea0e84106874485"></a>Vec</td>
<td class="fieldname">
Nu_t</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a217e7d968ac372d82d28d88654ed2072"></a>MatNullSpace</td>
<td class="fieldname">
nullsp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9bd5fd46cf1983e6d2db8b141da137d2"></a>PetscInt</td>
<td class="fieldname">
number_flowwave</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a903a40f61431586183444e3feda2125a"></a>PetscInt</td>
<td class="fieldname">
NumberofParticles</td>
<td class="fielddoc">
Total number of particles in the simulation. </td></tr>
<tr><td class="fieldtype">
<a id="ada2db2a63cf3a9fe7ad2abf01cedc818"></a>Vec</td>
<td class="fieldname">
Nvert</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab7d6dffd5a35c03211c65aca209c909e"></a>Vec</td>
<td class="fieldname">
Nvert_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5a73aa2bc6be44bc1ff8847cf0a1b6af"></a>Vec</td>
<td class="fieldname">
P</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac18d37d85b7c9affd8034dc51991e3ce"></a>int</td>
<td class="fieldname">
p_global_begin</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afa542dfd7b8528862c1b4a96db3e35c7"></a>Vec</td>
<td class="fieldname">
P_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7766fff7f21998c052d5948977cbd2bb"></a>Vec</td>
<td class="fieldname">
P_sum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa194db376ea0f68ec7090718804488ab"></a>Vec</td>
<td class="fieldname">
ParticleCount</td>
<td class="fielddoc">
Eulerian field to count particles per cell. </td></tr>
<tr><td class="fieldtype">
<a id="a1e5101d176abd0528ef62199ee7ff9c0"></a>PetscInt</td>
<td class="fieldname">
ParticleInitialization</td>
<td class="fielddoc">
Flag controlling how particles are initially placed. </td></tr>
<tr><td class="fieldtype">
<a id="a2f3825691b122a0bf2ed5728b70bc9b1"></a>Vec</td>
<td class="fieldname">
Phi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3e0bf04db6c6b0dabfa954d56bf1600b"></a>Vec</td>
<td class="fieldname">
Phi2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="abd4f6361408aaf0b54662992ecea5041"></a>Mat</td>
<td class="fieldname">
PJ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac693e222cb5dc2d33e9394ea3bddd4dc"></a><a class="el" href="variables__old_8h.html#structPostProcessParams">PostProcessParams</a></td>
<td class="fieldname">
pp</td>
<td class="fielddoc">
Parameters controlling post-processing. </td></tr>
<tr><td class="fieldtype">
<a id="af8df0703ce4dab73db61fa500a7c5f2b"></a>Vec</td>
<td class="fieldname">
Psi</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3bb50860ac519bb564cf17e83075184c"></a>Vec</td>
<td class="fieldname">
psuedot</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9f0e5575e60f124d715fc4e5b2f4d6a4"></a>Vec</td>
<td class="fieldname">
pUcont</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9ef9f0c1489d1e09be84074649f4ad17"></a>Vec</td>
<td class="fieldname">
Ql</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a51fea22f31ec3648cdfe2b88219590b6"></a>Vec</td>
<td class="fieldname">
Qnew</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac68ff04231ee0e5fd575c66ffa7f8f36"></a>Vec</td>
<td class="fieldname">
R</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9cdf5dfef754056b907da42aee535f07"></a>PetscReal</td>
<td class="fieldname">
r[101]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac6a8eb8e8fd8e5b5c674384576890517"></a><a class="el" href="variables__old_8h.html#structRankCellInfo">RankCellInfo</a> *</td>
<td class="fieldname">
RankCellInfoMap</td>
<td class="fielddoc">
List of <a class="el" href="variables__old_8h.html#structRankCellInfo" title="A lean struct to hold the global cell ownership range for a single MPI rank.">RankCellInfo</a> objects which contain the cells owned by each rank. </td></tr>
<tr><td class="fieldtype">
<a id="a4f0207f098ec7b5e9895a44a6e74aee4"></a>PetscBool</td>
<td class="fieldname">
rans</td>
<td class="fielddoc">
Flag to enable Reynolds-Averaged Navier-Stokes. </td></tr>
<tr><td class="fieldtype">
<a id="aca463463e796e02c2fed10db86875262"></a>PetscReal</td>
<td class="fieldname">
ratio</td>
<td class="fielddoc">
A generic ratio parameter. </td></tr>
<tr><td class="fieldtype">
<a id="a43dd1398703b3ffaa2c1f2ce0948e593"></a>int</td>
<td class="fieldname">
reduced_p_size</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa762e9ded806b7020b664ef0a88e8613"></a>PetscReal</td>
<td class="fieldname">
ren</td>
<td class="fielddoc">
Reynolds number. </td></tr>
<tr><td class="fieldtype">
<a id="ac0ea412df4c42791577a03c53b7672d4"></a>Vec</td>
<td class="fieldname">
RFC</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a154e530f8443bc67858ba6e3c411c3d8"></a>Vec</td>
<td class="fieldname">
Rhs</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a60be491be429a4e2b1d80d7a274f51ff"></a>int</td>
<td class="fieldname">
rhs_count</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a08e4b4d7f423d7ffa185c9c90d95fc4e"></a>Vec</td>
<td class="fieldname">
Rhsp</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ade80a8abea8047bfe4b83bd9363df589"></a>PetscReal</td>
<td class="fieldname">
rx</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a540dc135c4299ebf7fcbb33ecd8ca096"></a>PetscReal</td>
<td class="fieldname">
ry</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a94c6d4cf5f0820de35ff6ee1909fd0d6"></a>PetscReal</td>
<td class="fieldname">
rz</td>
<td class="fielddoc">
Grid stretching ratios. </td></tr>
<tr><td class="fieldtype">
<a id="abbcebcc6c0da2d5051acd4e09d65b174"></a>Vec</td>
<td class="fieldname">
shrr</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a322702c716e6e140d71515d0b3e111b1"></a><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *</td>
<td class="fieldname">
simCtx</td>
<td class="fielddoc">
Back-pointer to the master simulation context. </td></tr>
<tr><td class="fieldtype">
<a id="a13c4608ad279b8635470c147d65d5fec"></a>SNES</td>
<td class="fieldname">
snes</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5cd553394168445f1838567bb6cf89fe"></a>PetscReal</td>
<td class="fieldname">
st</td>
<td class="fielddoc">
Strouhal number. </td></tr>
<tr><td class="fieldtype">
<a id="a0d20996363e49a21eeab384118449e25"></a>PetscInt</td>
<td class="fieldname">
step</td>
<td class="fielddoc">
Current timestep index. </td></tr>
<tr><td class="fieldtype">
<a id="a1675749ea3b2429f00405a1ee3203d18"></a>DM</td>
<td class="fieldname">
swarm</td>
<td class="fielddoc">
DMSwarm object for particle data. </td></tr>
<tr><td class="fieldtype">
<a id="a99a88d89d58073bd134175f62213c528"></a>PetscInt</td>
<td class="fieldname">
thislevel</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aba7ae9121c4851dee73ebc4e46150dd8"></a>PetscReal</td>
<td class="fieldname">
ti</td>
<td class="fielddoc">
Current simulation time. </td></tr>
<tr><td class="fieldtype">
<a id="a6359634b555181659d225045029bde3f"></a>PetscReal</td>
<td class="fieldname">
tin[101]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa1823d873982755996b7335f43732af4"></a>Vec</td>
<td class="fieldname">
Ucat</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ad78de239c377f8290aa9a5979006d50f"></a>Vec</td>
<td class="fieldname">
Ucat_cross_sum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a82d8c3eb7b01d4a4decdd9e3f23c152f"></a>Vec</td>
<td class="fieldname">
Ucat_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a75b5725be5540b27c16fb4672da3b352"></a>Vec</td>
<td class="fieldname">
Ucat_square_sum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab17892f7348a15501be2ac3896e7d345"></a>Vec</td>
<td class="fieldname">
Ucat_sum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a69c3a361d1aac3bdc14f971bda57e032"></a>Vec</td>
<td class="fieldname">
Ucont</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8c95f10934ed36ff22576fe55104aa06"></a>Vec</td>
<td class="fieldname">
Ucont2</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af7931df0742b774570090c22538370b5"></a>Vec</td>
<td class="fieldname">
Ucont_MG</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa3e47c4956a89b33d659fe33f4814091"></a>Vec</td>
<td class="fieldname">
Ucont_o</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac5eef54f719e58aacd10010fbe61f2d5"></a>Vec</td>
<td class="fieldname">
Ucont_rm1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9c692217d9376e374a28931d512ca254"></a>PetscReal</td>
<td class="fieldname">
uinr[101][1001]</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a8420a45c7f75054e71e9d8530e52ee8e"></a><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *</td>
<td class="fieldname">
user_c</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2cda7005f38b4f15851a13afa70f1b3d"></a><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *</td>
<td class="fieldname">
user_f</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a06e50286e041f03c4da8f915b9f25af8"></a>Vec</td>
<td class="fieldname">
USQ</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac02f65cd4decd1f3cc005f847eedb1fa"></a>PetscReal</td>
<td class="fieldname">
utaw</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a60d868dbae1aaf222981f3ffcba4a2cc"></a>PetscReal</td>
<td class="fieldname">
utaw1</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a4821f4944d561546a0700360271121a1"></a>PetscReal</td>
<td class="fieldname">
utaw1sum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a15b5a72a8e79afcd442ffd6ecb9218fd"></a>PetscReal</td>
<td class="fieldname">
utawsum</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af78b7a7973e17475d82cd7557b33a35c"></a>Vec</td>
<td class="fieldname">
Vcont</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0949a51fb857ad550aee8053c1ce2df3"></a>PetscReal</td>
<td class="fieldname">
vnn</td>
<td class="fielddoc">
Von Neumann number. </td></tr>
<tr><td class="fieldtype">
<a id="a91548fd2696b57d5096ef52e00f525ff"></a>Vec</td>
<td class="fieldname">
Wcat</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1c07c24c702517add075f618194e8f82"></a>Vec</td>
<td class="fieldname">
X</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3624653328a9aabb1338d4b28ec5ca32"></a>PetscReal</td>
<td class="fieldname">
xMax</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af3bdfeffb10e0d450856f8eaacc0c4c0"></a>PetscReal</td>
<td class="fieldname">
xMin</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="afd6d19f6a25afc18f1552f8bd3724103"></a>PetscReal</td>
<td class="fieldname">
yMax</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a6093bb506189aeae2e94d81491265463"></a>PetscReal</td>
<td class="fieldname">
yMin</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a148acf527180f13125589c3fb8f4e816"></a>Vec</td>
<td class="fieldname">
Zet</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9b737f614558ab58504a0db0b401d1fe"></a>PetscReal</td>
<td class="fieldname">
zMax</td>
<td class="fielddoc">
Physical maximum bounds of the grid. </td></tr>
<tr><td class="fieldtype">
<a id="ab8c185469ce22d0e2749aff93a85e289"></a>PetscReal</td>
<td class="fieldname">
zMin</td>
<td class="fielddoc">
Physical minimum bounds of the grid. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af0af02fbd08daea87f3523a3754981f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0af02fbd08daea87f3523a3754981f0">&#9670;&nbsp;</a></span>COEF_TIME_ACCURACY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COEF_TIME_ACCURACY&#160;&#160;&#160;1.5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Coefficient controlling the temporal accuracy scheme (e.g., 1.5 for BDF2). </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00049">49</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a10a62bce766452804bad64d119e127f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10a62bce766452804bad64d119e127f7">&#9670;&nbsp;</a></span>MAX_POINT_DATA_FIELDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_POINT_DATA_FIELDS&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the maximum number of data fields for VTK point data. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00051">51</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a22a9148c380850b8568b82d154446340"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22a9148c380850b8568b82d154446340">&#9670;&nbsp;</a></span>BC_Param</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structBC__Param__s">BC_Param_s</a> <a class="el" href="variables_8h.html#a22a9148c380850b8568b82d154446340">BC_Param</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00076">76</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="afc2af32ff12b47d8e9e02b3adca2c262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc2af32ff12b47d8e9e02b3adca2c262">&#9670;&nbsp;</a></span>BoundaryCondition</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structBoundaryCondition__s.html">BoundaryCondition_s</a> <a class="el" href="structBoundaryCondition.html">BoundaryCondition</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00077">77</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="adf3537b955823a1cc6f6028d6747053d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf3537b955823a1cc6f6028d6747053d">&#9670;&nbsp;</a></span>BoundaryFaceConfig</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structBoundaryFaceConfig__s">BoundaryFaceConfig_s</a> <a class="el" href="variables_8h.html#structBoundaryFaceConfig">BoundaryFaceConfig</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00078">78</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a48835bb3e95726270d15ae238f08a699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48835bb3e95726270d15ae238f08a699">&#9670;&nbsp;</a></span>IBMList</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> <a class="el" href="variables__old_8h.html#structIBMList">IBMList</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Head of a linked list for IBM data. </p>

</div>
</div>
<a id="a4222faf080077cd7e5703d7bd83cf992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4222faf080077cd7e5703d7bd83cf992">&#9670;&nbsp;</a></span>IBMListNode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structIBMListNode">IBMListNode</a> <a class="el" href="variables__old_8h.html#structIBMListNode">IBMListNode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A linked list node containing IBM interpolation info. </p>

</div>
</div>
<a id="aa89b8bc105d9a09d4e7c06e8b34078a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa89b8bc105d9a09d4e7c06e8b34078a7">&#9670;&nbsp;</a></span>List</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structlist">list</a> <a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Head of a generic C-style linked list. </p>

</div>
</div>
<a id="af4aeda155dbe167f1c1cf38cb65bf324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4aeda155dbe167f1c1cf38cb65bf324">&#9670;&nbsp;</a></span>node</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structnode">node</a> <a class="el" href="variables__old_8h.html#structnode">node</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A generic C-style linked list node for integers. </p>

</div>
</div>
<a id="adaaacd4affdea8751e35bff19e7e5191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaaacd4affdea8751e35bff19e7e5191">&#9670;&nbsp;</a></span>Node_List</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structlist__node">list_node</a> <a class="el" href="list_8h.html#adaaacd4affdea8751e35bff19e7e5191">Node_List</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A generic C-style linked list node for indices. </p>

</div>
</div>
<a id="a8af80dea40db36357149fbf3f19bdb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8af80dea40db36357149fbf3f19bdb1e">&#9670;&nbsp;</a></span>UserCtx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> <a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User-defined context containing all simulation data, parameters, and configurations. </p>
<p>This is the primary data structure passed throughout the application. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00079">79</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="ac7273b619c47098a1c963da9d6fd54d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7273b619c47098a1c963da9d6fd54d7">&#9670;&nbsp;</a></span>VTKMetaData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="variables__old_8h.html#struct__n__VTKMetaData">_n_VTKMetaData</a> <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Metadata structure for VTK output (.vts or .vtp files). </p>
<p>This struct is used for both Eulerian grid data and Lagrangian (particle) data. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="afc4c17936462d8236c21005c4cf6bbaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4c17936462d8236c21005c4cf6bbaf">&#9670;&nbsp;</a></span>BCFace</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies the six logical faces of a structured computational block. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611"></a>BC_FACE_NEG_X&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c"></a>BC_FACE_POS_X&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a"></a>BC_FACE_NEG_Y&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb"></a>BC_FACE_POS_Y&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d"></a>BC_FACE_NEG_Z&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e"></a>BC_FACE_POS_Z&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611"></a>BC_FACE_NEG_X&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c"></a>BC_FACE_POS_X&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a"></a>BC_FACE_NEG_Y&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb"></a>BC_FACE_POS_Y&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d"></a>BC_FACE_NEG_Z&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e"></a>BC_FACE_POS_Z&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00235">235</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;             {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a> = 0, <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a> = 1,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a> = 2, <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a> = 3,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d">BC_FACE_NEG_Z</a> = 4, <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e">BC_FACE_POS_Z</a> = 5</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;} <a class="code" href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a id="a466f572ad4e3d8b6f5eb03bceaad2ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a466f572ad4e3d8b6f5eb03bceaad2ca1">&#9670;&nbsp;</a></span>BCHandlerType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="variables_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the specific computational "strategy" for a boundary handler. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453"></a>BC_HANDLER_UNDEFINED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c"></a>BC_HANDLER_NOGRAD_COPY_GHOST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a"></a>BC_HANDLER_WALL_NOSLIP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462"></a>BC_HANDLER_WALL_MOVING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b"></a>BC_HANDLER_SYMMETRY_PLANE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad"></a>BC_HANDLER_INLET_PARABOLIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d"></a>BC_HANDLER_INLET_CONSTANT_VELOCITY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576"></a>BC_HANDLER_INLET_PULSANTILE_FLUX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079"></a>BC_HANDLER_INLET_DEVELOPED_PROFILE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32"></a>BC_HANDLER_OUTLET_CONSERVATION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077"></a>BC_HANDLER_OUTLET_PRESSURE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f"></a>BC_HANDLER_FARFIELD_NONREFLECTING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d"></a>BC_HANDLER_PERIODIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7"></a>BC_HANDLER_INTERFACE_OVERSET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453"></a>BC_HANDLER_UNDEFINED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c"></a>BC_HANDLER_NOGRAD_COPY_GHOST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a"></a>BC_HANDLER_WALL_NOSLIP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462"></a>BC_HANDLER_WALL_MOVING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b"></a>BC_HANDLER_SYMMETRY_PLANE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad"></a>BC_HANDLER_INLET_PARABOLIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d"></a>BC_HANDLER_INLET_CONSTANT_VELOCITY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576"></a>BC_HANDLER_INLET_PULSANTILE_FLUX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079"></a>BC_HANDLER_INLET_DEVELOPED_PROFILE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32"></a>BC_HANDLER_OUTLET_CONSERVATION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077"></a>BC_HANDLER_OUTLET_PRESSURE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f"></a>BC_HANDLER_FARFIELD_NONREFLECTING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d"></a>BC_HANDLER_PERIODIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7"></a>BC_HANDLER_INTERFACE_OVERSET&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00248">248</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;             {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453">BC_HANDLER_UNDEFINED</a> = 0,<a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a>,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a>, <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462">BC_HANDLER_WALL_MOVING</a>,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b">BC_HANDLER_SYMMETRY_PLANE</a>,<a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a>,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a>, <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576">BC_HANDLER_INLET_PULSANTILE_FLUX</a>, <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079">BC_HANDLER_INLET_DEVELOPED_PROFILE</a>,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32">BC_HANDLER_OUTLET_CONSERVATION</a>, <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077">BC_HANDLER_OUTLET_PRESSURE</a>,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f">BC_HANDLER_FARFIELD_NONREFLECTING</a>,</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d">BC_HANDLER_PERIODIC</a>, <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7">BC_HANDLER_INTERFACE_OVERSET</a></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;} <a class="code" href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a00003814ee8095a2c39d1d5cba08fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a00003814ee8095a2c39d1d5cba08fa">&#9670;&nbsp;</a></span>BCType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Defines the general mathematical/physical category of a boundary. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faac4f816c9f2b363c7e2c959807809bd94"></a>WALLFUNCTION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544"></a>INTERFACE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a"></a>WALL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa21ba3bc4a36398f4c11fba2c3db9e877"></a>MOVING_WALL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e"></a>SYMMETRY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a"></a>INLET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18"></a>OUTLET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757"></a>FARFIELD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58"></a>PERIODIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa9ee1404b18b6acf6db149de82f6d677d"></a>CHARACTERISTIC_BC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa847f2dd2cd88b336cf5a621f8393fcba"></a>ANALYTICAL_VORTEX&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faaf450e16147ffcf97341b35890aa4056c"></a>JUNCTION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa7ea5c9eb9cab9f86765ccf12e2bd0413"></a>ANNULUS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faadd03a62c8db17bc188262f525a1f4871"></a>OGRID&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa9331c56dedc775b064f31ce6981f56c1"></a>RHEOLOGY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908"></a>NOGRAD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa605159e8a4c32319fd69b5d151369d93"></a>UNDEFINED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908"></a>NOGRAD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a"></a>WALL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e"></a>SYMMETRY&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a"></a>INLET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18"></a>OUTLET&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757"></a>FARFIELD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58"></a>PERIODIC&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544"></a>INTERFACE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00242">242</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;             {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa605159e8a4c32319fd69b5d151369d93">UNDEFINED</a> = 0, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a>, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a>, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e">SYMMETRY</a>, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a>,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a>, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757">FARFIELD</a>, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58">PERIODIC</a>, <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544">INTERFACE</a></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;} <a class="code" href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3fc1d97a3c41ea9d58d0ab14f75294f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3fc1d97a3c41ea9d58d0ab14f75294f">&#9670;&nbsp;</a></span>Face</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294f">Face</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerates the six faces of a cubic cell for distance calculations. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065"></a>LEFT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38"></a>RIGHT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461"></a>BOTTOM&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3"></a>TOP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02"></a>FRONT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee"></a>BACK&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f"></a>NUM_FACES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065"></a>LEFT&#160;</td><td class="fielddoc"><p>Left face (x-) </p>
</td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38"></a>RIGHT&#160;</td><td class="fielddoc"><p>Right face (x+) </p>
</td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461"></a>BOTTOM&#160;</td><td class="fielddoc"><p>Bottom face (y-) </p>
</td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3"></a>TOP&#160;</td><td class="fielddoc"><p>Top face (y+) </p>
</td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02"></a>FRONT&#160;</td><td class="fielddoc"><p>Front face (z-) </p>
</td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee"></a>BACK&#160;</td><td class="fielddoc"><p>Back face (z+) </p>
</td></tr>
<tr><td class="fieldname"><a id="ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f"></a>NUM_FACES&#160;</td><td class="fielddoc"><p>Total number of faces. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00166">166</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;             {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a> = 0,    <span class="comment">/**&lt; Left face (x-) */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>,       <span class="comment">/**&lt; Right face (x+) */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>,      <span class="comment">/**&lt; Bottom face (y-) */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>,         <span class="comment">/**&lt; Top face (y+) */</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>,       <span class="comment">/**&lt; Front face (z-) */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>,        <span class="comment">/**&lt; Back face (z+) */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a>    <span class="comment">/**&lt; Total number of faces */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;} <a class="code" href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294f">Face</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a id="a347829443e8a679209e21f7f04f51581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a347829443e8a679209e21f7f04f51581">&#9670;&nbsp;</a></span>ParticleLocationStatus</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a"></a>NEEDS_LOCATION&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253"></a>ACTIVE_AND_LOCATED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329"></a>MIGRATING_OUT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317"></a>LOST&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780"></a>UNINITIALIZED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a"></a>NEEDS_LOCATION&#160;</td><td class="fielddoc"><p>The particle's host cell is unknown or invalid. </p>
<p>This is the initial state for newly arrived particles on a rank after migration, or for particles whose location search failed in a previous step. Any particle in this state is a candidate for processing in the current relocation pass. </p>
</td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253"></a>ACTIVE_AND_LOCATED&#160;</td><td class="fielddoc"><p>The particle has been successfully located in a cell owned by the current rank. </p>
<p>This state indicates that the particle is settled for the current timestep and does not need further location checks or migration. The orchestrator can skip this particle in subsequent passes of the do-while loop. </p>
</td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329"></a>MIGRATING_OUT&#160;</td><td class="fielddoc"><p>The particle has been identified as needing to move to another rank. </p>
<p>This status is set by the sending rank during the identification phase. The particle's <code>destination_rank</code> field will be valid. This state is temporary and primarily used to signal that the particle should be included in the MPI migration step. </p>
</td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317"></a>LOST&#160;</td><td class="fielddoc"><p>The particle could not be located and is considered lost. </p>
<p>This status is set when the walk search exceeds its maximum traversal limit or walks outside the global domain boundaries. Particles in this state are candidates for removal by the <code>CheckAndRemoveOutOfBoundsParticles</code> function. </p>
</td></tr>
<tr><td class="fieldname"><a id="a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780"></a>UNINITIALIZED&#160;</td><td class="fielddoc"><p>The default state for a newly created particle before any processing. </p>
<p>While <code>NEEDS_LOCATION</code> is functionally similar for the first pass, having a distinct initial state can be useful for debugging and initialization logic. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00123">123</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;             {<span class="comment"></span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">     * @brief The particle&#39;s host cell is unknown or invalid.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">     * This is the initial state for newly arrived particles on a rank after migration,</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">     * or for particles whose location search failed in a previous step. Any particle</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">     * in this state is a candidate for processing in the current relocation pass.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a">NEEDS_LOCATION</a>,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">     * @brief The particle has been successfully located in a cell owned by the current rank.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">     * This state indicates that the particle is settled for the current timestep and</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">     * does not need further location checks or migration. The orchestrator can skip</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">     * this particle in subsequent passes of the do-while loop.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253">ACTIVE_AND_LOCATED</a>,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     * @brief The particle has been identified as needing to move to another rank.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">     * This status is set by the sending rank during the identification phase. The particle&#39;s</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">     * `destination_rank` field will be valid. This state is temporary and primarily used</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">     * to signal that the particle should be included in the MPI migration step.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329">MIGRATING_OUT</a>,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">     * @brief The particle could not be located and is considered lost.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">     * This status is set when the walk search exceeds its maximum traversal limit or</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">     * walks outside the global domain boundaries. Particles in this state are candidates</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     * for removal by the `CheckAndRemoveOutOfBoundsParticles` function.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317">LOST</a>,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">    /**</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">     * @brief The default state for a newly created particle before any processing.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">     * While `NEEDS_LOCATION` is functionally similar for the first pass, having a distinct</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">     * initial state can be useful for debugging and initialization logic.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <a class="code" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;} <a class="code" href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a>;</div>
</div><!-- fragment -->
</div>
</div>
<a id="afef259795cd298f0d543f574536e4dd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afef259795cd298f0d543f574536e4dd7">&#9670;&nbsp;</a></span>VTKFileType</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7">VTKFileType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enumerates the type of VTK file to be written. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9"></a>VTK_STRUCTURED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57"></a>VTK_POLYDATA&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9"></a>VTK_STRUCTURED&#160;</td><td class="fielddoc"><p>For .vts (StructuredGrid) files from Eulerian data. </p>
</td></tr>
<tr><td class="fieldname"><a id="afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57"></a>VTK_POLYDATA&#160;</td><td class="fielddoc"><p>For .vtp (PolyData) files from Lagrangian/particle data. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00502">502</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;             {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a>, <span class="comment">///&lt; For .vts (StructuredGrid) files from Eulerian data.</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment"></span>    <a class="code" href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a>    <span class="comment">///&lt; For .vtp (PolyData) files from Lagrangian/particle data.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"></span>} <a class="code" href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7">VTKFileType</a>;</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9191fb960803f52c32b3a01d054fdf4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9191fb960803f52c32b3a01d054fdf4a">&#9670;&nbsp;</a></span>AddIBMNode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddIBMNode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *&#160;</td>
          <td class="paramname"><em>ilist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a>&#160;</td>
          <td class="paramname"><em>ibm_intp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00066">66</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="variables__old_8h.html#structIBMListNode">IBMListNode</a> *<span class="keyword">new</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  PetscNew(<a class="code" href="variables__old_8h.html#structIBMListNode">IBMListNode</a>, &amp;<span class="keyword">new</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keyword">new</span>-&gt;next = ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keyword">new</span>-&gt;<a class="code" href="variables__old_8h.html#aa213f23946307ee6f278543f23fb28de">ibm_intp</a> = ibm_intp;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a> = <span class="keyword">new</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a865d8d58260f9c51a44a9e18d0d5663b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a865d8d58260f9c51a44a9e18d0d5663b">&#9670;&nbsp;</a></span>Block_Interface_U()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Block_Interface_U </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1450af65e49d15d25e9ad8c0e2f5d16a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1450af65e49d15d25e9ad8c0e2f5d16a">&#9670;&nbsp;</a></span>Calc_forces_SI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Calc_forces_SI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>FSinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ibi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>bi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a26fcb995c42e7146b27f5f1882ac920c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26fcb995c42e7146b27f5f1882ac920c">&#9670;&nbsp;</a></span>CollisionDetectionOfParticles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode CollisionDetectionOfParticles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a444d8f7af8f98024e8079aed3e9448e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a444d8f7af8f98024e8079aed3e9448e3">&#9670;&nbsp;</a></span>Compute_du_dxyz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Compute_du_dxyz </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>csi0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>csi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>csi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>eta2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zet0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zet1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zet2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ajc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dudc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dvdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dwdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dvde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dwde</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dudz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dvdz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dwdz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>du_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dv_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dw_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>du_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dv_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dw_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>du_dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dv_dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>dw_dz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab37f8a0517cf55932174fa327e7ab072"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab37f8a0517cf55932174fa327e7ab072">&#9670;&nbsp;</a></span>Compute_Smagorinsky_Constant_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Compute_Smagorinsky_Constant_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>Ucont</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>Ucat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acaf7eb2d12267231f3cf08c3c24de666"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaf7eb2d12267231f3cf08c3c24de666">&#9670;&nbsp;</a></span>destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a> *&#160;</td>
          <td class="paramname"><em>ilist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00037">37</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="variables__old_8h.html#structnode">node</a> *current;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">while</span> (ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a>) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    current = ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a>-&gt;<a class="code" href="variables__old_8h.html#a111a569ab2765add9b91c9f94cf9f063">next</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    PetscFree(ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a> = current;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48f2874f8a3f8b460966ec88db35bfd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48f2874f8a3f8b460966ec88db35bfd3">&#9670;&nbsp;</a></span>DestroyIBMList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DestroyIBMList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *&#160;</td>
          <td class="paramname"><em>ilist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00075">75</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="variables__old_8h.html#structIBMListNode">IBMListNode</a> *current;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">while</span> (ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a>) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    current = ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a>-&gt;<a class="code" href="variables__old_8h.html#a5222a315981e705b07b070e49cb31f9d">next</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    PetscFree(ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a> = current;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="accdc3f1a3e5c7e95c6bdde11cde3b236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accdc3f1a3e5c7e95c6bdde11cde3b236">&#9670;&nbsp;</a></span>Divergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Divergence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02015">2015</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;{</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  DM        da = user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, fda = user-&gt;<a class="code" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  DMDALocalInfo info = user-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; </div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  PetscInt ti = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;  PetscInt  xs = info.xs, xe = info.xs + info.xm;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  PetscInt      ys = info.ys, ye = info.ys + info.ym;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  PetscInt  zs = info.zs, ze = info.zs + info.zm;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  PetscInt  mx = info.mx, my = info.my, mz = info.mz;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  PetscInt  lxs, lys, lzs, lxe, lye, lze;</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  PetscInt  i, j, k;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  Vec       Div;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  PetscReal ***div, ***aj, ***nvert,***p;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>    ***ucont;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  PetscReal maxdiv;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  lxs = xs; lxe = xe;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  lys = ys; lye = ye;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  lzs = zs; lze = ze;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160; </div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="keywordflow">if</span> (xs==0) lxs = xs+1;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="keywordflow">if</span> (ys==0) lys = ys+1;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="keywordflow">if</span> (zs==0) lzs = zs+1;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160; </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <span class="keywordflow">if</span> (xe==mx) lxe = xe-1;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;  <span class="keywordflow">if</span> (ye==my) lye = ye-1;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;  <span class="keywordflow">if</span> (ze==mz) lze = ze-1;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  DMDAVecGetArray(fda,user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;ucont);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;aj);</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  VecDuplicate(user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;Div);</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  DMDAVecGetArray(da, Div, &amp;div);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;   DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;         <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++){</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        <span class="keywordflow">if</span> (k==10 &amp;&amp; j==10 &amp;&amp; i==1){</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;          <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Pressure[10][10][1] =  %f | Pressure[10][10][0] =  %f  \n &quot;</span>,p[k][j][i],p[k][j][i-1]);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;              }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="keywordflow">if</span> (k==10 &amp;&amp; j==10 &amp;&amp; i==mx-3)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;              <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Pressure[10][10][%d] =  %f | Pressure[10][10][%d] =  %f  \n &quot;</span>,mx-2,p[k][j][mx-2],mx-1,p[k][j][mx-1]);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    }</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;   DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; </div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    maxdiv = fabs((ucont[k][j][i].x - ucont[k][j][i-1].x +</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;               ucont[k][j][i].y - ucont[k][j-1][i].y +</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;               ucont[k][j][i].z - ucont[k-1][j][i].z)*aj[k][j][i]);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <span class="keywordflow">if</span> (nvert[k][j][i] + nvert[k+1][j][i] + nvert[k-1][j][i] +</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        nvert[k][j+1][i] + nvert[k][j-1][i] +</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        nvert[k][j][i+1] + nvert[k][j][i-1] &gt; 0.1) maxdiv = 0.;</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    div[k][j][i] = maxdiv;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160; </div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    }</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  }</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    k=0;</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;      }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    }</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;  }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160; </div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">if</span> (ze == mz) {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    k=mz-1;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    }</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;  }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160; </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    i=0;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;      }</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  }</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    i=mx-1;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    div[k][j][i] = 0;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      }</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    }</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;  }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    j=0;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;  }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160; </div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    j=my-1;</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  }</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;  DMDAVecRestoreArray(da, Div, &amp;div);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  PetscInt MaxFlatIndex;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  VecMax(Div, &amp;MaxFlatIndex, &amp;maxdiv);</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;[Step %d]] The Maximum Divergence is %e at flat index %d.\n&quot;</span>,ti,maxdiv,MaxFlatIndex); </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a9285c06d5e6bee00c9061c27b2b73cb8">MaxDivFlatArg</a> = MaxFlatIndex;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;  user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a768740aa4a2ae69549670ebbfea58fc0">MaxDiv</a> = maxdiv;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="setup_8c.html#a3d538200fed5b9ee9d1ef391bb61036c">Gidx</a>(i,j,k,user) == MaxFlatIndex) {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;[Step %d] The Maximum Divergence(%e) is at location [%d][%d][%d]. \n&quot;</span>, ti, maxdiv,k,j,i);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;      user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a8b2e7f4d2e2e95e4c49aa02684e2e51d">MaxDivz</a> = k;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a8811a9a632140d00bca04337f2261d23">MaxDivy</a> = j;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a83e58d8ef2d285dc135be286ddc67f01">MaxDivx</a> = i;</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;      }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  }</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;  </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;ucont);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;aj);</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  VecDestroy(&amp;Div);</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="variables__old_8h_accdc3f1a3e5c7e95c6bdde11cde3b236_cgraph.svg" width="207" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="variables__old_8h_accdc3f1a3e5c7e95c6bdde11cde3b236_icgraph.svg" width="555" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a606c9c7fe576cda6af28d2b458e6acdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a606c9c7fe576cda6af28d2b458e6acdd">&#9670;&nbsp;</a></span>Flow_Solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Flow_Solver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *&#160;</td>
          <td class="paramname"><em>usermg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adcd96cff4b9e15e03cdff9f5ea695dec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd96cff4b9e15e03cdff9f5ea695dec">&#9670;&nbsp;</a></span>FormBCS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode FormBCS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="Boundaries_8c_source.html#l01261">1261</a> of file <a class="el" href="Boundaries_8c_source.html">Boundaries.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;{</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  DM            da = user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, fda = user-&gt;<a class="code" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  DMDALocalInfo info = user-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  PetscInt  xs = info.xs, xe = info.xs + info.xm;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  PetscInt      ys = info.ys, ye = info.ys + info.ym;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  PetscInt  zs = info.zs, ze = info.zs + info.zm;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  PetscInt  mx = info.mx, my = info.my, mz = info.mz;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  PetscInt  lxs, lxe, lys, lye, lzs, lze;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  PetscInt  i, j, k;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160; </div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  PetscReal ***nvert,***lnvert; <span class="comment">//local working array</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  PetscReal ***p,***lp;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>    ***ucont, ***ubcs, ***ucat,***lucat, ***csi, ***eta, ***zet;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>    ***cent,***centx,***centy,***centz,***coor;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  PetscScalar   FluxIn, FluxOut,ratio;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  PetscScalar   lArea, AreaSum;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  PetscScalar   FarFluxIn=0., FarFluxOut=0., FarFluxInSum, FarFluxOutSum;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  PetscScalar   FarAreaIn=0., FarAreaOut=0., FarAreaInSum, FarAreaOutSum;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  PetscScalar   FluxDiff, VelDiffIn, VelDiffOut;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>        V_frame;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  PetscReal Un, nx,ny,nz,A;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;  </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  lxs = xs; lxe = xe;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  lys = ys; lye = ye;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  lzs = zs; lze = ze;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  PetscInt  gxs, gxe, gys, gye, gzs, gze;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160; </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  gxs = info.gxs; gxe = gxs + info.gxm;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  gys = info.gys; gye = gys + info.gym;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  gzs = info.gzs; gze = gzs + info.gzm;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  <span class="keywordflow">if</span> (xs==0) lxs = xs+1;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">if</span> (ys==0) lys = ys+1;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <span class="keywordflow">if</span> (zs==0) lzs = zs+1;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordflow">if</span> (xe==mx ) lxe = xe-1;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;  <span class="keywordflow">if</span> (ye==my ) lye = ye-1;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="keywordflow">if</span> (ze==mz ) lze = ze-1;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables__old_8h.html#a6ef13ed6ab8f82c44bd8a81739ff90e2">Ubcs</a>, &amp;ubcs);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>,  &amp;csi);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>,  &amp;eta);</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>,  &amp;zet);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  PetscInt ttemp;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  <span class="keywordflow">for</span> (ttemp=0; ttemp&lt;3; ttemp++) {</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert); </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>,  &amp;ucat);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">/*   FAR-FIELD BC */</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  <span class="comment">// reset FAR FLUXES</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  FarFluxIn = 0.; FarFluxOut=0.;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  FarAreaIn = 0.; FarAreaOut=0.;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  PetscReal lFlux_abs=0.0,FluxSum_abs=0.0,ratio=0.0;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    V_frame.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=0.;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    V_frame.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=0.;</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    V_frame.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=0.;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160; </div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==6) {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keywordflow">if</span> (xs == 0) {</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      i= xs;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * csi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      FarFluxIn += ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      lFlux_abs += fabs(ucont[k][j][i].x);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;      FarAreaIn += csi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    </div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==6) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      i= xe-1;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      FarFluxOut += ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      lFlux_abs  += fabs(ucont[k][j][i-1].x);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      FarAreaOut += csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; </div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==6) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      j= ys;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      FarFluxIn += ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;      lFlux_abs += fabs(ucont[k][j][i].y);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;      FarAreaIn += eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      }</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==6) {</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      j=ye-1;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * eta[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      FarFluxOut += ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      lFlux_abs  += fabs(ucont[k][j-1][i].y);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      FarAreaOut += eta[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  }</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160; </div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==6 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==10) {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      k = 0;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      FarFluxIn += ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      lFlux_abs += fabs(ucont[k][j][i].z);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      FarAreaIn += zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==6 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==10) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      k = ze-1;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      FarFluxOut += ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      lFlux_abs  += fabs(ucont[k-1][j][i].z); </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      FarAreaOut += zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  MPI_Allreduce(&amp;FarFluxIn,&amp;FarFluxInSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  MPI_Allreduce(&amp;FarFluxOut,&amp;FarFluxOutSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;  MPI_Allreduce(&amp;lFlux_abs,&amp;FluxSum_abs,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD); </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  MPI_Allreduce(&amp;FarAreaIn,&amp;FarAreaInSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  MPI_Allreduce(&amp;FarAreaOut,&amp;FarAreaOutSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==6 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==6 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==6) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  </div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    ratio=(FarFluxInSum - FarFluxOutSum)/FluxSum_abs;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">if</span> (fabs(FluxSum_abs) &lt;1.e-10) ratio = 0.;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;/FluxSum_abs %le ratio %le \n&quot;</span>, FluxSum_abs,ratio);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    FluxDiff = 0.5*(FarFluxInSum - FarFluxOutSum) ;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    VelDiffIn  = FluxDiff / FarAreaInSum ;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordflow">if</span> (fabs(FarAreaInSum) &lt;1.e-6) VelDiffIn = 0.;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    VelDiffOut  = FluxDiff / FarAreaOutSum ;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    <span class="keywordflow">if</span> (fabs(FarAreaOutSum) &lt;1.e-6) VelDiffOut = 0.;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Far Flux Diff %d %le %le %le %le %le %le %le\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, FarFluxInSum, FarFluxOutSum, FluxDiff, FarAreaInSum, FarAreaOutSum, VelDiffIn, VelDiffOut);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;           </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==10) {</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    FluxDiff = simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a> -( FarFluxOutSum -FarFluxInSum) ;</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    VelDiffIn  = 1/3.*FluxDiff / (FarAreaInSum);<span class="comment">// +  FarsimCtx-&gt;AreaOutSum);</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">if</span> (fabs(FarAreaInSum) &lt;1.e-6) VelDiffIn = 0.;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    VelDiffOut  = 2./3.* FluxDiff / (FarAreaOutSum) ;<span class="comment">//(FarAreaInSum +  FarsimCtx-&gt;AreaOutSum) ;</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;   </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">if</span> (fabs(FarAreaOutSum) &lt;1.e-6) VelDiffOut = 0.;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Far Flux Diff %d %le %le %le %le %le %le %le\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, FarFluxInSum, FarFluxOutSum, FluxDiff, FarAreaInSum, FarAreaOutSum, VelDiffIn, VelDiffOut);</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;           </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">// scale global mass conservation</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==6 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==10) {</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;      k = ze-1;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>  += ratio*fabs(ucont[k-1][j][i].z);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      <span class="comment">//  ubcs[k][j][i].z = ucat[k-1][j][i].z + VelDiffOut ;//+ V_frame.z;</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;      <span class="comment">// ucont[k-1][j][i].z = ubcs[k][j][i].z * zet[k-1][j][i].z;</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;      }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  }</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160; </div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==6) {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;      j=ye-1;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +=ratio*fabs(ucont[k][j-1][i].y);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> /eta[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="comment">//      ubcs[k][j][i].y = ucat[k][j-1][i].y + VelDiffOut;// + V_frame.y;</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;      <span class="comment">// ucont[k][j-1][i].y = ubcs[k][j][i].y * eta[k][j-1][i].y;</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      }</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==6) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      i= xe-1;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +=ratio*fabs(ucont[k][j][i-1].x);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> / csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> ;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;      <span class="comment">//  ubcs[k][j][i].x = ucat[k][j][i-1].x + VelDiffOut;// + V_frame.x;</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;      <span class="comment">// ucont[k][j][i-1].x = ubcs[k][j][i].x * csi[k][j][i-1].x;</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  }</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==6) {</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">if</span> (xs == 0) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      i= xs;</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>  -=ratio*fabs(ucont[k][j][i].x);</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> / csi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="comment">// ubcs[k][j][i].x = ucat[k][j][i+1].x - VelDiffIn;// + V_frame.x;</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="comment">// ucont[k][j][i].x = ubcs[k][j][i].x * csi[k][j][i].x;</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==6) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      j= ys;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> -=ratio*fabs(ucont[k][j][i].y);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> / eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="comment">//      ubcs[k][j][i].y = ucat[k][j+1][i].y - VelDiffIn;// + V_frame.y;</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="comment">// ucont[k][j][i].y = ubcs[k][j][i].y * eta[k][j][i].y;</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    }</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  }</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  </div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==6 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==10) {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      k = 0;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> -=ratio*fabs(ucont[k][j][i].z);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> / zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;      <span class="comment">// ubcs[k][j][i].z = ucat[k+1][j][i].z - VelDiffIn;// + V_frame.z;</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;      <span class="comment">// ucont[k][j][i].z = ubcs[k][j][i].z * zet[k][j][i].z;</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;      }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">//// Amir wall Ogrid</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==1 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==-1)  {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    j= ys;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        A=sqrt(eta[k][j][i].z*eta[k][j][i].z +</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;               eta[k][j][i].y*eta[k][j][i].y +</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;               eta[k][j][i].x*eta[k][j][i].x);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        nx=eta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        ny=eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        nz=eta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        Un=ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;      }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment">/*   SOLID WALL BC (NO-SLIP / NO-PENETRATION) */</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">// NOTE: This block is added to explicitly handle bctype=1 (solid wall) for all faces.</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">// It ensures both no-slip (ubcs=0) and no-penetration (ucont_normal=0).</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">// ubcs is handled by the implicit-zero assumption, but ucont must be set explicitly.</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">// -X Face (i=0)</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==1 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==-1)  {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      i= xs;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;          ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0; <span class="comment">// Enforce no-penetration</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;}</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">// +X Face (i=mx-1)</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==1 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==-1)  {</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      i= xe-1;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;          <span class="comment">// The relevant ucont is at the face, index i-1</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0; <span class="comment">// Enforce no-penetration</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    }</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;}</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="comment">// -Y Face (j=0)</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==1 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==-1)  {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;      j= ys;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0; <span class="comment">// Enforce no-penetration</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;}</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">// +Y Face (j=my-1)</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==1 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==-1)  {</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      j= ye-1;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;          <span class="comment">// The relevant ucont is at the face, index j-1</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;          ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0; <span class="comment">// Enforce no-penetration</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;      }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;}</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment">/* Original &quot;Amir wall Ogrid&quot; block can now be removed or commented out</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment">   as its functionality is included above.</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment">if (user-&gt;bctype[2]==1 || user-&gt;bctype[2]==-1)  { ... }</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment">/*   SYMMETRY BC */</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==3) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    i= xs;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    A=sqrt(csi[k][j][i].z*csi[k][j][i].z +</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;           csi[k][j][i].y*csi[k][j][i].y +</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;           csi[k][j][i].x*csi[k][j][i].x);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    nx=csi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    ny=csi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    nz=csi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    Un=ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>-Un*nx;<span class="comment">//-V_frame.x;</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>-Un*ny;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>-Un*nz;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      }</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==3) {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    i= xe-1;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160; </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    A=sqrt(csi[k][j][i-1].z*csi[k][j][i-1].z +</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;           csi[k][j][i-1].y*csi[k][j][i-1].y +</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;           csi[k][j][i-1].x*csi[k][j][i-1].x);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    nx=csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    ny=csi[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    nz=csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    Un=ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>-Un*nx;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>-Un*ny;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>-Un*nz;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  }</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==3) {</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    j= ys;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    A=sqrt(eta[k][j][i].z*eta[k][j][i].z +</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;           eta[k][j][i].y*eta[k][j][i].y +</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;           eta[k][j][i].x*eta[k][j][i].x);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    nx=eta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    ny=eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    nz=eta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    Un=ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>-Un*nx;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>-Un*ny;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>-Un*nz;</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160; </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==3) {</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    j=ye-1;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    A=sqrt(eta[k][j-1][i].z*eta[k][j-1][i].z +</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;           eta[k][j-1][i].y*eta[k][j-1][i].y +</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;           eta[k][j-1][i].x*eta[k][j-1][i].x);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    nx=eta[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    ny=eta[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    nz=eta[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    Un=ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>-Un*nx;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>-Un*ny;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>-Un*nz;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==3) {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      k = 0;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    A=sqrt(zet[k][j][i].z*zet[k][j][i].z +</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;           zet[k][j][i].y*zet[k][j][i].y +</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;           zet[k][j][i].x*zet[k][j][i].x);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    nx=zet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    ny=zet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    nz=zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    Un=ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>-Un*nx;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>-Un*ny;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>-Un*nz;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;      }</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==3) {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;      k = ze-1;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    A=sqrt(zet[k-1][j][i].z*zet[k-1][j][i].z +</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;           zet[k-1][j][i].y*zet[k-1][j][i].y +</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;           zet[k-1][j][i].x*zet[k-1][j][i].x);</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    nx=zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/A;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    ny=zet[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/A;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    nz=zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/A;</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    Un=ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>*nx+ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>*ny+ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*nz;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>-Un*nx;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>-Un*ny;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>-Un*nz;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">/*     CHARACTERISTIC OUTLET BC :8 */</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==8) {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordflow">if</span> (ze == mz) {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;      k = ze-2;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;      FluxOut = 0;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      FluxOut += ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      }</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      FluxOut = 0.;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    FluxIn = simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a> + FarFluxInSum;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    MPI_Allreduce(&amp;FluxOut,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="comment">// PetscGlobalSum(PETSC_COMM_WORLD,&amp;FluxOut, &amp;FluxOutSum);</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160; </div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">//ratio = FluxInSum / FluxOutSum;</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    ratio = FluxIn / simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="keywordflow">if</span> (fabs(simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>) &lt; 1.e-6) ratio = 1.;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="comment">//if (fabs(FluxInSum) &lt;1.e-6) ratio = 0.;</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordflow">if</span> (fabs(FluxIn) &lt;1.e-6) ratio = 0.;</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Char Ratio %d %le %le %le %le %d %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, ratio, FluxIn, simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>, FarFluxInSum,zs, ze);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;      k = ze-1;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>==0 || simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>==1)</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a57b3c5733ac4acdef370e635e85df95f">inletprofile</a>&lt;0)</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = -1.;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==6)</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 1.;<span class="comment">//ubcs[0][j][i].z;//-1.;//1.;</span></div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>*ratio;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      </div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> / zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    }</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;      }</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    }</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  }</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  </div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">/*     OUTLETBC :4 */</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==<a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a> || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==14 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==20) {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    lArea=0.;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;+Zeta Outlet \n&quot;</span>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;     <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;FluxOutSum before FormBCS applied = %.6f \n&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordflow">if</span> (ze == mz) {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="comment">//    k = ze-3;</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      k=ze-1;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;      FluxOut = 0;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="keywordflow">if</span> ((nvert[k-1][j][i])&lt;0.1) {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      FluxOut += (ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * (zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>) +</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;              ucat[k-1][j][i].y * (zet[k-1][j][i].y) +</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;              ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * (zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>));</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;      lArea += sqrt( (zet[k-1][j][i].x) * (zet[k-1][j][i].x) +</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;             (zet[k-1][j][i].y) * (zet[k-1][j][i].y) +</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;             (zet[k-1][j][i].z) * (zet[k-1][j][i].z));</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;     </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;      }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;      }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;      FluxOut = 0.;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    }</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    MPI_Allreduce(&amp;FluxOut,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    MPI_Allreduce(&amp;lArea,&amp;AreaSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;   </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#aca7ff63d94b0fbd2d541734b7200b0e2">AreaOutSum</a> = AreaSum;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;AreaOutSum = %.6f | FluxOutSum = %.6f \n&quot;</span>,AreaSum,simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>);</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>&gt;1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==14) {</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a> += user-&gt;<a class="code" href="variables__old_8h.html#aa26cfafb620f75f7cf36a184604455ae">FluxIntfcSum</a>;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="comment">//      AreaSum    += user-&gt;AreaIntfcSum;</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    }</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    FluxIn = simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a> + FarFluxInSum + user-&gt;<a class="code" href="variables__old_8h.html#ad29bf4d78039031aef92981faa325c94">FluxIntpSum</a>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==20)</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      ratio = (FluxIn / simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      ratio = (FluxIn - simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>) / AreaSum;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;   </div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;     <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Ratio for momentum correction = %.6f \n&quot;</span>,ratio);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="comment">/*   user-&gt;FluxOutSum += ratio*user-&gt;simCtx-&gt;AreaOutSum; */</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a> =0.0;</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    FluxOut=0.0;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      k = ze-1;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="keywordflow">if</span> ((nvert[k-1][j][i])&lt;0.1) {</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;     </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;<span class="comment">//+ratio;</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;<span class="comment">// + ratio;//*n_z;</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="comment">//  ucont[k-1][j][i].z = ubcs[k][j][i].z * zet[k-1][j][i].z;</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==20)</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;          ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = (ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * (zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> ) +</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                    ubcs[k][j][i].y * (zet[k-1][j][i].y ) +</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * (zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> ))*ratio;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;          ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = (ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * (zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> ) +</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                    ubcs[k][j][i].y * (zet[k-1][j][i].y ) +</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;                    ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * (zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> ))</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        + ratio * sqrt( (zet[k-1][j][i].x) * (zet[k-1][j][i].x) +</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;                (zet[k-1][j][i].y) * (zet[k-1][j][i].y) +</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;                (zet[k-1][j][i].z) * (zet[k-1][j][i].z)); </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;          FluxOut += ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      }<span class="comment">//if</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      }</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    MPI_Allreduce(&amp;FluxOut,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Timestep = %d | FluxInSum = %.6f | FlucOutSum = %.6f | FluxIntfcSum = %.6f | FluxIntpSum = %.6f \n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>, simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>, user-&gt;<a class="code" href="variables__old_8h.html#aa26cfafb620f75f7cf36a184604455ae">FluxIntfcSum</a>,user-&gt;<a class="code" href="variables__old_8h.html#ad29bf4d78039031aef92981faa325c94">FluxIntpSum</a>);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==2) {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="comment">/* Designed for driven cavity problem (top(k=kmax) wall moving)</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="comment">   u_x = 1 at k==kmax */</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      k = ze-1;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.;<span class="comment">// - ucat[k-1][j][i].x;</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 1;<span class="comment">//sin(2*3.14*simCtx-&gt;step*simCtx-&gt;dt);//1.;//- ucat[k-1][j][i].y;</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.;<span class="comment">//- ucat[k-1][j][i].z;</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;      }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  }</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;  <span class="comment">/*   OUTLET at k==0 */</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==<a class="code" href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a>) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    lArea=0.;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keywordflow">if</span> (zs == 0) {</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;      k = zs;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;      <span class="comment">//      k= zs + 1;</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      FluxOut = 0;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160; </div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      FluxOut += ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> ;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      lArea += zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160; </div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    }</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      FluxOut = 0.;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    }</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    FluxIn = simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a> + FarFluxInSum;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; </div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    MPI_Allreduce(&amp;FluxOut,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    MPI_Allreduce(&amp;lArea,&amp;AreaSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    ratio = (simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a> - simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>) / AreaSum;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Ratio b %d  %le %le %le %le %d %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>,ratio, simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>, simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a>, AreaSum,zs, ze);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    </div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;      k = 0;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;     </div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = (ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ratio) * zet[k][j][i].z;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      }</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="comment">/*     Ogrid :77 */</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="comment">/* </span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment">  if (user-&gt;bctype[3]=77 &amp;&amp; Ogrid)</span></div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="comment">    {Cmpnts ***coor;</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;<span class="comment">      lArea=0.;</span></div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;<span class="comment">      FluxOut=0.0;</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="comment">      //    k = ze-3;</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;<span class="comment">      Vec Coor; DMGetCoordinatesLocal(da, &amp;Coor); </span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="comment">      DMDAVecGetArray(fda,Coor,&amp;coor);       </span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment">      if (ye==my) {</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="comment">    j=my-2;</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="comment">    for (k=lzs; k&lt;lze; k++){</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;<span class="comment">      for (i=lxs; i&lt;lxe; i++) {</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;<span class="comment">        </span></div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">          FluxOut += ucont[k][j][i].y;</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;<span class="comment">          lArea += sqrt( (eta[k-1][j][i].x) * (eta[k-1][j][i].x) +</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">                 (eta[k-1][j][i].y) * (eta[k-1][j][i].y) +</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;<span class="comment">                 (eta[k-1][j][i].z) * (eta[k-1][j][i].z));</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;<span class="comment">     </span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">      else {</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">    FluxOut = 0.;</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="comment">      MPI_Allreduce(&amp;FluxOut,&amp;FluxOutSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;<span class="comment">      MPI_Allreduce(&amp;lArea,&amp;AreaSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;<span class="comment">      user-&gt;FluxOutSum = FluxOutSum;</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">      simCtx-&gt;AreaOutSum = AreaSum;</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment">     export PL=&quot;$HOME/CSBL/Codes/fdf_project/pic_les&quot;</span></div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"> ratio=2*(FluxIn-FluxOutSum)/AreaSum;</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment">       ratio=0.0;   </span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment">      if (ye==my){</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment">    j=my-2;</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment">    for (k=lzs; k&lt;lze; k++){      </span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment">      for (i=lxs; i&lt;lxe; i++) { </span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">        if ((nvert[k-1][j][i])&lt;0.1 &amp;&amp; coor[k][j][i].z &gt;= 800.) {</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">          ucont[k][j][i].y *= (1+ratio);</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment">          </span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="comment">            </span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="comment">      if (ye==my){</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="comment">    j=my-2;</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">    for (k=lzs; k&lt;lze; k++){      </span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">      for (i=lxs; i&lt;lxe; i++) { </span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">        </span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">        ubcs[k][j+1][i].z=ucat[k][j][i].z;</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="comment">        ubcs[k][j+1][i].y=ucat[k][j][i].y;</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;<span class="comment">        ubcs[k][j+1][i].x=ucat[k][j][i].x;</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">      //   LOG_ALLOW(GLOBAL,LOG_DEBUG, &quot;  ratio %le &quot;,ratio);</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">/*     Channelz */</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; <span class="comment">// Amir channel flow correction</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; simCtx-&gt;<a class="code" href="variables_8h.html#a2e1d74f612f5443c8ece068511563453">channelz</a>==1) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; Vec Coor; DMGetCoordinatesLocal(da, &amp;Coor); </div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; DMDAVecGetArray(fda,Coor,&amp;coor); </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a>  ***uch;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables__old_8h.html#afbf649648426b009265d74fade4665ca">Uch</a>, &amp;uch);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    lArea=0.0;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;   <span class="comment">// if (zs==0) {</span></div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;   <span class="comment">// k=0;</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    FluxIn=0.0;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keywordtype">double</span> Fluxbcs=0.0, Fluxbcssum,ratiobcs;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;   <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    k=0;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;     Fluxbcs=0.0;      </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i]&lt;0.1){</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        Fluxbcs += ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160; </div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        lArea +=  sqrt((zet[k][j][i].x) * (zet[k][j][i].x) +</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;              (zet[k][j][i].y) * (zet[k][j][i].y) +</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;              (zet[k][j][i].z) * (zet[k][j][i].z));</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;      }</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    }</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    }</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    </div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160; </div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    <span class="comment">//int kk=(simCtx-&gt;step % (mz-2))+2;</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    <span class="keywordflow">for</span> (k=zs;k&lt;lze;k++){      </div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i]&lt;0.1){</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        FluxIn += ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> /((mz)-1);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;      }</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    }</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;      }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;   <span class="comment">// else {</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="comment">//   FluxIn=0.0;</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    MPI_Allreduce(&amp;FluxIn,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab6ee189c80a939393b9cfd780774966e">Fluxsum</a>,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    MPI_Allreduce(&amp;lArea,&amp;AreaSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    MPI_Allreduce(&amp;Fluxbcs,&amp;Fluxbcssum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160; </div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>==simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a> &amp;&amp; simCtx-&gt;<a class="code" href="variables_8h.html#a43fb110dc2ce420db6f659f6c055f086">rstart_flg</a> &amp;&amp; simCtx-&gt;<a class="code" href="variables_8h.html#a64c0b8cda05b216ac96fc09da38c3c70">ccc</a>==0) {</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;      simCtx-&gt;<a class="code" href="variables_8h.html#a64c0b8cda05b216ac96fc09da38c3c70">ccc</a>=1;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;      simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>=Fluxbcssum;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="comment">//  simCtx-&gt;FluxInSum=6.3908; </span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  FluxInSum %le .\n &quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;  </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>=6.35066; </div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        ratio=(simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>-simCtx-&gt;<a class="code" href="variables_8h.html#ab6ee189c80a939393b9cfd780774966e">Fluxsum</a>)/AreaSum;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a677188b3aedc7e7d0331e43f8f37ad02">ratio</a>=ratio;</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        ratiobcs=(simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>-Fluxbcssum)/AreaSum;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    k=0;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i]&lt;0.1){</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a1b08cdba1a7d4de048fbf472edfd5850">fish</a>) { </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;             ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+=ratiobcs * <span class="comment">/* (1.-exp(-500. * (1.-fabs(coor[k][j][i].y))))  */</span> sqrt( (zet[k+1][j][i].x) * (zet[k+1][j][i].x) + </div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                       (zet[k+1][j][i].y) * (zet[k+1][j][i].y) + </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                       (zet[k+1][j][i].z) * (zet[k+1][j][i].z)); </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            }</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160; </div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        uch[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=ratiobcs * <span class="comment">/* (1.-exp(-500. * (1.-fabs(coor[k][j][i].y)))) */</span>   sqrt( (zet[k+1][j][i].x) * (zet[k+1][j][i].x) +</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                       (zet[k+1][j][i].y) * (zet[k+1][j][i].y) +</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                       (zet[k+1][j][i].z) * (zet[k+1][j][i].z)); </div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;  </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;      k=mz-1;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i]&lt;0.1){</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a1b08cdba1a7d4de048fbf472edfd5850">fish</a>){</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;           ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+=ratiobcs * <span class="comment">/*(1.-exp(-500. * (1.-fabs(coor[k][j][i].y))))  */</span>    sqrt((zet[k-1][j][i].x) * (zet[k-1][j][i].x) + </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                       (zet[k-1][j][i].y) * (zet[k-1][j][i].y) + </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                       (zet[k-1][j][i].z) * (zet[k-1][j][i].z));    </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      }</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        uch[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=ratiobcs *   <span class="comment">/*(1.-exp(-500. * (1.-fabs(coor[k][j][i].y)))) */</span>     sqrt( (zet[k+1][j][i].x) * (zet[k+1][j][i].x) +</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                       (zet[k+1][j][i].y) * (zet[k+1][j][i].y) +</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                       (zet[k+1][j][i].z) * (zet[k+1][j][i].z)); </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      }</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      }</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables__old_8h.html#afbf649648426b009265d74fade4665ca">Uch</a>, &amp;uch);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Ratio  %le %.15le %.15le  %.15le \n&quot;</span>, ratio, ratiobcs, simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a>,AreaSum);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    DMDAVecRestoreArray(fda,Coor,&amp;coor); </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment">  ////.................////</span></div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment"></span>   </div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;   </div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="comment">//just for check</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">/*         if (zs==0) { */</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment">/*       k=10; */</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment">/*       FluxIn=0.0; */</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">/*       for (j=lys; j&lt;lye; j++) { */</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">/*  for (i=lxs; i&lt;lxe; i++) { */</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="comment">/*    if (nvert[k+1][j][i]&lt;0.1){ */</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="comment">/*      FluxIn += ucont[k][j][i].z; */</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="comment">/*      lArea += sqrt((zet[k+1][j][i].x) * (zet[k+1][j][i].x) + */</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="comment">/*            (zet[k+1][j][i].y) * (zet[k+1][j][i].y) + */</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="comment">/*            (zet[k+1][j][i].z) * (zet[k+1][j][i].z)); */</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="comment">/*    } */</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="comment">/*  } */</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="comment">/*       } */</span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="comment">/*  } */</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">/*     else { */</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">/*       FluxIn=0.0; */</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">/*     } */</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="comment">/*     // LOG_ALLOW(PETSC_COMM_SELF, &quot;  Fluxsum %le &quot;,FluxIn); */</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="comment">/*     MPI_Allreduce(&amp;FluxIn,&amp;Fluxsum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD); */</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="comment">/*     MPI_Allreduce(&amp;lArea,&amp;AreaSum,1,MPI_DOUBLE,MPI_SUM,PETSC_COMM_WORLD); */</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160; </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  }<span class="comment">//channel</span></div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160; </div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160; </div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <span class="comment">/*  ==================================================================================== */</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;  <span class="comment">/*     Cylinder O-grid */</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;  <span class="comment">/*  ==================================================================================== */</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==12) {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="comment">/* Designed to test O-grid for flow over a cylinder at jmax velocity is 1 (horizontal) </span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="comment">   u_x = 1 at k==kmax */</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      j = ye-1;</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 1.;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      }</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;  <span class="comment">/*  ==================================================================================== */</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  <span class="comment">/*     Annulus */</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="comment">/*  ==================================================================================== */</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="comment">/* designed to test periodic boundary condition for O-grid j=0 rotates */</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>, &amp;cent);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==11) {</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <span class="keywordflow">if</span> (ys==0){</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      j=0;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    </div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    <span class="comment">/*   ubcs[k][j][i].x=0.0; */</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;     </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="comment">/*    ubcs[k][j][i].y = -cent[k][j+1][i].z/sqrt(cent[k][j+1][i].z*cent[k][j+1][i].z+cent[k][j+1][i].y*cent[k][j+1][i].y); */</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;     </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="comment">/*    ubcs[k][j][i].z =cent[k][j+1][i].y/sqrt(cent[k][j+1][i].z*cent[k][j+1][i].z+cent[k][j+1][i].y*cent[k][j+1][i].y); */</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = cent[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/sqrt(cent[k][j+1][i].x*cent[k][j+1][i].x+cent[k][j+1][i].y*cent[k][j+1][i].y);;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> =-cent[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/sqrt(cent[k][j+1][i].x*cent[k][j+1][i].x+cent[k][j+1][i].y*cent[k][j+1][i].y);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="comment">//  if(k==1)  LOG_ALLOW(PETSC_COMM_SELF, &quot;@ i= %d j=%d k=%d ubcs.y is %le\n&quot;,i,j,k,ubcs[k][j][i].y);</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    }</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    }</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  <span class="comment">/*  ==================================================================================== */</span></div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <span class="comment">/*     Rheology */</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="comment">/*  ==================================================================================== */</span></div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160; </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  PetscOptionsGetReal(NULL,NULL, <span class="stringliteral">&quot;-simCtx-&gt;U_bc&quot;</span>, &amp;(simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a>), NULL);</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="comment">//  LOG_ALLOW(GLOBAL,LOG_DEBUG, &quot;moving plate velocity for rheology setup is %le \n&quot;,simCtx-&gt;U_bc);</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160; </div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==13){</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keywordflow">if</span> (ys==0){</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      j=0;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;       ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.;</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;      <span class="comment">// ubcs[k][j][i].x = -simCtx-&gt;U_bc;</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = -simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a>;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;      <span class="comment">//ubcs[k][j][i].z =0.0;</span></div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    }</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      }</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    }</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==13){</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="keywordflow">if</span> (ye==my){</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;      j=ye-1;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="comment">// ubcs[k][j][i].x = simCtx-&gt;U_bc;</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a>;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;       <span class="comment">//ubcs[k][j][i].z =0.0;</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;      }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    }</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160; </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==13){</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    <span class="keywordflow">if</span> (zs==0){</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      k=0;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> =-simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a>;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    }</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      }</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;    }</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==13){</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    <span class="keywordflow">if</span> (ze==mz){</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;      k=ze-1;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a>;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    }</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;  }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>, &amp;cent);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, &amp;ucat);</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; </div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160; </div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <a class="code" href="setup_8h.html#a515c9a96eb4bcac29f79e78c8882d7aa">Contra2Cart</a>(user); <span class="comment">// it also does global to local for Ucat</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="comment">/*   WALL FUNCTION */</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#aa60ee4e3f8eca251ee470427f1ebac13">wallfunction</a> &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==-1) {</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;  PetscReal ***ustar, ***aj;</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="comment">//Mohsen Dec 2015</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  Vec Aj  =  user-&gt;<a class="code" href="variables__old_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  DMDAVecGetArray(da, Aj,  &amp;aj);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">//  DMDAVecGetArray(da, user-&gt;Nvert, &amp;nvert);</span></div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a58d3237c97d6f16130867370858d5bad">lUstar</a>, &amp;ustar);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160; </div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;  <span class="comment">// wall function for boundary</span></div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;  <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++)</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160; </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    <span class="keywordflow">if</span>( nvert[k][j][i]&lt;1.1 &amp;&amp;  user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==-1 &amp;&amp; j==1 )</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;     {</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;      <span class="keywordtype">double</span> area = sqrt( eta[k][j][i].x*eta[k][j][i].x + eta[k][j][i].y*eta[k][j][i].y + eta[k][j][i].z*eta[k][j][i].z );</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      <span class="keywordtype">double</span> sb, sc;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;      <span class="keywordtype">double</span> ni[3], nj[3], nk[3];</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;      <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> Uc, Ua;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      Ua.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = Ua.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = Ua.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0;</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      sb = 0.5/aj[k][j][i]/area;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;      </div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        sc = 2*sb + 0.5/aj[k][j+1][i]/area;</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        Uc = ucat[k][j+1][i];</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      </div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;      </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="comment">//Calculate_normal(csi[k][j][i], eta[k][j][i], zet[k][j][i], ni, nj, nk);</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">//if(j==my-2) nj[0]*=-1, nj[1]*=-1, nj[2]*=-1;</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;         <span class="keywordtype">double</span> AA=sqrt(eta[k][j][i].z*eta[k][j][i].z +</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;               eta[k][j][i].y*eta[k][j][i].y +</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;               eta[k][j][i].x*eta[k][j][i].x);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    nj[0]=eta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>/AA;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        nj[1]=eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>/AA;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        nj[2]=eta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>/AA;     </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;      <a class="code" href="wallfunction_8h.html#a82a96fd4f826d93b926bea9bb776b93e">noslip</a> (user, sc, sb, Ua, Uc, &amp;ucat[k][j][i], nj[0], nj[1], nj[2]);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <a class="code" href="wallfunction_8h.html#aae67d9282b09691fffdea6f1012e6df7">wall_function_loglaw</a>(user, 1.e-16, sc, sb, Ua, Uc, &amp;ucat[k][j][i], &amp;ustar[k][j][i], nj[0], nj[1], nj[2]);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;     <span class="comment">// nvert[k][j][i]=1.;  /* set nvert to 1 to exclude from rhs */</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="comment">// if (k==1) </span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      <span class="comment">// LOG_ALLOW(GLOBAL,LOG_DEBUG, &quot; %d   %le   %le  %le   %le   %le   %le   %le   %le   %le\n&quot;,i, sb,aj[k][j][i],AA, nj[0], nj[1], nj[2],ucat[k][j][i].x,ucat[k][j][i].y,ucat[k][j][i].z);</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160; </div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    }</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;      }</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    j= ys;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    }</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160; </div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;  DMDAVecRestoreArray(da, Aj,  &amp;aj);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a58d3237c97d6f16130867370858d5bad">lUstar</a>, &amp;ustar);</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; <span class="comment">// DMDAVecRestoreArray(da, user-&gt;Nvert, &amp;nvert);</span></div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; <span class="comment">// DMGlobalToLocalBegin(da, user-&gt;Nvert, INSERT_VALUES, user-&gt;lNvert);</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; <span class="comment">// DMGlobalToLocalEnd(da, user-&gt;Nvert, INSERT_VALUES, user-&gt;lNvert);</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="comment">//   DMLocalToGlobalBegin(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); </span></div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="comment">//   DMLocalToGlobalEnd(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); </span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160; </div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160; </div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <span class="comment">// boundary conditions on ghost nodes</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;  <span class="keywordflow">if</span> (xs==0 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7) {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    i = xs;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      }</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  }</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;  <span class="keywordflow">if</span> (xe==mx &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7) {</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    i = xe-1;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;      }</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  }</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160; </div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160; </div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <span class="keywordflow">if</span> (ys==0 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7) {</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    j = ys;</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      }</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160; </div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  <span class="keywordflow">if</span> (ye==my &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7) {</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    j = ye-1;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;      }</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;    }</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  }</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160; </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <span class="keywordflow">if</span> (zs==0 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7) {</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    k = zs;</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      }</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    }</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;  }</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160; </div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;  <span class="keywordflow">if</span> (ze==mz &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7) {</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    k = ze-1;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 2 * ubcs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      }</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  }</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160; </div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;ucat);</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; <span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;  <span class="comment">/*   Periodic BC */</span><span class="comment">//Mohsen</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7){</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="comment">/* /\*   DMGlobalToLocalBegin(da, user-&gt;Nvert, INSERT_VALUES, user-&gt;lNvert); *\/ */</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="comment">/* /\*   DMGlobalToLocalEnd(da, user-&gt;Nvert, INSERT_VALUES, user-&gt;lNvert); *\/ */</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;  <span class="comment">//Mohsen Dec 2015</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, &amp;lucat);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;   </div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==7){</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;      <span class="keywordflow">if</span> (xs==0){</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    i=xs;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        <span class="keywordflow">if</span>(j&gt;0 &amp;&amp; k&gt;0 &amp;&amp; j&lt;user-&gt;JM &amp;&amp; k&lt;user-&gt;KM){</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;          ucat[k][j][i]=lucat[k][j][i-2];</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;          p[k][j][i]=lp[k][j][i-2];</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;          nvert[k][j][i]=lnvert[k][j][i-2];</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        }</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      }</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    }</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;    }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==7){</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <span class="keywordflow">if</span> (ys==0){</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    j=ys;</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        <span class="keywordflow">if</span>(i&gt;0 &amp;&amp; k&gt;0 &amp;&amp; i&lt;user-&gt;IM &amp;&amp; k&lt;user-&gt;KM){</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;          ucat[k][j][i]=lucat[k][j-2][i];</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;          p[k][j][i]=lp[k][j-2][i];</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;          nvert[k][j][i]=lnvert[k][j-2][i];</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;        }</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;      }</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==7){</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;      <span class="keywordflow">if</span> (zs==0){</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    k=zs;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <span class="keywordflow">if</span>(i&gt;0 &amp;&amp; j&gt;0 &amp;&amp; i&lt;user-&gt;IM &amp;&amp; j&lt;user-&gt;JM){</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;          ucat[k][j][i]=lucat[k-2][j][i];</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;          nvert[k][j][i]=lnvert[k-2][j][i];</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;          <span class="comment">//amir</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;        p[k][j][i]=lp[k-2][j][i];</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        }</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;      }</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    }</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      }</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    }</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==7){</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      <span class="keywordflow">if</span> (xe==mx){</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    i=mx-1;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        <span class="keywordflow">if</span>(j&gt;0 &amp;&amp; k&gt;0 &amp;&amp; j&lt;user-&gt;JM &amp;&amp; k&lt;user-&gt;KM){</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;          ucat[k][j][i]=lucat[k][j][i+2];</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;          p[k][j][i]=lp[k][j][i+2];</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;          nvert[k][j][i]=lnvert[k][j][i+2];</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        }</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      }</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    }</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      }</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    }</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==7){</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      <span class="keywordflow">if</span> (ye==my){</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    j=my-1;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        <span class="keywordflow">if</span>(i&gt;0 &amp;&amp; k&gt;0 &amp;&amp; i&lt;user-&gt;IM &amp;&amp; k&lt;user-&gt;KM){</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;          ucat[k][j][i]=lucat[k][j+2][i];</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;          p[k][j][i]=lp[k][j+2][i];</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;          nvert[k][j][i]=lnvert[k][j+2][i];</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        }</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      }</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;      }</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    }</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;  </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==7){</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      <span class="keywordflow">if</span> (ze==mz){</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    k=mz-1;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        <span class="keywordflow">if</span>(i&gt;0 &amp;&amp; j&gt;0 &amp;&amp; i&lt;user-&gt;IM &amp;&amp; j&lt;user-&gt;JM){</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;          ucat[k][j][i]=lucat[k+2][j][i];</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;              nvert[k][j][i]=lnvert[k+2][j][i]; </div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;          <span class="comment">//amir</span></div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        p[k][j][i]=lp[k+2][j][i];</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        }</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      }</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;    }</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      }</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;    }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160; </div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;       </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160; </div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160; </div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, &amp;lucat);</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="comment">/*  /\*  DMLocalToGlobalBegin(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); *\/ */</span></div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="comment">/* /\*   DMLocalToGlobalEnd(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); *\/ */</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160; </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">/* /\*   DMLocalToGlobalBegin(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); *\/ */</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="comment">/* /\*   DMLocalToGlobalEnd(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); *\/ */</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="comment">/* /\*   DMLocalToGlobalBegin(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); *\/ */</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="comment">/* /\*   DMLocalToGlobalEnd(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); *\/ */</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;  }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; <span class="comment">// 0 velocity on the corner point</span></div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160; </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;  </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    k=0;</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;      i=0;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    p[k][j][i]= 0.5*(p[k+1][j][i]+p[k][j][i+1]);</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;      }</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="keywordflow">if</span> (xe == mx) {</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;      i=mx-1;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    p[k][j][i] = 0.5*(p[k+1][j][i]+p[k][j][i-1]);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;      }</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;    }</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160; </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;      j=0;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    p[k][j][i] = 0.5*(p[k+1][j][i]+p[k][j+1][i]);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      }</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    }</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160; </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      j=my-1;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    p[k][j][i] = 0.5*(p[k+1][j][i]+p[k][j-1][i]);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;      }</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    }</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  }</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160; </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    k=mz-1;</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;      i=0;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    p[k][j][i] = 0.5*(p[k-1][j][i]+p[k][j][i+1]);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      }</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    }</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    <span class="keywordflow">if</span> (xe == mx) {</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;      i=mx-1;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;    p[k][j][i] = 0.5*(p[k-1][j][i]+p[k][j][i-1]);</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      }</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;    }</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160; </div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      j=0;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    p[k][j][i] = 0.5*(p[k-1][j][i]+p[k][j+1][i]);</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      }</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    }</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160; </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      j=my-1;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    p[k][j][i] = 0.5*(p[k-1][j][i]+p[k][j-1][i]);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;      }</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    }</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;  }</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160; </div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;  <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    j=0;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      i=0;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    p[k][j][i]= 0.5*(p[k][j+1][i]+p[k][j][i+1]);</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      }</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    }</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160; </div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      i=mx-1;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k][j+1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    p[k][j][i] = 0.5*(p[k][j+1][i]+p[k][j][i-1]);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      }</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    }</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;  }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    j=my-1;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      i=0;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i+1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    p[k][j][i] = 0.5*(p[k][j-1][i]+p[k][j][i+1]);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      }</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    }</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      i=mx-1;</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.5*(ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.5*(ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.5*(ucat[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>+ucat[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    p[k][j][i] = 0.5*(p[k][j-1][i]+p[k][j][i-1]);</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      }</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    }</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;  }</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160; </div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;ucat);</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;  DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;  DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160; </div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;  DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;  DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160; </div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <span class="comment">//Mohsen Nov 2012</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  <span class="comment">//Velocity and Presurre at corners for Periodic BC&#39;s</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160; </div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7){</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;  <span class="comment">//i-direction</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160; </div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>,  &amp;lucat);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;ucat);</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7){</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      <span class="keywordflow">if</span> (xs==0){</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    i=xs;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        ucat[k][j][i]=lucat[k][j][i-2];</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        p[k][j][i]=lp[k][j][i-2];</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        nvert[k][j][i]=lnvert[k][j][i-2];</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      }</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;      }</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==7){</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <span class="keywordflow">if</span> (xe==mx){</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    i=xe-1;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=lucat[k][j][i+2].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        p[k][j][i]=lp[k][j][i+2];</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        nvert[k][j][i]=lnvert[k][j][i+2];</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      }</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;    }</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;      }</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    }</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, &amp;lucat);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160; </div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160; <span class="comment">/*  DMLocalToGlobalBegin(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); */</span></div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); */</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160; </div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); */</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); */</span></div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); */</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); */</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;    DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;    </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    </div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;    </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    <span class="comment">//j-direction</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>,  &amp;lucat);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;ucat);</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;    </div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7){</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      <span class="keywordflow">if</span> (ys==0){</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    j=ys;</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;        ucat[k][j][i]=lucat[k][j-2][i];</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;        p[k][j][i]=lp[k][j-2][i];</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;        nvert[k][j][i]=lnvert[k][j-2][i];</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      }</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;    }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      }</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;    }</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    </div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==7){</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;      <span class="keywordflow">if</span> (ye==my){</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    j=my-1;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        ucat[k][j][i]=lucat[k][j+2][i];</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        p[k][j][i]=lp[k][j+2][i];</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        nvert[k][j][i]=lnvert[k][j+2][i];</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      }</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    }</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    }</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;    </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, &amp;lucat);</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    </div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); */</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); */</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160; </div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); */</span></div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); */</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160; </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); */</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); */</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160; </div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    </div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    </div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <span class="comment">//k-direction</span></div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>,  &amp;lucat);</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;ucat);</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    </div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7){</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      <span class="keywordflow">if</span> (zs==0){</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    k=zs;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        ucat[k][j][i]=lucat[k-2][j][i];</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        nvert[k][j][i]=lnvert[k-2][j][i]; </div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;        <span class="comment">//amir   </span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;          p[k][j][i]=lp[k-2][j][i];</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      }</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    }</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    }</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==7){</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;      <span class="keywordflow">if</span> (ze==mz){</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    k=mz-1;</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        ucat[k][j][i]=lucat[k+2][j][i];</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;        nvert[k][j][i]=lnvert[k+2][j][i];</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;          p[k][j][i]=lp[k+2][j][i];</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;      }</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      }</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;    }</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    </div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, &amp;lucat);</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;lp);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert);</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;    </div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); */</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(fda, user-&gt;lUcat, INSERT_VALUES, user-&gt;Ucat); */</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160; </div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); */</span></div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(da, user-&gt;lP, INSERT_VALUES, user-&gt;P); */</span></div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160; </div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;<span class="comment">/*   DMLocalToGlobalBegin(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); */</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;<span class="comment">/*   DMLocalToGlobalEnd(da, user-&gt;lNvert, INSERT_VALUES, user-&gt;Nvert); */</span></div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160; </div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;    DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;    </div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;    DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  }</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;<span class="comment">/*   Analytical Vortex BC */</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;<span class="comment">/* ==================================================================================             */</span></div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160; </div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;ucat);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>, &amp;cent); </div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a77888fe1930df923549faaf5951455ba">Centx</a>, &amp;centx);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#addaea1781031d3f9ff945d87e8c5b728">Centy</a>, &amp;centy);</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a3998b7b5dad8340caf395c5da62230b7">Centz</a>, &amp;centz);</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160; </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==9) {</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;      i= xs;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=-cos(cent[k][j][i+1].x)*sin(cent[k][j][i+1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=-sin(cent[k][j][i+1].x)*cos(cent[k][j][i+1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;     </div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> =-(cos(centx[k][j][i].x)*sin(centx[k][j][i].y)*csi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    }</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;      }</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    j=ys;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=cos(cent[k][j+1][i+1].x)*sin(cent[k][j+1][i+1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=-sin(cent[k][j+1][i+1].x)*cos(cent[k][j+1][i+1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    }</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      }</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;    j=ye-1;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=cos(cent[k][j-1][i+1].x)*sin(cent[k][j-1][i+1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=-sin(cent[k][j-1][i+1].x)*cos(cent[k][j-1][i+1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    }</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;      }</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    }</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;  }</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==9) {</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      i= xe-1;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=-cos(cent[k][j][i-1].x)*sin(cent[k][j][i-1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=-sin(cent[k][j][i-1].x)*cos(cent[k][j][i-1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;    </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      ucont[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> =(-cos(centx[k][j][i-1].x)*sin(centx[k][j][i-1].y)*csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    }</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      }</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    j=ys;</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=cos(cent[k][j+1][i-1].x)*sin(cent[k][j+1][i-1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=-sin(cent[k][j+1][i-1].x)*cos(cent[k][j+1][i-1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;    }</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      }</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    j=ye-1;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=cos(cent[k][j-1][i-1].x)*sin(cent[k][j-1][i-1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=-sin(cent[k][j-1][i-1].x)*cos(cent[k][j-1][i-1].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    }</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;      }</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    }</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;  }</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==9) {</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;    <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      j= ys;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=cos(cent[k][j+1][i].x)*sin(cent[k][j+1][i].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=sin(cent[k][j+1][i].x)*cos(cent[k][j+1][i].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=(sin(centy[k][j][i].x)*cos(centy[k][j][i].y)*eta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    }</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      }</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;    }</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;  }</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160; </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==9) {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;      j= ye-1;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=cos(cent[k][j-1][i].x)*sin(cent[k][j-1][i].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=sin(cent[k][j-1][i].x)*cos(cent[k][j-1][i].y)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.0;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;    </div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;      ucont[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=(sin(centy[k][j-1][i].x)*cos(centy[k][j-1][i].y)*eta[k][j-1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>)*exp(-2.0*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>*(simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>+1)/simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;    }</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;      }</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;    }</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==9) {</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;      k= zs;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=ucat[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160; </div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=0.0;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    }</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;      }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    }</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;  }</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==9) {</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="keywordflow">if</span> (ze==mz) {</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;      k= ze-1;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      ucat[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=ucat[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160; </div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      ucont[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=0.0;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    }</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      }</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    }</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>, &amp;cent);</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a77888fe1930df923549faaf5951455ba">Centx</a>, &amp;centx);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#addaea1781031d3f9ff945d87e8c5b728">Centy</a>, &amp;centy);</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a3998b7b5dad8340caf395c5da62230b7">Centz</a>, &amp;centz);</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160; </div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;ucat);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>,  &amp;ucont);</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160; </div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  } <span class="comment">// ttemp</span></div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160; </div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; </div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables__old_8h.html#a6ef13ed6ab8f82c44bd8a81739ff90e2">Ubcs</a>, &amp;ubcs);</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>,  &amp;csi);</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>,  &amp;eta);</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>,  &amp;zet);</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160; </div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  DMGlobalToLocalBegin(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  DMGlobalToLocalEnd(da, user-&gt;<a class="code" href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;  DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;  DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>);</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;  DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>); </div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160; </div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  }</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="variables__old_8h_adcd96cff4b9e15e03cdff9f5ea695dec_cgraph.svg" width="100%" height="423"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="variables__old_8h_adcd96cff4b9e15e03cdff9f5ea695dec_icgraph.svg" width="362" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae8a0a7cb4587034d295f6c7f23d70465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a0a7cb4587034d295f6c7f23d70465">&#9670;&nbsp;</a></span>FormFunction1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode FormFunction1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>Rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the Right-Hand-Side (RHS) of the momentum equations. </p>
<p>Computes the Right-Hand Side (RHS) of the momentum equations.</p>
<p>This function orchestrates the calculation of the spatial discretization of the convective and diffusive terms. It calls specialized helper functions (<code>Convection</code>, <code>Viscous</code>) to compute these terms and then combines them with the pressure gradient to form the final RHS vector.</p>
<p>This is a minimally-edited version of the legacy kernel. It operates on a single <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> (one grid block) and retrieves all global parameters (Re, rans, les, etc.) from the master <a class="el" href="variables_8h.html#structSimCtx" title="The master context for the entire simulation.">SimCtx</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> for the specific block being computed. </td></tr>
    <tr><td class="paramname">Rhs</td><td>The PETSc Vec where the calculated RHS will be stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="rhs_8c_source.html#l01231">1231</a> of file <a class="el" href="rhs_8c_source.html">rhs.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;{</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    DM da = user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, fda = user-&gt;<a class="code" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    DMDALocalInfo info = user-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    PetscInt i,j,k;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    PetscReal dpdc, dpde,dpdz;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="comment">// --- Local Grid Indices and Parameters ---</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    PetscInt xs = info.xs, xe = xs + info.xm, mx = info.mx;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    PetscInt ys = info.ys, ye = ys + info.ym, my = info.my;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    PetscInt zs = info.zs, ze = zs + info.zm, mz = info.mz;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    PetscInt lxs = (xs==0) ? xs+1 : xs;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    PetscInt lys = (ys==0) ? ys+1 : ys;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    PetscInt lzs = (zs==0) ? zs+1 : zs;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    PetscInt lxe = (xe==mx) ? xe-1 : xe;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    PetscInt lye = (ye==my) ? ye-1 : ye;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    PetscInt lze = (ze==mz) ? ze-1 : ze;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    PetscInt mz_end = (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5] == 8) ? mz - 2 : mz - 3;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="comment">// --- Array Pointers ---</span></div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***csi, ***eta, ***zet, ***icsi, ***ieta, ***izet, ***jcsi, ***jeta, ***jzet, ***kcsi, ***keta, ***kzet;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    PetscReal ***p, ***iaj, ***jaj, ***kaj, ***aj, ***nvert, ***nvert_o;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***rhs, ***rc, ***rct,***ucont;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="comment">// --- Temporary Vectors ---</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    Vec Conv, Visc, Rc, Rct;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d, Block %d: Computing RHS (FormFunction1)...\n&quot;</span>,</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;              simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, user-&gt;<a class="code" href="variables__old_8h.html#a4f7c5fd8843d026101b193e9236e1192">_this</a>);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">// --- Get all necessary array pointers ---</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;csi); CHKERRQ(ierr);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>, &amp;eta); CHKERRQ(ierr);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>, &amp;zet); CHKERRQ(ierr);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    ierr = DMDAVecGetArrayRead(da,  user-&gt;<a class="code" href="variables__old_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>,  &amp;aj);  CHKERRQ(ierr);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>, &amp;icsi); CHKERRQ(ierr);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>, &amp;ieta); CHKERRQ(ierr);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>, &amp;izet); CHKERRQ(ierr);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>, &amp;jcsi); CHKERRQ(ierr);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>, &amp;jeta); CHKERRQ(ierr);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>, &amp;jzet); CHKERRQ(ierr);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>, &amp;kcsi); CHKERRQ(ierr);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>, &amp;keta); CHKERRQ(ierr);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    ierr = DMDAVecGetArrayRead(fda, user-&gt;<a class="code" href="variables__old_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>, &amp;kzet); CHKERRQ(ierr);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    ierr = DMDAVecGetArrayRead(da, user-&gt;<a class="code" href="variables__old_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>, &amp;iaj); CHKERRQ(ierr);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    ierr = DMDAVecGetArrayRead(da, user-&gt;<a class="code" href="variables__old_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>, &amp;jaj); CHKERRQ(ierr);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    ierr = DMDAVecGetArrayRead(da, user-&gt;<a class="code" href="variables__old_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>, &amp;kaj); CHKERRQ(ierr);</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    ierr = DMDAVecGetArrayRead(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;p); CHKERRQ(ierr);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    ierr = DMDAVecGetArrayRead(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert); CHKERRQ(ierr);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    ierr = DMDAVecGetArray(fda, Rhs, &amp;rhs); CHKERRQ(ierr);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="comment">// --- Create temporary work vectors ---</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    ierr = VecDuplicate(user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;Rc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    ierr = VecDuplicate(Rc, &amp;Rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    ierr = VecDuplicate(Rct, &amp;Conv); CHKERRQ(ierr);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    ierr = VecDuplicate(Rct, &amp;Visc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="comment">// ========================================================================</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">//   CORE LOGIC (UNCHANGED FROM LEGACY CODE)</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="comment">// ========================================================================</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="comment">// 1. Obtain Cartesian velocity from Contravariant velocity</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    ierr = <a class="code" href="setup_8h.html#a515c9a96eb4bcac29f79e78c8882d7aa">Contra2Cart</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160; </div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="comment">// 2. Compute Convective term</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  Calculating convective terms...\n&quot;</span>);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a0ca5cdac6f3648539846966855d2b75a">moveframe</a> || simCtx-&gt;<a class="code" href="variables_8h.html#aecc33b61ded0b8c01e2524094af2504a">rotateframe</a>) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;      <span class="comment">// ierr = Convection_MV(user, user-&gt;lUcont, user-&gt;lUcat, Conv); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        ierr = <a class="code" href="rhs_8c.html#a59a4e489633014a0f4e1e85318d395d3">Convection</a>(user, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, Conv); CHKERRQ(ierr);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">// 3. Compute Viscous term</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a7af448f97fbebfd44e5989614b982a93">invicid</a>) {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        ierr = VecSet(Visc, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  Calculating viscous terms...\n&quot;</span>);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        ierr = <a class="code" href="rhs_8c.html#a3e0cf2a027c25bb1f6510d4a7e5d4870">Viscous</a>(user, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, user-&gt;<a class="code" href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, Visc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    }</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="comment">// 4. Combine terms to get Cartesian RHS: Rc = Visc - Conv</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    ierr = VecWAXPY(Rc, -1.0, Conv, Visc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// 5. Convert Cartesian RHS (Rc) to Contravariant RHS (Rct)</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  Converting Cartesian RHS to Contravariant RHS...\n&quot;</span>);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    ierr = DMDAVecGetArray(fda, Rct, &amp;rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    ierr = DMDAVecGetArray(fda, Rc, &amp;rc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    </div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">for</span> (k = lzs; k &lt; lze; k++) {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="keywordflow">for</span> (j = lys; j &lt; lye; j++) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <span class="keywordflow">for</span> (i = lxs; i &lt; lxe; i++) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                rct[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = aj[k][j][i] *</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                    (0.5 * (csi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>) * rc[k][j][i].x +</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                     0.5 * (csi[k][j][i].y + csi[k][j][i-1].y) * rc[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                     0.5 * (csi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + csi[k][j][i-1].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * rc[k][j][i].z);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                rct[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = aj[k][j][i] *</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                    (0.5 * (eta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + eta[k][j-1][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>) * rc[k][j][i].x +</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                     0.5 * (eta[k][j][i].y + eta[k][j-1][i].y) * rc[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                     0.5 * (eta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + eta[k][j-1][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * rc[k][j][i].z);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                rct[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = aj[k][j][i] *</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                    (0.5 * (zet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>) * rc[k][j][i].x +</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                     0.5 * (zet[k][j][i].y + zet[k-1][j][i].y) * rc[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                     0.5 * (zet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + zet[k-1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * rc[k][j][i].z);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    ierr = DMDAVecRestoreArray(fda, Rct, &amp;rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    ierr = DMDAVecRestoreArray(fda, Rc, &amp;rc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    PetscBarrier(NULL);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    DMLocalToLocalBegin(fda, Rct, INSERT_VALUES, Rct);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    DMLocalToLocalEnd(fda, Rct, INSERT_VALUES, Rct);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    DMDAVecGetArray(fda, Rct, &amp;rct);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[1]==7){</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <span class="keywordflow">if</span> (xs==0){</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    i=xs;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        rct[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=rct[k][j][i-2].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;      <span class="keywordflow">if</span> (xe==mx){</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    i=mx-1;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        rct[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=rct[k][j][i+2].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      }</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[3]==7){</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="keywordflow">if</span> (ys==0){</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    j=ys;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        rct[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=rct[k][j-2][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;      }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keywordflow">if</span> (ye==my){</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    j=my-1;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        rct[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=rct[k][j+2][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;      }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;      }</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 || user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[5]==7){</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;      <span class="keywordflow">if</span> (zs==0){</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    k=zs;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        rct[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=rct[k-2][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="keywordflow">if</span> (ze==mz){</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    k=mz-1;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        rct[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=rct[k+2][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      }</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      }</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="comment">// 6. Add Pressure Gradient Term and Finalize RHS</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">// This involves calculating pressure derivatives (dpdc, dpde, dpdz) and using</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// them to adjust the contravariant RHS. The full stencil logic is preserved.</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  Adding pressure gradient term to RHS...\n&quot;</span>);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    ierr = DMDAVecRestoreArray(fda, Rct, &amp;rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    ierr = DMLocalToLocalBegin(fda, Rct, INSERT_VALUES, Rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    ierr = DMLocalToLocalEnd(fda, Rct, INSERT_VALUES, Rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    ierr = DMDAVecGetArray(fda, Rct, &amp;rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="keywordflow">for</span> (k = lzs; k &lt; lze; k++) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">for</span> (j = lys; j &lt; lye; j++) {</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            <span class="keywordflow">for</span> (i = lxs; i &lt; lxe; i++) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                PetscReal dpdc, dpde, dpdz;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    dpdc = p[k][j][i+1] - p[k][j][i];</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">if</span> ((j==my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        dpde = (p[k][j  ][i] + p[k][j  ][i+1] -</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j==my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        dpde = (p[k][j  ][i] + p[k][j  ][i+1] -</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;      }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7) || nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            p[k][j  ][i] - p[k][j  ][i+1]) * 0.5;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            p[k][j  ][i] - p[k][j  ][i+1]) * 0.5;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;      }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    }</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;          p[k][j-1][i] - p[k][j-1][i+1]) * 0.25;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7) || nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j][i+1] -</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            p[k-1][j][i] - p[k-1][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      }</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((k == mz-2 || k==1) &amp;&amp;  user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j][i+1] -</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            p[k-1][j][i] - p[k-1][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            p[k  ][j][i] - p[k  ][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;      }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            p[k  ][j][i] - p[k  ][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      }</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;          p[k-1][j][i] - p[k-1][j][i+1]) * 0.25;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> =0.5 * (rct[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + rct[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    </div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> -=</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      (dpdc * (icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;           icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;           icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)+</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;       dpde * (ieta[k][j][i].x * icsi[k][j][i].x +</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;           ieta[k][j][i].y * icsi[k][j][i].y +</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;           ieta[k][j][i].z * icsi[k][j][i].z)+</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;       dpdz * (izet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;           izet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;           izet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) * iaj[k][j][i];</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7) || nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) {</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        dpdc = (p[k][j][i  ] + p[k][j+1][i  ] -</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;            p[k][j][i-1] - p[k][j+1][i-1]) * 0.5;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        dpdc = (p[k][j][i  ] + p[k][j+1][i  ] -</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            p[k][j][i-1] - p[k][j+1][i-1]) * 0.5;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;            p[k][j][i  ] - p[k][j+1][i  ]) * 0.5;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;      }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            p[k][j][i  ] - p[k][j+1][i  ]) * 0.5;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;      }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;      dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;          p[k][j][i-1] - p[k][j+1][i-1]) * 0.25;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    }</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    dpde = p[k][j+1][i] - p[k][j][i];</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j+1][i] -</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            p[k-1][j][i] - p[k-1][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == mz-2 || k==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j+1][i] -</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            p[k-1][j][i] - p[k-1][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            p[k  ][j][i] - p[k  ][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            p[k  ][j][i] - p[k  ][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    }</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;          p[k-1][j][i] - p[k-1][j+1][i]) * 0.25;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    }</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> =0.5 * (rct[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + rct[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> -=</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      (dpdc * (jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;           jcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;           jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) +</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;       dpde * (jeta[k][j][i].x * jeta[k][j][i].x +</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;           jeta[k][j][i].y * jeta[k][j][i].y +</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;           jeta[k][j][i].z * jeta[k][j][i].z) +</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;       dpdz * (jzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;           jzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;           jzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) * jaj[k][j][i];</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        dpdc = (p[k][j][i  ] + p[k+1][j][i  ] -</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            p[k][j][i-1] - p[k+1][j][i-1]) * 0.5;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;      }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1) {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        dpdc = (p[k][j][i  ] + p[k+1][j][i  ] -</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            p[k][j][i-1] - p[k+1][j][i-1]) * 0.5;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;      }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    }</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;            p[k][j][i  ] - p[k+1][j][i  ]) * 0.5;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            p[k][j][i  ] - p[k+1][j][i  ]) * 0.5;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      }</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;          p[k][j][i-1] - p[k+1][j][i-1]) * 0.25;</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; </div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="keywordflow">if</span> ((j == my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        dpde = (p[k][j  ][i] + p[k+1][j  ][i] -</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            p[k][j-1][i] - p[k+1][j-1][i]) * 0.5;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    }</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((j == my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        dpde = (p[k][j  ][i] + p[k+1][j  ][i] -</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            p[k][j-1][i] - p[k+1][j-1][i]) * 0.5;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      }</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            p[k][j  ][i] - p[k+1][j  ][i]) * 0.5;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            p[k][j  ][i] - p[k+1][j  ][i]) * 0.5;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;      dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          p[k][j-1][i] - p[k+1][j-1][i]) * 0.25;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    dpdz = (p[k+1][j][i] - p[k][j][i]);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.5 * (rct[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + rct[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> -=</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      (dpdc * (kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;           kcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;           kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) +</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;       dpde * (keta[k][j][i].x * kzet[k][j][i].x +</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;           keta[k][j][i].y * kzet[k][j][i].y +</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;           keta[k][j][i].z * kzet[k][j][i].z) +</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;       dpdz * (kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;           kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;           kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) * kaj[k][j][i];</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    </div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    }</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  }</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;  <span class="comment">//Mohsen March 2012//</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  <span class="comment">// rhs.x at boundaries for periodic bc at i direction//</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; xs==0){</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {   </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    i=xs;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    dpdc = p[k][j][i+1] - p[k][j][i];</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">if</span> ((j==my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        dpde = (p[k][j  ][i] + p[k][j  ][i+1] -</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;            p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j==my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        dpde = (p[k][j  ][i] + p[k][j  ][i+1] -</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7) || nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            p[k][j  ][i] - p[k][j  ][i+1]) * 0.5;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            p[k][j  ][i] - p[k][j  ][i+1]) * 0.5;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;          p[k][j-1][i] - p[k][j-1][i+1]) * 0.25;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7) || nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) {</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j][i+1] -</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            p[k-1][j][i] - p[k-1][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      }</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((k == mz-2 || k==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j][i+1] -</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            p[k-1][j][i] - p[k-1][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            p[k  ][j][i] - p[k  ][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            p[k  ][j][i] - p[k  ][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;          p[k-1][j][i] - p[k-1][j][i+1]) * 0.25;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160; </div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> =0.5 * (rct[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + rct[k][j][i+1].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> -=</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      (dpdc * (icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;           icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;           icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)+</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;       dpde * (ieta[k][j][i].x * icsi[k][j][i].x +</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;           ieta[k][j][i].y * icsi[k][j][i].y +</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;           ieta[k][j][i].z * icsi[k][j][i].z)+</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;       dpdz * (izet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;           izet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;           izet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) * iaj[k][j][i];</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  </div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="comment">// rhs.y at boundaries for periodic bc at j direction//</span></div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; ys==0){</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {   </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160; </div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    j=ys;</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7) || nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        dpdc = (p[k][j][i  ] + p[k][j+1][i  ] -</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;            p[k][j][i-1] - p[k][j+1][i-1]) * 0.5;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;      }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1) {</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        dpdc = (p[k][j][i  ] + p[k][j+1][i  ] -</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;            p[k][j][i-1] - p[k][j+1][i-1]) * 0.5;</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;      }</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    }</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            p[k][j][i  ] - p[k][j+1][i  ]) * 0.5;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      }</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            p[k][j][i  ] - p[k][j+1][i  ]) * 0.5;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;      }</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    }</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;      dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;          p[k][j][i-1] - p[k][j+1][i-1]) * 0.25;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    }</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160; </div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    dpde = p[k][j+1][i] - p[k][j][i];</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j+1][i] -</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            p[k-1][j][i] - p[k-1][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      }</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    }</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == mz-2 || k==1 ) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j+1][i] -</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            p[k-1][j][i] - p[k-1][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      }</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            p[k  ][j][i] - p[k  ][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;      }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            p[k  ][j][i] - p[k  ][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      }</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    }</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;          p[k-1][j][i] - p[k-1][j+1][i]) * 0.25;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    }</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> =0.5 * (rct[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + rct[k][j+1][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;     </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> -=</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      (dpdc * (jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;           jcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;           jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)+</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;       dpde * (jeta[k][j][i].x * jeta[k][j][i].x +</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;           jeta[k][j][i].y * jeta[k][j][i].y +</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;           jeta[k][j][i].z * jeta[k][j][i].z)+</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;       dpdz * (jzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;           jzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;           jzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) * jaj[k][j][i];</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;      }</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    }</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">// rhs.z at boundaries for periodic bc at k direction//</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7&amp;&amp; zs==0){</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    k=zs; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        dpdc = (p[k][j][i  ] + p[k+1][j][i  ] -</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            p[k][j][i-1] - p[k+1][j][i-1]) * 0.5;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;      }</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1) {</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        dpdc = (p[k][j][i  ] + p[k+1][j][i  ] -</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            p[k][j][i-1] - p[k+1][j][i-1]) * 0.5;</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;      }</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            p[k][j][i  ] - p[k+1][j][i  ]) * 0.5;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      }</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    }</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            p[k][j][i  ] - p[k+1][j][i  ]) * 0.5;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      }</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    }</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;          p[k][j][i-1] - p[k+1][j][i-1]) * 0.25;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160; </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span> ((j == my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        dpde = (p[k][j  ][i] + p[k+1][j  ][i] -</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            p[k][j-1][i] - p[k+1][j-1][i]) * 0.5;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((j == my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        dpde = (p[k][j  ][i] + p[k+1][j  ][i] -</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;            p[k][j-1][i] - p[k+1][j-1][i]) * 0.5;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    }</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            p[k][j  ][i] - p[k+1][j  ][i]) * 0.5;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            p[k][j  ][i] - p[k+1][j  ][i]) * 0.5;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;      }</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;      dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;          p[k][j-1][i] - p[k+1][j-1][i]) * 0.25;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    }</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    dpdz = (p[k+1][j][i] - p[k][j][i]);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.5 * (rct[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + rct[k+1][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> -=</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      (dpdc * (kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;           kcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;           kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)+</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;       dpde * (keta[k][j][i].x * kzet[k][j][i].x +</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;           keta[k][j][i].y * kzet[k][j][i].y +</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;           keta[k][j][i].z * kzet[k][j][i].z)+</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;       dpdz * (kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;           kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;           kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) * kaj[k][j][i];</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      }</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;  }</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    ierr = DMDAVecRestoreArray(fda, Rct, &amp;rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Pressure Gradient added to RHS .\n&quot;</span>);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    PetscInt TwoD = simCtx-&gt;<a class="code" href="variables_8h.html#a0e237daee9fc063a6563c731846eca76">TwoD</a>;</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160; </div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Final cleanup and edge-cases initiated .\n&quot;</span>);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    </div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    <span class="comment">// 7. Final clean-up for immersed boundaries and 2D cases</span></div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;      <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keywordflow">if</span> (TwoD==1)</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> =0.;</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TwoD==2)</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> =0.;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (TwoD==3)</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> =0.;</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordflow">if</span> (nvert[k][j][i]&gt;0.1) {</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0;</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    }</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keywordflow">if</span> (nvert[k][j][i+1]&gt;0.1) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>=0;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    }</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keywordflow">if</span> (nvert[k][j+1][i]&gt;0.1) {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>=0;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">if</span> (nvert[k+1][j][i]&gt;0.1) {</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      rhs[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>=0;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    }</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    }</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Final cleanup and edge-cases complete .\n&quot;</span>);</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      <span class="comment">// ========================================================================</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="comment">// --- Restore all PETSc array pointers ---</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="comment">// DMDAVecRestoreArray(fda, user-&gt;lUcont, &amp;ucont);   </span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    DMDAVecRestoreArray(fda, Rhs, &amp;rhs);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Rhs restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;csi);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>, &amp;eta);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>, &amp;zet);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    DMDAVecRestoreArray(da,  user-&gt;<a class="code" href="variables__old_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>,  &amp;aj);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Face metrics restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>, &amp;icsi);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>, &amp;ieta);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>, &amp;izet);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>, &amp;iaj);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;I Face metrics restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>, &amp;jcsi);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>, &amp;jeta);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>, &amp;jzet);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>, &amp;jaj);  </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;J Face metrics restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;  </div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>, &amp;kcsi);</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>, &amp;keta);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>, &amp;kzet);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>, &amp;kaj);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;K Face metrics restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;p);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Pressure restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Nvert restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Cell Centered scalars restored successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="comment">// --- Destroy temporary work vectors ---</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    ierr = VecDestroy(&amp;Conv); CHKERRQ(ierr);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    ierr = VecDestroy(&amp;Visc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    ierr = VecDestroy(&amp;Rc); CHKERRQ(ierr);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    ierr = VecDestroy(&amp;Rct); CHKERRQ(ierr);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Temporary work vectors destroyed successfully! .\n&quot;</span>);</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d, Block %d: RHS computation complete.\n&quot;</span>,</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;              simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, user-&gt;<a class="code" href="variables__old_8h.html#a4f7c5fd8843d026101b193e9236e1192">_this</a>);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="variables__old_8h_ae8a0a7cb4587034d295f6c7f23d70465_cgraph.svg" width="100%" height="423"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a29920cd4a8d12fbb64fd79845120d7de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29920cd4a8d12fbb64fd79845120d7de">&#9670;&nbsp;</a></span>FsiInitialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode FsiInitialize </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>n_elmt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ibi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae7960ddea53706ec458c3894653fa30a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7960ddea53706ec458c3894653fa30a">&#9670;&nbsp;</a></span>ibm_interpolation_advanced()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ibm_interpolation_advanced </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ibi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>Add_dUndt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29b8a7e554df144af1f673ac19aefda6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29b8a7e554df144af1f673ac19aefda6">&#9670;&nbsp;</a></span>ibm_read_tecplot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ibm_read_tecplot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscBool&#160;</td>
          <td class="paramname"><em>flg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a52e47a27559b32ae8f448e053ca300fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52e47a27559b32ae8f448e053ca300fe">&#9670;&nbsp;</a></span>ibm_read_ucd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ibm_read_ucd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ibi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae47c3bf1d511544e5b1515fedf6d19ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae47c3bf1d511544e5b1515fedf6d19ae">&#9670;&nbsp;</a></span>ibm_search_advanced()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ibm_search_advanced </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ibi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8d0e61d0e37192570f9ce90ac19220f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0e61d0e37192570f9ce90ac19220f8">&#9670;&nbsp;</a></span>ibm_surface_VTKOut()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ibm_surface_VTKOut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ibi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abf6d598a9ff81ff311063c0297bf2ea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf6d598a9ff81ff311063c0297bf2ea0">&#9670;&nbsp;</a></span>Implicit_DMMG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Implicit_DMMG </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *&#160;</td>
          <td class="paramname"><em>usermg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8c89e1512c34f710f01f417760194b7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c89e1512c34f710f01f417760194b7f">&#9670;&nbsp;</a></span>Implicit_SNES()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Implicit_SNES </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acabfa3f2386d9f9ff2a32591ab17c9ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acabfa3f2386d9f9ff2a32591ab17c9ef">&#9670;&nbsp;</a></span>ImplicitMomentumSolver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ImplicitMomentumSolver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a897af499c583fc011aecd975a78f0d6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a897af499c583fc011aecd975a78f0d6c">&#9670;&nbsp;</a></span>InitIBMList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitIBMList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMList">IBMList</a> *&#160;</td>
          <td class="paramname"><em>ilist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00062">62</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                 {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  ilist-&gt;<a class="code" href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">head</a> = PETSC_NULL;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aecc25fa839846bfc3dfd097458c0d495"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecc25fa839846bfc3dfd097458c0d495">&#9670;&nbsp;</a></span>initlist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initlist </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a> *&#160;</td>
          <td class="paramname"><em>ilist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00011">11</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                           {</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a> = PETSC_NULL;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f0509f331636f9e16ad145ca2e36f98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0509f331636f9e16ad145ca2e36f98">&#9670;&nbsp;</a></span>InletRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InletRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af045b58df4ca4babe828ab4d56b7fec1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af045b58df4ca4babe828ab4d56b7fec1">&#9670;&nbsp;</a></span>insertnode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insertnode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="list_8h.html#aa89b8bc105d9a09d4e7c06e8b34078a7">List</a> *&#160;</td>
          <td class="paramname"><em>ilist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>Node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="list_8h_source.html#l00015">15</a> of file <a class="el" href="list_8h_source.html">list.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <a class="code" href="variables__old_8h.html#structnode">node</a> *<span class="keyword">new</span>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="code" href="variables__old_8h.html#structnode">node</a> *current;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  current = ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a>;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  PetscTruth Exist = PETSC_FALSE;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">while</span>(current) {</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">if</span> (Node == current-&gt;<a class="code" href="variables__old_8h.html#a67c35e6b366d28db7510776d6d187d35">Node</a>) {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      Exist = PETSC_TRUE;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    }</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span> (Exist) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    current = current-&gt;<a class="code" href="variables__old_8h.html#a111a569ab2765add9b91c9f94cf9f063">next</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">if</span> (!Exist) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    PetscMalloc(<span class="keyword">sizeof</span>(<a class="code" href="variables__old_8h.html#structnode">node</a>), &amp;<span class="keyword">new</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keyword">new</span>-&gt;next = ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keyword">new</span>-&gt;<a class="code" href="variables__old_8h.html#a67c35e6b366d28db7510776d6d187d35">Node</a> = Node;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    ilist-&gt;<a class="code" href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">head</a> = <span class="keyword">new</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa156b8badceb595be2544f8d7885626b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa156b8badceb595be2544f8d7885626b">&#9670;&nbsp;</a></span>K_Omega_IC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void K_Omega_IC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4ec5d71bbdc8575c50a4c970b6541566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ec5d71bbdc8575c50a4c970b6541566">&#9670;&nbsp;</a></span>KE_Output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode KE_Output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a520f896b0af92aa116cbdab4ea8af8e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a520f896b0af92aa116cbdab4ea8af8e5">&#9670;&nbsp;</a></span>MG_Finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode MG_Finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *&#160;</td>
          <td class="paramname"><em>usermg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4358d23da72e420bdd351a340b1d51d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4358d23da72e420bdd351a340b1d51d2">&#9670;&nbsp;</a></span>MG_Initial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode MG_Initial </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *&#160;</td>
          <td class="paramname"><em>usermg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2ef563a812c1c384e6c3cadff3b6449a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ef563a812c1c384e6c3cadff3b6449a">&#9670;&nbsp;</a></span>PoissonSolver_Hypre()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PoissonSolver_Hypre </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMInfo">IBMInfo</a> *&#160;</td>
          <td class="paramname"><em>ibminfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acfdf6d56006b1b5f68d400deb6cf0959"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfdf6d56006b1b5f68d400deb6cf0959">&#9670;&nbsp;</a></span>PoissonSolver_MG()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode PoissonSolver_MG </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *&#160;</td>
          <td class="paramname"><em>usermg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solves the pressure-Poisson equation using a geometric multigrid method. </p>
<p>This function orchestrates the entire multigrid V-cycle for the pressure correction equation. It assembles the Laplacian matrix on all grid levels, sets up the KSP solvers, smoothers, restriction/interpolation operators, and executes the solve.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">usermg</td><td>The <a class="el" href="variables__old_8h.html#structUserMG" title="User-level context for managing the entire multigrid hierarchy.">UserMG</a> context containing the entire multigrid hierarchy. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="poisson_8c_source.html#l03974">3974</a> of file <a class="el" href="poisson_8c_source.html">poisson.c</a>.</p>
<div class="fragment"><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;{</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    <span class="comment">// --- CONTEXT ACQUISITION BLOCK ---</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;    <span class="comment">// Get the master simulation context from the first block&#39;s UserCtx on the finest level.</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;    <span class="comment">// This provides access to all former global variables.</span></div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = usermg-&gt;<a class="code" href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">mgctx</a>[0].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>[0].<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160; </div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;    <span class="comment">// Create local variables to mirror the legacy globals for minimal code changes.</span></div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;    <span class="keyword">const</span> PetscInt block_number = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    <span class="keyword">const</span> PetscInt immersed = simCtx-&gt;<a class="code" href="variables_8h.html#aef90766eec6fc6887cd39bd1d79cb6d2">immersed</a>;</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;    <span class="keyword">const</span> PetscInt MHV = simCtx-&gt;<a class="code" href="variables_8h.html#a02fd03c4c166911f067e92b36d1820a3">MHV</a>;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    <span class="keyword">const</span> PetscInt LV = simCtx-&gt;<a class="code" href="variables_8h.html#a1bec6eafffafc2eecc2efb4377e6fed1">LV</a>;</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    PetscMPIInt rank = simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>;</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    <span class="comment">// --- END CONTEXT ACQUISITION BLOCK ---</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160; </div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    PetscInt l, bi;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    <a class="code" href="variables__old_8h.html#structMGCtx">MGCtx</a> *mgctx = usermg-&gt;<a class="code" href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">mgctx</a>;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;    KSP mgksp, subksp;</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    PC mgpc, subpc;</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;    <a class="code" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user;</div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160; </div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    PetscFunctionBeginUser; <span class="comment">// Moved to after variable declarations</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Starting Multigrid Poisson Solve...\n&quot;</span>);</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160; </div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;    <span class="keywordflow">for</span> (bi = 0; bi &lt; block_number; bi++) {</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;        </div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;        <span class="comment">// ====================================================================</span></div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;        <span class="comment">//   SECTION: Immersed Boundary Specific Setup (Conditional)</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;        <span class="comment">// ====================================================================</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;        <span class="keywordflow">if</span> (immersed) {</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Block %d: Performing IBM pre-solve setup (Nvert restriction, etc.).\n&quot;</span>, bi);</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;            <span class="keywordflow">for</span> (l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1; l &gt; 0; l--) {</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>[bi].<a class="code" href="variables__old_8h.html#ae0a7a10f0bc2adac4b621178b64aa6f6">multinullspace</a> = PETSC_FALSE;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;                <a class="code" href="poisson_8c.html#a0f0addfc422c642ad5eb5315ace4ff2f">MyNvertRestriction</a>(&amp;mgctx[l].user[bi], &amp;mgctx[l-1].user[bi]);</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;            }</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;            <span class="comment">// Coarsest level check for disconnected domains due to IBM</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;            l = 0;</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;            user = mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;            ierr = PetscMalloc1(user[bi].info.mx * user[bi].info.my * 2, &amp;user[bi].KSKE); CHKERRQ(ierr);</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;            <a class="code" href="poisson_8c.html#aaec10e12d0e5fba6c1f53e47d62b6efe">FullyBlocked</a>(&amp;user[bi]);</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;        }</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        </div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160; </div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1;</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        user = mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        </div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        <span class="comment">// --- 1. Compute RHS of the Poisson Equation ---</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Block %d: Computing Poisson RHS...\n&quot;</span>, bi);</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        ierr = VecDuplicate(user[bi].P, &amp;user[bi].B); CHKERRQ(ierr);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;        </div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        PetscReal ibm_Flux, ibm_Area;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        PetscInt flg = immersed - 1;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        <span class="comment">// Calculate volume flux source terms (often from IBM)</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        <a class="code" href="poisson_8c.html#a8c4cb4c082ab40cc20db95c962fc1d5c">VolumeFlux</a>(&amp;user[bi], &amp;ibm_Flux, &amp;ibm_Area, flg);</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;        <span class="keywordflow">if</span> (MHV || LV) {</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;            flg = ((MHV &gt; 1 || LV) &amp;&amp; bi == 0) ? 1 : 0;</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;            <a class="code" href="poisson_8c.html#a34f6242556bffd27f00a84b377c1bf9d">VolumeFlux_rev</a>(&amp;user[bi], &amp;ibm_Flux, &amp;ibm_Area, flg);</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;        }</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;        <span class="comment">// Calculate the main divergence term</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;        <a class="code" href="poisson_8c.html#a9340445ae2c0a3c7be290e2a1aea3d67">PoissonRHS</a>(&amp;user[bi], user[bi].B);</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;        </div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;        <span class="comment">// --- 2. Assemble LHS Matrix (Laplacian) on all MG levels ---</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Block %d: Assembling Poisson LHS on all levels...\n&quot;</span>, bi);</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        <span class="keywordflow">for</span> (l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1; l &gt;= 0; l--) {</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;            user = mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot; Calculating LHS for Level %d.\n&quot;</span>,l);</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;            <a class="code" href="poisson_8c.html#a26f0e6321b7ace56b3b105e1eb10475e">PoissonLHSNew</a>(&amp;user[bi]);</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;        }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;        <span class="comment">// --- 3. Setup PETSc KSP and PCMG (Multigrid Preconditioner) ---</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Block %d: Configuring KSP and PCMG...\n&quot;</span>, bi);</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160; </div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;    ierr = KSPCreate(PETSC_COMM_WORLD, &amp;mgksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;        ierr = KSPAppendOptionsPrefix(mgksp, <span class="stringliteral">&quot;ps_&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160; </div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;    <span class="comment">// =======================================================================</span></div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        <a class="code" href="logging_8h.html#structDualMonitorCtx">DualMonitorCtx</a> *monctx;</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;        <span class="keywordtype">char</span>           filen[128];</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;        PetscBool      has_monitor_option;</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160; </div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;        <span class="comment">// 1. Allocate the context and set it up.</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;        ierr = PetscNew(&amp;monctx); CHKERRQ(ierr);</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160; </div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    monctx-&gt;<a class="code" href="logging_8h.html#a64100408e773bad5a0c07581dc3ab039">step</a> = simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;    monctx-&gt;<a class="code" href="logging_8h.html#aeb27d528b5c766bb8c213bb2112a79f6">block_id</a> = bi;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    monctx-&gt;<a class="code" href="logging_8h.html#ae5af09d0145fba810375f6a2069c7098">file_handle</a> = NULL;</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160; </div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <span class="comment">// Only rank 0 handles the file.</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;        <span class="keywordflow">if</span> (!rank) {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;      sprintf(filen, <span class="stringliteral">&quot;logs/Poisson_Solver_Convergence_History_Block_%d.log&quot;</span>, bi);</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;      <span class="comment">// On the very first step of the entire simulation, TRUNCATE the file.</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;      <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a> == simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>) {</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        monctx-&gt;<a class="code" href="logging_8h.html#ae5af09d0145fba810375f6a2069c7098">file_handle</a> = fopen(filen, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;      } <span class="keywordflow">else</span> { <span class="comment">// For all subsequent steps, APPEND to the file.</span></div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;        monctx-&gt;<a class="code" href="logging_8h.html#ae5af09d0145fba810375f6a2069c7098">file_handle</a> = fopen(filen, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;      }</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160; </div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            <span class="keywordflow">if</span> (monctx-&gt;<a class="code" href="logging_8h.html#ae5af09d0145fba810375f6a2069c7098">file_handle</a>) {</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;                PetscFPrintf(PETSC_COMM_SELF, monctx-&gt;<a class="code" href="logging_8h.html#ae5af09d0145fba810375f6a2069c7098">file_handle</a>, <span class="stringliteral">&quot;--- Convergence for Timestep %d, Block %d ---\n&quot;</span>, (<span class="keywordtype">int</span>)simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>, bi);</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;                SETERRQ1(PETSC_COMM_SELF, PETSC_ERR_FILE_OPEN, <span class="stringliteral">&quot;Could not open KSP monitor log file: %s&quot;</span>, filen);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;            }</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        }</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160; </div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;        ierr = PetscOptionsHasName(NULL, NULL, <span class="stringliteral">&quot;-ps_ksp_pic_monitor_true_residual&quot;</span>, &amp;has_monitor_option); CHKERRQ(ierr);</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;        monctx-&gt;<a class="code" href="logging_8h.html#a34c7203eac55e4ac9f075e106a7afe5f">log_to_console</a> = has_monitor_option;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160; </div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;        ierr = KSPMonitorSet(mgksp, <a class="code" href="logging_8h.html#ab0414bd7dfd804d39019da707808a819">DualKSPMonitor</a>, monctx, <a class="code" href="logging_8h.html#a26f628c9bae473d94674a1a97641b474">DualMonitorDestroy</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;        <span class="comment">// =======================================================================</span></div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;    </div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;        ierr = KSPGetPC(mgksp, &amp;mgpc); CHKERRQ(ierr);</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;        ierr = PCSetType(mgpc, PCMG); CHKERRQ(ierr);</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160; </div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;    ierr = PCMGSetLevels(mgpc, usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>, PETSC_NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;        ierr = PCMGSetCycleType(mgpc, PC_MG_CYCLE_V); CHKERRQ(ierr);</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;        ierr = PCMGSetType(mgpc, PC_MG_MULTIPLICATIVE); CHKERRQ(ierr);</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160; </div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;        <span class="comment">// --- 4. Define Restriction and Interpolation Operators for MG ---</span></div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;        <span class="keywordflow">for</span> (l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1; l &gt; 0; l--) {</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160; </div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;         <span class="comment">// Get stable pointers directly from the main mgctx array.</span></div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;         <span class="comment">// These pointers point to memory that will persist.</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;      <a class="code" href="variables__old_8h.html#structUserCtx">UserCtx</a> *fine_user_ctx   = &amp;mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>[bi];</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;      <a class="code" href="variables__old_8h.html#structUserCtx">UserCtx</a> *coarse_user_ctx = &amp;mgctx[l-1].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>[bi];</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160; </div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;      <span class="comment">// --- Configure the context pointers ---</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;      <span class="comment">// The coarse UserCtx needs to know about the fine grid for restriction.</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;      coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#a3f7d6c40e13da36f13d6b34c4a304950">da_f</a>     = &amp;(fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>);</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;      coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#a2cda7005f38b4f15851a13afa70f1b3d">user_f</a>   = fine_user_ctx;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160; </div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;      <span class="comment">// The fine UserCtx needs to know about the coarse grid for interpolation.</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;      fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#a7fb47de7893b318ba4e4e12ed46c0712">da_c</a>       = &amp;(coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>);</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;      fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#a8420a45c7f75054e71e9d8530e52ee8e">user_c</a>     = coarse_user_ctx;</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;      fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#a9b9e67bbc48d48f825de0639526c0a4f">lNvert_c</a>   = &amp;(coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>);</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160; </div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;      <span class="comment">// --- Get matrix dimensions ---</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;      PetscInt m_c = (coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.xm * coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.ym * coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.zm);</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;      PetscInt m_f = (fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.xm * fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.ym * fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.zm);</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;      PetscInt M_c = (coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.mx * coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.my * coarse_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.mz);</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;      PetscInt M_f = (fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.mx * fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.my * fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>.mz);</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160; </div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;level = %d; m_c = %d; m_f = %d; M_c = %d; M_f = %d.\n&quot;</span>,l,m_c,m_f,M_c,M_f);</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;      <span class="comment">// --- Create the MatShell objects ---</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      <span class="comment">// Pass the STABLE pointer coarse_user_ctx as the context for restriction.</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;      ierr = MatCreateShell(PETSC_COMM_WORLD, m_c, m_f, M_c, M_f, (<span class="keywordtype">void</span>*)coarse_user_ctx, &amp;fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#ad397aa8cb29c2ca1d2335b897e2f7690">MR</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;    </div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;      <span class="comment">// Pass the STABLE pointer fine_user_ctx as the context for interpolation.</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;      ierr = MatCreateShell(PETSC_COMM_WORLD, m_f, m_c, M_f, M_c, (<span class="keywordtype">void</span>*)fine_user_ctx, &amp;fine_user_ctx-&gt;MP); CHKERRQ(ierr);</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    </div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;      <span class="comment">// --- Set the operations for the MatShells ---</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      ierr = MatShellSetOperation(fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#ad397aa8cb29c2ca1d2335b897e2f7690">MR</a>, MATOP_MULT, (<span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>))<a class="code" href="poisson_8c.html#a85e1eff3b6e34605b863323d6336eecd">RestrictResidual_SolidAware</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;      ierr = MatShellSetOperation(fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#ac5212e2fb1eeb3323ab8c063aef6a498">MP</a>, MATOP_MULT, (<span class="keywordtype">void</span>(*)(<span class="keywordtype">void</span>))<a class="code" href="poisson_8c.html#aa2fc17959230252f30b2278d81a16caf">MyInterpolation</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;    </div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      <span class="comment">// --- Register the operators with PCMG ---</span></div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      ierr = PCMGSetRestriction(mgpc, l, fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#ad397aa8cb29c2ca1d2335b897e2f7690">MR</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;      ierr = PCMGSetInterpolation(mgpc, l, fine_user_ctx-&gt;<a class="code" href="variables__old_8h.html#ac5212e2fb1eeb3323ab8c063aef6a498">MP</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      </div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;        }</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;        </div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;        <span class="comment">// --- 5. Configure Solvers on Each MG Level ---</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;        <span class="keywordflow">for</span> (l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1; l &gt;= 0; l--) {</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;            user = mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;            <span class="keywordflow">if</span> (l &gt; 0) { <span class="comment">// Smoother for fine levels</span></div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                ierr = PCMGGetSmoother(mgpc, l, &amp;subksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// Direct or iterative solver for the coarsest level</span></div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                ierr = PCMGGetCoarseSolve(mgpc, &amp;subksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                ierr = KSPSetTolerances(subksp, 1.e-8, PETSC_DEFAULT, PETSC_DEFAULT, 40); CHKERRQ(ierr);</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;            } </div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;            </div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;            ierr = KSPSetOperators(subksp, user[bi].A, user[bi].A); CHKERRQ(ierr);</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;        ierr = KSPSetFromOptions(subksp); CHKERRQ(ierr); </div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;            ierr = KSPGetPC(subksp, &amp;subpc); CHKERRQ(ierr);</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;        ierr = PCSetType(subpc, PCBJACOBI); CHKERRQ(ierr);</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;        </div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;        KSP *subsubksp;</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;        PC subsubpc;</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;        PetscInt nlocal;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160; </div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;        <span class="comment">// This logic is required for both the smoother and the coarse solve</span></div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;        <span class="comment">// since both use PCBJACOBI.</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;        ierr = KSPSetUp(subksp); CHKERRQ(ierr); <span class="comment">// Set up KSP to allow access to sub-KSPs</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;        ierr = PCBJacobiGetSubKSP(subpc, &amp;nlocal, NULL, &amp;subsubksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160; </div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;        <span class="keywordflow">for</span> (PetscInt abi = 0; abi &lt; nlocal; abi++) {</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;          ierr = KSPGetPC(subsubksp[abi], &amp;subsubpc); CHKERRQ(ierr);</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;          <span class="comment">// Add the critical shift amount</span></div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;          ierr = PCFactorSetShiftAmount(subsubpc, 1.e-10); CHKERRQ(ierr);</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;        }</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;        </div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;        ierr = MatNullSpaceCreate(PETSC_COMM_WORLD, PETSC_TRUE, 0, PETSC_NULL, &amp;user[bi].nullsp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;            ierr = MatNullSpaceSetFunction(user[bi].nullsp, <a class="code" href="poisson_8c.html#a2648a0c6cafb7916a706cd757e5b92f5">PoissonNullSpaceFunction</a>, &amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;            ierr = MatSetNullSpace(user[bi].A, user[bi].nullsp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;            </div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;            ierr = PCMGSetResidual(mgpc, l, PCMGResidualDefault, user[bi].A); CHKERRQ(ierr);</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;            ierr = KSPSetUp(subksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160; </div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;            <span class="keywordflow">if</span> (l &lt; usermg-&gt;mglevels - 1) {</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                ierr = MatCreateVecs(user[bi].A, &amp;user[bi].R, PETSC_NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                ierr = PCMGSetRhs(mgpc, l, user[bi].R); CHKERRQ(ierr);</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;            }</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        }</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160; </div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;        <span class="comment">// --- 6. Set Final KSP Operators and Solve ---</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;        l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1;</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        user = mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;        </div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Block %d: Setting KSP operators and solving...\n&quot;</span>, bi);</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;        ierr = KSPSetOperators(mgksp, user[bi].A, user[bi].A); CHKERRQ(ierr);</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;        ierr = MatSetNullSpace(user[bi].A, user[bi].nullsp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        ierr = KSPSetFromOptions(mgksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;        ierr = KSPSetUp(mgksp); CHKERRQ(ierr);</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;        ierr = KSPSolve(mgksp, user[bi].B, user[bi].Phi); CHKERRQ(ierr);</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160; </div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;        <span class="comment">// --- 7. Cleanup for this block ---</span></div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        <span class="keywordflow">for</span> (l = usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1; l &gt;= 0; l--) {</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;            user = mgctx[l].<a class="code" href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">user</a>;</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;            MatNullSpaceDestroy(&amp;user[bi].nullsp);</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;            MatDestroy(&amp;user[bi].A);</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;            user[bi].<a class="code" href="variables__old_8h.html#a41951f47cfbe9c08def29998a76dc791">assignedA</a> = PETSC_FALSE;</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;            <span class="keywordflow">if</span> (l &gt; 0) {</div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                MatDestroy(&amp;user[bi].MR);</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                MatDestroy(&amp;user[bi].MP);</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l==0 &amp;&amp; immersed) {</div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                PetscFree(user[bi].KSKE);</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;            }</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;            <span class="keywordflow">if</span> (l &lt; usermg-&gt;mglevels - 1) {</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                VecDestroy(&amp;user[bi].R);</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;            }</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;        }</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;        </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;        KSPDestroy(&amp;mgksp);</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;        VecDestroy(&amp;mgctx[usermg-&gt;<a class="code" href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>-1].user[bi].B);</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;        </div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;    } <span class="comment">// End of loop over blocks</span></div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160; </div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Multigrid Poisson Solve complete.\n&quot;</span>);</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="variables__old_8h_acfdf6d56006b1b5f68d400deb6cf0959_cgraph.svg" width="576" height="544"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a34a113dcc9ca606d914c3d021a4d85fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a113dcc9ca606d914c3d021a4d85fc">&#9670;&nbsp;</a></span>Projection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Projection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the projection step to enforce an incompressible velocity field. </p>
<p>Corrects the contravariant velocity field <code>Ucont</code> to be divergence-free using the gradient of the pressure correction field <code>Phi</code>.</p>
<p>This function executes the final "correction" stage of a fractional-step (projection) method for solving the incompressible Navier-Stokes equations. After solving the Pressure Poisson Equation to get a pressure correction <code>Phi</code>, this function uses <code>Phi</code> to correct the intermediate velocity field, making it divergence-free.</p>
<p>The main steps are:</p><ol type="1">
<li><b>Calculate Pressure Gradient</b>: At each velocity point (on the cell faces), it computes the gradient of the pressure correction field (<code></code>). This is done using finite differences on a generalized curvilinear grid.</li>
<li><b>Correct Velocity Field</b>: It updates the contravariant velocity components <code>Ucont</code> by subtracting the scaled pressure gradient. The update rule is: <code>U_new = U_intermediate - t * G * </code>, where <code>G</code> is the metric tensor <code>g_ij</code> that transforms the gradient into contravariant components.</li>
<li><b>Boundary-Aware Gradients</b>: The gradient calculation is highly sensitive to boundaries. The code uses complex, dynamic stencils that switch from centered differences to one-sided differences if a standard stencil would use a point inside an immersed solid (<code>nvert &gt; 0.1</code>). This preserves accuracy at the fluid-solid interface.</li>
<li><b>Periodic Boundary Updates</b>: Includes dedicated loops to correctly calculate the pressure gradient at the domain edges for periodic boundary conditions.</li>
<li><b>Finalization</b>: After correcting <code>Ucont</code>, it calls helper functions to convert the velocity back to Cartesian coordinates (<code>Contra2Cart</code>) and update all ghost cell values.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> struct, containing simulation context, grid metrics, and the velocity/pressure fields.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a non-zero error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="poisson_8c_source.html#l00986">986</a> of file <a class="el" href="poisson_8c_source.html">poisson.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;{</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Entering Projection step to correct velocity field.\n&quot;</span>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="comment">//================================================================================</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="comment">// Section 1: Initialization and Data Acquisition</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  <span class="comment">//================================================================================</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="comment">// --- Get simulation and grid context ---</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  DM da = user-&gt;<a class="code" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, fda = user-&gt;<a class="code" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  DMDALocalInfo info = user-&gt;<a class="code" href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// --- Grid dimensions ---</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  PetscInt mx = info.mx, my = info.my, mz = info.mz;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  PetscInt xs = info.xs, xe = info.xs + info.xm;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  PetscInt ys = info.ys, ye = info.ys + info.ym;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  PetscInt zs = info.zs, ze = info.zs + info.zm;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <span class="comment">// --- Loop bounds (excluding outer ghost layers) ---</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  PetscInt lxs = (xs == 0) ? xs + 1 : xs;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  PetscInt lxe = (xe == mx) ? xe - 1 : xe;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  PetscInt lys = (ys == 0) ? ys + 1 : ys;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  PetscInt lye = (ye == my) ? ye - 1 : ye;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  PetscInt lzs = (zs == 0) ? zs + 1 : zs;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  PetscInt lze = (ze == mz) ? ze - 1 : ze;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  <span class="comment">// --- Get direct pointer access to grid metric and field data ---</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***icsi, ***ieta, ***izet, ***jcsi, ***jeta, ***jzet, ***kcsi, ***keta, ***kzet;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  PetscReal ***iaj, ***jaj, ***kaj, ***p, ***nvert;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  <a class="code" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***ucont;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>, &amp;icsi); DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>, &amp;ieta); DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>, &amp;izet);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>, &amp;jcsi); DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>, &amp;jeta); DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>, &amp;jzet);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>, &amp;kcsi); DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>, &amp;keta); DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>, &amp;kzet);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>, &amp;iaj); DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>, &amp;jaj); DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>, &amp;kaj);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a7a1cf0e107351a96b27ae00160e60271">lPhi</a>, &amp;p); <span class="comment">// Note: using lPhi, which is the pressure correction</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <span class="comment">//DMDAVecGetArray(da,user-&gt;lP,&amp;p);</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  DMDAVecGetArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="comment">// --- Constants for clarity ---</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <span class="keyword">const</span> PetscReal IBM_FLUID_THRESHOLD = 0.1;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="keyword">const</span> PetscReal scale = simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a> * simCtx-&gt;<a class="code" href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">st</a> / <a class="code" href="variables_8h.html#af0af02fbd08daea87f3523a3754981f0">COEF_TIME_ACCURACY</a>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot; Starting velocity correction: Scale = %le .\n&quot;</span>,scale);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="comment">//================================================================================</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">// Section 2: Correct Velocity Components</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="comment">//================================================================================</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Calculating pressure gradients and correcting velocity components.\n&quot;</span>);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;  <span class="comment">// --- Main loop over interior domain points ---</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <span class="keywordflow">for</span> (PetscInt k = lzs; k &lt; lze; k++) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordflow">for</span> (PetscInt j = lys; j &lt; lye; j++) {</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">for</span> (PetscInt i = lxs; i &lt; lxe; i++) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="comment">// --- Correct U_contravariant (x-component of velocity) ---</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        PetscInt i_end = (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0] == 7) ? mx - 1 : mx - 2;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <span class="keywordflow">if</span> (i &lt; i_end) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      </div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;          <span class="keywordflow">if</span> (!(nvert[k][j][i] &gt; IBM_FLUID_THRESHOLD || nvert[k][j][i + 1] &gt; IBM_FLUID_THRESHOLD)) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            <span class="comment">// Compute pressure derivatives (dp/d_csi, dp/d_eta, dp/d_zet) at the i-face</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        PetscReal dpdc = p[k][j][i + 1] - p[k][j][i];</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            PetscReal dpde = 0.0, dpdz = 0.0;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="comment">// Boundary-aware stencil for dp/d_eta</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;          <span class="keywordflow">if</span> ((j==my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;          dpde = (p[k][j][i] + p[k][j][i+1] -</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;              p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;          }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j==my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1) { dpde = (p[k][j][i] + p[k][j][i+1] - p[k][j-1][i] - p[k][j-1][i+1]) * 0.5; }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7) || nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) { dpde = (p[k][j+1][i] + p[k][j+1][i+1] - p[k][j][i] - p[k][j][i+1]) * 0.5; }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          }</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) { dpde = (p[k][j+1][i] + p[k][j+1][i+1] - p[k][j][i] - p[k][j][i+1]) * 0.5; }</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;          }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          <span class="keywordflow">else</span> { dpde = (p[k][j+1][i] + p[k][j+1][i+1] - p[k][j-1][i] - p[k][j-1][i+1]) * 0.25; }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="comment">// Boundary-aware stencil for dp/d_zet</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;          <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7) || nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) { dpdz = (p[k][j][i] + p[k][j][i+1] - p[k-1][j][i] - p[k-1][j][i+1]) * 0.5; }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((k == mz-2 || k==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1) { dpdz = (p[k][j][i] + p[k][j][i+1] - p[k-1][j][i] - p[k-1][j][i+1]) * 0.5; }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;          }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160; </div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) { dpdz = (p[k+1][j][i] + p[k+1][j][i+1] - p[k][j][i] - p[k][j][i+1]) * 0.5; }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;          }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) { dpdz = (p[k+1][j][i] + p[k+1][j][i+1] - p[k][j][i] - p[k][j][i+1]) * 0.5; }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;          }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;          <span class="keywordflow">else</span> { dpdz = (p[k+1][j][i] + p[k+1][j][i+1] - p[k-1][j][i] - p[k-1][j][i+1]) * 0.25; }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="comment">// Apply the correction: U_new = U_old - dt * (g11*dpdc + g12*dpde + g13*dpdz)</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            </div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            PetscReal grad_p_x = (dpdc * (icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                      + icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * iaj[k][j][i] +</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                                dpde * (ieta[k][j][i].x * icsi[k][j][i].x + ieta[k][j][i].y * icsi[k][j][i].y</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                    + ieta[k][j][i].z * icsi[k][j][i].z) * iaj[k][j][i] +</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                dpdz * (izet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + izet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                    + izet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * iaj[k][j][i]);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        PetscReal correction = grad_p_x*scale;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment">//LOG_LOOP_ALLOW_EXACT(GLOBAL,LOG_DEBUG,k,5,&quot; Flux correction in Csi Direction: %le.\n&quot;,correction);</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> -= correction;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;          }</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="comment">// --- Correct V_contravariant (y-component of velocity) ---</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        PetscInt j_end = (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2] == 7) ? my - 1 : my - 2;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">if</span> (j &lt; j_end) {</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          <span class="keywordflow">if</span> (!(nvert[k][j][i] &gt; IBM_FLUID_THRESHOLD || nvert[k][j + 1][i] &gt; IBM_FLUID_THRESHOLD)) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            PetscReal dpdc = 0.0, dpde = 0.0, dpdz = 0.0;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            dpde = p[k][j + 1][i] - p[k][j][i];</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="comment">// Boundary-aware stencil for dp/d_csi</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;          <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7) || nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) { dpdc = (p[k][j][i] + p[k][j+1][i] - p[k][j][i-1] - p[k][j+1][i-1]) * 0.5; }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1) { dpdc = (p[k][j][i] + p[k][j+1][i] - p[k][j][i-1] - p[k][j+1][i-1]) * 0.5; }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) { dpdc = (p[k][j][i+1] + p[k][j+1][i+1] - p[k][j][i] - p[k][j+1][i]) * 0.5; }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) { dpdc = (p[k][j][i+1] + p[k][j+1][i+1] - p[k][j][i] - p[k][j+1][i]) * 0.5; }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;          } <span class="keywordflow">else</span> { dpdc = (p[k][j][i+1] + p[k][j+1][i+1] - p[k][j][i-1] - p[k][j+1][i-1]) * 0.25; }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;            <span class="comment">// Boundary-aware stencil for dp/d_zet</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) { dpdz = (p[k][j][i] + p[k][j+1][i] - p[k-1][j][i] - p[k-1][j+1][i]) * 0.5; }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == mz-2 || k==1 ) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1) { dpdz = (p[k][j][i] + p[k][j+1][i] - p[k-1][j][i] - p[k-1][j+1][i]) * 0.5; }</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) { dpdz = (p[k+1][j][i] + p[k+1][j+1][i] - p[k][j][i] - p[k][j+1][i]) * 0.5; }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) { dpdz = (p[k+1][j][i] + p[k+1][j+1][i] - p[k][j][i] - p[k][j+1][i]) * 0.5; }</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          } <span class="keywordflow">else</span> { dpdz = (p[k+1][j][i] + p[k+1][j+1][i] - p[k-1][j][i] - p[k-1][j+1][i]) * 0.25; }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            PetscReal grad_p_y = (dpdc * (jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + jcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * jaj[k][j][i] +</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                dpde * (jeta[k][j][i].x * jeta[k][j][i].x + jeta[k][j][i].y * jeta[k][j][i].y + jeta[k][j][i].z * jeta[k][j][i].z) * jaj[k][j][i] +</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                dpdz * (jzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + jzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + jzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * jaj[k][j][i]);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        PetscReal correction = grad_p_y*scale;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="comment">//LOG_LOOP_ALLOW_EXACT(GLOBAL,LOG_DEBUG,k,5,&quot; Flux correction in Eta Direction: %le.\n&quot;,correction);</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> -= correction;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="comment">// --- Correct W_contravariant (z-component of velocity) ---</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        PetscInt k_end = (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4] == 7) ? mz - 1 : mz - 2;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        <span class="keywordflow">if</span> (k &lt; k_end) {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          <span class="keywordflow">if</span> (!(nvert[k][j][i] &gt; IBM_FLUID_THRESHOLD || nvert[k + 1][j][i] &gt; IBM_FLUID_THRESHOLD)) {</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            PetscReal dpdc = 0.0, dpde = 0.0, dpdz = 0.0;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            dpdz = p[k + 1][j][i] - p[k][j][i];</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="comment">// Boundary-aware stencil for dp/d_csi</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) { dpdc = (p[k][j][i] + p[k+1][j][i] - p[k][j][i-1] - p[k+1][j][i-1]) * 0.5; }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1) { dpdc = (p[k][j][i] + p[k+1][j][i] - p[k][j][i-1] - p[k+1][j][i-1]) * 0.5; }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) { dpdc = (p[k][j][i+1] + p[k+1][j][i+1] - p[k][j][i] - p[k+1][j][i]) * 0.5; }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) { dpdc = (p[k][j][i+1] + p[k+1][j][i+1] - p[k][j][i] - p[k+1][j][i]) * 0.5; }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;          } <span class="keywordflow">else</span> { dpdc = (p[k][j][i+1] + p[k+1][j][i+1] - p[k][j][i-1] - p[k+1][j][i-1]) * 0.25; }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            <span class="comment">// Boundary-aware stencil for dp/d_eta</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          <span class="keywordflow">if</span> ((j == my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) { dpde = (p[k][j][i] + p[k+1][j][i] - p[k][j-1][i] - p[k+1][j-1][i]) * 0.5; }</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          } <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((j == my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1) { dpde = (p[k][j][i] + p[k+1][j][i] - p[k][j-1][i] - p[k+1][j-1][i]) * 0.5; }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) { dpde = (p[k][j+1][i] + p[k+1][j+1][i] - p[k][j][i] - p[k+1][j][i]) * 0.5; }</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) { dpde = (p[k][j+1][i] + p[k+1][j+1][i] - p[k][j][i] - p[k+1][j][i]) * 0.5; }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;          } <span class="keywordflow">else</span> { dpde = (p[k][j+1][i] + p[k+1][j+1][i] - p[k][j-1][i] - p[k+1][j-1][i]) * 0.25; }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            PetscReal grad_p_z = (dpdc * (kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + kcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * kaj[k][j][i] +</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                dpde * (keta[k][j][i].x * kzet[k][j][i].x + keta[k][j][i].y * kzet[k][j][i].y + keta[k][j][i].z * kzet[k][j][i].z) * kaj[k][j][i] +</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                dpdz * (kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * kaj[k][j][i]);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="comment">// ========================= DEBUG PRINT  =========================</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <a class="code" href="logging_8h.html#aa987297fa072943c2409f3b2cc4e31f9">LOG_LOOP_ALLOW_EXACT</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, k, 5,</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                 <span class="stringliteral">&quot;[k=%d, j=%d, i=%d] ---- Neighbor Pressures ----\n&quot;</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                 <span class="stringliteral">&quot;  Central Z-Neighbors: p[k+1][j][i] = %g | p[k][j][i] = %g\n&quot;</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                 <span class="stringliteral">&quot;  Eta-Stencil (Y-dir): p[k][j-1][i] = %g, p[k+1][j-1][i] = %g | p[k][j+1][i] = %g, p[k+1][j+1][i] = %g\n&quot;</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                 <span class="stringliteral">&quot;  Csi-Stencil (X-dir): p[k][j][i-1] = %g, p[k+1][j][i-1] = %g | p[k][j][i+1] = %g, p[k+1][j][i+1] = %g\n&quot;</span>,</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                 k, j, i,</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                 p[k + 1][j][i], p[k][j][i],</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                 p[k][j - 1][i], p[k + 1][j - 1][i], p[k][j + 1][i], p[k + 1][j + 1][i],</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                 p[k][j][i - 1], p[k + 1][j][i - 1], p[k][j][i + 1], p[k + 1][j][i + 1]);</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="comment">// ======================= END DEBUG PRINT =======================</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <a class="code" href="logging_8h.html#aa987297fa072943c2409f3b2cc4e31f9">LOG_LOOP_ALLOW_EXACT</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,k,5,<span class="stringliteral">&quot; dpdc: %le | dpde: %le | dpdz: %le.\n&quot;</span>,dpdc,dpde,dpdz);      </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        PetscReal correction = grad_p_z*scale;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="comment">//LOG_LOOP_ALLOW_EXACT(GLOBAL,LOG_DEBUG,k,5,&quot; Flux correction in Zet Direction: %le.\n&quot;,correction);</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> -= correction;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;      }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    }</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">// --- Explicit correction for periodic boundaries (if necessary) ---</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="comment">// The main loop handles the interior, but this handles the first physical layer at periodic boundaries.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="comment">// Note: This logic is largely duplicated from the main loop and could be merged, but is preserved for fidelity.</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0] == 7 &amp;&amp; xs == 0) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">for</span> (PetscInt k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">for</span> (PetscInt j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    PetscInt i=xs;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    PetscReal dpdc = p[k][j][i+1] - p[k][j][i];</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    PetscReal dpde = 0.;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    PetscReal dpdz = 0.;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> ((j==my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        dpde = (p[k][j  ][i] + p[k][j  ][i+1] -</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    }</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j==my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i]+nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k][j-1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        dpde = (p[k][j  ][i] + p[k][j  ][i+1] -</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;            p[k][j-1][i] - p[k][j-1][i+1]) * 0.5;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7) || nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            p[k][j  ][i] - p[k][j  ][i+1]) * 0.5;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k][j-1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            p[k][j  ][i] - p[k][j  ][i+1]) * 0.5;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      dpde = (p[k][j+1][i] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;          p[k][j-1][i] - p[k][j-1][i+1]) * 0.25;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7) || nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) {</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j][i+1] -</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            p[k-1][j][i] - p[k-1][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    }</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((k == mz-2 || k==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j][i+1] -</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            p[k-1][j][i] - p[k-1][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    }</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            p[k  ][j][i] - p[k  ][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            p[k  ][j][i] - p[k  ][j][i+1]) * 0.5;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      dpdz = (p[k+1][j][i] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;          p[k-1][j][i] - p[k-1][j][i+1]) * 0.25;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (!(nvert[k][j][i] + nvert[k][j][i+1])) {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> -=</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        (dpdc * (icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;             icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;             icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * iaj[k][j][i] +</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         dpde * (ieta[k][j][i].x * icsi[k][j][i].x +</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;             ieta[k][j][i].y * icsi[k][j][i].y +</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;             ieta[k][j][i].z * icsi[k][j][i].z) * iaj[k][j][i] +</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;         dpdz * (izet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;             izet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;             izet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * icsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * iaj[k][j][i])</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        * scale;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    } </div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2] == 7 &amp;&amp; ys == 0) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">for</span> (PetscInt k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;      <span class="keywordflow">for</span> (PetscInt i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    PetscInt j=ys;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    PetscReal dpdc = 0.;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    PetscReal dpdz = 0.;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7) || nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        dpdc = (p[k][j][i  ] + p[k][j+1][i  ] -</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            p[k][j][i-1] - p[k][j+1][i-1]) * 0.5;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k][j+1][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k][j+1][i-1] &lt; 0.1) {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        dpdc = (p[k][j][i  ] + p[k][j+1][i  ] -</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            p[k][j][i-1] - p[k][j+1][i-1]) * 0.5;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      }</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            p[k][j][i  ] - p[k][j+1][i  ]) * 0.5;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k][j+1][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k][j+1][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            p[k][j][i  ] - p[k][j+1][i  ]) * 0.5;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      }</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      dpdc = (p[k][j][i+1] + p[k][j+1][i+1] -</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          p[k][j][i-1] - p[k][j+1][i-1]) * 0.25;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    PetscReal dpde = p[k][j+1][i] - p[k][j][i];</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    <span class="keywordflow">if</span> ((k == mz-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1 &amp;&amp; (k!=1 || (k==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7))) {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j+1][i] -</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            p[k-1][j][i] - p[k-1][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == mz-2 || k==1 ) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k+1][j][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">if</span> (nvert[k-1][j][i] + nvert[k-1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        dpdz = (p[k  ][j][i] + p[k  ][j+1][i] -</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            p[k-1][j][i] - p[k-1][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]!=7)|| nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            p[k  ][j][i] - p[k  ][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      }</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    }</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((k == 1 || k==mz-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4]==7 &amp;&amp; nvert[k-1][j][i] + nvert[k-1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="keywordflow">if</span> (nvert[k+1][j][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            p[k  ][j][i] - p[k  ][j+1][i]) * 0.5;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;      }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;      dpdz = (p[k+1][j][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;          p[k-1][j][i] - p[k-1][j+1][i]) * 0.25;</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        </div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">if</span> (!(nvert[k][j][i] + nvert[k][j+1][i])) {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> -=</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        (dpdc * (jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;             jcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;             jcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * jaj[k][j][i] +</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;         dpde * (jeta[k][j][i].x * jeta[k][j][i].x +</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;             jeta[k][j][i].y * jeta[k][j][i].y +</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;             jeta[k][j][i].z * jeta[k][j][i].z) * jaj[k][j][i] +</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;         dpdz * (jzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;             jzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;             jzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * jeta[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * jaj[k][j][i])</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        * scale;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      }</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[4] == 7 &amp;&amp; zs == 0) {</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    <span class="keywordflow">for</span> (PetscInt j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;      <span class="keywordflow">for</span> (PetscInt i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    PetscInt k=zs;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    PetscReal dpdc = 0.;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    PetscReal dpde = 0.;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160; </div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    <span class="keywordflow">if</span> ((i == mx-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1 &amp;&amp; (i!=1 || (i==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7))) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        dpdc = (p[k][j][i  ] + p[k+1][j][i  ] -</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;            p[k][j][i-1] - p[k+1][j][i-1]) * 0.5;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      }</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == mx-2 || i==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i+1] + nvert[k+1][j][i+1] &gt; 0.1) {</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i-1] + nvert[k+1][j][i-1] &lt; 0.1) {</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        dpdc = (p[k][j][i  ] + p[k+1][j][i  ] -</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;            p[k][j][i-1] - p[k+1][j][i-1]) * 0.5;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]!=7)|| nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            p[k][j][i  ] - p[k+1][j][i  ]) * 0.5;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      }</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((i == 1 || i==mx-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[0]==7 &amp;&amp; nvert[k][j][i-1] + nvert[k+1][j][i-1] &gt; 0.1) {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j][i+1] + nvert[k+1][j][i+1] &lt; 0.1) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            p[k][j][i  ] - p[k+1][j][i  ]) * 0.5;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    }</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      dpdc = (p[k][j][i+1] + p[k+1][j][i+1] -</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;          p[k][j][i-1] - p[k+1][j][i-1]) * 0.25;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    }</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">if</span> ((j == my-2 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1 &amp;&amp; (j!=1 || (j==1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7))) {</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        dpde = (p[k][j  ][i] + p[k+1][j  ][i] -</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            p[k][j-1][i] - p[k+1][j-1][i]) * 0.5;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;      }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ((j == my-2 || j==1) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j+1][i] + nvert[k+1][j+1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j-1][i] + nvert[k+1][j-1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        dpde = (p[k][j  ][i] + p[k+1][j  ][i] -</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            p[k][j-1][i] - p[k+1][j-1][i]) * 0.5;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;      }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]!=7)|| nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            p[k][j  ][i] - p[k+1][j  ][i]) * 0.5;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((j == 1 || j==my-2) &amp;&amp; user-&gt;<a class="code" href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">bctype</a>[2]==7 &amp;&amp; nvert[k][j-1][i] + nvert[k+1][j-1][i] &gt; 0.1) {</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordflow">if</span> (nvert[k][j+1][i] + nvert[k+1][j+1][i] &lt; 0.1) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            p[k][j  ][i] - p[k+1][j  ][i]) * 0.5;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      }</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      dpde = (p[k][j+1][i] + p[k+1][j+1][i] -</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;          p[k][j-1][i] - p[k+1][j-1][i]) * 0.25;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    }</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    PetscReal dpdz = p[k+1][j][i] - p[k][j][i];</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="keywordflow">if</span> (!(nvert[k][j][i] + nvert[k+1][j][i])) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      ucont[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> -=</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;       (dpdc * (kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                   kcsi[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                   kcsi[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * kaj[k][j][i] +</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;               dpde * (keta[k][j][i].x * kzet[k][j][i].x +</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                   keta[k][j][i].y * kzet[k][j][i].y +</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                   keta[k][j][i].z * kzet[k][j][i].z) * kaj[k][j][i] +</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;               dpdz * (kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> +</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                   kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> +</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                   kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> * kzet[k][j][i].<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>) * kaj[k][j][i])</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                        * scale;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      }</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">// --- Optional: Enforce specific mass flow rate for channel flow simulations ---</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a2e1d74f612f5443c8ece068511563453">channelz</a>) {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Applying channel flow mass flux correction.\n&quot;</span>);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="comment">// DMDAVecGetArray(fda, user-&gt;lCsi, &amp;csi); DMDAVecGetArray(fda, user-&gt;lEta, &amp;eta); DMDAVecGetArray(fda, user-&gt;lZet, &amp;zet);</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">//DMDAVecGetArray(da, user-&gt;lAj, &amp;aj);</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">// This entire block was commented out in the original code. It calculates the current</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="comment">// total flux in the z-direction, compares it to a target flux (user-&gt;simCtx-&gt;FluxInSum),</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">// and computes a uniform velocity correction `ratio` to enforce the target.</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="comment">// The implementation for applying the `ratio` was also commented out.</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="comment">// Preserving this as-is.</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  } </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;  <span class="comment">//================================================================================</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="comment">// Section 3: Finalization and Cleanup</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="comment">//================================================================================</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  <span class="comment">// --- Restore access to all PETSc vector arrays ---</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;ucont);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// DMDAVecRestoreArray(fda, user-&gt;lCsi, &amp;csi); DMDAVecRestoreArray(fda, user-&gt;lEta, &amp;eta); DMDAVecRestoreArray(fda, user-&gt;lZet, &amp;zet);</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;  <span class="comment">//DMDAVecRestoreArray(da, user-&gt;lAj, &amp;aj);</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>, &amp;icsi); DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>, &amp;ieta); DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>, &amp;izet);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>, &amp;jcsi); DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>, &amp;jeta); DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>, &amp;jzet);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>, &amp;kcsi); DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>, &amp;keta); DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables__old_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>, &amp;kzet);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>, &amp;iaj); DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>, &amp;jaj); DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>, &amp;kaj);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, &amp;p);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <span class="comment">// --- Update ghost cells for the newly corrected velocity field ---</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Updating ghost cells for corrected velocity.\n&quot;</span>);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  DMGlobalToLocalBegin(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  DMGlobalToLocalEnd(fda, user-&gt;<a class="code" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, INSERT_VALUES, user-&gt;<a class="code" href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>);</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="comment">// --- Convert velocity to Cartesian and update ghost nodes ---</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Converting velocity to Cartesian and finalizing ghost nodes.\n&quot;</span>);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <a class="code" href="setup_8h.html#a515c9a96eb4bcac29f79e78c8882d7aa">Contra2Cart</a>(user);</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <a class="code" href="poisson_8c.html#a6046e36e2334fa29a86d652a0b8f0593">GhostNodeVelocity</a>(user);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Exiting Projection step.\n&quot;</span>);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="variables__old_8h_a34a113dcc9ca606d914c3d021a4d85fc_cgraph.svg" width="100%" height="385"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a89ae58d48076ba82dc70438b5e389bf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89ae58d48076ba82dc70438b5e389bf5">&#9670;&nbsp;</a></span>RungeKutta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode RungeKutta </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advances the momentum equations for ALL blocks by one time step using an explicit 4-stage, 4th-order Runge-Kutta scheme. </p>
<p>Advances the momentum equations using an explicit 4th-order Runge-Kutta scheme.</p>
<p>This function computes an intermediate, non-divergence-free contravariant velocity field (Ucont) at time t_{n+1} for all computational blocks.</p>
<p>This is a minimally-edited version of the legacy solver. It retains its internal loop over all blocks and is intended to be called once per time step from the main Flow_Solver orchestrator. All former global variables are now accessed via the <a class="el" href="variables_8h.html#structSimCtx" title="The master context for the entire simulation.">SimCtx</a> passed in through the first block's <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The array of <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structs for all blocks. </td></tr>
    <tr><td class="paramname">ibm</td><td>(Optional) Pointer to the full array of IBM data structures. Pass NULL if disabled. </td></tr>
    <tr><td class="paramname">fsi</td><td>(Optional) Pointer to the full array of FSI data structures. Pass NULL if disabled. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="implicitsolvers_8c_source.html#l00022">22</a> of file <a class="el" href="implicitsolvers_8c_source.html">implicitsolvers.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// --- Context Acquisition ---</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// Get the master simulation context from the first block&#39;s UserCtx.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// This is the bridge to access all former global variables.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user[0].<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    PetscReal dt = simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    PetscReal st = simCtx-&gt;<a class="code" href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">st</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    PetscInt  istage;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    PetscReal alfa[] = {0.25, 1.0/3.0, 0.5, 1.0};</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Executing explicit momentum solver (Runge-Kutta) for %d block(s).\n&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// --- 1. Pre-Loop Initialization (Legacy Logic) ---</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// This block prepares boundary conditions and allocates the RHS vector for all blocks</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// before the main RK loop begins. This logic is preserved from the original code.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Preparing all blocks for Runge-Kutta solve...\n&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>; bi++) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        ierr = <a class="code" href="Boundaries_8h.html#abd9b573f8f42ea93e265da37a0673f24">InflowFlux</a>(&amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        ierr = <a class="code" href="Boundaries_8h.html#a684320111be78b3001fda2ba25638e79">OutflowFlux</a>(&amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        ierr = <a class="code" href="Boundaries_8h.html#adcd96cff4b9e15e03cdff9f5ea695dec">FormBCS</a>(&amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">        // Immersed boundary interpolation (if enabled)</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">        if (simCtx-&gt;immersed) {</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">            LOG_ALLOW(LOCAL, LOG_DEBUG, &quot;  Performing pre-RK IBM interpolation for block %d.\n&quot;, bi);</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">            for (PetscInt ibi = 0; ibi &lt; simCtx-&gt;NumberOfBodies; ibi++) {</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">                // The &#39;ibm&#39; and &#39;fsi&#39; pointers are passed directly from Flow_Solver</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">                ierr = ibm_interpolation_advanced(&amp;user[bi], &amp;ibm[ibi], ibi, 1); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="comment">// Allocate the persistent RHS vector for this block&#39;s context</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        ierr = VecDuplicate(user[bi].Ucont, &amp;user[bi].Rhs); CHKERRQ(ierr);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Pre-loop initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// --- 2. Main Runge-Kutta Loop ---</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// The legacy code had an outer `pseudot` loop that only ran once. We preserve it.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">for</span> (PetscInt pseudot = 0; pseudot &lt; 1; pseudot++) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">// Loop over each block to perform the RK stages</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>; bi++) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">for</span> (istage = 0; istage &lt; 4; istage++) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  Block %d, RK Stage %d (alpha=%.4f)...\n&quot;</span>, bi, istage, alfa[istage]);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="comment">// a. Calculate the Right-Hand Side (RHS) of the momentum equation.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                ierr = <a class="code" href="rhs_8h.html#ae8a0a7cb4587034d295f6c7f23d70465">FormFunction1</a>(&amp;user[bi], user[bi].Rhs); CHKERRQ(ierr);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="comment">// b. Advance Ucont to the next intermediate stage using the RK coefficient.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <span class="comment">//    Ucont_new = Ucont_old + alpha * dt * RHS</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                ierr = VecWAXPY(user[bi].Ucont, alfa[istage] * dt * st, user[bi].Rhs, user[bi].Ucont_o); CHKERRQ(ierr);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <span class="comment">// c. Update local ghost values for the new intermediate Ucont.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                ierr = DMGlobalToLocalBegin(user[bi].fda, user[bi].Ucont, INSERT_VALUES, user[bi].lUcont); CHKERRQ(ierr);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                ierr = DMGlobalToLocalEnd(user[bi].fda, user[bi].Ucont, INSERT_VALUES, user[bi].lUcont); CHKERRQ(ierr);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="comment">// d. Re-apply boundary conditions for the new intermediate velocity.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="comment">//    This is crucial for the stability and accuracy of the multi-stage scheme.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                ierr = <a class="code" href="Boundaries_8h.html#abd9b573f8f42ea93e265da37a0673f24">InflowFlux</a>(&amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                ierr = <a class="code" href="Boundaries_8h.html#a684320111be78b3001fda2ba25638e79">OutflowFlux</a>(&amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                ierr = <a class="code" href="Boundaries_8h.html#adcd96cff4b9e15e03cdff9f5ea695dec">FormBCS</a>(&amp;user[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            } <span class="comment">// End of RK stages for one block</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">            // Final IBM Interpolation for the block (if enabled)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">            if (simCtx-&gt;immersed) {</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">                LOG_ALLOW(LOCAL, LOG_DEBUG, &quot;  Performing post-RK IBM interpolation for block %d.\n&quot;, bi);</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">                for (PetscInt ibi = 0; ibi &lt; simCtx-&gt;NumberOfBodies; ibi++) {</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">                    ierr = ibm_interpolation_advanced(&amp;user[bi], &amp;ibm[ibi], ibi, 1); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        } <span class="comment">// End loop over blocks</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// --- 3. Inter-Block Communication (Legacy Logic) ---</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// This is called after all blocks have completed their RK stages.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a> &gt; 1) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="comment">//    LOG_ALLOW(GLOBAL, LOG_DEBUG, &quot;Updating multi-block interfaces after RK stages.\n&quot;);</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="comment">//   ierr = Block_Interface_U(user); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    } <span class="comment">// End of pseudo-time loop</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// --- 4. Cleanup ---</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// Destroy the RHS vectors that were created at the start of this function.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>; bi++) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        ierr = VecDestroy(&amp;user[bi].Rhs); CHKERRQ(ierr);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Runge-Kutta solve completed for all blocks.\n&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="variables__old_8h_a89ae58d48076ba82dc70438b5e389bf5_cgraph.svg" width="458" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae7099f2ad08892d7a4327e6a4e442c4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7099f2ad08892d7a4327e6a4e442c4f">&#9670;&nbsp;</a></span>Solve_K_Omega()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Solve_K_Omega </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c40d1283bc7686edd12fb2eb651e51e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c40d1283bc7686edd12fb2eb651e51e">&#9670;&nbsp;</a></span>Struc_Solver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Struc_Solver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserMG">UserMG</a> *&#160;</td>
          <td class="paramname"><em>usermg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structIBMNodes">IBMNodes</a> *&#160;</td>
          <td class="paramname"><em>ibm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structFSInfo">FSInfo</a> *&#160;</td>
          <td class="paramname"><em>fsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCstart">Cstart</a> *&#160;</td>
          <td class="paramname"><em>cstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>itr_sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>tistart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscBool *&#160;</td>
          <td class="paramname"><em>DoSCLoop</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ace787c32c54dcbb56d4dad5a885c0936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace787c32c54dcbb56d4dad5a885c0936">&#9670;&nbsp;</a></span>Ucont_P_Binary_Output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Ucont_P_Binary_Output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a74ed1b371c557b826d503a1627351eec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74ed1b371c557b826d503a1627351eec">&#9670;&nbsp;</a></span>wall_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wall_function </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a>&#160;</td>
          <td class="paramname"><em>Ua</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a>&#160;</td>
          <td class="paramname"><em>Uc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *&#160;</td>
          <td class="paramname"><em>Ub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>ustar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="wallfunction_8c_source.html#l00245">245</a> of file <a class="el" href="wallfunction_8c_source.html">wallfunction.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;{</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordtype">double</span> u_c = Uc.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> - Ua.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, v_c = Uc.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> - Ua.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, w_c = Uc.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> - Ua.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordtype">double</span> un = u_c * nx + v_c * ny + w_c * nz;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">double</span> ut = u_c - un * nx, vt = v_c - un * ny, wt = w_c - un * nz;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">double</span> ut_mag = sqrt( ut*ut + vt*vt + wt*wt );</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">//*ustar = find_utau_Cabot(1./simCtx-&gt;ren, ut_mag, sc, 0.01, 0);</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordtype">double</span> utau=0.05;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">double</span> ut_mag_modeled = <a class="code" href="wallfunction_8c.html#a7ded59b6a455ad3a8db66bea549aa82d">u_Werner</a>(1./simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>, sb, utau);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">//double ut_mag_modeled = u_Cabot(1./simCtx-&gt;ren, sb, *ustar, 0);</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span>(ut_mag&gt;1.e-10) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        ut *= ut_mag_modeled/ut_mag;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        vt *= ut_mag_modeled/ut_mag;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        wt *= ut_mag_modeled/ut_mag;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">else</span> ut=vt=wt=0;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// u = ut + (u.n)n</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    (*Ub).x = ut + sb/sc * un * nx;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    (*Ub).y = vt + sb/sc * un * ny;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    (*Ub).z = wt + sb/sc * un * nz;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    (*Ub).x += Ua.<a class="code" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    (*Ub).y += Ua.<a class="code" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    (*Ub).z += Ua.<a class="code" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="variables__old_8h_a74ed1b371c557b826d503a1627351eec_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a1f57403f8650934f8b2bc977a7728a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f57403f8650934f8b2bc977a7728a93">&#9670;&nbsp;</a></span>clark</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int clark</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag for Clark model formulation. </p>

</div>
</div>
<a id="a0869ece14dd9e44bafd4e7714d5be952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0869ece14dd9e44bafd4e7714d5be952">&#9670;&nbsp;</a></span>i_homo_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i_homo_filter</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a16a7f73a80ca8b7474d0e13fec876c9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16a7f73a80ca8b7474d0e13fec876c9f">&#9670;&nbsp;</a></span>i_periodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int i_periodic</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af184533da5928ad08e8f3e2aaa97df89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af184533da5928ad08e8f3e2aaa97df89">&#9670;&nbsp;</a></span>ii_periodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ii_periodic</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a10349ff47cf37e14fe5b8e592cff37cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10349ff47cf37e14fe5b8e592cff37cc">&#9670;&nbsp;</a></span>j_homo_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int j_homo_filter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00059">59</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a73ebc4b2aa9f7a85a08bee74e63413ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73ebc4b2aa9f7a85a08bee74e63413ff">&#9670;&nbsp;</a></span>j_periodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int j_periodic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00054">54</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a86dd9a8db04235acbf59b7e45df616a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86dd9a8db04235acbf59b7e45df616a7">&#9670;&nbsp;</a></span>jj_periodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int jj_periodic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00055">55</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a3694edd9b37a04a5f0918e7db6e48ad7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3694edd9b37a04a5f0918e7db6e48ad7">&#9670;&nbsp;</a></span>k_homo_filter</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int k_homo_filter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags for applying a homogeneous filter in each direction. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00059">59</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="abbfa4d897c8528d0949dd1dd77be163f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbfa4d897c8528d0949dd1dd77be163f">&#9670;&nbsp;</a></span>k_periodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int k_periodic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Periodicity flags for the main grid. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00054">54</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="acb2967be157af973bf692f2b5c62e65d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb2967be157af973bf692f2b5c62e65d">&#9670;&nbsp;</a></span>kk_periodic</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int kk_periodic</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Periodicity flags for a secondary grid/context. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00055">55</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a6646696f78da622f98f412c48ffecff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6646696f78da622f98f412c48ffecff9">&#9670;&nbsp;</a></span>les</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int les</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag to enable Large Eddy Simulation. </p>

</div>
</div>
<a id="a8ab0b5c9c94575762f583129a64d1adc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ab0b5c9c94575762f583129a64d1adc">&#9670;&nbsp;</a></span>rans</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rans</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag to enable Reynolds-Averaged Navier-Stokes models. </p>

</div>
</div>
<a id="a281cbf74d081b7a33f1d6ff7bf936e0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281cbf74d081b7a33f1d6ff7bf936e0d">&#9670;&nbsp;</a></span>testfilter_1d</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int testfilter_1d</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flags for specific test filters. </p>

<p class="definition">Definition at line <a class="el" href="variables__old_8h_source.html#l00060">60</a> of file <a class="el" href="variables__old_8h_source.html">variables_old.h</a>.</p>

</div>
</div>
<a id="a92ac2d2ceed26829501edf7e35fa4c86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92ac2d2ceed26829501edf7e35fa4c86">&#9670;&nbsp;</a></span>testfilter_ik</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int testfilter_ik</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a45aaac6d22d918755aa24acf785b1241"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45aaac6d22d918755aa24acf785b1241">&#9670;&nbsp;</a></span>wallfunction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int wallfunction</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag to enable wall function models. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a></div><div class="ttdeci">@ BC_FACE_POS_X</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00236">variables_old.h:236</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4a7154d09d7dee5e3dd7f0323dfb4ff3"><div class="ttname"><a href="variables__old_8h.html#a4a7154d09d7dee5e3dd7f0323dfb4ff3">MGCtx::user</a></div><div class="ttdeci">UserCtx * user</div><div class="ttdoc">Pointer to the main application context for this level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00419">variables.h:419</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afef259795cd298f0d543f574536e4dd7"><div class="ttname"><a href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7">VTKFileType</a></div><div class="ttdeci">VTKFileType</div><div class="ttdoc">Enumerates the type of VTK file to be written.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00502">variables_old.h:502</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa266d6a7abcd7483578364c547b428f3a">INLET</a></div><div class="ttdeci">@ INLET</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00243">variables_old.h:243</a></div></div>
<div class="ttc" id="avariables_8h_html_ab6ee189c80a939393b9cfd780774966e"><div class="ttname"><a href="variables_8h.html#ab6ee189c80a939393b9cfd780774966e">SimCtx::Fluxsum</a></div><div class="ttdeci">PetscReal Fluxsum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00532">variables.h:532</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a></div><div class="ttdeci">@ OUTLET</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00244">variables_old.h:244</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aac8e0dd714804b073dbb32c0ad84b2eb"><div class="ttname"><a href="variables__old_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">UserMG::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdoc">Total number of multigrid levels.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00426">variables.h:426</a></div></div>
<div class="ttc" id="avariables_8h_html_a83e58d8ef2d285dc135be286ddc67f01"><div class="ttname"><a href="variables_8h.html#a83e58d8ef2d285dc135be286ddc67f01">SimCtx::MaxDivx</a></div><div class="ttdeci">PetscInt MaxDivx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a></div><div class="ttdeci">@ BC_FACE_NEG_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00237">variables_old.h:237</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afbf649648426b009265d74fade4665ca"><div class="ttname"><a href="variables__old_8h.html#afbf649648426b009265d74fade4665ca">BCS::Uch</a></div><div class="ttdeci">Vec Uch</div><div class="ttdoc">Characteristic velocity for boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00122">variables.h:122</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a7fb47de7893b318ba4e4e12ed46c0712"><div class="ttname"><a href="variables__old_8h.html#a7fb47de7893b318ba4e4e12ed46c0712">UserCtx::da_c</a></div><div class="ttdeci">DM * da_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00643">variables.h:643</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ac8ba12826d60a51ec54fa7c047d806e1"><div class="ttname"><a href="variables__old_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">UserCtx::lUcont</a></div><div class="ttdeci">Vec lUcont</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a347829443e8a679209e21f7f04f51581"><div class="ttname"><a href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a></div><div class="ttdeci">ParticleLocationStatus</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00123">variables_old.h:123</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ae0a7a10f0bc2adac4b621178b64aa6f6"><div class="ttname"><a href="variables__old_8h.html#ae0a7a10f0bc2adac4b621178b64aa6f6">UserCtx::multinullspace</a></div><div class="ttdeci">PetscBool multinullspace</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00618">variables.h:618</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a77c29afd999c79749fc4a0163da98d2e"><div class="ttname"><a href="variables__old_8h.html#a77c29afd999c79749fc4a0163da98d2e">UserCtx::Bcs</a></div><div class="ttdeci">BCS Bcs</div><div class="ttdoc">Legacy boundary condition structure.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00603">variables.h:603</a></div></div>
<div class="ttc" id="avariables_8h_html_a768740aa4a2ae69549670ebbfea58fc0"><div class="ttname"><a href="variables_8h.html#a768740aa4a2ae69549670ebbfea58fc0">SimCtx::MaxDiv</a></div><div class="ttdeci">PetscReal MaxDiv</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00567">variables.h:567</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a></div><div class="ttdeci">@ TOP</div><div class="ttdoc">Top face (y+)</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00170">variables_old.h:170</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa26cfafb620f75f7cf36a184604455ae"><div class="ttname"><a href="variables__old_8h.html#aa26cfafb620f75f7cf36a184604455ae">UserCtx::FluxIntfcSum</a></div><div class="ttdeci">PetscReal FluxIntfcSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00606">variables.h:606</a></div></div>
<div class="ttc" id="avariables_8h_html_af0af02fbd08daea87f3523a3754981f0"><div class="ttname"><a href="variables_8h.html#af0af02fbd08daea87f3523a3754981f0">COEF_TIME_ACCURACY</a></div><div class="ttdeci">#define COEF_TIME_ACCURACY</div><div class="ttdoc">Coefficient controlling the temporal accuracy scheme (e.g., 1.5 for BDF2).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00057">variables.h:57</a></div></div>
<div class="ttc" id="avariables_8h_html_ac9684d6e871566d55c997416270b5b99"><div class="ttname"><a href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">SimCtx::step</a></div><div class="ttdeci">PetscInt step</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00482">variables.h:482</a></div></div>
<div class="ttc" id="avariables_8h_html_a2e1d74f612f5443c8ece068511563453"><div class="ttname"><a href="variables_8h.html#a2e1d74f612f5443c8ece068511563453">SimCtx::channelz</a></div><div class="ttdeci">PetscInt channelz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00523">variables.h:523</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a95078248cc49ce19d5d05b14e1701888"><div class="ttname"><a href="variables__old_8h.html#a95078248cc49ce19d5d05b14e1701888">UserCtx::lP</a></div><div class="ttdeci">Vec lP</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a67c35e6b366d28db7510776d6d187d35"><div class="ttname"><a href="variables__old_8h.html#a67c35e6b366d28db7510776d6d187d35">node::Node</a></div><div class="ttdeci">PetscInt Node</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00003">list.h:3</a></div></div>
<div class="ttc" id="avariables_8h_html_aef90766eec6fc6887cd39bd1d79cb6d2"><div class="ttname"><a href="variables_8h.html#aef90766eec6fc6887cd39bd1d79cb6d2">SimCtx::immersed</a></div><div class="ttdeci">PetscInt immersed</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00495">variables.h:495</a></div></div>
<div class="ttc" id="alogging_8h_html_ab0414bd7dfd804d39019da707808a819"><div class="ttname"><a href="logging_8h.html#ab0414bd7dfd804d39019da707808a819">DualKSPMonitor</a></div><div class="ttdeci">PetscErrorCode DualKSPMonitor(KSP ksp, PetscInt it, PetscReal rnorm, void *ctx)</div><div class="ttdoc">A custom KSP monitor that logs to a file and optionally to the console.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00759">logging.c:759</a></div></div>
<div class="ttc" id="aBoundaries_8h_html_abd9b573f8f42ea93e265da37a0673f24"><div class="ttname"><a href="Boundaries_8h.html#abd9b573f8f42ea93e265da37a0673f24">InflowFlux</a></div><div class="ttdeci">PetscErrorCode InflowFlux(UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="Boundaries_8c_source.html#l00819">Boundaries.c:819</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structUserCtx"><div class="ttname"><a href="variables__old_8h.html#structUserCtx">UserCtx</a></div><div class="ttdoc">User-defined context containing data specific to a single computational grid level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00582">variables.h:582</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a"><div class="ttname"><a href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a73a50b46251a0e24a0e2ed0e0082003a">NEEDS_LOCATION</a></div><div class="ttdeci">@ NEEDS_LOCATION</div><div class="ttdoc">The particle's host cell is unknown or invalid.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00130">variables_old.h:130</a></div></div>
<div class="ttc" id="avariables_8h_html_a6a5533a086f46652d5587ae84ec62c9f"><div class="ttname"><a href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">SimCtx::StartStep</a></div><div class="ttdeci">PetscInt StartStep</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00484">variables.h:484</a></div></div>
<div class="ttc" id="avariables_8h_html_a1bec6eafffafc2eecc2efb4377e6fed1"><div class="ttname"><a href="variables_8h.html#a1bec6eafffafc2eecc2efb4377e6fed1">SimCtx::LV</a></div><div class="ttdeci">PetscInt LV</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00501">variables.h:501</a></div></div>
<div class="ttc" id="avariables__old_8h_html_acb5123619f6844033498dbbd1f46b8d0"><div class="ttname"><a href="variables__old_8h.html#acb5123619f6844033498dbbd1f46b8d0">UserCtx::lAj</a></div><div class="ttdeci">Vec lAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables_8h_html_a64c0b8cda05b216ac96fc09da38c3c70"><div class="ttname"><a href="variables_8h.html#a64c0b8cda05b216ac96fc09da38c3c70">SimCtx::ccc</a></div><div class="ttdeci">PetscInt ccc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00535">variables.h:535</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a41951f47cfbe9c08def29998a76dc791"><div class="ttname"><a href="variables__old_8h.html#a41951f47cfbe9c08def29998a76dc791">UserCtx::assignedA</a></div><div class="ttdeci">PetscBool assignedA</div><div class="ttdoc">Flag indicating if matrix A has been assigned.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00621">variables.h:621</a></div></div>
<div class="ttc" id="asetup_8c_html_a3d538200fed5b9ee9d1ef391bb61036c"><div class="ttname"><a href="setup_8c.html#a3d538200fed5b9ee9d1ef391bb61036c">Gidx</a></div><div class="ttdeci">static PetscInt Gidx(PetscInt i, PetscInt j, PetscInt k, UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01998">setup.c:1998</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a96938d329a797441f228ecddd8e8e607"><div class="ttname"><a href="variables__old_8h.html#a96938d329a797441f228ecddd8e8e607">UserCtx::lJEta</a></div><div class="ttdeci">Vec lJEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00628">variables.h:628</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a></div><div class="ttdeci">@ NUM_FACES</div><div class="ttdoc">Total number of faces.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00173">variables_old.h:173</a></div></div>
<div class="ttc" id="avariables_8h_html_a0ca5cdac6f3648539846966855d2b75a"><div class="ttname"><a href="variables_8h.html#a0ca5cdac6f3648539846966855d2b75a">SimCtx::moveframe</a></div><div class="ttdeci">PetscInt moveframe</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00496">variables.h:496</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a2cda7005f38b4f15851a13afa70f1b3d"><div class="ttname"><a href="variables__old_8h.html#a2cda7005f38b4f15851a13afa70f1b3d">UserCtx::user_f</a></div><div class="ttdeci">UserCtx * user_f</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00642">variables.h:642</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a33be93b070fc9c810103ca3b646d16a5"><div class="ttname"><a href="variables__old_8h.html#a33be93b070fc9c810103ca3b646d16a5">list::head</a></div><div class="ttdeci">node * head</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00008">list.h:8</a></div></div>
<div class="ttc" id="apoisson_8c_html_a26f0e6321b7ace56b3b105e1eb10475e"><div class="ttname"><a href="poisson_8c.html#a26f0e6321b7ace56b3b105e1eb10475e">PoissonLHSNew</a></div><div class="ttdeci">PetscErrorCode PoissonLHSNew(UserCtx *user)</div><div class="ttdoc">Assembles the Left-Hand Side (LHS) matrix for the Pressure Poisson Equation.</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l02232">poisson.c:2232</a></div></div>
<div class="ttc" id="apoisson_8c_html_a0f0addfc422c642ad5eb5315ace4ff2f"><div class="ttname"><a href="poisson_8c.html#a0f0addfc422c642ad5eb5315ace4ff2f">MyNvertRestriction</a></div><div class="ttdeci">PetscErrorCode MyNvertRestriction(UserCtx *user_h, UserCtx *user_c)</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l03859">poisson.c:3859</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a></div><div class="ttdeci">@ FRONT</div><div class="ttdoc">Front face (z-)</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00171">variables_old.h:171</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a3f7d6c40e13da36f13d6b34c4a304950"><div class="ttname"><a href="variables__old_8h.html#a3f7d6c40e13da36f13d6b34c4a304950">UserCtx::da_f</a></div><div class="ttdeci">DM * da_f</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00643">variables.h:643</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faaa18d562b4107edccb2e10090864d1c5e">SYMMETRY</a></div><div class="ttdeci">@ SYMMETRY</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00243">variables_old.h:243</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a5ac839bb6636888ef19a109bca5de462">BC_HANDLER_WALL_MOVING</a></div><div class="ttdeci">@ BC_HANDLER_WALL_MOVING</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00250">variables_old.h:250</a></div></div>
<div class="ttc" id="avariables_8h_html_a937a59194fd0b844bc61a175d8ae6a30"><div class="ttname"><a href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">SimCtx::FluxInSum</a></div><div class="ttdeci">PetscReal FluxInSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00532">variables.h:532</a></div></div>
<div class="ttc" id="apoisson_8c_html_aaec10e12d0e5fba6c1f53e47d62b6efe"><div class="ttname"><a href="poisson_8c.html#aaec10e12d0e5fba6c1f53e47d62b6efe">FullyBlocked</a></div><div class="ttdeci">PetscErrorCode FullyBlocked(UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l03776">poisson.c:3776</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a771c8e564dcfe2d27c913ef90bbe9337"><div class="ttname"><a href="variables__old_8h.html#a771c8e564dcfe2d27c913ef90bbe9337">UserCtx::bctype</a></div><div class="ttdeci">PetscInt bctype[6]</div><div class="ttdoc">Legacy integer array for BC types per face.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00605">variables.h:605</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00474">variables.h:474</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a></div><div class="ttdeci">@ RIGHT</div><div class="ttdoc">Right face (x+)</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00168">variables_old.h:168</a></div></div>
<div class="ttc" id="aBoundaries_8h_html_a684320111be78b3001fda2ba25638e79"><div class="ttname"><a href="Boundaries_8h.html#a684320111be78b3001fda2ba25638e79">OutflowFlux</a></div><div class="ttdeci">PetscErrorCode OutflowFlux(UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="Boundaries_8c_source.html#l01165">Boundaries.c:1165</a></div></div>
<div class="ttc" id="aBoundaries_8h_html_adcd96cff4b9e15e03cdff9f5ea695dec"><div class="ttname"><a href="Boundaries_8h.html#adcd96cff4b9e15e03cdff9f5ea695dec">FormBCS</a></div><div class="ttdeci">PetscErrorCode FormBCS(UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="Boundaries_8c_source.html#l01261">Boundaries.c:1261</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a58d3237c97d6f16130867370858d5bad"><div class="ttname"><a href="variables__old_8h.html#a58d3237c97d6f16130867370858d5bad">UserCtx::lUstar</a></div><div class="ttdeci">Vec lUstar</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00604">variables.h:604</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1af7b255ab5636e4d3be43326b5eaae453">BC_HANDLER_UNDEFINED</a></div><div class="ttdeci">@ BC_HANDLER_UNDEFINED</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00249">variables_old.h:249</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faa605159e8a4c32319fd69b5d151369d93"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa605159e8a4c32319fd69b5d151369d93">UNDEFINED</a></div><div class="ttdeci">@ UNDEFINED</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00243">variables_old.h:243</a></div></div>
<div class="ttc" id="arhs_8c_html_a3e0cf2a027c25bb1f6510d4a7e5d4870"><div class="ttname"><a href="rhs_8c.html#a3e0cf2a027c25bb1f6510d4a7e5d4870">Viscous</a></div><div class="ttdeci">PetscErrorCode Viscous(UserCtx *user, Vec Ucont, Vec Ucat, Vec Visc)</div><div class="ttdef"><b>Definition:</b> <a href="rhs_8c_source.html#l00580">rhs.c:580</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a562229d30c48165ba8864b067786f079">BC_HANDLER_INLET_DEVELOPED_PROFILE</a></div><div class="ttdeci">@ BC_HANDLER_INLET_DEVELOPED_PROFILE</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00252">variables_old.h:252</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structnode"><div class="ttname"><a href="variables__old_8h.html#structnode">node</a></div><div class="ttdoc">A generic C-style linked list node for integers.</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00002">list.h:2</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08fa"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08fa">BCType</a></div><div class="ttdeci">BCType</div><div class="ttdoc">Defines the general mathematical/physical category of a boundary.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00242">variables_old.h:242</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317"><div class="ttname"><a href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a339435bd0d4a842c6107333c908a5317">LOST</a></div><div class="ttdeci">@ LOST</div><div class="ttdoc">The particle could not be located and is considered lost.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00154">variables_old.h:154</a></div></div>
<div class="ttc" id="avariables_8h_html_a0e237daee9fc063a6563c731846eca76"><div class="ttname"><a href="variables_8h.html#a0e237daee9fc063a6563c731846eca76">SimCtx::TwoD</a></div><div class="ttdeci">PetscInt TwoD</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00496">variables.h:496</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1ab3873aa611c29374b17b00cf17c3e59b">BC_HANDLER_SYMMETRY_PLANE</a></div><div class="ttdeci">@ BC_HANDLER_SYMMETRY_PLANE</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00251">variables_old.h:251</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18"><div class="ttname"><a href="variables_8h.html#a0a00003814ee8095a2c39d1d5cba08faae1ba6a2cab8245290be27ffde2a46d18">OUTLET</a></div><div class="ttdeci">@ OUTLET</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00212">variables.h:212</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ace2eeedc863d73caaf51bb83aa993e44"><div class="ttname"><a href="variables__old_8h.html#ace2eeedc863d73caaf51bb83aa993e44">UserCtx::lUcat</a></div><div class="ttdeci">Vec lUcat</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294f"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294f">Face</a></div><div class="ttdeci">Face</div><div class="ttdoc">Enumerates the six faces of a cubic cell for distance calculations.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00166">variables_old.h:166</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a5a73aa2bc6be44bc1ff8847cf0a1b6af"><div class="ttname"><a href="variables__old_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">UserCtx::P</a></div><div class="ttdeci">Vec P</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4d561e219e8bc40951d121cce66d93ce"><div class="ttname"><a href="variables__old_8h.html#a4d561e219e8bc40951d121cce66d93ce">UserCtx::lIAj</a></div><div class="ttdeci">Vec lIAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ae8527c7cba1c5764994053481722eb01"><div class="ttname"><a href="variables__old_8h.html#ae8527c7cba1c5764994053481722eb01">UserCtx::lJAj</a></div><div class="ttdeci">Vec lJAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00628">variables.h:628</a></div></div>
<div class="ttc" id="avariables__old_8h_html_addaea1781031d3f9ff945d87e8c5b728"><div class="ttname"><a href="variables__old_8h.html#addaea1781031d3f9ff945d87e8c5b728">UserCtx::Centy</a></div><div class="ttdeci">Vec Centy</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00626">variables.h:626</a></div></div>
<div class="ttc" id="apoisson_8c_html_a9340445ae2c0a3c7be290e2a1aea3d67"><div class="ttname"><a href="poisson_8c.html#a9340445ae2c0a3c7be290e2a1aea3d67">PoissonRHS</a></div><div class="ttdeci">PetscErrorCode PoissonRHS(UserCtx *user, Vec B)</div><div class="ttdoc">Computes the Right-Hand-Side (RHS) of the Poisson equation, which is the divergence of the intermedia...</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l02829">poisson.c:2829</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9b9e67bbc48d48f825de0639526c0a4f"><div class="ttname"><a href="variables__old_8h.html#a9b9e67bbc48d48f825de0639526c0a4f">UserCtx::lNvert_c</a></div><div class="ttdeci">Vec * lNvert_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00644">variables.h:644</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329"><div class="ttname"><a href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581af0c3b8144a24d2379a1580a6cd48d329">MIGRATING_OUT</a></div><div class="ttdeci">@ MIGRATING_OUT</div><div class="ttdoc">The particle has been identified as needing to move to another rank.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00146">variables_old.h:146</a></div></div>
<div class="ttc" id="avariables__old_8h_html_acbf784310453bd7aec02838cdef24a66"><div class="ttname"><a href="variables__old_8h.html#acbf784310453bd7aec02838cdef24a66">UserCtx::lICsi</a></div><div class="ttdeci">Vec lICsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="awallfunction_8h_html_a82a96fd4f826d93b926bea9bb776b93e"><div class="ttname"><a href="wallfunction_8h.html#a82a96fd4f826d93b926bea9bb776b93e">noslip</a></div><div class="ttdeci">void noslip(UserCtx *user, double sc, double sb, Cmpnts Ua, Cmpnts Uc, Cmpnts *Ub, double nx, double ny, double nz)</div><div class="ttdef"><b>Definition:</b> <a href="wallfunction_8c_source.html#l00013">wallfunction.c:13</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ac5212e2fb1eeb3323ab8c063aef6a498"><div class="ttname"><a href="variables__old_8h.html#ac5212e2fb1eeb3323ab8c063aef6a498">UserCtx::MP</a></div><div class="ttdeci">Mat MP</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00620">variables.h:620</a></div></div>
<div class="ttc" id="avariables_8h_html_a8811a9a632140d00bca04337f2261d23"><div class="ttname"><a href="variables_8h.html#a8811a9a632140d00bca04337f2261d23">SimCtx::MaxDivy</a></div><div class="ttdeci">PetscInt MaxDivy</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="asetup_8h_html_a515c9a96eb4bcac29f79e78c8882d7aa"><div class="ttname"><a href="setup_8h.html#a515c9a96eb4bcac29f79e78c8882d7aa">Contra2Cart</a></div><div class="ttdeci">PetscErrorCode Contra2Cart(UserCtx *user)</div><div class="ttdoc">Reconstructs Cartesian velocity (Ucat) at cell centers from contravariant velocity (Ucont) defined on...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01729">setup.c:1729</a></div></div>
<div class="ttc" id="avariables_8h_html_a8b2e7f4d2e2e95e4c49aa02684e2e51d"><div class="ttname"><a href="variables_8h.html#a8b2e7f4d2e2e95e4c49aa02684e2e51d">SimCtx::MaxDivz</a></div><div class="ttdeci">PetscInt MaxDivz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a77888fe1930df923549faaf5951455ba"><div class="ttname"><a href="variables__old_8h.html#a77888fe1930df923549faaf5951455ba">UserCtx::Centx</a></div><div class="ttdeci">Vec Centx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00626">variables.h:626</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa0f10efbfba88094aa07cee1cdb0baff"><div class="ttname"><a href="variables__old_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">UserCtx::lKCsi</a></div><div class="ttdeci">Vec lKCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00629">variables.h:629</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structMGCtx"><div class="ttname"><a href="variables__old_8h.html#structMGCtx">MGCtx</a></div><div class="ttdoc">Context for Multigrid operations.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00418">variables.h:418</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a247e4c6e2fe8ce63fa129ec7a5b1d5ad">BC_HANDLER_INLET_PARABOLIC</a></div><div class="ttdeci">@ BC_HANDLER_INLET_PARABOLIC</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00251">variables_old.h:251</a></div></div>
<div class="ttc" id="awallfunction_8h_html_aae67d9282b09691fffdea6f1012e6df7"><div class="ttname"><a href="wallfunction_8h.html#aae67d9282b09691fffdea6f1012e6df7">wall_function_loglaw</a></div><div class="ttdeci">void wall_function_loglaw(UserCtx *user, double ks, double sc, double sb, Cmpnts Ua, Cmpnts Uc, Cmpnts *Ub, PetscReal *ustar, double nx, double ny, double nz)</div><div class="ttdef"><b>Definition:</b> <a href="wallfunction_8c_source.html#l00276">wallfunction.c:276</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9693ebf5c9ea601d5ebaf6d24cc60721"><div class="ttname"><a href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">UserCtx::lCsi</a></div><div class="ttdeci">Vec lCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="alogging_8h_html_aeb27d528b5c766bb8c213bb2112a79f6"><div class="ttname"><a href="logging_8h.html#aeb27d528b5c766bb8c213bb2112a79f6">DualMonitorCtx::block_id</a></div><div class="ttdeci">PetscInt block_id</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00068">logging.h:68</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a4f7c5fd8843d026101b193e9236e1192"><div class="ttname"><a href="variables__old_8h.html#a4f7c5fd8843d026101b193e9236e1192">UserCtx::_this</a></div><div class="ttdeci">PetscInt _this</div><div class="ttdoc">Legacy block index, for multi-block contexts.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00595">variables.h:595</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a></div><div class="ttdeci">@ BOTTOM</div><div class="ttdoc">Bottom face (y-)</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00169">variables_old.h:169</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad29bf4d78039031aef92981faa325c94"><div class="ttname"><a href="variables__old_8h.html#ad29bf4d78039031aef92981faa325c94">UserCtx::FluxIntpSum</a></div><div class="ttdeci">PetscReal FluxIntpSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00606">variables.h:606</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a48e8ab3e61445049929bc2664450e3b7">BC_HANDLER_INTERFACE_OVERSET</a></div><div class="ttdeci">@ BC_HANDLER_INTERFACE_OVERSET</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00255">variables_old.h:255</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa994deb5e50b841824b257d6d2d108757">FARFIELD</a></div><div class="ttdeci">@ FARFIELD</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00244">variables_old.h:244</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a2283f432e972416db48600d533f23576">BC_HANDLER_INLET_PULSANTILE_FLUX</a></div><div class="ttdeci">@ BC_HANDLER_INLET_PULSANTILE_FLUX</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00252">variables_old.h:252</a></div></div>
<div class="ttc" id="avariables_8h_html_a22580e0e52ca8ddccc76d24c96f00e4a"><div class="ttname"><a href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">SimCtx::block_number</a></div><div class="ttdeci">PetscInt block_number</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00523">variables.h:523</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="avariables_8h_html_a35819a5678c9c37c2f8b55c2091a9a05"><div class="ttname"><a href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">SimCtx::FluxOutSum</a></div><div class="ttdeci">PetscReal FluxOutSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00532">variables.h:532</a></div></div>
<div class="ttc" id="arhs_8h_html_ae8a0a7cb4587034d295f6c7f23d70465"><div class="ttname"><a href="rhs_8h.html#ae8a0a7cb4587034d295f6c7f23d70465">FormFunction1</a></div><div class="ttdeci">PetscErrorCode FormFunction1(UserCtx *user, Vec Rhs)</div><div class="ttdoc">Computes the Right-Hand Side (RHS) of the momentum equations.</div><div class="ttdef"><b>Definition:</b> <a href="rhs_8c_source.html#l01231">rhs.c:1231</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a414751d7a391a78834cdce87b52a066f"><div class="ttname"><a href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">UserCtx::lZet</a></div><div class="ttdeci">Vec lZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a3998b7b5dad8340caf395c5da62230b7"><div class="ttname"><a href="variables__old_8h.html#a3998b7b5dad8340caf395c5da62230b7">UserCtx::Centz</a></div><div class="ttdeci">Vec Centz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00626">variables.h:626</a></div></div>
<div class="ttc" id="avariables_8h_html_aa60ee4e3f8eca251ee470427f1ebac13"><div class="ttname"><a href="variables_8h.html#aa60ee4e3f8eca251ee470427f1ebac13">SimCtx::wallfunction</a></div><div class="ttdeci">PetscInt wallfunction</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00540">variables.h:540</a></div></div>
<div class="ttc" id="alogging_8h_html_aa987297fa072943c2409f3b2cc4e31f9"><div class="ttname"><a href="logging_8h.html#aa987297fa072943c2409f3b2cc4e31f9">LOG_LOOP_ALLOW_EXACT</a></div><div class="ttdeci">#define LOG_LOOP_ALLOW_EXACT(scope, level, var, val, fmt,...)</div><div class="ttdoc">Logs a custom message if a variable equals a specific value.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00355">logging.h:355</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a7a1cf0e107351a96b27ae00160e60271"><div class="ttname"><a href="variables__old_8h.html#a7a1cf0e107351a96b27ae00160e60271">UserCtx::lPhi</a></div><div class="ttdeci">Vec lPhi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad744b47ca3c5f3df2d1b737e432d6f07"><div class="ttname"><a href="variables__old_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">UserCtx::Cent</a></div><div class="ttdeci">Vec Cent</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables_8h_html_a02fd03c4c166911f067e92b36d1820a3"><div class="ttname"><a href="variables_8h.html#a02fd03c4c166911f067e92b36d1820a3">SimCtx::MHV</a></div><div class="ttdeci">PetscInt MHV</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00501">variables.h:501</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a8e6283b2989fae5d0a235baa570e929f"><div class="ttname"><a href="variables__old_8h.html#a8e6283b2989fae5d0a235baa570e929f">UserCtx::lKZet</a></div><div class="ttdeci">Vec lKZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00629">variables.h:629</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structCmpnts"><div class="ttname"><a href="variables__old_8h.html#structCmpnts">Cmpnts</a></div><div class="ttdoc">A 3D point or vector with PetscScalar components.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00100">variables.h:100</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa56690e5e62dbaca19fd78dcfe5d78544">INTERFACE</a></div><div class="ttdeci">@ INTERFACE</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00244">variables_old.h:244</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a2276cb159119246bfadea1c234dee31b"><div class="ttname"><a href="variables__old_8h.html#a2276cb159119246bfadea1c234dee31b">UserCtx::lIEta</a></div><div class="ttdeci">Vec lIEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ab7a460d0a7eaa2d76d0b6267310c3184"><div class="ttname"><a href="variables__old_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">UserCtx::lJZet</a></div><div class="ttdeci">Vec lJZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00628">variables.h:628</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad4296b10d8eb7b065165582f5cc85897"><div class="ttname"><a href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">UserCtx::lEta</a></div><div class="ttdeci">Vec lEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables_8h_html_a57b3c5733ac4acdef370e635e85df95f"><div class="ttname"><a href="variables_8h.html#a57b3c5733ac4acdef370e635e85df95f">SimCtx::inletprofile</a></div><div class="ttdeci">PetscInt inletprofile</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00523">variables.h:523</a></div></div>
<div class="ttc" id="apoisson_8c_html_a2648a0c6cafb7916a706cd757e5b92f5"><div class="ttname"><a href="poisson_8c.html#a2648a0c6cafb7916a706cd757e5b92f5">PoissonNullSpaceFunction</a></div><div class="ttdeci">PetscErrorCode PoissonNullSpaceFunction(MatNullSpace nullsp, Vec X, void *ctx)</div><div class="ttdoc">The callback function for PETSc's MatNullSpace object.</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l01714">poisson.c:1714</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ada2db2a63cf3a9fe7ad2abf01cedc818"><div class="ttname"><a href="variables__old_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">UserCtx::Nvert</a></div><div class="ttdeci">Vec Nvert</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbaf"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbaf">BCFace</a></div><div class="ttdeci">BCFace</div><div class="ttdoc">Identifies the six logical faces of a structured computational block.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00235">variables_old.h:235</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a5222a315981e705b07b070e49cb31f9d"><div class="ttname"><a href="variables__old_8h.html#a5222a315981e705b07b070e49cb31f9d">IBMListNode::next</a></div><div class="ttdeci">struct IBMListNode * next</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00055">list.h:55</a></div></div>
<div class="ttc" id="avariables__old_8h_html_acd99423029a666652ee1f5bf573619bc"><div class="ttname"><a href="variables__old_8h.html#acd99423029a666652ee1f5bf573619bc">UserCtx::info</a></div><div class="ttdeci">DMDALocalInfo info</div><div class="ttdoc">Cached local grid info for the current rank.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00589">variables.h:589</a></div></div>
<div class="ttc" id="avariables_8h_html_a19aa807b9181b13618527d6c4eb6fa89"><div class="ttname"><a href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">SimCtx::rank</a></div><div class="ttdeci">PetscMPIInt rank</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00477">variables.h:477</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a02a65fc528fb6c4e468c54686cde3171"><div class="ttname"><a href="variables__old_8h.html#a02a65fc528fb6c4e468c54686cde3171">IBMList::head</a></div><div class="ttdeci">IBMListNode * head</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00059">list.h:59</a></div></div>
<div class="ttc" id="awallfunction_8c_html_a7ded59b6a455ad3a8db66bea549aa82d"><div class="ttname"><a href="wallfunction_8c.html#a7ded59b6a455ad3a8db66bea549aa82d">u_Werner</a></div><div class="ttdeci">double u_Werner(double nu, double y, double utau)</div><div class="ttdef"><b>Definition:</b> <a href="wallfunction_8c_source.html#l00145">wallfunction.c:145</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a6ef13ed6ab8f82c44bd8a81739ff90e2"><div class="ttname"><a href="variables__old_8h.html#a6ef13ed6ab8f82c44bd8a81739ff90e2">BCS::Ubcs</a></div><div class="ttdeci">Vec Ubcs</div><div class="ttdoc">Boundary condition velocity values. (Comment: &quot;An ugly hack, waste of memory&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00121">variables.h:121</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a718a09fbedf450248eaf7019a980e139"><div class="ttname"><a href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">Cmpnts::x</a></div><div class="ttdeci">PetscScalar x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="alogging_8h_html_structDualMonitorCtx"><div class="ttname"><a href="logging_8h.html#structDualMonitorCtx">DualMonitorCtx</a></div><div class="ttdoc">Context for a dual-purpose KSP monitor.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00063">logging.h:63</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8e4d319e69db46cfeb7c907264066f0a">BC_HANDLER_WALL_NOSLIP</a></div><div class="ttdeci">@ BC_HANDLER_WALL_NOSLIP</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00250">variables_old.h:250</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1">BCHandlerType</a></div><div class="ttdeci">BCHandlerType</div><div class="ttdoc">Defines the specific computational &quot;strategy&quot; for a boundary handler.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00248">variables_old.h:248</a></div></div>
<div class="ttc" id="arhs_8c_html_a59a4e489633014a0f4e1e85318d395d3"><div class="ttname"><a href="rhs_8c.html#a59a4e489633014a0f4e1e85318d395d3">Convection</a></div><div class="ttdeci">PetscErrorCode Convection(UserCtx *user, Vec Ucont, Vec Ucat, Vec Conv)</div><div class="ttdef"><b>Definition:</b> <a href="rhs_8c_source.html#l00087">rhs.c:87</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9"><div class="ttname"><a href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a></div><div class="ttdeci">@ VTK_STRUCTURED</div><div class="ttdoc">For .vts (StructuredGrid) files from Eulerian data.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00503">variables_old.h:503</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a></div><div class="ttdeci">@ BACK</div><div class="ttdoc">Back face (z+)</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00172">variables_old.h:172</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a></div><div class="ttdeci">@ BC_FACE_NEG_X</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00236">variables_old.h:236</a></div></div>
<div class="ttc" id="apoisson_8c_html_aa2fc17959230252f30b2278d81a16caf"><div class="ttname"><a href="poisson_8c.html#aa2fc17959230252f30b2278d81a16caf">MyInterpolation</a></div><div class="ttdeci">PetscErrorCode MyInterpolation(Mat A, Vec X, Vec F)</div><div class="ttdoc">The callback function for the multigrid interpolation operator (MatShell).</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l01907">poisson.c:1907</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8efec6d0827e764925c321a471027e32">BC_HANDLER_OUTLET_CONSERVATION</a></div><div class="ttdeci">@ BC_HANDLER_OUTLET_CONSERVATION</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00253">variables_old.h:253</a></div></div>
<div class="ttc" id="alogging_8h_html_a34c7203eac55e4ac9f075e106a7afe5f"><div class="ttname"><a href="logging_8h.html#a34c7203eac55e4ac9f075e106a7afe5f">DualMonitorCtx::log_to_console</a></div><div class="ttdeci">PetscBool log_to_console</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00065">logging.h:65</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1aa4d79583b798695cc49e68bb8548f077">BC_HANDLER_OUTLET_PRESSURE</a></div><div class="ttdeci">@ BC_HANDLER_OUTLET_PRESSURE</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00253">variables_old.h:253</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faa3eaeee121cc2f3eb72936dae68db7908">NOGRAD</a></div><div class="ttdeci">@ NOGRAD</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00243">variables_old.h:243</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa1823d873982755996b7335f43732af4"><div class="ttname"><a href="variables__old_8h.html#aa1823d873982755996b7335f43732af4">UserCtx::Ucat</a></div><div class="ttdeci">Vec Ucat</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="apoisson_8c_html_a6046e36e2334fa29a86d652a0b8f0593"><div class="ttname"><a href="poisson_8c.html#a6046e36e2334fa29a86d652a0b8f0593">GhostNodeVelocity</a></div><div class="ttdeci">static PetscErrorCode GhostNodeVelocity(UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l00059">poisson.c:59</a></div></div>
<div class="ttc" id="avariables_8h_html_aecc33b61ded0b8c01e2524094af2504a"><div class="ttname"><a href="variables_8h.html#aecc33b61ded0b8c01e2524094af2504a">SimCtx::rotateframe</a></div><div class="ttdeci">PetscInt rotateframe</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00496">variables.h:496</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a508de73c1c5929cbee04a94091f2799e"><div class="ttname"><a href="variables__old_8h.html#a508de73c1c5929cbee04a94091f2799e">UserCtx::lKEta</a></div><div class="ttdeci">Vec lKEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00629">variables.h:629</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad397aa8cb29c2ca1d2335b897e2f7690"><div class="ttname"><a href="variables__old_8h.html#ad397aa8cb29c2ca1d2335b897e2f7690">UserCtx::MR</a></div><div class="ttdeci">Mat MR</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00620">variables.h:620</a></div></div>
<div class="ttc" id="avariables_8h_html_a9285c06d5e6bee00c9061c27b2b73cb8"><div class="ttname"><a href="variables_8h.html#a9285c06d5e6bee00c9061c27b2b73cb8">SimCtx::MaxDivFlatArg</a></div><div class="ttdeci">PetscInt MaxDivFlatArg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="alogging_8h_html_ae5af09d0145fba810375f6a2069c7098"><div class="ttname"><a href="logging_8h.html#ae5af09d0145fba810375f6a2069c7098">DualMonitorCtx::file_handle</a></div><div class="ttdeci">FILE * file_handle</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00064">logging.h:64</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aee8a3f32f3bdc0dda2f862651708c0f4"><div class="ttname"><a href="variables__old_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">UserCtx::lKAj</a></div><div class="ttdeci">Vec lKAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00629">variables.h:629</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a63b70d5ad8338013a2888928d4106f63"><div class="ttname"><a href="variables__old_8h.html#a63b70d5ad8338013a2888928d4106f63">UserCtx::lJCsi</a></div><div class="ttdeci">Vec lJCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00628">variables.h:628</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a8187c46957c3b674d07ff4ab92c53f6c">BC_HANDLER_NOGRAD_COPY_GHOST</a></div><div class="ttdeci">@ BC_HANDLER_NOGRAD_COPY_GHOST</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00249">variables_old.h:249</a></div></div>
<div class="ttc" id="avariables__old_8h_html_aa213f23946307ee6f278543f23fb28de"><div class="ttname"><a href="variables__old_8h.html#aa213f23946307ee6f278543f23fb28de">IBMListNode::ibm_intp</a></div><div class="ttdeci">IBMInfo ibm_intp</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00054">list.h:54</a></div></div>
<div class="ttc" id="avariables_8h_html_a3ff353812541b8ebba309e8d3ba6674b"><div class="ttname"><a href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">SimCtx::st</a></div><div class="ttdeci">PetscReal st</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00510">variables.h:510</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00207">logging.h:207</a></div></div>
<div class="ttc" id="apoisson_8c_html_a34f6242556bffd27f00a84b377c1bf9d"><div class="ttname"><a href="poisson_8c.html#a34f6242556bffd27f00a84b377c1bf9d">VolumeFlux_rev</a></div><div class="ttdeci">PetscErrorCode VolumeFlux_rev(UserCtx *user, PetscReal *ibm_Flux, PetscReal *ibm_Area, PetscInt flg)</div><div class="ttdoc">A specialized version of VolumeFlux, likely for reversed normals.</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l02906">poisson.c:2906</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa4ce567113013a4c4cafd58543ac2b61e">BC_FACE_POS_Z</a></div><div class="ttdeci">@ BC_FACE_POS_Z</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00238">variables_old.h:238</a></div></div>
<div class="ttc" id="alogging_8h_html_a26f628c9bae473d94674a1a97641b474"><div class="ttname"><a href="logging_8h.html#a26f628c9bae473d94674a1a97641b474">DualMonitorDestroy</a></div><div class="ttdeci">PetscErrorCode DualMonitorDestroy(void **ctx)</div><div class="ttdoc">Destroys the DualMonitorCtx.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00727">logging.c:727</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9b8e75c971d888ab5ccacf8090e1012f">BC_HANDLER_FARFIELD_NONREFLECTING</a></div><div class="ttdeci">@ BC_HANDLER_FARFIELD_NONREFLECTING</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00254">variables_old.h:254</a></div></div>
<div class="ttc" id="avariables_8h_html_a1b08cdba1a7d4de048fbf472edfd5850"><div class="ttname"><a href="variables_8h.html#a1b08cdba1a7d4de048fbf472edfd5850">SimCtx::fish</a></div><div class="ttdeci">PetscInt fish</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00501">variables.h:501</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a111a569ab2765add9b91c9f94cf9f063"><div class="ttname"><a href="variables__old_8h.html#a111a569ab2765add9b91c9f94cf9f063">node::next</a></div><div class="ttdeci">struct node * next</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00004">list.h:4</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faafca2faad41310c7e71ec303ef789c53a">WALL</a></div><div class="ttdeci">@ WALL</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00243">variables_old.h:243</a></div></div>
<div class="ttc" id="avariables_8h_html_a4897d17394963da4ac73b9856fac48c5"><div class="ttname"><a href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">SimCtx::ren</a></div><div class="ttdeci">PetscReal ren</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00510">variables.h:510</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="apoisson_8c_html_a85e1eff3b6e34605b863323d6336eecd"><div class="ttname"><a href="poisson_8c.html#a85e1eff3b6e34605b863323d6336eecd">RestrictResidual_SolidAware</a></div><div class="ttdeci">static PetscErrorCode RestrictResidual_SolidAware(Mat A, Vec X, Vec F)</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l02014">poisson.c:2014</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780"><div class="ttname"><a href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581af096820742c38363e9d6c33e7c932780">UNINITIALIZED</a></div><div class="ttdeci">@ UNINITIALIZED</div><div class="ttdoc">The default state for a newly created particle before any processing.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00161">variables_old.h:161</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065"><div class="ttname"><a href="variables__old_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a></div><div class="ttdeci">@ LEFT</div><div class="ttdoc">Left face (x-)</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00167">variables_old.h:167</a></div></div>
<div class="ttc" id="avariables__old_8h_html_structIBMListNode"><div class="ttname"><a href="variables__old_8h.html#structIBMListNode">IBMListNode</a></div><div class="ttdoc">A linked list node containing IBM interpolation info.</div><div class="ttdef"><b>Definition:</b> <a href="list_8h_source.html#l00053">list.h:53</a></div></div>
<div class="ttc" id="avariables_8h_html_a53b044b8b0e4a4dc8c8fa05387af564c"><div class="ttname"><a href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">SimCtx::dt</a></div><div class="ttdeci">PetscReal dt</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00488">variables.h:488</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9f0c002a2c7cde3b6ac843ab9185f4d4"><div class="ttname"><a href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">Cmpnts::z</a></div><div class="ttdeci">PetscScalar z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafaa686c3443b4073aa247c2446ae9d5c8d">BC_FACE_NEG_Z</a></div><div class="ttdeci">@ BC_FACE_NEG_Z</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00238">variables_old.h:238</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a10f4f7dc00a854759067cf96ab66485a"><div class="ttname"><a href="variables__old_8h.html#a10f4f7dc00a854759067cf96ab66485a">UserMG::mgctx</a></div><div class="ttdeci">MGCtx * mgctx</div><div class="ttdoc">Array of multigrid contexts, one for each level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00429">variables.h:429</a></div></div>
<div class="ttc" id="avariables__old_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdoc">DMDA for scalar fields (e.g., Pressure, Nvert).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="avariables_8h_html_a677188b3aedc7e7d0331e43f8f37ad02"><div class="ttname"><a href="variables_8h.html#a677188b3aedc7e7d0331e43f8f37ad02">SimCtx::ratio</a></div><div class="ttdeci">PetscReal ratio</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00536">variables.h:536</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad032e456f7f4b32b9ac0d94be05de204"><div class="ttname"><a href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">Cmpnts::y</a></div><div class="ttdeci">PetscScalar y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a9879f7f7f2ce1bad8f116b920983236d">BC_HANDLER_PERIODIC</a></div><div class="ttdeci">@ BC_HANDLER_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00255">variables_old.h:255</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb"><div class="ttname"><a href="variables__old_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a></div><div class="ttdeci">@ BC_FACE_POS_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00237">variables_old.h:237</a></div></div>
<div class="ttc" id="avariables_8h_html_a7af448f97fbebfd44e5989614b982a93"><div class="ttname"><a href="variables_8h.html#a7af448f97fbebfd44e5989614b982a93">SimCtx::invicid</a></div><div class="ttdeci">PetscInt invicid</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00496">variables.h:496</a></div></div>
<div class="ttc" id="apoisson_8c_html_a8c4cb4c082ab40cc20db95c962fc1d5c"><div class="ttname"><a href="poisson_8c.html#a8c4cb4c082ab40cc20db95c962fc1d5c">VolumeFlux</a></div><div class="ttdeci">PetscErrorCode VolumeFlux(UserCtx *user, PetscReal *ibm_Flux, PetscReal *ibm_Area, PetscInt flg)</div><div class="ttdoc">Calculates the net flux across the immersed boundary surface.</div><div class="ttdef"><b>Definition:</b> <a href="poisson_8c_source.html#l03148">poisson.c:3148</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58"><div class="ttname"><a href="variables__old_8h.html#a0a00003814ee8095a2c39d1d5cba08faae4379d044711537d9ce3b3b58c575c58">PERIODIC</a></div><div class="ttdeci">@ PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00244">variables_old.h:244</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a69c3a361d1aac3bdc14f971bda57e032"><div class="ttname"><a href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">UserCtx::Ucont</a></div><div class="ttdeci">Vec Ucont</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables_8h_html_ac12eb831808e07c80a03e393a986f93f"><div class="ttname"><a href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">SimCtx::U_bc</a></div><div class="ttdeci">PetscReal U_bc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00534">variables.h:534</a></div></div>
<div class="ttc" id="avariables__old_8h_html_afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57"><div class="ttname"><a href="variables__old_8h.html#afef259795cd298f0d543f574536e4dd7a37bd63d1b8edab46f0e9e6e4a52dfb57">VTK_POLYDATA</a></div><div class="ttdeci">@ VTK_POLYDATA</div><div class="ttdoc">For .vtp (PolyData) files from Lagrangian/particle data.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00504">variables_old.h:504</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253"><div class="ttname"><a href="variables__old_8h.html#a347829443e8a679209e21f7f04f51581a97d609accacbcc1a41e4da5ac052f253">ACTIVE_AND_LOCATED</a></div><div class="ttdeci">@ ACTIVE_AND_LOCATED</div><div class="ttdoc">The particle has been successfully located in a cell owned by the current rank.</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00138">variables_old.h:138</a></div></div>
<div class="ttc" id="alogging_8h_html_a64100408e773bad5a0c07581dc3ab039"><div class="ttname"><a href="logging_8h.html#a64100408e773bad5a0c07581dc3ab039">DualMonitorCtx::step</a></div><div class="ttdeci">PetscInt step</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00067">logging.h:67</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a2db602ea5fce7cec91f19f507f922a74"><div class="ttname"><a href="variables__old_8h.html#a2db602ea5fce7cec91f19f507f922a74">UserCtx::lIZet</a></div><div class="ttdeci">Vec lIZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a2f213dcdaf9617bfb44e4f22857f2e56"><div class="ttname"><a href="variables__old_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">UserCtx::lNvert</a></div><div class="ttdeci">Vec lNvert</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a69966d928601d61d4f526636f84396c5"><div class="ttname"><a href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">UserCtx::fda</a></div><div class="ttdeci">DM fda</div><div class="ttdoc">DMDA for primary 3-component vector fields (e.g., Velocity).</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d"><div class="ttname"><a href="variables__old_8h.html#a466f572ad4e3d8b6f5eb03bceaad2ca1a25bcc12476da9fcbd880e7bd3149017d">BC_HANDLER_INLET_CONSTANT_VELOCITY</a></div><div class="ttdeci">@ BC_HANDLER_INLET_CONSTANT_VELOCITY</div><div class="ttdef"><b>Definition:</b> <a href="variables__old_8h_source.html#l00252">variables_old.h:252</a></div></div>
<div class="ttc" id="avariables_8h_html_a43fb110dc2ce420db6f659f6c055f086"><div class="ttname"><a href="variables_8h.html#a43fb110dc2ce420db6f659f6c055f086">SimCtx::rstart_flg</a></div><div class="ttdeci">PetscBool rstart_flg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00489">variables.h:489</a></div></div>
<div class="ttc" id="avariables_8h_html_aca7ff63d94b0fbd2d541734b7200b0e2"><div class="ttname"><a href="variables_8h.html#aca7ff63d94b0fbd2d541734b7200b0e2">SimCtx::AreaOutSum</a></div><div class="ttdeci">PetscReal AreaOutSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00533">variables.h:533</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a8420a45c7f75054e71e9d8530e52ee8e"><div class="ttname"><a href="variables__old_8h.html#a8420a45c7f75054e71e9d8530e52ee8e">UserCtx::user_c</a></div><div class="ttdeci">UserCtx * user_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00642">variables.h:642</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="variables__old_8h.html">variables_old.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
