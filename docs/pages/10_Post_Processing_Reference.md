@page 09_Post_Processing_Reference Configuration Reference: Post-Processing Recipes (`post.yml`)

For a complete, heavily commented reference file showing every possible option, please see the master template:

@verbinclude master_template/master_postprocessor.yml

A **Post-Processing Recipe** is a `.yml` file that instructs the `postprocessor` executable on how to analyze the raw binary data generated by the solver. Using these recipes, you can perform complex analysis and generate tailored visualization files without writing any new code.

The post-processing workflow is always run via the `pic-flow` conductor using the `--post-process` flag.

@tableofcontents

@section structure_sec 1. Structure of a `post.yml` File

A `post.yml` file is organized into sections that control the time range, data sources, processing steps, and output format.

```yaml
# Example post.yml
run_control:
  startTime: 100
  endTime: 1000
  timeStep: 100

source_data:
  directory: "<solver_output_dir>"

eulerian_pipeline:
  - task: CellToNodeAverage
    input_field: Ucat
    output_field: Ucat_nodal
  - task: ComputeQCriterion

lagrangian_pipeline:
  - task: specific_ke
    input_field: velocity
    output_field: SpecificKE

io:
  output_directory: "viz"
  output_filename_prefix: "Field"
  particle_filename_prefix: "Particle"
  output_particles: true
  eulerian_fields:
    - Ucat_nodal
    - Qcrit
  particle_fields:
    - velocity
    - SpecificKE
```

@section run_control_sec 2. The `run_control` Section

This section specifies which timesteps from the simulation will be analyzed.

| Parameter | Type | Description |
| :--- | :--- | :--- |
| `startTime` | Integer | The first time step to process. |
| `endTime` | Integer | The last time step to process. |
| `timeStep` | Integer | The interval between processed time steps. |

@section source_data_sec 3. The `source_data` Section

This section tells the post-processor where to find the raw solver output.

| Parameter | Type | Description |
| :--- | :--- | :--- |
| `directory` | String | Path to the directory containing the solver's binary output files (`.dat`). The special value **`<solver_output_dir>`** is a placeholder that automatically resolves to the `results` (or equivalent) folder of the run being processed. This is the recommended default. |

@section eulerian_pipeline_sec 4. The `eulerian_pipeline` Section

This is a list of computational tasks (kernels) that are executed in sequence on the Eulerian (grid) data.

@subsection eulerian_kernels_ssec 4.1. Available Eulerian Kernels

| `task` Name | Description | Parameters |
| :--- | :--- | :--- |
| `CellToNodeAverage` | Averages a cell-centered field to the grid nodes. This is essential for creating smooth visualizations. | `input_field`: Name of the cell-centered field (e.g., "Ucat", "P").<br>`output_field`: Name for the new node-centered field (e.g., "Ucat_nodal", "P_nodal"). |
| `ComputeQCriterion` | Computes the Q-criterion, a scalar field used to identify vortices. This creates a new field named `Qcrit`. | *None* |
| `NormalizeRelativeField`| Normalizes a scalar field (like pressure) by subtracting the value at a reference point. | `field`: The name of the field to normalize (e.g., "P").<br>`reference_point`: A list of 3 integers `[i, j, k]` for the reference grid index. |
| `DimensionalizeAllLoadedFields` | (Implicitly available) Converts all loaded non-dimensional fields to dimensional units using the scaling factors from the original `case.yml`. This is usually run automatically. | *None* |

@section lagrangian_pipeline_sec 5. The `lagrangian_pipeline` Section

This is a list of computational tasks that are executed in sequence on the Lagrangian (particle) data.

@subsection lagrangian_kernels_ssec 5.1. Available Lagrangian Kernels

| `task` Name | Description | Parameters |
| :--- | :--- | :--- |
| `specific_ke` | Computes the specific kinetic energy (0.5 * |velocity|Â²) for each particle. | `input_field`: Name of the particle velocity field (usually "velocity").<br>`output_field`: Name for the new scalar field (e.g., "SpecificKE"). |

@section io_post_sec 6. The `io` Section

This section controls the format and content of the final visualization files (`.vts` and `.vtp`).

| Parameter | Type | Description |
| :--- | :--- | :--- |
| `output_directory` | String | The name of the subdirectory within the run folder where visualization files will be saved (e.g., "viz"). |
| `output_filename_prefix`| String | The base name for the output Eulerian `.vts` files (e.g., "Field" results in `Field_000100.vts`). |
| `particle_filename_prefix`| String | The base name for the output Lagrangian `.vtp` files. |
| `output_particles` | Boolean | If `true`, the post-processor will load, process, and save particle data into `.vtp` files. |
| `particle_subsampling_frequency`| Integer | Saves particle data for every N-th particle, reducing the size of `.vtp` files. A value of `1` saves all particles. |
| `eulerian_fields` | String List | A list of the final grid-based fields to include in the output `.vts` files. These can be fields loaded from the solver or new fields created by the pipeline. |
| `particle_fields` | String List | A list of the final particle-based fields to include in the output `.vtp` files. |

@section next_steps_sec 7. Next Steps

You have now completed the reference guides for all the core configuration files in the PICurv user workflow. The next step is to explore a collection of practical examples.

Proceed to the **@subpage 11_User_How_To_Guides** for a list of quick, goal-oriented recipes for common simulation tasks.
logical step is to create the "How-To Guides" page that consolidates answers to common user questions. Ready to proceed?