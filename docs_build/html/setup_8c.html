<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PICurv: setup.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PICurv
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">A Parallel Particle-In-Cell Solver for Curvilinear LES</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('setup_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">setup.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Test program for DMSwarm interpolation using the fdf-curvIB method. Provides the setup to start any simulation with DMSwarm and DMDAs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="setup_8h_source.html">setup.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for setup.c:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="setup_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;CreateSimulationContext&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;AllocateContextHeirarchy&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetupSolverParameters&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetupGridAndSolvers&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;CreateAndInitializeAllVectors&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;UpdateLocalGhosts&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetupBoundaryConditions&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;GetOwnedCellRange&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;GetGhostedCellRange&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;ComputeAndStoreNeighborRanks&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetDMDAProcLayout&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetupDomainRankInfo&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;Contra2Cart&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetupDomainCellDecompositionMap&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;BinarySearchInt64&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;ComputeDivergence&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a977df65dac293c1308451334cb198693"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a977df65dac293c1308451334cb198693">CreateSimulationContext</a> (int argc, char **argv, <a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> **p_simCtx)</td></tr>
<tr class="memdesc:a977df65dac293c1308451334cb198693"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates and populates the master SimulationContext object.  <a href="setup_8c.html#a977df65dac293c1308451334cb198693">More...</a><br /></td></tr>
<tr class="separator:a977df65dac293c1308451334cb198693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf739211501f0646c25ceb99a68a1163"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#acf739211501f0646c25ceb99a68a1163">AllocateContextHierarchy</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:acf739211501f0646c25ceb99a68a1163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates the memory for the <a class="el" href="variables_8h.html#structUserMG" title="User-level context for managing the entire multigrid hierarchy.">UserMG</a> and <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> hierarchy.  <a href="setup_8c.html#acf739211501f0646c25ceb99a68a1163">More...</a><br /></td></tr>
<tr class="separator:acf739211501f0646c25ceb99a68a1163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3766d23bad255474ff61d06fbb6f63f7"><td class="memItemLeft" align="right" valign="top">static PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a3766d23bad255474ff61d06fbb6f63f7">SetupSolverParameters</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="separator:a3766d23bad255474ff61d06fbb6f63f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be2815aeb79afe9b95caf39c7b3312c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a2be2815aeb79afe9b95caf39c7b3312c">SetupGridAndSolvers</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:a2be2815aeb79afe9b95caf39c7b3312c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main orchestrator for setting up all grid-related components.  <a href="setup_8c.html#a2be2815aeb79afe9b95caf39c7b3312c">More...</a><br /></td></tr>
<tr class="separator:a2be2815aeb79afe9b95caf39c7b3312c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47daae7d6e456ef74e75626c1c9d6c9a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a47daae7d6e456ef74e75626c1c9d6c9a">CreateAndInitializeAllVectors</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:a47daae7d6e456ef74e75626c1c9d6c9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and initializes all PETSc Vec objects for all fields.  <a href="setup_8c.html#a47daae7d6e456ef74e75626c1c9d6c9a">More...</a><br /></td></tr>
<tr class="separator:a47daae7d6e456ef74e75626c1c9d6c9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f82951adcce74b3d37cb5880acf43a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ad5f82951adcce74b3d37cb5880acf43a">UpdateLocalGhosts</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, const char *fieldName)</td></tr>
<tr class="memdesc:ad5f82951adcce74b3d37cb5880acf43a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the local vector (including ghost points) from its corresponding global vector.  <a href="setup_8c.html#ad5f82951adcce74b3d37cb5880acf43a">More...</a><br /></td></tr>
<tr class="separator:ad5f82951adcce74b3d37cb5880acf43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f399b16547eba3244159f7136a1eb9"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ad9f399b16547eba3244159f7136a1eb9">SetupBoundaryConditions</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:ad9f399b16547eba3244159f7136a1eb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">(Orchestrator) Sets up all boundary conditions for the simulation.  <a href="setup_8c.html#ad9f399b16547eba3244159f7136a1eb9">More...</a><br /></td></tr>
<tr class="separator:ad9f399b16547eba3244159f7136a1eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b1b661a11ef0a0e0bb7fb92f2d211f4"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a8b1b661a11ef0a0e0bb7fb92f2d211f4">Allocate3DArrayScalar</a> (PetscReal ****array, PetscInt nz, PetscInt ny, PetscInt nx)</td></tr>
<tr class="memdesc:a8b1b661a11ef0a0e0bb7fb92f2d211f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a 3D array of PetscReal values using PetscCalloc.  <a href="setup_8c.html#a8b1b661a11ef0a0e0bb7fb92f2d211f4">More...</a><br /></td></tr>
<tr class="separator:a8b1b661a11ef0a0e0bb7fb92f2d211f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73e238fa95229094a92ac66812799f7"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#af73e238fa95229094a92ac66812799f7">Deallocate3DArrayScalar</a> (PetscReal ***array, PetscInt nz, PetscInt ny)</td></tr>
<tr class="memdesc:af73e238fa95229094a92ac66812799f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates a 3D array of PetscReal values allocated by Allocate3DArrayScalar.  <a href="setup_8c.html#af73e238fa95229094a92ac66812799f7">More...</a><br /></td></tr>
<tr class="separator:af73e238fa95229094a92ac66812799f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b5edc0d4872661a274fabbbf790019"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#ad0b5edc0d4872661a274fabbbf790019">Allocate3DArrayVector</a> (<a class="el" href="variables_8h.html#structCmpnts">Cmpnts</a> ****array, PetscInt nz, PetscInt ny, PetscInt nx)</td></tr>
<tr class="memdesc:ad0b5edc0d4872661a274fabbbf790019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures using PetscCalloc.  <a href="setup_8c.html#ad0b5edc0d4872661a274fabbbf790019">More...</a><br /></td></tr>
<tr class="separator:ad0b5edc0d4872661a274fabbbf790019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b52d74f346e62584fb4e91e11a850b9"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a2b52d74f346e62584fb4e91e11a850b9">Deallocate3DArrayVector</a> (<a class="el" href="variables_8h.html#structCmpnts">Cmpnts</a> ***array, PetscInt nz, PetscInt ny)</td></tr>
<tr class="memdesc:a2b52d74f346e62584fb4e91e11a850b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocates a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures allocated by Allocate3DArrayVector.  <a href="setup_8c.html#a2b52d74f346e62584fb4e91e11a850b9">More...</a><br /></td></tr>
<tr class="separator:a2b52d74f346e62584fb4e91e11a850b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a135027905841ed83f1a3ef2279d865cc"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a135027905841ed83f1a3ef2279d865cc">GetOwnedCellRange</a> (const DMDALocalInfo *info_nodes, PetscInt dim, PetscInt *xs_cell_global_out, PetscInt *xm_cell_local_out)</td></tr>
<tr class="memdesc:a135027905841ed83f1a3ef2279d865cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the global starting index of cells owned by this rank and the number of such cells.  <a href="setup_8c.html#a135027905841ed83f1a3ef2279d865cc">More...</a><br /></td></tr>
<tr class="separator:a135027905841ed83f1a3ef2279d865cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25ce912d8aafa319a8c915cd350c7322"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a> (const DMDALocalInfo *info_nodes, const <a class="el" href="variables_8h.html#structRankNeighbors">RankNeighbors</a> *neighbors, PetscInt dim, PetscInt *xs_cell_global_out, PetscInt *xm_cell_local_out)</td></tr>
<tr class="memdesc:a25ce912d8aafa319a8c915cd350c7322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the global cell range for a rank, including boundary cells.  <a href="setup_8c.html#a25ce912d8aafa319a8c915cd350c7322">More...</a><br /></td></tr>
<tr class="separator:a25ce912d8aafa319a8c915cd350c7322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d7b90ec69412357cf8c38ea8f4e71f6"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a4d7b90ec69412357cf8c38ea8f4e71f6">ComputeAndStoreNeighborRanks</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a4d7b90ec69412357cf8c38ea8f4e71f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes and stores the Cartesian neighbor ranks for the DMDA decomposition.  <a href="setup_8c.html#a4d7b90ec69412357cf8c38ea8f4e71f6">More...</a><br /></td></tr>
<tr class="separator:a4d7b90ec69412357cf8c38ea8f4e71f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf7da4f6b65d67f5d8eafa2e5fc7ead"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#aacf7da4f6b65d67f5d8eafa2e5fc7ead">SetDMDAProcLayout</a> (DM dm, <a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:aacf7da4f6b65d67f5d8eafa2e5fc7ead"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the processor layout for a given DMDA based on PETSc options.  <a href="setup_8c.html#aacf7da4f6b65d67f5d8eafa2e5fc7ead">More...</a><br /></td></tr>
<tr class="separator:aacf7da4f6b65d67f5d8eafa2e5fc7ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c08bf327e1aee897c56610a89f75814"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a1c08bf327e1aee897c56610a89f75814">SetupDomainRankInfo</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:a1c08bf327e1aee897c56610a89f75814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the full rank communication infrastructure for all blocks.  <a href="setup_8c.html#a1c08bf327e1aee897c56610a89f75814">More...</a><br /></td></tr>
<tr class="separator:a1c08bf327e1aee897c56610a89f75814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a515c9a96eb4bcac29f79e78c8882d7aa"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a515c9a96eb4bcac29f79e78c8882d7aa">Contra2Cart</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:a515c9a96eb4bcac29f79e78c8882d7aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reconstructs Cartesian velocity (Ucat) at cell centers from contravariant velocity (Ucont) defined on cell faces.  <a href="setup_8c.html#a515c9a96eb4bcac29f79e78c8882d7aa">More...</a><br /></td></tr>
<tr class="separator:a515c9a96eb4bcac29f79e78c8882d7aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb77337317f41972d1c75c8d80527892"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#aeb77337317f41972d1c75c8d80527892">SetupDomainCellDecompositionMap</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:aeb77337317f41972d1c75c8d80527892"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and distributes a map of the domain's cell decomposition to all ranks.  <a href="setup_8c.html#aeb77337317f41972d1c75c8d80527892">More...</a><br /></td></tr>
<tr class="separator:aeb77337317f41972d1c75c8d80527892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd8d87dc85f19ba3e32811a623bf5b36"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#acd8d87dc85f19ba3e32811a623bf5b36">BinarySearchInt64</a> (PetscInt n, const PetscInt64 arr[], PetscInt64 key, PetscBool *found)</td></tr>
<tr class="memdesc:acd8d87dc85f19ba3e32811a623bf5b36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a binary search for a key in a sorted array of PetscInt64.  <a href="setup_8c.html#acd8d87dc85f19ba3e32811a623bf5b36">More...</a><br /></td></tr>
<tr class="separator:acd8d87dc85f19ba3e32811a623bf5b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d538200fed5b9ee9d1ef391bb61036c"><td class="memItemLeft" align="right" valign="top">static PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#a3d538200fed5b9ee9d1ef391bb61036c">Gidx</a> (PetscInt i, PetscInt j, PetscInt k, <a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:a3d538200fed5b9ee9d1ef391bb61036c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abab14dc7f20644674b043609950eefe2"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="setup_8c.html#abab14dc7f20644674b043609950eefe2">ComputeDivergence</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="separator:abab14dc7f20644674b043609950eefe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Test program for DMSwarm interpolation using the fdf-curvIB method. Provides the setup to start any simulation with DMSwarm and DMDAs. </p>
<p>// Setup code for running any simulation </p>

<p class="definition">Definition in file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[1/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;CreateSimulationContext&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[2/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;AllocateContextHeirarchy&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[3/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetupSolverParameters&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[4/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetupGridAndSolvers&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[5/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;CreateAndInitializeAllVectors&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[6/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;UpdateLocalGhosts&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[7/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetupBoundaryConditions&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[8/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;GetOwnedCellRange&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[9/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;GetGhostedCellRange&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[10/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;ComputeAndStoreNeighborRanks&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[11/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetDMDAProcLayout&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[12/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetupDomainRankInfo&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[13/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;Contra2Cart&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[14/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetupDomainCellDecompositionMap&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[15/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;BinarySearchInt64&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[16/16]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;ComputeDivergence&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02178">2178</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a977df65dac293c1308451334cb198693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a977df65dac293c1308451334cb198693">&#9670;&nbsp;</a></span>CreateSimulationContext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode CreateSimulationContext </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> **&#160;</td>
          <td class="paramname"><em>p_simCtx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates and populates the master SimulationContext object. </p>
<p>This function serves as the single, authoritative entry point for all simulation configuration. It merges the setup logic from both the legacy FSI/IBM solver and the modern particle solver into a unified, robust process.</p>
<p>The function follows a strict sequence:</p><ol type="1">
<li><b>Allocate Context &amp; Set Defaults:</b> It first allocates the <code>SimulationContext</code> and populates every field with a sane, hardcoded default value. This ensures the simulation starts from a known, predictable state.</li>
<li><b>Configure Logging System:</b> It configures the custom logging framework. It parses the <code>-func_config_file</code> option to load a list of function names allowed to produce log output. This configuration (the file path and the list of function names) is stored within the <code>SimulationContext</code> for later reference and cleanup.</li>
<li><b>Parse All Options:</b> It performs a comprehensive pass of <code>PetscOptionsGet...</code> calls for every possible command-line flag, overriding the default values set in step 1.</li>
<li><b>Log Summary:</b> After all options are parsed, it uses the now-active logging system to print a summary of the key simulation parameters.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>Argument count passed from <code>main</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argv</td><td>Argument vector passed from <code>main</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_simCtx</td><td>On success, this will point to the newly created and fully configured <code>SimulationContext</code> pointer. The caller is responsible for eventually destroying this object by calling <code>FinalizeSimulation()</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, or a non-zero PETSc error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l00044">44</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">char</span> control_filename[PETSC_MAX_PATH_LEN] = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// Temporary placeholder for control file name.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    PetscBool control_flg; <span class="comment">// Temporary placeholder for control file tag existence check flag.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// === 1. Allocate the Context Struct and Set ALL Defaults ==================</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    ierr = PetscNew(p_simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    simCtx = *p_simCtx;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// --- Group 1: Parallelism &amp; MPI ---</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">size</a> = 1;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// --- Group 2: Simulation Control, Time, and I/O ---</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#aea06dd1e5437886745d3545e2a383172">ti</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">StepsToRun</a> = 10;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a4020eb5a53d6a827a93f000bfb09cd6f">tiout</a> = 10; simCtx-&gt;<a class="code" href="variables_8h.html#a337c3a9a9bf061e10d71ba990aa6ed29">StartTime</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a> = 0.001;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a6bae0e92738d6c3498ac41b67ed5b7a4">OnlySetup</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#adeb409a2b27c8f7bba53944a876cc7bc">logviewer</a> = NULL; simCtx-&gt;<a class="code" href="variables_8h.html#aa002126f8760bb0f98614b78ac70e940">OutputFreq</a> = simCtx-&gt;<a class="code" href="variables_8h.html#a4020eb5a53d6a827a93f000bfb09cd6f">tiout</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a22578f82210005268294944e4227473e">eulerianSource</a>,<span class="stringliteral">&quot;solve&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#af09e3f546ff8fa1192338e746391aa22">restart_dir</a>,<span class="stringliteral">&quot;results&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a52b4bfae9bf1813f3280faecb20cab0d">output_dir</a>,<span class="stringliteral">&quot;results&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a922566a9e001486fa838d96925a6f102">log_dir</a>,<span class="stringliteral">&quot;logs&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// --- Group 3: High-Level Physics &amp; Model Selection Flags ---</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aef90766eec6fc6887cd39bd1d79cb6d2">immersed</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a090892cd5c5a867ca95c239ee24568be">movefsi</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a6bbc45b8c4ff978d205c0a7b670b54f9">rotatefsi</a> = 0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a292340e9970a9cd8564bfb064862730f">sediment</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#aa872769b7375d16b560211774f36eab3">rheology</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a7af448f97fbebfd44e5989614b982a93">invicid</a> = 0;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a0e237daee9fc063a6563c731846eca76">TwoD</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a1fb23a91520ea2d2cd06eacdae38ef13">thin</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a0ca5cdac6f3648539846966855d2b75a">moveframe</a> = 0;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aecc33b61ded0b8c01e2524094af2504a">rotateframe</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#af1abb750bddbd00d7149307d4c01a218">blank</a> = 0;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a752886caf27f1ff423393206403eda22">dgf_x</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#af2143bc1a9f6bb90236d624f4a45b4e2">dgf_y</a> = 1; simCtx-&gt;<a class="code" href="variables_8h.html#a12ea69c9013845d392b1a2c3036d8042">dgf_z</a> = 0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aaf3084979f6cafb4ec5e4eccd9129ee8">dgf_ax</a> = 1; simCtx-&gt;<a class="code" href="variables_8h.html#acac9c41534675c81a182fbd07ced455b">dgf_ay</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a34e33d9993af3306ede1e2b45093c4b9">dgf_az</a> = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">st</a> = 1.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// --- Group 4: Specific Simulation Case Flags --- (DEPRICATED)</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ae9f42dc66b074d482e5515c908519216">cop</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a1b08cdba1a7d4de048fbf472edfd5850">fish</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a0f1542afb8462493ca6e37c0285b3436">fish_c</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a05c02891978b9f09aff6f2f6b0a636fe">fishcyl</a>=0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a912b5bb58c3db258fa468d66ead8d6fd">eel</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a768706b18a55a91246d847ec829faa43">pizza</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a04c849d5fadc93b99bd328df1b90adce">turbine</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#aeb624d13d58833ceca0dcac7855a1b65">Pipe</a>=0;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aff67a9b22db3995c8a1acf0ccbcb3eb7">wing</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#acdd1a65b6f7557e023f70e782c24c202">hydro</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a02fd03c4c166911f067e92b36d1820a3">MHV</a>=0; simCtx-&gt;<a class="code" href="variables_8h.html#a1bec6eafffafc2eecc2efb4377e6fed1">LV</a>=0;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// --- Group 5: Solver &amp; Numerics Parameters ---</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a413be1a878e86c9e5d54d52380822d2d">implicit</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a070c1635b3c81726e526cc8efeae4022">implicit_type</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#ae7ba91fbb3aedec394bb9bf821740584">imp_MAX_IT</a> = 50;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a46331b4618365171b8acca414cfee348">imp_atol</a> = 1e-7; simCtx-&gt;<a class="code" href="variables_8h.html#a3c4eaacc19b561cba4a96aafbdb30850">imp_rtol</a> = 1e-4; simCtx-&gt;<a class="code" href="variables_8h.html#a9ceb6475261683f406ad2961abaa0f3d">imp_stol</a> = 1.e-8;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ab03f6ae8e484ed1a626cf207aeab1382">mglevels</a> = 3; simCtx-&gt;<a class="code" href="variables_8h.html#a6a60d593b5ef4747e9c7eb086e91c75a">mg_MAX_IT</a> = 30; simCtx-&gt;<a class="code" href="variables_8h.html#a68dffbb3717fdf0b6a79bd9169c067c5">mg_idx</a> = 1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#adb0a0adae51684c0d56ca6d8ab119fbf">mg_preItr</a> = 1; simCtx-&gt;<a class="code" href="variables_8h.html#a805f30aa6b217daa5ec56481577f71f8">mg_poItr</a> = 1;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a859022c229213fbf2166434a66ee7422">poisson</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a146d75ad33e5ba60b528cc38a0d3f7dd">poisson_tol</a> = 5.e-9;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a82348af36047097defe3692225145edc">STRONG_COUPLING</a> = 0;simCtx-&gt;<a class="code" href="variables_8h.html#ab4811dc3ebc8ea1154e75c8c38639259">central</a>=0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a> = 100.0; simCtx-&gt;<a class="code" href="variables_8h.html#aaf69cd924766117c45ba60fcf2ed452e">cfl</a> = 0.1; simCtx-&gt;<a class="code" href="variables_8h.html#aebf75baa2defdbe4f6dcce0b6620cad4">vnn</a> = 0.1;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aadc4cfc6880a57f1cb68ac900e472155">cdisx</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a599be83bcac9867e2ba22fc981ae05fc">cdisy</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a707859093eedbfdbcd1b61c3e58bd73d">cdisz</a> = 0.0;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a> = 0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = 0.0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = 0.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = 0.0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// --- Group 6: Physical &amp; Geometric Parameters ---</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a88c4b985c5df59d8fd0ac17910dbb85c">NumberOfBodies</a> = 1; simCtx-&gt;<a class="code" href="variables_8h.html#aa8f85a4a159853045094b4a018ac36dd">Flux_in</a> = 1.0; simCtx-&gt;<a class="code" href="variables_8h.html#a1c09604af49856ddc75bb32cd1b2a836">angle</a> = 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a3bd5fc05f2098708e4e8fb142161add3">max_angle</a> = -54. * 3.1415926 / 180.;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#af76e1d38bb7cbd24474b58fa54fd7ad5">CMx_c</a>=0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a361610227b8cc6afe449d5faf982a347">CMy_c</a>=0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a97b91f798c877756e4a9aae26853bb2c">CMz_c</a>=0.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// --- Group 7: Grid, Domain, and Boundary Condition Settings ---</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a> = 1; simCtx-&gt;<a class="code" href="variables_8h.html#a57b3c5733ac4acdef370e635e85df95f">inletprofile</a> = 1;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a223f70881916d4d77f5f62b1faf4547f">grid1d</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a8a4e2f647306f38daa0d543090647a4f">Ogrid</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a2e1d74f612f5443c8ece068511563453">channelz</a> = 0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac6c6cfb6059e67c1f8ad3c1bbe7f7889">i_periodic</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#afd3cbef00a91e3115e40ccd7b0a8cfbb">j_periodic</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a57873ffd9532be40cdf7aa76955b5d61">k_periodic</a> = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a2892b7742faefb81b542c6fdd2351e68">blkpbc</a> = 10; simCtx-&gt;<a class="code" href="variables_8h.html#a0e447e75b801c0a9305fcadd317159a4">pseudo_periodic</a> = 0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>, <span class="stringliteral">&quot;config/grid.run&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a98a90e3a55a0a0da6e392f44ebf50dad">generate_grid</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac014127a43e8978a157a8a42c2f0538d">da_procs_x</a> = PETSC_DECIDE;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a44230884a9901af3992a1faf2eebdfb1">da_procs_y</a> = PETSC_DECIDE;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a281d10df99cab1a563bb65203f3bd823">da_procs_z</a> = PETSC_DECIDE;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#abf0fd1ca67fe0886eb53735ec3d5ed01">grid_rotation_angle</a>  = 0.0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ab98a3518e774e7d3778c82c8d4e06e67">Croty</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a494c23ca7d8b99ea8bdcd34d6c2b81a3">Crotz</a> = 0.0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a> = 1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    ierr = PetscMalloc1(1, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    ierr = PetscStrallocpy(<span class="stringliteral">&quot;config/bcs.run&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">FluxInSum</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">FluxOutSum</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#ab6ee189c80a939393b9cfd780774966e">Fluxsum</a> = 0.0;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aed540f6bcccf526419b3d5ec4ec6b82f">AreaInSum</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#aca7ff63d94b0fbd2d541734b7200b0e2">AreaOutSum</a> = 0.0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a> = 0.0; simCtx-&gt;<a class="code" href="variables_8h.html#a64c0b8cda05b216ac96fc09da38c3c70">ccc</a> = 0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a677188b3aedc7e7d0331e43f8f37ad02">ratio</a> = 0.0;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// --- Group 8: Turbulence Modeling (LES/RANS) ---</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a61f9f685923b2b7b99434b6100cc10d7">averaging</a> = PETSC_FALSE; simCtx-&gt;<a class="code" href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">les</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">rans</a> = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aa60ee4e3f8eca251ee470427f1ebac13">wallfunction</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a4b2a3494bdeca82703c2b3125c81c8f6">mixed</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a0636fa7c6553721728dc41cafb482463">clark</a> = 0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#abf6c288c1dbfb0530acf9490fd947f3b">dynamic_freq</a> = 1; simCtx-&gt;<a class="code" href="variables_8h.html#a7a3f92059ddd489f41cd89dbcd2a1763">max_cs</a> = 0.5;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#acca07088dd652f1f01ed1f4eb8b1d4cc">testfilter_ik</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a463c0299584d32311b5f290ee5f9597c">testfilter_1d</a> = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aa483a3664f2eca9684bf3efbec8da1aa">i_homo_filter</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a8c2555d0e12b81177396765b584f1a14">j_homo_filter</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a86567855ecf1fbc638287ad7040ab55a">k_homo_filter</a> = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// --- Group 9: Particle / DMSwarm Data &amp; Settings ---</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#ab45ae5b28b66812e5e4b0e85a540f948">readFields</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ab32e253228241b5de900c4ac9c9e7452">dm_swarm</a> = NULL; simCtx-&gt;<a class="code" href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">bboxlist</a> = NULL;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a> = 0;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>,<span class="stringliteral">&quot;load&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// --- Group 10: Immersed Boundary &amp; FSI Data Object Pointers ---</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aece7be3444e8a4a29db12c10e070dd9c">ibm</a> = NULL; simCtx-&gt;<a class="code" href="variables_8h.html#a4e46a0a7eb2e0ed0280df04ff25e24a8">ibmv</a> = NULL; simCtx-&gt;<a class="code" href="variables_8h.html#afff98e471314dce8cc7a2b55e536431f">fsi</a> = NULL;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a5d62bb83d782192bfb7a04b985d1b8aa">rstart_fsi</a> = PETSC_FALSE; simCtx-&gt;<a class="code" href="variables_8h.html#a4008d732ef13f23af3139d500f629624">duplicate</a> = 0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// --- Group 11: Logging and Custom Configuration ---</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a432208fc455621e01de80448272ae582">allowedFile</a>, <span class="stringliteral">&quot;config/whitelist.run&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ab342b9a07bb00be469836bd6974b0c93">useCfg</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a> = NULL;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a> = 0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#af4e8e680314f5a935c26342d6dca13c8">LoggingFrequency</a> = 10;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aee7757dd3f6e9566fc1206526625e000">summationRHS</a> = 0.0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a768740aa4a2ae69549670ebbfea58fc0">MaxDiv</a> = 0.0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a9285c06d5e6bee00c9061c27b2b73cb8">MaxDivFlatArg</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a83e58d8ef2d285dc135be286ddc67f01">MaxDivx</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a8811a9a632140d00bca04337f2261d23">MaxDivy</a> = 0; simCtx-&gt;<a class="code" href="variables_8h.html#a8b2e7f4d2e2e95e4c49aa02684e2e51d">MaxDivz</a> = 0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#a51f095899dcd18840b729608a73c8916">criticalFuncsFile</a>, <span class="stringliteral">&quot;config/profile.run&quot;</span>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ab4b123a5f980ecdaa79c5f855f751999">useCriticalFuncsCfg</a> =  PETSC_FALSE;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a> = NULL;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aee028ea541ee28c6c777dc0ec22b9d51">nCriticalFuncs</a> = 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// --- Group 11: Post-Processing Information ---</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    strcpy(simCtx-&gt;<a class="code" href="variables_8h.html#af05e9e68e0acf99ae030d44b905e33fb">PostprocessingControlFile</a>, <span class="stringliteral">&quot;config/post.run&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    ierr = PetscNew(&amp;simCtx-&gt;<a class="code" href="variables_8h.html#acf6d729ae4d0d996d6b056ccc5438995">pps</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// === 2. Get MPI Info and Handle Config File =============================</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// -- Group 1:  Parallelism &amp; MPI Information</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">size</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; <span class="comment">// First, check if the -control_file argument was provided by the user/script.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    ierr = PetscOptionsGetString(NULL, NULL, <span class="stringliteral">&quot;-control_file&quot;</span>, control_filename, <span class="keyword">sizeof</span>(control_filename), &amp;control_flg); CHKERRQ(ierr);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// If the flag is NOT present or the filename is empty, abort with a helpful error.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (!control_flg || strlen(control_filename) == 0) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONG,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="stringliteral">&quot;\n\n*** MANDATORY ARGUMENT MISSING ***\n&quot;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="stringliteral">&quot;The -control_file argument was not provided.\n&quot;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <span class="stringliteral">&quot;This program must be launched with a configuration file.\n&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="stringliteral">&quot;Example: mpiexec -n 4 ./picsolver -control_file /path/to/your/config.control\n&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="stringliteral">&quot;This is typically handled automatically by the &#39;pic-flow&#39; script.\n&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="comment">// At this point, we have a valid filename. Attempt to load it.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="logging_8h.html#a672ff9c400e2307306b36415d4fefcb9">LOG</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Loading mandatory configuration from: %s\n&quot;</span>, control_filename);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    ierr = PetscOptionsInsertFile(PETSC_COMM_WORLD, NULL, control_filename, PETSC_FALSE);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (ierr == PETSC_ERR_FILE_OPEN) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_FILE_OPEN, <span class="stringliteral">&quot;The specified control file was not found or could not be opened: %s&quot;</span>, control_filename);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    CHKERRQ(ierr);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// === 3. A Configure Logging System ========================================</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// This logic determines the logging configuration and STORES it in simCtx for</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// later reference and cleanup.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    ierr = PetscOptionsGetString(NULL, NULL, <span class="stringliteral">&quot;-whitelist_config_file&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a432208fc455621e01de80448272ae582">allowedFile</a>, PETSC_MAX_PATH_LEN, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab342b9a07bb00be469836bd6974b0c93">useCfg</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ab342b9a07bb00be469836bd6974b0c93">useCfg</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        ierr = <a class="code" href="logging_8h.html#a6c0ddc8d3a828f3ab26c557ba0aedf75">LoadAllowedFunctionsFromFile</a>(simCtx-&gt;<a class="code" href="variables_8h.html#a432208fc455621e01de80448272ae582">allowedFile</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">// Use direct PetscPrintf as logging system isn&#39;t fully active yet.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;[%s] WARNING: Failed to load allowed functions from &#39;%s&#39;. Falling back to default list.\n&quot;</span>, __func__, simCtx-&gt;<a class="code" href="variables_8h.html#a432208fc455621e01de80448272ae582">allowedFile</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            simCtx-&gt;<a class="code" href="variables_8h.html#ab342b9a07bb00be469836bd6974b0c93">useCfg</a> = PETSC_FALSE; <span class="comment">// Mark as failed.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            ierr = 0; <span class="comment">// Clear the error to allow fallback.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (!simCtx-&gt;<a class="code" href="variables_8h.html#ab342b9a07bb00be469836bd6974b0c93">useCfg</a>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">// Fallback to default logging functions if no file was used or if loading failed.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a> = 2;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        ierr = PetscMalloc1(simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        ierr = PetscStrallocpy(<span class="stringliteral">&quot;main&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a>[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        ierr = PetscStrallocpy(<span class="stringliteral">&quot;CreateSimulationContext&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a>[1]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// Activate the configuration by passing it to the logging module&#39;s setup function.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="logging_8h.html#a0c30361e55f762e47599a9e2a5999d24">set_allowed_functions</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>**)simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a>, (<span class="keywordtype">size_t</span>)simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// Now that the logger is configured, we can use it.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Context created. Initializing on rank %d of %d.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, simCtx-&gt;<a class="code" href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">size</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="logging_8h.html#a4d4a385a6fac09d0e106eeb2dfde18ba">print_log_level</a>(); <span class="comment">// This will now correctly reflect the LOG_LEVEL environment variable.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// === 3.B Configure Profiling System ========================================</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    ierr = PetscOptionsGetString(NULL, NULL, <span class="stringliteral">&quot;-profile_config_file&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a51f095899dcd18840b729608a73c8916">criticalFuncsFile</a>, PETSC_MAX_PATH_LEN, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab4b123a5f980ecdaa79c5f855f751999">useCriticalFuncsCfg</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ab4b123a5f980ecdaa79c5f855f751999">useCriticalFuncsCfg</a>) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        ierr = <a class="code" href="logging_8h.html#a6c0ddc8d3a828f3ab26c557ba0aedf75">LoadAllowedFunctionsFromFile</a>(simCtx-&gt;<a class="code" href="variables_8h.html#a51f095899dcd18840b729608a73c8916">criticalFuncsFile</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aee028ea541ee28c6c777dc0ec22b9d51">nCriticalFuncs</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (ierr) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;[%s] WARNING: Failed to load critical profiling functions from &#39;%s&#39;. Falling back to default list.\n&quot;</span>, __func__, simCtx-&gt;<a class="code" href="variables_8h.html#a51f095899dcd18840b729608a73c8916">criticalFuncsFile</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            simCtx-&gt;<a class="code" href="variables_8h.html#ab4b123a5f980ecdaa79c5f855f751999">useCriticalFuncsCfg</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            ierr = 0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span> (!simCtx-&gt;<a class="code" href="variables_8h.html#ab4b123a5f980ecdaa79c5f855f751999">useCriticalFuncsCfg</a>) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="comment">// Fallback to a hardcoded default list if no file or loading failed</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        simCtx-&gt;<a class="code" href="variables_8h.html#aee028ea541ee28c6c777dc0ec22b9d51">nCriticalFuncs</a> = 4;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        ierr = PetscMalloc1(simCtx-&gt;<a class="code" href="variables_8h.html#aee028ea541ee28c6c777dc0ec22b9d51">nCriticalFuncs</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        ierr = PetscStrallocpy(<span class="stringliteral">&quot;Flow_Solver&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a>[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        ierr = PetscStrallocpy(<span class="stringliteral">&quot;AdvanceSimulation&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a>[1]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        ierr = PetscStrallocpy(<span class="stringliteral">&quot;LocateAllParticlesInGrid_TEST&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a>[2]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        ierr = PetscStrallocpy(<span class="stringliteral">&quot;InterpolateAllFieldsToSwarm&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">criticalFuncs</a>[3]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// Initialize the profiling system with the current updated simulation context.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    ierr = <a class="code" href="logging_8h.html#ac4f5428199f6cd908056ad3e0ead934f">ProfilingInitialize</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// === 4. Parse All Command Line Options ==================================</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Parsing command-line options...\n&quot;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// --- Group 2</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 2: Simulation Control,Time and I/O.\n&quot;</span>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// Read the physical time to start from.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// The default is already 0.0, so this will only be non-zero if the user provides it.</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-start_step&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    ierr = PetscOptionsGetInt(NULL,NULL, <span class="stringliteral">&quot;-totalsteps&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">StepsToRun</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    ierr = PetscOptionsGetBool(NULL, NULL, <span class="stringliteral">&quot;-only_setup&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a6bae0e92738d6c3498ac41b67ed5b7a4">OnlySetup</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-dt&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-tio&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a4020eb5a53d6a827a93f000bfb09cd6f">tiout</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    ierr = PetscOptionsGetString(NULL,NULL,<span class="stringliteral">&quot;-euler_field_source&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a22578f82210005268294944e4227473e">eulerianSource</a>,64,NULL);CHKERRQ(ierr);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    ierr = PetscOptionsGetString(NULL,NULL,<span class="stringliteral">&quot;-output_dir&quot;</span>,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#a52b4bfae9bf1813f3280faecb20cab0d">output_dir</a>,<span class="keyword">sizeof</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a52b4bfae9bf1813f3280faecb20cab0d">output_dir</a>),NULL);CHKERRQ(ierr);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    ierr = PetscOptionsGetString(NULL,NULL,<span class="stringliteral">&quot;-restart_dir&quot;</span>,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#af09e3f546ff8fa1192338e746391aa22">restart_dir</a>,<span class="keyword">sizeof</span>(simCtx-&gt;<a class="code" href="variables_8h.html#af09e3f546ff8fa1192338e746391aa22">restart_dir</a>),NULL);CHKERRQ(ierr);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    ierr = PetscOptionsGetString(NULL,NULL,<span class="stringliteral">&quot;-log_dir&quot;</span>,&amp;simCtx-&gt;<a class="code" href="variables_8h.html#a922566a9e001486fa838d96925a6f102">log_dir</a>,<span class="keyword">sizeof</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a922566a9e001486fa838d96925a6f102">log_dir</a>),NULL);CHKERRQ(ierr);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aa002126f8760bb0f98614b78ac70e940">OutputFreq</a> = simCtx-&gt;<a class="code" href="variables_8h.html#a4020eb5a53d6a827a93f000bfb09cd6f">tiout</a>; <span class="comment">// backward compatibility related redundancy.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span>(strcmp(simCtx-&gt;<a class="code" href="variables_8h.html#a22578f82210005268294944e4227473e">eulerianSource</a>,<span class="stringliteral">&quot;solve&quot;</span>)!= 0 &amp;&amp; strcmp(simCtx-&gt;<a class="code" href="variables_8h.html#a22578f82210005268294944e4227473e">eulerianSource</a>,<span class="stringliteral">&quot;load&quot;</span>) != 0){</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      SETERRQ(PETSC_COMM_WORLD,PETSC_ERR_ARG_WRONG,<span class="stringliteral">&quot;Invalid value for -euler_field_source. Must be &#39;load&#39; or &#39;solve&#39;. You provided &#39;%s&#39;.&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a22578f82210005268294944e4227473e">eulerianSource</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//  --- Group 3</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 3: High-Level Physics &amp; Model Selection Flags\n&quot;</span>);    </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-imm&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aef90766eec6fc6887cd39bd1d79cb6d2">immersed</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-fsi&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a090892cd5c5a867ca95c239ee24568be">movefsi</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-rfsi&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a6bbc45b8c4ff978d205c0a7b670b54f9">rotatefsi</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-sediment&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a292340e9970a9cd8564bfb064862730f">sediment</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-rheology&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aa872769b7375d16b560211774f36eab3">rheology</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-inv&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a7af448f97fbebfd44e5989614b982a93">invicid</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-TwoD&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a0e237daee9fc063a6563c731846eca76">TwoD</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-thin&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a1fb23a91520ea2d2cd06eacdae38ef13">thin</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mframe&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a0ca5cdac6f3648539846966855d2b75a">moveframe</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-rframe&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aecc33b61ded0b8c01e2524094af2504a">rotateframe</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-blk&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#af1abb750bddbd00d7149307d4c01a218">blank</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dgf_z&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a12ea69c9013845d392b1a2c3036d8042">dgf_z</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dgf_y&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#af2143bc1a9f6bb90236d624f4a45b4e2">dgf_y</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dgf_x&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a752886caf27f1ff423393206403eda22">dgf_x</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dgf_az&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a34e33d9993af3306ede1e2b45093c4b9">dgf_az</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dgf_ay&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#acac9c41534675c81a182fbd07ced455b">dgf_ay</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dgf_ax&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aaf3084979f6cafb4ec5e4eccd9129ee8">dgf_ax</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">//  --- Group 4</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 4: Specific Simulation Case Flags \n&quot;</span>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-cop&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ae9f42dc66b074d482e5515c908519216">cop</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-fish&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a1b08cdba1a7d4de048fbf472edfd5850">fish</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-pizza&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a768706b18a55a91246d847ec829faa43">pizza</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-turbine&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a04c849d5fadc93b99bd328df1b90adce">turbine</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-fishcyl&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a05c02891978b9f09aff6f2f6b0a636fe">fishcyl</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-eel&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a912b5bb58c3db258fa468d66ead8d6fd">eel</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-cstart&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a0f1542afb8462493ca6e37c0285b3436">fish_c</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-wing&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aff67a9b22db3995c8a1acf0ccbcb3eb7">wing</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mhv&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a02fd03c4c166911f067e92b36d1820a3">MHV</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-hydro&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#acdd1a65b6f7557e023f70e782c24c202">hydro</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-lv&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a1bec6eafffafc2eecc2efb4377e6fed1">LV</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-Pipe&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aeb624d13d58833ceca0dcac7855a1b65">Pipe</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//  --- Group 5</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 5: Solver &amp; Numerics Parameters \n&quot;</span>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-imp&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a413be1a878e86c9e5d54d52380822d2d">implicit</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-imp_type&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a070c1635b3c81726e526cc8efeae4022">implicit_type</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-imp_MAX_IT&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ae7ba91fbb3aedec394bb9bf821740584">imp_MAX_IT</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-imp_atol&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a46331b4618365171b8acca414cfee348">imp_atol</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-imp_rtol&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a3c4eaacc19b561cba4a96aafbdb30850">imp_rtol</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-imp_stol&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a9ceb6475261683f406ad2961abaa0f3d">imp_stol</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-central&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab4811dc3ebc8ea1154e75c8c38639259">central</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// --- Multigrid Options ---</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mg_level&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab03f6ae8e484ed1a626cf207aeab1382">mglevels</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mg_max_it&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a6a60d593b5ef4747e9c7eb086e91c75a">mg_MAX_IT</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mg_idx&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a68dffbb3717fdf0b6a79bd9169c067c5">mg_idx</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mg_pre_it&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#adb0a0adae51684c0d56ca6d8ab119fbf">mg_preItr</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mg_post_it&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a805f30aa6b217daa5ec56481577f71f8">mg_poItr</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// --- Other Solver Options ---</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-poisson&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a859022c229213fbf2166434a66ee7422">poisson</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-poisson_tol&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a146d75ad33e5ba60b528cc38a0d3f7dd">poisson_tol</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-str&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a82348af36047097defe3692225145edc">STRONG_COUPLING</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-ren&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">ren</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-cfl&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aaf69cd924766117c45ba60fcf2ed452e">cfl</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-vnn&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aebf75baa2defdbe4f6dcce0b6620cad4">vnn</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-finit&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-ucont_x&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-ucont_y&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-ucont_z&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// NOTE: cdisx,cdisy,cdisz haven&#39;t been parsed, add if necessary.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;     <span class="comment">//  --- Group 6</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 6: Physical &amp; Geometric Parameters \n&quot;</span>);   </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-no_of_bodies&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a88c4b985c5df59d8fd0ac17910dbb85c">NumberOfBodies</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// NOTE: angle is not parsed in the original code, it set programmatically. We will follow that.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// NOTE: max_angle is calculated based on other flags (like MHV) in the legacy code.</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// We will defer that logic to a later setup stage and not parse them directly.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// The Scaling Information is calculated here</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    ierr = <a class="code" href="io_8h.html#a10269cd4ddae9d1a84b84de3e2913158">ParseScalingInformation</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;     <span class="comment">//  --- Group 7</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 7: Grid, Domain, and Boundary Condition Settings \n&quot;</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-nblk&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>, NULL); CHKERRQ(ierr); <span class="comment">// This is also a modern option</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-inlet&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a57b3c5733ac4acdef370e635e85df95f">inletprofile</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-Ogrid&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a8a4e2f647306f38daa0d543090647a4f">Ogrid</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// NOTE: channelz was not parsed, likely set programmatically. We will omit its parsing call.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-grid1d&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a223f70881916d4d77f5f62b1faf4547f">grid1d</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    ierr = PetscOptionsGetBool(NULL, NULL, <span class="stringliteral">&quot;-grid&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a98a90e3a55a0a0da6e392f44ebf50dad">generate_grid</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    ierr = PetscOptionsGetString(NULL, NULL, <span class="stringliteral">&quot;-grid_file&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">grid_file</a>, PETSC_MAX_PATH_LEN, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-da_processors_x&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ac014127a43e8978a157a8a42c2f0538d">da_procs_x</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-da_processors_y&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a44230884a9901af3992a1faf2eebdfb1">da_procs_y</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-da_processors_z&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a281d10df99cab1a563bb65203f3bd823">da_procs_z</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-i_periodic&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ac6c6cfb6059e67c1f8ad3c1bbe7f7889">i_periodic</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-j_periodic&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#afd3cbef00a91e3115e40ccd7b0a8cfbb">j_periodic</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-k_periodic&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a57873ffd9532be40cdf7aa76955b5d61">k_periodic</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-pbc_domain&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a2892b7742faefb81b542c6fdd2351e68">blkpbc</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// NOTE: pseudo_periodic was not parsed. We will omit its parsing call. </span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-grid_rotation_angle&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#abf0fd1ca67fe0886eb53735ec3d5ed01">grid_rotation_angle</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-Croty&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab98a3518e774e7d3778c82c8d4e06e67">Croty</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-Crotz&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a494c23ca7d8b99ea8bdcd34d6c2b81a3">Crotz</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    PetscBool bcs_flg;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordtype">char</span>      file_list_str[PETSC_MAX_PATH_LEN * 10]; <span class="comment">// Buffer for comma-separated list</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    ierr = PetscOptionsGetString(NULL, NULL, <span class="stringliteral">&quot;-bcs_files&quot;</span>, file_list_str, <span class="keyword">sizeof</span>(file_list_str), &amp;bcs_flg); CHKERRQ(ierr);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;     ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-U_bc&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">U_bc</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">if</span> (bcs_flg) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Found -bcs_files option, overriding default.\n&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">// A. Clean up the default memory we allocated in Phase 1.</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      ierr = PetscFree(simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      ierr = PetscFree(simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a> = 0;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a> = NULL;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="comment">// B. Parse the user-provided comma-separated list.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordtype">char</span> *token;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordtype">char</span> *str_copy;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      ierr = PetscStrallocpy(file_list_str, &amp;str_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">// First pass: count the number of files.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      token = strtok(str_copy, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">while</span> (token) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a>++;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        token = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      ierr = PetscFree(str_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="comment">// Second pass: allocate memory and store the filenames.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      ierr = PetscMalloc1(simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      ierr = PetscStrallocpy(file_list_str, &amp;str_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      token = strtok(str_copy, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a>; i++) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        ierr = PetscStrallocpy(token, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>[i]); CHKERRQ(ierr);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        token = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      ierr = PetscFree(str_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;     <span class="comment">//  --- Group 8</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 8: Turbulence Modeling (LES/RANS) \n&quot;</span>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-les&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">les</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-rans&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">rans</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-wallfunction&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aa60ee4e3f8eca251ee470427f1ebac13">wallfunction</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-mixed&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a4b2a3494bdeca82703c2b3125c81c8f6">mixed</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-clark&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a0636fa7c6553721728dc41cafb482463">clark</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-dynamic_freq&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#abf6c288c1dbfb0530acf9490fd947f3b">dynamic_freq</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    ierr = PetscOptionsGetReal(NULL, NULL, <span class="stringliteral">&quot;-max_cs&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a7a3f92059ddd489f41cd89dbcd2a1763">max_cs</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-testfilter_ik&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#acca07088dd652f1f01ed1f4eb8b1d4cc">testfilter_ik</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-testfilter_1d&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a463c0299584d32311b5f290ee5f9597c">testfilter_1d</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-i_homo_filter&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#aa483a3664f2eca9684bf3efbec8da1aa">i_homo_filter</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-j_homo_filter&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a8c2555d0e12b81177396765b584f1a14">j_homo_filter</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-k_homo_filter&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a86567855ecf1fbc638287ad7040ab55a">k_homo_filter</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    ierr = PetscOptionsGetBool(NULL, NULL, <span class="stringliteral">&quot;-averaging&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a61f9f685923b2b7b99434b6100cc10d7">averaging</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;     <span class="comment">//  --- Group 9</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 9:  Particle / DMSwarm Data &amp; Settings \n&quot;</span>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-numParticles&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    ierr = PetscOptionsGetBool(NULL, NULL, <span class="stringliteral">&quot;-read_fields&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ab45ae5b28b66812e5e4b0e85a540f948">readFields</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-pinit&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    ierr = PetscOptionsGetString(NULL,NULL,<span class="stringliteral">&quot;-particle_restart_mode&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>,<span class="keyword">sizeof</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>),NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// Validation for Particle Restart Mode</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">if</span> (strcmp(simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>, <span class="stringliteral">&quot;load&quot;</span>) != 0 &amp;&amp; strcmp(simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>, <span class="stringliteral">&quot;init&quot;</span>) != 0) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONG, <span class="stringliteral">&quot;Invalid value for -particle_restart_mode. Must be &#39;load&#39; or &#39;init&#39;. You provided &#39;%s&#39;.&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// --- Group 10</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 10: Immersed Boundary &amp; FSI Data Object Pointers \n&quot;</span>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    ierr = PetscOptionsGetBool(NULL, NULL, <span class="stringliteral">&quot;-rs_fsi&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a5d62bb83d782192bfb7a04b985d1b8aa">rstart_fsi</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-duplicate&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a4008d732ef13f23af3139d500f629624">duplicate</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// --- Group 11</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 11: Top-Level Managers &amp; Custom Configuration \n&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    ierr = PetscOptionsGetInt(NULL, NULL, <span class="stringliteral">&quot;-logfreq&quot;</span>, &amp;simCtx-&gt;<a class="code" href="variables_8h.html#af4e8e680314f5a935c26342d6dca13c8">LoggingFrequency</a>, NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a> != simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>) {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_INCOMP, <span class="stringliteral">&quot;Number of BC files (%d) does not match number of blocks (%d). Use -bcs_files \&quot;file1.dat,file2.dat,...\&quot;.&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">num_bcs_files</a>, simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// --- Group 12</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Parsing Group 12: Post-Processing Information.\n&quot;</span>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// This logic determines the Post Processing configuration and STORES it in simCtx for later reference and cleanup.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    ierr = PetscOptionsGetString(NULL,NULL,<span class="stringliteral">&quot;-postprocessing_config_file&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#af05e9e68e0acf99ae030d44b905e33fb">PostprocessingControlFile</a>,PETSC_MAX_PATH_LEN,NULL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    ierr = PetscNew(&amp;simCtx-&gt;<a class="code" href="variables_8h.html#acf6d729ae4d0d996d6b056ccc5438995">pps</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    ierr = <a class="code" href="io_8h.html#a048b921bc98a7354369a176193c2bd62">ParsePostProcessingSettings</a>(simCtx);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// === 5. Dependent Parameter Calculations ================================</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// Some parameters depend on others, so we calculate them here.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a337c3a9a9bf061e10d71ba990aa6ed29">StartTime</a> = (PetscReal)simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#aea06dd1e5437886745d3545e2a383172">ti</a> = simCtx-&gt;<a class="code" href="variables_8h.html#a337c3a9a9bf061e10d71ba990aa6ed29">StartTime</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a> = simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// === 5. Log Summary and Finalize Setup ==================================</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;-- Console Output Functions [Total : %d] : --\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; simCtx-&gt;<a class="code" href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">nAllowed</a>; ++i) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;   [%2d] «%s»\n&quot;</span>, i, simCtx-&gt;<a class="code" href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">allowedFuncs</a>[i]);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Configuration complete. Key parameters:\n&quot;</span>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  - Run mode: %s\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a6bae0e92738d6c3498ac41b67ed5b7a4">OnlySetup</a> ? <span class="stringliteral">&quot;SETUP ONLY&quot;</span> : <span class="stringliteral">&quot;Full Simulation&quot;</span>);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  - Time steps: %d (from %d to %d)\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">StepsToRun</a>, simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>, simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a> + simCtx-&gt;<a class="code" href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">StepsToRun</a>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  - Time step size (dt): %g\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  - Immersed Boundary: %s\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#aef90766eec6fc6887cd39bd1d79cb6d2">immersed</a> ? <span class="stringliteral">&quot;ENABLED&quot;</span> : <span class="stringliteral">&quot;DISABLED&quot;</span>);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  - Particles: %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a> &gt; 0 &amp;&amp; simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> &gt; 0) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;    - Particle Restart Mode: %s\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// --- Initialize PETSc&#39;s internal performance logging stage ---</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    ierr = PetscLogDefaultBegin(); CHKERRQ(ierr); <span class="comment">// REDUNDANT but safe.</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Finished CreateSimulationContext successfully on rank %d.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a977df65dac293c1308451334cb198693_cgraph.svg" width="663" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a977df65dac293c1308451334cb198693_icgraph.svg" width="300" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acf739211501f0646c25ceb99a68a1163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf739211501f0646c25ceb99a68a1163">&#9670;&nbsp;</a></span>AllocateContextHierarchy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode AllocateContextHierarchy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates the memory for the <a class="el" href="variables_8h.html#structUserMG" title="User-level context for managing the entire multigrid hierarchy.">UserMG</a> and <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> hierarchy. </p>
<p>This function performs the foundational memory allocation for the solver's data structures. It reads the number of multigrid levels and grid blocks from the master SimulationContext, then allocates the arrays for <a class="el" href="variables_8h.html#structMGCtx" title="Context for Multigrid operations.">MGCtx</a> and <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a>.</p>
<p>It performs three critical tasks:</p><ol type="1">
<li>Allocates the <a class="el" href="variables_8h.html#structMGCtx" title="Context for Multigrid operations.">MGCtx</a> array within the <a class="el" href="variables_8h.html#structUserMG" title="User-level context for managing the entire multigrid hierarchy.">UserMG</a> struct.</li>
<li>For each level, allocates the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> array for all blocks.</li>
<li>Sets the <code>simCtx</code> back-pointer in every single <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a>, linking it to the master configuration.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">simCtx</td><td>The master SimulationContext, which contains configuration and will store the resulting allocated hierarchy in its <code>usermg</code> member. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l00491">491</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;{</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="variables_8h.html#structUserMG">UserMG</a>         *usermg = &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="variables_8h.html#structMGCtx">MGCtx</a>          *mgctx;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    PetscInt       nblk = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    PetscBool      found;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Allocating context hierarchy for %d levels and %d blocks...\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#ab03f6ae8e484ed1a626cf207aeab1382">mglevels</a>, nblk);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="comment">// Store the number of levels in the UserMG struct itself</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> = simCtx-&gt;<a class="code" href="variables_8h.html#ab03f6ae8e484ed1a626cf207aeab1382">mglevels</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">// --- 1. Allocate the array of MGCtx structs ---</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    ierr = PetscMalloc(usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> * <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structMGCtx">MGCtx</a>), &amp;usermg-&gt;<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    mgctx = usermg-&gt;<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Allocated MGCtx array of size %d.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// --- 2. Parse semi-coarsening options (logic from MG_Initial) ---</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// These flags determine if a dimension is coarsened in the multigrid hierarchy.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    PetscInt *isc, *jsc, *ksc;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    ierr = PetscMalloc3(nblk, &amp;isc, nblk, &amp;jsc, nblk, &amp;ksc); CHKERRQ(ierr);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="comment">// Set defaults to FALSE (full coarsening)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">for</span> (PetscInt i = 0; i &lt; nblk; ++i) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        isc[i] = 0; jsc[i] = 0; ksc[i] = 0;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">// Use a temporary variable for the &#39;count&#39; argument to the parsing function.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// This protects the original &#39;nblk&#39; which is needed for the loop bounds.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    PetscInt n_opts_found = nblk;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-mg_i_semi&quot;</span>, isc, &amp;n_opts_found, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    n_opts_found = nblk; <span class="comment">// Reset the temp variable before the next call</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-mg_j_semi&quot;</span>, jsc, &amp;n_opts_found, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    n_opts_found = nblk; <span class="comment">// Reset the temp variable before the next call</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    ierr = PetscOptionsGetIntArray(NULL, NULL, <span class="stringliteral">&quot;-mg_k_semi&quot;</span>, ksc, &amp;n_opts_found, &amp;found); CHKERRQ(ierr);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="comment">// --- 3. Loop over levels and blocks to allocate UserCtx arrays ---</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">for</span> (PetscInt level = 0; level &lt; simCtx-&gt;<a class="code" href="variables_8h.html#ab03f6ae8e484ed1a626cf207aeab1382">mglevels</a>; level++) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Setting up MG Level %d...\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, level);        </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment">// Allocate the array of UserCtx structs for this level</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        ierr = PetscMalloc(nblk * <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structUserCtx">UserCtx</a>), &amp;mgctx[level].user); CHKERRQ(ierr);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">// It&#39;s good practice to zero out the memory to avoid uninitialized values</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        ierr = PetscMemzero(mgctx[level].user, nblk * <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structUserCtx">UserCtx</a>)); CHKERRQ(ierr);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        mgctx[level].<a class="code" href="variables_8h.html#a6174aa2a9e98d6a6aa1d332aa58f0ffe">thislevel</a> = level;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; nblk; bi++) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a> *currentUser = &amp;mgctx[level].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>[bi];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d:   Initializing UserCtx for Level %d, Block %d.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, level, bi);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="comment">// --- CRITICAL STEP: Set the back-pointer to the master context ---</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a> = simCtx;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="comment">// Initialize other per-context values</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a99a88d89d58073bd134175f62213c528">thislevel</a> = level;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a4f7c5fd8843d026101b193e9236e1192">_this</a> = bi; <span class="comment">// Store the block index</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a1a81a690145500f4d561fb9f84c5f64b">mglevels</a> = usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <span class="comment">// Assign semi-coarsening flags</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a03772da847da737415fd5a86a97147bd">isc</a> = isc[bi];</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a5fd8588302a68eca03d086e01e8972c1">jsc</a> = jsc[bi];</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            currentUser-&gt;<a class="code" href="variables_8h.html#a3e8bcd710c619c329608b6f7da5f1ea1">ksc</a> = ksc[bi];</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            <span class="comment">// Link to finer/coarser contexts for multigrid operations</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="keywordflow">if</span> (level &gt; 0) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                currentUser-&gt;<a class="code" href="variables_8h.html#a8420a45c7f75054e71e9d8530e52ee8e">user_c</a> = &amp;mgctx[level-1].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>[bi];</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d:     -&gt; Linked to coarser context (user_c).\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            <span class="keywordflow">if</span> (level &lt; usermg-&gt;mglevels - 1) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                currentUser-&gt;<a class="code" href="variables_8h.html#a2deb96128ed850632f645128e26e229e">user_f</a> = &amp;mgctx[level+1].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>[bi];</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d:     -&gt; Linked to finer context (user_f).\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            }</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="comment">// Log a summary of the parsed flags on each rank.</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a>() &gt;= <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a> &amp;&amp; nblk &gt; 0) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Final semi-coarsening configuration view:\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; nblk; ++bi) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d:   Block %d: i-semi=%d, j-semi=%d, k-semi=%d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, bi, isc[bi], jsc[bi], ksc[bi]);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="comment">// Clean up temporary arrays</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    ierr = PetscFree3(isc, jsc, ksc); CHKERRQ(ierr);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Context hierarchy allocation complete.\n&quot;</span>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_acf739211501f0646c25ceb99a68a1163_cgraph.svg" width="358" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_acf739211501f0646c25ceb99a68a1163_icgraph.svg" width="510" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3766d23bad255474ff61d06fbb6f63f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3766d23bad255474ff61d06fbb6f63f7">&#9670;&nbsp;</a></span>SetupSolverParameters()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscErrorCode SetupSolverParameters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l00588">588</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                                           {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot; -- Setting up solver parameters -- .\n&quot;</span>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="variables_8h.html#structUserMG">UserMG</a>         *usermg = &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <a class="code" href="variables_8h.html#structMGCtx">MGCtx</a>          *mgctx = usermg-&gt;<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  PetscInt       nblk = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keywordflow">for</span> (PetscInt level  = usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>-1; level &gt;=0; level--) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; nblk; bi++) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a> *user = &amp;mgctx[level].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>[bi];</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Setting up parameters for level %d, block %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, level, bi);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      user-&gt;<a class="code" href="variables_8h.html#a41951f47cfbe9c08def29998a76dc791">assignedA</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      user-&gt;<a class="code" href="variables_8h.html#ae0a7a10f0bc2adac4b621178b64aa6f6">multinullspace</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a3766d23bad255474ff61d06fbb6f63f7_icgraph.svg" width="495" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2be2815aeb79afe9b95caf39c7b3312c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be2815aeb79afe9b95caf39c7b3312c">&#9670;&nbsp;</a></span>SetupGridAndSolvers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetupGridAndSolvers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main orchestrator for setting up all grid-related components. </p>
<p>(Implementation of the orchestrator function itself) </p>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l00618">618</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;{</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Starting Grid and Solvers Setup ---\n&quot;</span>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// Phase 1: Allocate the UserMG and UserCtx hierarchy</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    ierr = <a class="code" href="setup_8c.html#acf739211501f0646c25ceb99a68a1163">AllocateContextHierarchy</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// [ The next phases will be added here ]</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    ierr = <a class="code" href="grid_8h.html#a04f0887f08166a2a8d01411f39fa1a40">DefineAllGridDimensions</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    ierr = <a class="code" href="grid_8h.html#aa0b95ab3ac28c8df985e38b888c9bb52">InitializeAllGridDMs</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    ierr = <a class="code" href="grid_8h.html#ab2aef4bb6fc2d2223a52ff6a45c7c600">AssignAllGridCoordinates</a>(simCtx);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    ierr = <a class="code" href="setup_8c.html#a47daae7d6e456ef74e75626c1c9d6c9a">CreateAndInitializeAllVectors</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    ierr = <a class="code" href="setup_8c.html#a3766d23bad255474ff61d06fbb6f63f7">SetupSolverParameters</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    ierr = <a class="code" href="Metric_8h.html#a063043da47b68702c78c7e0769325b36">CalculateAllGridMetrics</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Grid and Solvers Setup Complete ---\n&quot;</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_a2be2815aeb79afe9b95caf39c7b3312c_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a2be2815aeb79afe9b95caf39c7b3312c_icgraph.svg" width="272" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a47daae7d6e456ef74e75626c1c9d6c9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47daae7d6e456ef74e75626c1c9d6c9a">&#9670;&nbsp;</a></span>CreateAndInitializeAllVectors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode CreateAndInitializeAllVectors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and initializes all PETSc Vec objects for all fields. </p>
<p>This function iterates through every <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> in the multigrid and multi-block hierarchy. For each context, it creates the comprehensive set of global and local PETSc Vecs required by the flow solver (e.g., Ucont, P, Nvert, metrics, turbulence fields, etc.). Each vector is initialized to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">simCtx</td><td>The master <a class="el" href="variables_8h.html#structSimCtx" title="The master context for the entire simulation.">SimCtx</a>, containing the configured <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> hierarchy. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l00658">658</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="variables_8h.html#structUserMG">UserMG</a>         *usermg = &amp;simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="variables_8h.html#structMGCtx">MGCtx</a>          *mgctx = usermg-&gt;<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    PetscInt       nblk = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160; </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Creating and initializing all simulation vectors...\n&quot;</span>);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">for</span> (PetscInt level  = usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>-1; level &gt;=0; level--) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; nblk; bi++) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a> *user = &amp;mgctx[level].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>[bi];</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">if</span>(!user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a> || !user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;              SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;DMs not properly initialized in UserCtx before vector creation.&quot;</span>);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            }</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Creating vectors for level %d, block %d\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a>, level, bi);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// --- Group A: Primary Flow Fields (Global and Local) ---</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="comment">// These are the core solution variables.</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>);  CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>);     CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>);  CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>);     CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <span class="comment">// --- Group B: Time-Stepping &amp; Workspace Fields (Finest Level Only) ---</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">if</span> (level == usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#aa3e47c4956a89b33d659fe33f4814091">Ucont_o</a>);   CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#aa3e47c4956a89b33d659fe33f4814091">Ucont_o</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ac5eef54f719e58aacd10010fbe61f2d5">Ucont_rm1</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ac5eef54f719e58aacd10010fbe61f2d5">Ucont_rm1</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#a82d8c3eb7b01d4a4decdd9e3f23c152f">Ucat_o</a>);    CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a82d8c3eb7b01d4a4decdd9e3f23c152f">Ucat_o</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>,     &amp;user-&gt;<a class="code" href="variables_8h.html#afa542dfd7b8528862c1b4a96db3e35c7">P_o</a>);       CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#afa542dfd7b8528862c1b4a96db3e35c7">P_o</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                  ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a7be157e6d32861b8732814e08ce17ae2">lUcont_o</a>);   CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a7be157e6d32861b8732814e08ce17ae2">lUcont_o</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a4a1d73fcab703005ec80b7d68674506e">lUcont_rm1</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a4a1d73fcab703005ec80b7d68674506e">lUcont_rm1</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#adb95ee773b807cc6ec5e19c725f72afb">lNvert_o</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#adb95ee773b807cc6ec5e19c725f72afb">lNvert_o</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ab7d6dffd5a35c03211c65aca209c909e">Nvert_o</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ab7d6dffd5a35c03211c65aca209c909e">Nvert_o</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="comment">// --- Group C: Grid Metrics (Cell-Centered) ---</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a8f4b905ecaadd9a0fe0b36faa1e3aa53">Eta</a>);         CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a8f4b905ecaadd9a0fe0b36faa1e3aa53">Eta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a148acf527180f13125589c3fb8f4e816">Zet</a>);         CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a148acf527180f13125589c3fb8f4e816">Zet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>);  CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;              ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a2f3825691b122a0bf2ed5728b70bc9b1">Phi</a>);       CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a2f3825691b122a0bf2ed5728b70bc9b1">Phi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>);       CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>);       CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  &amp;user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>);  CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;         ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a7a1cf0e107351a96b27ae00160e60271">lPhi</a>);       CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a7a1cf0e107351a96b27ae00160e60271">lPhi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="comment">// --- Group D: Grid Metrics (Face-Centered) ---</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            <span class="comment">// Vector metrics are duplicated from Csi (DOF=3, fda-based)</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a9d9e92084d58808e9a52a80fa9d82092">ICsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a9d9e92084d58808e9a52a80fa9d82092">ICsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a3bfdfbc3022c8bc7f58ec9113275586f">IEta</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a3bfdfbc3022c8bc7f58ec9113275586f">IEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a3791d5150655979c702ff538e0c2d0a5">IZet</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a3791d5150655979c702ff538e0c2d0a5">IZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a0d160d8dbe2ebacbdf86c7c40edf6c68">JCsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a0d160d8dbe2ebacbdf86c7c40edf6c68">JCsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a14137f3f169b2ebe384683ea9a8b7f6d">JEta</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a14137f3f169b2ebe384683ea9a8b7f6d">JEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a733ad785db194e51ad86c1613844ba31">JZet</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a733ad785db194e51ad86c1613844ba31">JZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ada60dbb4f918fda297a992a4228b1166">KCsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ada60dbb4f918fda297a992a4228b1166">KCsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ac29b95b05aa4bc3539389113c408d19e">KEta</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ac29b95b05aa4bc3539389113c408d19e">KEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ad6b708fb886f2f7b49f28d4466af5fa0">KZet</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ad6b708fb886f2f7b49f28d4466af5fa0">KZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;            <span class="comment">// Scalar metrics are duplicated from Aj (DOF=1, da-based)</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#abbf9f36d259bcdf12c831721e70390ee">IAj</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#abbf9f36d259bcdf12c831721e70390ee">IAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ac07ad1cd425926ccddebaca19310d090">JAj</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ac07ad1cd425926ccddebaca19310d090">JAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a0d51f086ccdc81656ddea875d523173e">KAj</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a0d51f086ccdc81656ddea875d523173e">KAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="comment">// --- Group E: Cell/Face Center Coordinates and Grid Spacing ---</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a0a9771638133dcba2d6819c8ee4ea7b6">GridSpace</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a0a9771638133dcba2d6819c8ee4ea7b6">GridSpace</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a97d71af54bbd6d215c8d3838b574d799">lGridSpace</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a97d71af54bbd6d215c8d3838b574d799">lGridSpace</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="comment">// Face-center coordinate vectors are LOCAL to hold calculated values before scattering</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a77888fe1930df923549faaf5951455ba">Centx</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a77888fe1930df923549faaf5951455ba">Centx</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#addaea1781031d3f9ff945d87e8c5b728">Centy</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#addaea1781031d3f9ff945d87e8c5b728">Centy</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a3998b7b5dad8340caf395c5da62230b7">Centz</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a3998b7b5dad8340caf395c5da62230b7">Centz</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">if</span>(level == usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> -1){</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="comment">// --- Group F: Turbulence Models (Finest Level Only) ---</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">les</a> || simCtx-&gt;<a class="code" href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">rans</a>) {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a9458ae2fd01569ea1ea0e84106874485">Nu_t</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a9458ae2fd01569ea1ea0e84106874485">Nu_t</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                ierr = DMCreateLocalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a9338cb4f3fbc319695a259d0dc09c002">lNu_t</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a9338cb4f3fbc319695a259d0dc09c002">lNu_t</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="comment">// Add K_Omega, CS, etc. here as needed</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            <span class="comment">// Note: Add any other vectors from the legacy MG_Initial here as needed.</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="comment">// For example: Rhs, Forcing, turbulence Vecs (K_Omega, Nu_t)...</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">// --- Group G: Particle Methods    </span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>&gt;0){</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;          ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,&amp;user-&gt;<a class="code" href="variables_8h.html#aa194db376ea0f68ec7090718804488ab">ParticleCount</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#aa194db376ea0f68ec7090718804488ab">ParticleCount</a>,0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;           ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,&amp;user-&gt;<a class="code" href="variables_8h.html#af8df0703ce4dab73db61fa500a7c5f2b">Psi</a>); CHKERRQ(ierr); ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#af8df0703ce4dab73db61fa500a7c5f2b">Psi</a>,0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;          <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;ParticleCount &amp; Scalar(Psi) created for %d particles.\n&quot;</span>,simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;          }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        }</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="comment">// --- Group H: Boundary Condition vectors needed by the legacy FormBCS ---</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables_8h.html#a6ef13ed6ab8f82c44bd8a81739ff90e2">Ubcs</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables_8h.html#a6ef13ed6ab8f82c44bd8a81739ff90e2">Ubcs</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        ierr = DMCreateGlobalVector(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables_8h.html#afbf649648426b009265d74fade4665ca">Uch</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a77c29afd999c79749fc4a0163da98d2e">Bcs</a>.<a class="code" href="variables_8h.html#afbf649648426b009265d74fade4665ca">Uch</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <span class="keywordflow">if</span>(level == usermg-&gt;<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> -1){</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#ae27e734d789eb2f07918d6bae3969480">exec_mode</a> == <a class="code" href="variables_8h.html#ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f">EXEC_MODE_POSTPROCESSOR</a>){</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Post-processor mode detected. Allocating derived field vectors.\n&quot;</span>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a0d09ddf5e31ea3cfcab2c6bbc59b64cd">P_nodal</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a0d09ddf5e31ea3cfcab2c6bbc59b64cd">P_nodal</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a585521a5dbb55ae244e34a354ac93e3f">Ucat_nodal</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a585521a5dbb55ae244e34a354ac93e3f">Ucat_nodal</a>, 0.0); CHKERRQ(ierr);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                ierr = VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;user-&gt;<a class="code" href="variables_8h.html#a70969e8333ab8fd8eb60acc1f22f830a">Qcrit</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                ierr = VecSet(user-&gt;<a class="code" href="variables_8h.html#a70969e8333ab8fd8eb60acc1f22f830a">Qcrit</a>, 0.0); CHKERRQ(ierr);          </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                user-&gt;<a class="code" href="variables_8h.html#a0d09ddf5e31ea3cfcab2c6bbc59b64cd">P_nodal</a> = NULL;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                user-&gt;<a class="code" href="variables_8h.html#a585521a5dbb55ae244e34a354ac93e3f">Ucat_nodal</a> = NULL;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                user-&gt;<a class="code" href="variables_8h.html#a70969e8333ab8fd8eb60acc1f22f830a">Qcrit</a> = NULL;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;}</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;All simulation vectors created and initialized.\n&quot;</span>);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a47daae7d6e456ef74e75626c1c9d6c9a_icgraph.svg" width="532" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad5f82951adcce74b3d37cb5880acf43a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f82951adcce74b3d37cb5880acf43a">&#9670;&nbsp;</a></span>UpdateLocalGhosts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UpdateLocalGhosts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the local vector (including ghost points) from its corresponding global vector. </p>
<p>This function identifies the correct global vector, local vector, and DM based on the provided fieldName and performs the standard PETSc DMGlobalToLocalBegin/End sequence. Includes optional debugging output (max norms before/after).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the vectors and DMs. </td></tr>
    <tr><td class="paramname">fieldName</td><td>The name of the field to update ("Ucat", "Ucont", "P", "Nvert", etc.).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function assumes the global vector associated with fieldName has already been populated with the desired data (including any boundary conditions). </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l00832">832</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;{</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    PetscMPIInt    rank;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    Vec            globalVec = NULL;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    Vec            localVec = NULL;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    DM             dm = NULL; <span class="comment">// The DM associated with this field pair</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    PetscFunctionBeginUser; <span class="comment">// Use User version for application code</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Rank %d: Starting ghost update for field &#39;%s&#39;.\n&quot;</span>, rank, fieldName);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// --- 1. Identify the correct Vectors and DM ---</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Ucat&quot;</span>) == 0) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#ace2eeedc863d73caaf51bb83aa993e44">lUcat</a>;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Ucont&quot;</span>) == 0) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;P&quot;</span>) == 0) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#a95078248cc49ce19d5d05b14e1701888">lP</a>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Csi&quot;</span>) == 0) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">Csi</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Eta&quot;</span>) == 0) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a8f4b905ecaadd9a0fe0b36faa1e3aa53">Eta</a>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Zet&quot;</span>) == 0) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a148acf527180f13125589c3fb8f4e816">Zet</a>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Nvert&quot;</span>) == 0) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">Nvert</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;     <span class="comment">// Add other fields as needed</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Aj&quot;</span>) == 0) {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">Aj</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Cent&quot;</span>) == 0) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">Cent</a>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">lCent</a>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;GridSpace&quot;</span>) == 0) {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        globalVec = user-&gt;<a class="code" href="variables_8h.html#a0a9771638133dcba2d6819c8ee4ea7b6">GridSpace</a>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        localVec  = user-&gt;<a class="code" href="variables_8h.html#a97d71af54bbd6d215c8d3838b574d799">lGridSpace</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;ICsi&quot;</span>) == 0){</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a9d9e92084d58808e9a52a80fa9d82092">ICsi</a>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#acbf784310453bd7aec02838cdef24a66">lICsi</a>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;IEta&quot;</span>) == 0){</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a3bfdfbc3022c8bc7f58ec9113275586f">IEta</a>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a2276cb159119246bfadea1c234dee31b">lIEta</a>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;IZet&quot;</span>) == 0){</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a3791d5150655979c702ff538e0c2d0a5">IZet</a>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a2db602ea5fce7cec91f19f507f922a74">lIZet</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;JCsi&quot;</span>) == 0){</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a0d160d8dbe2ebacbdf86c7c40edf6c68">JCsi</a>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a63b70d5ad8338013a2888928d4106f63">lJCsi</a>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;JEta&quot;</span>) == 0){</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a14137f3f169b2ebe384683ea9a8b7f6d">JEta</a>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a96938d329a797441f228ecddd8e8e607">lJEta</a>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;JZet&quot;</span>) == 0){</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a733ad785db194e51ad86c1613844ba31">JZet</a>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">lJZet</a>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;KCsi&quot;</span>) == 0){</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#ada60dbb4f918fda297a992a4228b1166">KCsi</a>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">lKCsi</a>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;KEta&quot;</span>) == 0){</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#ac29b95b05aa4bc3539389113c408d19e">KEta</a>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a508de73c1c5929cbee04a94091f2799e">lKEta</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;KZet&quot;</span>) == 0){</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#ad6b708fb886f2f7b49f28d4466af5fa0">KZet</a>;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a8e6283b2989fae5d0a235baa570e929f">lKZet</a>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;IAj&quot;</span>) == 0){</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#abbf9f36d259bcdf12c831721e70390ee">IAj</a>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a4d561e219e8bc40951d121cce66d93ce">lIAj</a>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;JAj&quot;</span>) == 0){</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#ac07ad1cd425926ccddebaca19310d090">JAj</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#ae8527c7cba1c5764994053481722eb01">lJAj</a>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;KAj&quot;</span>) == 0){</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a0d51f086ccdc81656ddea875d523173e">KAj</a>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">lKAj</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(fieldName,<span class="stringliteral">&quot;Phi&quot;</span>) == 0){</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      globalVec = user-&gt;<a class="code" href="variables_8h.html#a2f3825691b122a0bf2ed5728b70bc9b1">Phi</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      localVec  = user-&gt;<a class="code" href="variables_8h.html#a7a1cf0e107351a96b27ae00160e60271">lPhi</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      dm        = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }<span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_UNKNOWN_TYPE, <span class="stringliteral">&quot;Field &#39;%s&#39; not recognized for ghost update.&quot;</span>, fieldName);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">// --- 2. Check if components were found ---</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordflow">if</span> (!globalVec) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;Global vector for field &#39;%s&#39; is NULL.&quot;</span>, fieldName);</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">if</span> (!localVec) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;Local vector for field &#39;%s&#39; is NULL.&quot;</span>, fieldName);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">if</span> (!dm) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;DM for field &#39;%s&#39; is NULL.&quot;</span>, fieldName);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Identified components for &#39;%s&#39;: DM=%p, GlobalVec=%p, LocalVec=%p.\n&quot;</span>,</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;              rank, fieldName, (<span class="keywordtype">void</span>*)dm, (<span class="keywordtype">void</span>*)globalVec, (<span class="keywordtype">void</span>*)localVec);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">// --- 3. Optional Debugging: Norm Before Update ---</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="comment">// Use your logging convention check</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="comment">// if (get_log_level() &gt;= LOG_LEVEL_DEBUG &amp;&amp; is_function_allowed(&quot;UpdateLocalGhosts&quot;)) { // Example check</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a>() == <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a> &amp;&amp; <a class="code" href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a>(__func__)){</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        PetscReal norm_global_before;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        ierr = VecNorm(globalVec, NORM_INFINITY, &amp;norm_global_before); CHKERRQ(ierr);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Max norm &#39;%s&#39; (Global) BEFORE Ghost Update: %g\n&quot;</span>, fieldName, norm_global_before);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="comment">// Optional: Norm of local vector before update (might contain old ghost values)</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="comment">// PetscReal norm_local_before;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="comment">// ierr = VecNorm(localVec, NORM_INFINITY, &amp;norm_local_before); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// LOG_ALLOW(GLOBAL, LOG_DEBUG,&quot;Max norm &#39;%s&#39; (Local) BEFORE Ghost Update: %g\n&quot;, fieldName, norm_local_before);</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="comment">// --- 4. Perform the Global-to-Local Transfer (Ghost Update) ---</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Calling DMGlobalToLocalBegin/End for &#39;%s&#39;.\n&quot;</span>, rank, fieldName);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    ierr = DMGlobalToLocalBegin(dm, globalVec, INSERT_VALUES, localVec); CHKERRQ(ierr);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    ierr = DMGlobalToLocalEnd(dm, globalVec, INSERT_VALUES, localVec); CHKERRQ(ierr);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Completed DMGlobalToLocalBegin/End for &#39;%s&#39;.\n&quot;</span>, rank, fieldName);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="comment">// --- 5. Optional Debugging: Norm After Update ---</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// Use your logging convention check</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="comment">// if (get_log_level() &gt;= LOG_LEVEL_DEBUG &amp;&amp; is_function_allowed(&quot;UpdateLocalGhosts&quot;)) { // Example check</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a>() == <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a> &amp;&amp; <a class="code" href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a>(__func__)){ <span class="comment">// Using your specific check</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        PetscReal norm_local_after;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        ierr = VecNorm(localVec, NORM_INFINITY, &amp;norm_local_after); CHKERRQ(ierr);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Max norm &#39;%s&#39; (Local) AFTER Ghost Update: %g\n&quot;</span>, fieldName, norm_local_after);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">// --- 6. Optional Debugging: Specific Point Checks (Example for Ucat on Rank 0/1) ---</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        <span class="comment">//    (Keep this conditional if it&#39;s only for specific debug scenarios)</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Ucat&quot;</span>) == 0) { <span class="comment">// Only do detailed checks for Ucat for now</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;           PetscMPIInt rank_test;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;           MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank_test);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;           <span class="comment">// Get Local Info needed for indexing checks</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;           DMDALocalInfo info_check;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;           ierr = DMDAGetLocalInfo(dm, &amp;info_check); CHKERRQ(ierr); <span class="comment">// Use the correct dm</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;           <span class="comment">// Buffer for array pointer</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;           <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> ***lUcat_arr_test = NULL;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;           PetscErrorCode ierr_test = 0;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;           <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Testing &#39;%s&#39; access immediately after ghost update...\n&quot;</span>, rank_test, fieldName);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;           ierr_test = DMDAVecGetArrayDOFRead(dm, localVec, &amp;lUcat_arr_test); <span class="comment">// Use correct dm and localVec</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; </div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;           <span class="keywordflow">if</span> (ierr_test) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;               <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;Rank %d: ERROR %d getting &#39;%s&#39; array after ghost update!\n&quot;</span>, rank_test, ierr_test, fieldName);</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;           } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!lUcat_arr_test) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;Rank %d: ERROR NULL pointer getting &#39;%s&#39; array after ghost update!\n&quot;</span>, rank_test, fieldName);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;           }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;           <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;               <span class="comment">// Check owned interior point (e.g., first interior point)</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;               PetscInt k_int = info_check.zs + (info_check.zm &gt; 1 ? 1 : 0); <span class="comment">// Global k index (at least zs+1 if possible)</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;               PetscInt j_int = info_check.ys + (info_check.ym &gt; 1 ? 1 : 0); <span class="comment">// Global j index</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;               PetscInt i_int = info_check.xs + (info_check.xm &gt; 1 ? 1 : 0); <span class="comment">// Global i index</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <span class="comment">// Ensure indices are within global bounds if domain is very small</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;               <span class="comment">//if (k_int &gt;= info_check.mz-1) k_int = info_check.mz-2; if (k_int &lt; 1) k_int = 1;</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;               <span class="comment">//if (j_int &gt;= info_check.my-1) j_int = info_check.my-2; if (j_int &lt; 1) j_int = 1;</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;           <span class="comment">// if (i_int &gt;= info_check.mx-1) i_int = info_check.mx-2; if (i_int &lt; 1) i_int = 1;</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;           <span class="comment">// clamp k_int to [1 .. mz-2] </span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;           <span class="keywordflow">if</span> (k_int &gt;= info_check.mz - 1) {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;         k_int = info_check.mz - 2;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;           }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;           <span class="keywordflow">if</span> (k_int &lt; 1) {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;         k_int = 1;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;           }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;           <span class="comment">// clamp j_int to [1 .. my-2] </span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;           <span class="keywordflow">if</span> (j_int &gt;= info_check.my - 1) {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;         j_int = info_check.my - 2;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;           }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;           <span class="keywordflow">if</span> (j_int &lt; 1) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;         j_int = 1;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;           }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;           <span class="comment">// clamp i_int to [1 .. mx-2]</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;           <span class="keywordflow">if</span> (i_int &gt;= info_check.mx - 1) {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;         i_int = info_check.mx - 2;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;           }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;           <span class="keywordflow">if</span> (i_int &lt; 1) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         i_int = 1;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;           }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;               <span class="comment">// Only attempt read if indices are actually owned (relevant for multi-rank)</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;               <span class="keywordflow">if</span> (k_int &gt;= info_check.zs &amp;&amp; k_int &lt; info_check.zs + info_check.zm &amp;&amp;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                   j_int &gt;= info_check.ys &amp;&amp; j_int &lt; info_check.ys + info_check.ym &amp;&amp;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                   i_int &gt;= info_check.xs &amp;&amp; i_int &lt; info_check.xs + info_check.xm)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;               {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Attempting test read OWNED INTERIOR [%d][%d][%d] (Global)\n&quot;</span>, rank_test, k_int, j_int, i_int);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                  <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> test_val_owned_interior = lUcat_arr_test[k_int][j_int][i_int];</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: SUCCESS reading owned interior: x=%g\n&quot;</span>, rank_test, test_val_owned_interior.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;               } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Skipping interior test read for non-owned index [%d][%d][%d].\n&quot;</span>, rank_test, k_int, j_int, i_int);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;               }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;               <span class="comment">// Check owned boundary point (e.g., first owned point)</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;               PetscInt k_bnd = info_check.zs; <span class="comment">// Global k index</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;               PetscInt j_bnd = info_check.ys; <span class="comment">// Global j index</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;               PetscInt i_bnd = info_check.xs; <span class="comment">// Global i index</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;               <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Attempting test read OWNED BOUNDARY [%d][%d][%d] (Global)\n&quot;</span>, rank_test, k_bnd, j_bnd, i_bnd);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;               <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> test_val_owned_boundary = lUcat_arr_test[k_bnd][j_bnd][i_bnd];</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;               <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: SUCCESS reading owned boundary: x=%g\n&quot;</span>, rank_test, test_val_owned_boundary.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;               <span class="comment">// Check ghost point (e.g., one layer below in k, if applicable)</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;               <span class="keywordflow">if</span> (info_check.zs &gt; 0) { <span class="comment">// Only if there&#39;s a rank below</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                   PetscInt k_ghost = info_check.zs - 1;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                   PetscInt j_ghost = info_check.ys; <span class="comment">// Use start of owned y, simple example</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                   PetscInt i_ghost = info_check.xs; <span class="comment">// Use start of owned x, simple example</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                   <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Attempting test read GHOST [%d][%d][%d] (Global)\n&quot;</span>, rank_test, k_ghost, j_ghost, i_ghost);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                   <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> test_val_ghost = lUcat_arr_test[k_ghost][j_ghost][i_ghost];</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                   <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: SUCCESS reading ghost: x=%g\n&quot;</span>, rank_test, test_val_ghost.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;               } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                   <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Skipping ghost test read (zs=0).\n&quot;</span>, rank_test);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;               }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;               <span class="comment">// Restore the array</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;               ierr_test = DMDAVecRestoreArrayDOFRead(dm, localVec, &amp;lUcat_arr_test);</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;               <span class="keywordflow">if</span>(ierr_test){ <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;Rank %d: ERROR %d restoring &#39;%s&#39; array after test read!\n&quot;</span>, rank_test, ierr_test, fieldName); }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;               <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: Finished testing &#39;%s&#39; access.\n&quot;</span>, rank_test, fieldName);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;           }</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        } <span class="comment">// end if Ucat</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    } <span class="comment">// end debug logging check</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Rank %d: Completed ghost update for field &#39;%s&#39;.\n&quot;</span>, rank, fieldName);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_ad5f82951adcce74b3d37cb5880acf43a_cgraph.svg" width="358" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_ad5f82951adcce74b3d37cb5880acf43a_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ad9f399b16547eba3244159f7136a1eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9f399b16547eba3244159f7136a1eb9">&#9670;&nbsp;</a></span>SetupBoundaryConditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetupBoundaryConditions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>(Orchestrator) Sets up all boundary conditions for the simulation. </p>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01091">1091</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;{</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Setting up Boundary Conditions ---\n&quot;</span>);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">// --- Parse and Adapt for each block on the finest level ---</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Parsing BC configuration file and adapting to legacy system for finest grid.\n&quot;</span>);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a> *user_finest = simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>[simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>-1].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">for</span> (PetscInt bi = 0; bi &lt; simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>; bi++) {</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  -&gt; Processing Block %d:\n&quot;</span>, bi);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="comment">// --- Generate the filename for the current block ---</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *current_bc_filename = simCtx-&gt;<a class="code" href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">bcs_files</a>[bi];</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;  -&gt; Processing Block %d using config file &#39;%s&#39;\n&quot;</span>, bi, current_bc_filename);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;       <span class="comment">// This will populate user_finest[bi].boundary_faces</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        ierr = <a class="code" href="io_8h.html#a5cc5e40cd538efc87ebd94ebdbb2a8e8">ParseAllBoundaryConditions</a>(&amp;user_finest[bi],current_bc_filename); CHKERRQ(ierr);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="comment">// Call the adapter to translate into the legacy format</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        ierr = <a class="code" href="Boundaries_8h.html#ae7f472e68b4ebad054e1391e5de8c9a0">TranslateModernBCsToLegacy</a>(&amp;user_finest[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="comment">// Call the function to calculate the center of the inlet face, which may be used to calculate Boundary values.</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        ierr = <a class="code" href="grid_8h.html#a7a6ee72a401708711d1bfd039627b606">CalculateInletCenter</a>(&amp;user_finest[bi]); CHKERRQ(ierr); </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Boundary Conditions setup complete ---\n&quot;</span>);   </div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_ad9f399b16547eba3244159f7136a1eb9_cgraph.svg" width="100%" height="594"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_ad9f399b16547eba3244159f7136a1eb9_icgraph.svg" width="304" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8b1b661a11ef0a0e0bb7fb92f2d211f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b1b661a11ef0a0e0bb7fb92f2d211f4">&#9670;&nbsp;</a></span>Allocate3DArrayScalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Allocate3DArrayScalar </td>
          <td>(</td>
          <td class="paramtype">PetscReal ****&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a 3D array of PetscReal values using PetscCalloc. </p>
<p>This function dynamically allocates memory for a 3D array of PetscReal values with dimensions nz (layers) x ny (rows) x nx (columns). It uses PetscCalloc1 to ensure the memory is zero-initialized.</p>
<p>The allocation is done in three steps:</p><ol type="1">
<li>Allocate an array of nz pointers (one for each layer).</li>
<li>Allocate a contiguous block for nz*ny row pointers and assign each layer’s row pointers.</li>
<li>Allocate a contiguous block for all nz*ny*nx PetscReal values.</li>
</ol>
<p>This setup allows the array to be accessed as array[k][j][i], and the memory for the data is contiguous, which improves cache efficiency.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">array</td><td>Pointer to the 3D array to be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>Number of layers (z-direction). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of rows (y-direction). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Number of columns (x-direction).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, nonzero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01148">1148</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;{</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  PetscReal      ***data;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  PetscReal      *dataContiguous;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  PetscInt       k, j;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  PetscFunctionBegin;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="comment">/* Step 1: Allocate memory for an array of nz layer pointers (zero-initialized) */</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  ierr = PetscCalloc1(nz, &amp;data); CHKERRQ(ierr);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="comment">/* Step 2: Allocate memory for all row pointers (nz * ny pointers) */</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  ierr = PetscCalloc1(nz * ny, &amp;data[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">for</span> (k = 1; k &lt; nz; k++) {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    data[k] = data[0] + k * ny;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="comment">/* Step 3: Allocate one contiguous block for all data elements (nz*ny*nx) */</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  ierr = PetscCalloc1(nz * ny * nx, &amp;dataContiguous); CHKERRQ(ierr);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160; </div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <span class="comment">/* Build the 3D pointer structure: each row pointer gets the correct segment of data */</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nz; k++) {</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; ny; j++) {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      data[k][j] = dataContiguous + (k * ny + j) * nx;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="comment">/* Memory is already zeroed by PetscCalloc1, so no manual initialization is needed */</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  }</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  *array = data;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af73e238fa95229094a92ac66812799f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73e238fa95229094a92ac66812799f7">&#9670;&nbsp;</a></span>Deallocate3DArrayScalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Deallocate3DArrayScalar </td>
          <td>(</td>
          <td class="paramtype">PetscReal ***&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates a 3D array of PetscReal values allocated by Allocate3DArrayScalar. </p>
<p>This function frees the memory allocated for a 3D array of PetscReal values. It assumes the memory was allocated using Allocate3DArrayScalar, which allocated three separate memory blocks: one for the contiguous data, one for the row pointers, and one for the layer pointers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">array</td><td>Pointer to the 3D array to be deallocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>Number of layers (z-direction). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of rows (y-direction).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, nonzero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01193">1193</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;{</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  PetscFunctionBegin;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;   <span class="keywordflow">if</span> (!array || !array[0] || !array[0][0] ) { <span class="comment">// Added more robust check</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Deallocate3DArrayScalar called with potentially unallocated or NULL array.\n&quot;</span>);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;       <span class="keywordflow">if</span> (array) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;           <span class="keywordflow">if</span> (array[0]) { <span class="comment">// Check if row pointers might exist</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;               <span class="comment">// Cannot safely access array[0][0] if array[0] might be invalid/freed</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;               <span class="comment">// Standard deallocation below assumes valid pointers.</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                ierr = PetscFree(array[0]); CHKERRQ(ierr); <span class="comment">// Free row pointers if they exist</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;           }</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            ierr = PetscFree(array); CHKERRQ(ierr); <span class="comment">// Free layer pointers if they exist</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;       }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;       PetscFunctionReturn(0);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;   }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// --- Standard Deallocation (assuming valid allocation) ---</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;  <span class="comment">/* 1. Free the contiguous block of PetscReal values.</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="comment">     The starting address was stored in array[0][0]. */</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  ierr = PetscFree(array[0][0]); CHKERRQ(ierr); <span class="comment">// Free the ACTUAL DATA</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  <span class="comment">/* 2. Free the contiguous block of row pointers.</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="comment">     The starting address was stored in array[0]. */</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  ierr = PetscFree(array[0]); CHKERRQ(ierr); <span class="comment">// Free the ROW POINTERS</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="comment">/* 3. Free the layer pointer array.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="comment">     The starting address is &#39;array&#39; itself. */</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  ierr = PetscFree(array); CHKERRQ(ierr); <span class="comment">// Free the LAYER POINTERS</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0b5edc0d4872661a274fabbbf790019"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b5edc0d4872661a274fabbbf790019">&#9670;&nbsp;</a></span>Allocate3DArrayVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Allocate3DArrayVector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structCmpnts">Cmpnts</a> ****&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures using PetscCalloc. </p>
<p>Deallocates a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures allocated by Allocate3DArrayVector.</p>
<p>This function dynamically allocates memory for a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> (vector) structures with dimensions nz (layers) x ny (rows) x nx (columns). It uses PetscCalloc1 to ensure that all allocated memory is zero-initialized.</p>
<p>The allocation procedure is similar to Allocate3DArrayScalar:</p><ol type="1">
<li>Allocate an array of nz pointers (one for each layer).</li>
<li>Allocate a contiguous block for nz*ny row pointers.</li>
<li>Allocate one contiguous block for nz*ny*nx <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures.</li>
</ol>
<p>After allocation, the array can be accessed as array[k][j][i] and each element (a <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structure) will have its x, y, and z fields initialized to 0.0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">array</td><td>Pointer to the 3D array to be allocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>Number of layers in the z-direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of rows in the y-direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nx</td><td>Number of columns in the x-direction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, nonzero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01250">1250</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;{</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a>         ***data;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a>         *dataContiguous;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  PetscInt       k, j;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  PetscMPIInt    rank;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  PetscFunctionBegin;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  ierr = MPI_Comm_rank(PETSC_COMM_WORLD,&amp;rank);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">/* Step 1: Allocate memory for nz layer pointers (zeroed) */</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  ierr = PetscCalloc1(nz, &amp;data); CHKERRQ(ierr);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot; [Rank %d] memory allocated for outermost layer (%d k-layer pointers).\n&quot;</span>,rank,nz);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">/* Step 2: Allocate memory for all row pointers (nz * ny pointers) */</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  ierr = PetscCalloc1(nz * ny, &amp;data[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="keywordflow">for</span> (k = 1; k &lt; nz; k++) {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    data[k] = data[0] + k * ny;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d] memory allocated for %dx%d row pointers.\n&quot;</span>,rank,nz,ny);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <span class="comment">/* Step 3: Allocate one contiguous block for nz*ny*nx Cmpnts structures (zeroed) */</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  ierr = PetscCalloc1(nz * ny * nx, &amp;dataContiguous); CHKERRQ(ierr);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d] memory allocated for contigous block of %dx%dx%d Cmpnts structures).\n&quot;</span>,rank,nz,ny,nx); </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  <span class="comment">/* Build the 3D pointer structure for vector data */</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordflow">for</span> (k = 0; k &lt; nz; k++) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; ny; j++) {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      data[k][j] = dataContiguous + (k * ny + j) * nx;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="comment">/* The PetscCalloc1 call has already initialized each Cmpnts to zero. */</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d] 3D pointer structure for vector data created. \n&quot;</span>,rank);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  *array = data;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b52d74f346e62584fb4e91e11a850b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b52d74f346e62584fb4e91e11a850b9">&#9670;&nbsp;</a></span>Deallocate3DArrayVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Deallocate3DArrayVector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structCmpnts">Cmpnts</a> ***&#160;</td>
          <td class="paramname"><em>array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ny</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocates a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures allocated by Allocate3DArrayVector. </p>
<p>This function frees the memory allocated for a 3D array of <a class="el" href="variables_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> structures. It assumes the memory was allocated using Allocate3DArrayVector, which created three separate memory blocks: one for the contiguous vector data, one for the row pointers, and one for the layer pointers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">array</td><td>Pointer to the 3D array to be deallocated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>Number of layers in the z-direction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ny</td><td>Number of rows in the y-direction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, nonzero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01308">1308</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;{</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  PetscFunctionBegin;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="comment">// If array is NULL or hasn&#39;t been allocated properly, just return.</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="keywordflow">if</span> (!array || !array[0] || !array[0][0] ) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Deallocate3DArrayVector called with potentially unallocated or NULL array.\n&quot;</span>);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="comment">// Attempt to free what might exist, but be cautious</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordflow">if</span> (array) {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;          <span class="keywordflow">if</span> (array[0]) { <span class="comment">// Check if row pointers were allocated</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;             <span class="comment">// We don&#39;t have a direct pointer to the contiguous data block</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;             <span class="comment">// saved separately in this allocation scheme. The allocation relies</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;             <span class="comment">// on array[0][0] pointing to it. If array[0] was freed first,</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;             <span class="comment">// accessing array[0][0] is unsafe.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;             <span class="comment">// The allocation scheme where the contiguous data block is not</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;             <span class="comment">// stored separately makes safe deallocation tricky if freeing</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;             <span class="comment">// happens out of order or if parts are NULL.</span></div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;             <span class="comment">// A SAFER ALLOCATION/DEALLOCATION would store the data pointer separately.</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;             <span class="comment">// Given the current allocation scheme, the order MUST be:</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;             <span class="comment">// 1. Free the data block (pointed to by array[0][0])</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;             <span class="comment">// 2. Free the row pointer block (pointed to by array[0])</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;             <span class="comment">// 3. Free the layer pointer block (pointed to by array)</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160; </div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;             <span class="comment">// Let&#39;s assume the allocation was successful and pointers are valid.</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;             <span class="comment">// Get pointer to the contiguous data block *before* freeing row pointers</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;             <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> *dataContiguous = array[0][0];</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;             ierr = PetscFree(dataContiguous); CHKERRQ(ierr); <span class="comment">// Free data block</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;             <span class="comment">// Now free the row pointers block</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;             ierr = PetscFree(array[0]); CHKERRQ(ierr); <span class="comment">// Free row pointers</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          }</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          <span class="comment">// Finally, free the array of layer pointers</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          ierr = PetscFree(array); CHKERRQ(ierr);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;      }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;      PetscFunctionReturn(0); <span class="comment">// Return gracefully if input was NULL initially</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="comment">// --- Standard Deallocation (assuming valid allocation) ---</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">/* 1. Free the contiguous block of Cmpnts structures.</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="comment">     The starting address was stored in array[0][0] by Allocate3DArrayVector. */</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;  ierr = PetscFree(array[0][0]); CHKERRQ(ierr); <span class="comment">// Free the ACTUAL DATA</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">/* 2. Free the contiguous block of row pointers.</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="comment">     The starting address was stored in array[0]. */</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  ierr = PetscFree(array[0]); CHKERRQ(ierr); <span class="comment">// Free the ROW POINTERS</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="comment">/* 3. Free the layer pointer array.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="comment">     The starting address is &#39;array&#39; itself. */</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  ierr = PetscFree(array); CHKERRQ(ierr); <span class="comment">// Free the LAYER POINTERS</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  PetscFunctionReturn(0);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a135027905841ed83f1a3ef2279d865cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a135027905841ed83f1a3ef2279d865cc">&#9670;&nbsp;</a></span>GetOwnedCellRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode GetOwnedCellRange </td>
          <td>(</td>
          <td class="paramtype">const DMDALocalInfo *&#160;</td>
          <td class="paramname"><em>info_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>xs_cell_global_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>xm_cell_local_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the global starting index of cells owned by this rank and the number of such cells. </p>
<p>Determines the global starting index and number of CELLS owned by the current processor in a specified dimension.</p>
<p>A cell's global index is considered the same as its origin node's global index. This function assumes a node-centered DMDA where <code>info_nodes</code> provides all necessary information:</p><ul>
<li><code>info_nodes-&gt;xs, ys, zs</code>: Global starting index of the first node owned by this rank (excluding ghosts).</li>
<li><code>info_nodes-&gt;xm, ym, zm</code>: Number of nodes owned by this rank in each dimension (excluding ghosts).</li>
<li><code>info_nodes-&gt;mx, my, mz</code>: Total number of global nodes in each dimension for the entire domain.</li>
</ul>
<p>A cell <code>C_k</code> (0-indexed) is defined by its origin node <code>N_k</code> and extends to node <code>N_{k+1}</code>. Thus, the last node in the global domain cannot be an origin for a cell. The last possible cell origin node index is <code>GlobalNodesInDim - 2</code>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info_nodes</td><td>Pointer to the DMDALocalInfo struct for the current rank. This struct contains local ownership information (xs, xm, etc.) and global domain dimensions (mx, my, mz for nodes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim</td><td>The dimension for which to get the cell range (0 for i/x, 1 for j/y, 2 for k/z). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xs_cell_global_out</td><td>Pointer to store the global index of the first cell whose origin node is owned by this rank. If the rank owns no valid cell origins in this dimension, this will be the rank's starting node index, but <code>xm_cell_local_out</code> will be 0. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xm_cell_local_out</td><td>Pointer to store the number of cells for which this rank owns the origin node AND that origin node is a valid cell origin within the global domain.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or an error code on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Example: If GlobalNodesInDim = 11 (nodes N0 to N10), there are 10 cells (C0 to C9). The last cell, C9, has its origin at node N9. So, N9 (index 9) is the last valid cell origin (GlobalNodesInDim - 2 = 11 - 2 = 9). If a rank owns nodes N8, N9, N10 (xs=8, xm=3):<ul>
<li>First potential origin on rank = N8.</li>
<li>Last potential origin on rank (node that is not the last owned node) = N9.</li>
<li>Actual last origin this rank can form = min(N9, GlobalMaxOrigin=N9) = N9.</li>
<li>Number of cells = (N9 - N8 + 1) = 2 cells (C8, C9). If a rank owns only node N10 (xs=10, xm=1):</li>
<li>First potential origin on rank = N10.</li>
<li>Actual last origin rank can form = min(N9, GlobalMaxOrigin=N9) (since N10-1=N9).</li>
<li>first_potential_origin_on_rank (N10) &gt; actual_last_origin_this_rank_can_form (N9) =&gt; 0 cells. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01409">1409</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;{</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    PetscErrorCode ierr = 0; <span class="comment">// Standard PETSc error code, not explicitly set here but good practice.</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    PetscInt xs_node_global_rank;   <span class="comment">// Global index of the first node owned by this rank in the specified dimension.</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    PetscInt num_nodes_owned_rank;  <span class="comment">// Number of nodes owned by this rank in this dimension (local count, excluding ghosts).</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    PetscInt GlobalNodesInDim_from_info; <span class="comment">// Total number of global nodes in this dimension, from DMDALocalInfo.</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160; </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="comment">// --- 1. Input Validation ---</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <span class="keywordflow">if</span> (!info_nodes || !xs_cell_global_out || !xm_cell_local_out) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Null pointer passed to GetOwnedCellRange.&quot;</span>);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="comment">// --- 2. Extract Node Ownership and Global Dimension Information from DMDALocalInfo ---</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordflow">if</span> (dim == 0) { <span class="comment">// I-direction</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        xs_node_global_rank = info_nodes-&gt;xs;       <span class="comment">// Starting owned node index (global)</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        num_nodes_owned_rank  = info_nodes-&gt;xm;     <span class="comment">// Number of nodes owned by this rank (local count)</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        GlobalNodesInDim_from_info = info_nodes-&gt;mx; <span class="comment">// Total global nodes in this dimension</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 1) { <span class="comment">// J-direction</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        xs_node_global_rank = info_nodes-&gt;ys;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        num_nodes_owned_rank  = info_nodes-&gt;ym;</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        GlobalNodesInDim_from_info = info_nodes-&gt;my;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) { <span class="comment">// K-direction</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;        xs_node_global_rank = info_nodes-&gt;zs;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        num_nodes_owned_rank  = info_nodes-&gt;zm;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        GlobalNodesInDim_from_info = info_nodes-&gt;mz;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;      SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_OUTOFRANGE, <span class="stringliteral">&quot;Invalid dimension %d in GetOwnedCellRange. Must be 0, 1, or 2.&quot;</span>, dim);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    }</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="comment">// --- 3. Handle Edge Cases for Global Domain Size ---</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    <span class="comment">// If the global domain has 0 or 1 node plane, no cells can be formed.</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">if</span> (GlobalNodesInDim_from_info &lt;= 1) {</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        *xs_cell_global_out = xs_node_global_rank; <span class="comment">// Still report the rank&#39;s starting node</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        *xm_cell_local_out = 0;                    <span class="comment">// But 0 cells</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    }</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="comment">// Negative global dimension is an error (should be caught by DMDA setup, but defensive)</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    <span class="keywordflow">if</span> (GlobalNodesInDim_from_info &lt; 0 ) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;         SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_OUTOFRANGE, <span class="stringliteral">&quot;GlobalNodesInDim %d from DMDALocalInfo must be non-negative for dimension %d.&quot;</span>, GlobalNodesInDim_from_info, dim);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// --- 4. Determine Cell Ownership Based on Node Ownership ---</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="comment">// The first cell this rank *could* define has its origin at the first node this rank owns.</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    *xs_cell_global_out = xs_node_global_rank;</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160; </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">// If the rank owns no nodes in this dimension, it can&#39;t form any cell origins.</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keywordflow">if</span> (num_nodes_owned_rank == 0) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        *xm_cell_local_out = 0;</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="comment">// Calculate the global index of the last possible node that can serve as a cell origin.</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="comment">// If GlobalNodesInDim = N (nodes 0 to N-1), cells are C_0 to C_{N-2}.</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="comment">// The origin of cell C_{N-2} is node N_{N-2}.</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="comment">// So, the last valid cell origin node index is (GlobalNodesInDim - 2).</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        PetscInt last_possible_origin_global_idx = GlobalNodesInDim_from_info - 2;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="comment">// Determine the range of nodes owned by this rank that could *potentially* be cell origins.</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        <span class="comment">// The first node owned by the rank is a potential origin.</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        PetscInt first_potential_origin_on_rank = xs_node_global_rank;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        <span class="comment">// A node can be an origin if there&#39;s at least one node after it to form the cell.</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="comment">// So, the last node owned by the rank that could *potentially* be an origin is</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="comment">// the second-to-last node it owns: (xs_node_global_rank + num_nodes_owned_rank - 1) - 1</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="comment">// which simplifies to: xs_node_global_rank + num_nodes_owned_rank - 2.</span></div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        PetscInt last_potential_origin_on_rank = xs_node_global_rank + num_nodes_owned_rank - 2;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160; </div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="comment">// The actual last origin this rank can provide is capped by the global domain limit.</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        PetscInt actual_last_origin_this_rank_can_form = PetscMin(last_potential_origin_on_rank, last_possible_origin_global_idx);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160; </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <span class="comment">// If the first potential origin this rank owns is already beyond the actual last origin it can form,</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="comment">// then this rank forms no valid cell origins. This happens if:</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="comment">//  - num_nodes_owned_rank is 1 (so last_potential_origin_on_rank = first_potential_origin_on_rank - 1).</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="comment">//  - The rank only owns nodes at the very end of the global domain (e.g., only the last global node).</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordflow">if</span> (first_potential_origin_on_rank &gt; actual_last_origin_this_rank_can_form) {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            *xm_cell_local_out = 0;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            <span class="comment">// The number of cells is the count of valid origins this rank owns.</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="comment">// (Count = Last Index - First Index + 1)</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            *xm_cell_local_out = actual_last_origin_this_rank_can_form - first_potential_origin_on_rank + 1;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    PetscFunctionReturn(ierr);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_a135027905841ed83f1a3ef2279d865cc_icgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a25ce912d8aafa319a8c915cd350c7322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25ce912d8aafa319a8c915cd350c7322">&#9670;&nbsp;</a></span>GetGhostedCellRange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode GetGhostedCellRange </td>
          <td>(</td>
          <td class="paramtype">const DMDALocalInfo *&#160;</td>
          <td class="paramname"><em>info_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structRankNeighbors">RankNeighbors</a> *&#160;</td>
          <td class="paramname"><em>neighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>xs_cell_global_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>xm_cell_local_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the global cell range for a rank, including boundary cells. </p>
<p>This function first calls GetOwnedCellRange to get the conservative range of fully-contained cells. It then extends this range by applying the "Lower-Rank-Owns-Boundary" principle. A rank claims ownership of the boundary cells it shares with neighbors in the positive (+x, +y, +z) directions.</p>
<p>This results in a final cell range that is gap-free and suitable for building the definitive particle ownership map.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">info_nodes</td><td>Pointer to the DMDALocalInfo struct. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbors</td><td>Pointer to the <a class="el" href="variables_8h.html#structRankNeighbors" title="Stores the MPI ranks of neighboring subdomains.">RankNeighbors</a> struct containing neighbor info. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dim</td><td>The dimension (0 for i/x, 1 for j/y, 2 for k/z). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xs_cell_global_out</td><td>Pointer to store the final starting cell index. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">xm_cell_local_out</td><td>Pointer to store the final number of cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or an error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01522">1522</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;{</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160; </div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="comment">// --- 1. Get the base, conservative range from the original function ---</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    ierr = <a class="code" href="setup_8c.html#a135027905841ed83f1a3ef2279d865cc">GetOwnedCellRange</a>(info_nodes, dim, xs_cell_global_out, xm_cell_local_out); CHKERRQ(ierr);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// --- 2. Apply the &quot;Lower-Rank-Owns-Boundary&quot; correction ---</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="comment">// A rank owns the boundary if it has a neighbor in the positive direction.</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="comment">// We check if the neighbor&#39;s rank is valid (not MPI_PROC_NULL, which is &lt; 0).</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">if</span> (dim == 0 &amp;&amp; neighbors-&gt;<a class="code" href="variables_8h.html#a37acd97196e51bd7e58e2d2fafc3344a">rank_xp</a> &gt; -1) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        (*xm_cell_local_out)++;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 1 &amp;&amp; neighbors-&gt;<a class="code" href="variables_8h.html#a1efe628456af87df55800c7ffce30a24">rank_yp</a> &gt; -1) {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        (*xm_cell_local_out)++;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2 &amp;&amp; neighbors-&gt;<a class="code" href="variables_8h.html#ac5abbee1a0f657e18deac2dbaef2ad74">rank_zp</a> &gt; -1) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        (*xm_cell_local_out)++;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a25ce912d8aafa319a8c915cd350c7322_cgraph.svg" width="380" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_a25ce912d8aafa319a8c915cd350c7322_icgraph.svg" width="100%" height="375"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a4d7b90ec69412357cf8c38ea8f4e71f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d7b90ec69412357cf8c38ea8f4e71f6">&#9670;&nbsp;</a></span>ComputeAndStoreNeighborRanks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ComputeAndStoreNeighborRanks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes and stores the Cartesian neighbor ranks for the DMDA decomposition. </p>
<p>This function retrieves the neighbor information from the primary DMDA (user-&gt;da) and stores the face neighbors (xm, xp, ym, yp, zm, zp) in the user-&gt;neighbors structure. It assumes a standard PETSc ordering for the neighbors array returned by DMDAGetNeighbors. If DMDAGetNeighbors returns a negative rank that is not MPI_PROC_NULL (which can happen in some PETSc/MPI configurations for non-periodic boundaries if not fully standard), this function will sanitize it to MPI_PROC_NULL to prevent issues.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure where neighbor info will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01567">1567</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;{</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    PetscErrorCode    ierr;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    PetscMPIInt       rank;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    PetscMPIInt       size; <span class="comment">// MPI communicator size</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keyword">const</span> PetscMPIInt *neighbor_ranks_ptr; <span class="comment">// Pointer to raw neighbor data from PETSc</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD, &amp;size); CHKERRQ(ierr); <span class="comment">// Get MPI size for validation</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Rank %d: Computing DMDA neighbor ranks.\n&quot;</span>, rank);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">if</span> (!user || !user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>) {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;UserCtx or user-&gt;da is NULL in ComputeAndStoreNeighborRanks.&quot;</span>);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">// Get the neighbor information from the DMDA</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="comment">// neighbor_ranks_ptr will point to an internal PETSc array of 27 ranks.</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    ierr = DMDAGetNeighbors(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;neighbor_ranks_ptr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="comment">// Log the raw values from DMDAGetNeighbors for boundary-relevant directions for debugging</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Raw DMDAGetNeighbors: xm_raw=%d, xp_raw=%d, ym_raw=%d, yp_raw=%d, zm_raw=%d, zp_raw=%d. MPI_PROC_NULL is %d.\n&quot;</span>,</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                   rank,</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                   neighbor_ranks_ptr[12], neighbor_ranks_ptr[14],</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                   neighbor_ranks_ptr[10], neighbor_ranks_ptr[16],</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;                   neighbor_ranks_ptr[4],  neighbor_ranks_ptr[22],</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                   (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">// PETSc standard indices for 3D face neighbors from the 27-point stencil:</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">// Index = k_offset*9 + j_offset*3 + i_offset (where offsets -1,0,1 map to 0,1,2)</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    <span class="comment">// Center: (i_off=1, j_off=1, k_off=1) =&gt; 1*9 + 1*3 + 1 = 13</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    <span class="comment">// X-min:  (i_off=0, j_off=1, k_off=1) =&gt; 1*9 + 1*3 + 0 = 12</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <span class="comment">// X-plus: (i_off=2, j_off=1, k_off=1) =&gt; 1*9 + 1*3 + 2 = 14</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="comment">// Y-min:  (i_off=1, j_off=0, k_off=1) =&gt; 1*9 + 0*3 + 1 = 10</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">// Y-plus: (i_off=1, j_off=2, k_off=1) =&gt; 1*9 + 2*3 + 1 = 16</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="comment">// Z-min:  (i_off=1, j_off=1, k_off=0) =&gt; 0*9 + 1*3 + 1 = 4</span></div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">// Z-plus: (i_off=1, j_off=1, k_off=2) =&gt; 2*9 + 1*3 + 1 = 22</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160; </div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">if</span> (neighbor_ranks_ptr[13] != rank) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Rank %d: DMDAGetNeighbors center index (13) is %d, expected current rank %d. Neighbor indexing might be non-standard or DMDA small.\n&quot;</span>,</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                  rank, neighbor_ranks_ptr[13], rank);</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <span class="comment">// This warning is important. If the center isn&#39;t the current rank, the offsets are likely wrong.</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        <span class="comment">// However, PETSc should ensure this unless the DM is too small for a 3x3x3 stencil.</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// Assign and sanitize each neighbor rank</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    PetscMPIInt temp_neighbor;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    temp_neighbor = neighbor_ranks_ptr[12]; <span class="comment">// xm</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">if</span> (temp_neighbor &lt; 0  || temp_neighbor &gt;= size) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;[Rank %d] Correcting invalid xm neighbor %d to MPI_PROC_NULL (%d).\n&quot;</span>, rank, temp_neighbor, (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a9419886ec15f30fb98c71804d563796c">rank_xm</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a9419886ec15f30fb98c71804d563796c">rank_xm</a> = temp_neighbor;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160; </div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    temp_neighbor = neighbor_ranks_ptr[14]; <span class="comment">// xp</span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">if</span> (temp_neighbor &lt; 0 || temp_neighbor &gt;= size) {</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;[Rank %d] Correcting invalid xp neighbor %d to MPI_PROC_NULL (%d).\n&quot;</span>, rank, temp_neighbor, (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a37acd97196e51bd7e58e2d2fafc3344a">rank_xp</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a37acd97196e51bd7e58e2d2fafc3344a">rank_xp</a> = temp_neighbor;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160; </div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    temp_neighbor = neighbor_ranks_ptr[10]; <span class="comment">// ym</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">if</span> (temp_neighbor &lt; 0 || temp_neighbor &gt;= size) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;[Rank %d] Correcting invalid ym neighbor %d to MPI_PROC_NULL (%d).\n&quot;</span>, rank, temp_neighbor, (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a358dc1518de03e8f825de1397787f513">rank_ym</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a358dc1518de03e8f825de1397787f513">rank_ym</a> = temp_neighbor;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    temp_neighbor = neighbor_ranks_ptr[16]; <span class="comment">// yp</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    <span class="keywordflow">if</span> (temp_neighbor &lt; 0 || temp_neighbor &gt;= size) {</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        <span class="comment">// The log for index 16 was &quot;zm&quot; in your output, should be yp</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;[Rank %d] Correcting invalid yp neighbor (raw index 16) %d to MPI_PROC_NULL (%d).\n&quot;</span>, rank, temp_neighbor, (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a1efe628456af87df55800c7ffce30a24">rank_yp</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a1efe628456af87df55800c7ffce30a24">rank_yp</a> = temp_neighbor;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    }</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    temp_neighbor = neighbor_ranks_ptr[4]; <span class="comment">// zm</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">if</span> (temp_neighbor &lt; 0 || temp_neighbor &gt;= size) {</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;[Rank %d] Correcting invalid zm neighbor %d to MPI_PROC_NULL (%d).\n&quot;</span>, rank, temp_neighbor, (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a02bb9f73a617ff6f0e5d21da2bd045c6">rank_zm</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a02bb9f73a617ff6f0e5d21da2bd045c6">rank_zm</a> = temp_neighbor;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160; </div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    temp_neighbor = neighbor_ranks_ptr[22]; <span class="comment">// zp</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">if</span> (temp_neighbor &lt; 0 || temp_neighbor &gt;= size) {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;[Rank %d] Correcting invalid zp neighbor %d to MPI_PROC_NULL (%d).\n&quot;</span>, rank, temp_neighbor, (<span class="keywordtype">int</span>)MPI_PROC_NULL);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#ac5abbee1a0f657e18deac2dbaef2ad74">rank_zp</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#ac5abbee1a0f657e18deac2dbaef2ad74">rank_zp</a> = temp_neighbor;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d] Stored user-&gt;neighbors: xm=%d, xp=%d, ym=%d, yp=%d, zm=%d, zp=%d\n&quot;</span>, rank,</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;              user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a9419886ec15f30fb98c71804d563796c">rank_xm</a>, user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a37acd97196e51bd7e58e2d2fafc3344a">rank_xp</a>,</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;              user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a358dc1518de03e8f825de1397787f513">rank_ym</a>, user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a1efe628456af87df55800c7ffce30a24">rank_yp</a>,</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;              user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#a02bb9f73a617ff6f0e5d21da2bd045c6">rank_zm</a>, user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>.<a class="code" href="variables_8h.html#ac5abbee1a0f657e18deac2dbaef2ad74">rank_zp</a>);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    PetscSynchronizedFlush(PETSC_COMM_WORLD, PETSC_STDOUT); <span class="comment">// Ensure logs are flushed</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; </div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="comment">// Note: neighbor_ranks_ptr memory is managed by PETSc, do not free it.</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a4d7b90ec69412357cf8c38ea8f4e71f6_icgraph.svg" width="568" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aacf7da4f6b65d67f5d8eafa2e5fc7ead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacf7da4f6b65d67f5d8eafa2e5fc7ead">&#9670;&nbsp;</a></span>SetDMDAProcLayout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetDMDAProcLayout </td>
          <td>(</td>
          <td class="paramtype">DM&#160;</td>
          <td class="paramname"><em>dm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the processor layout for a given DMDA based on PETSc options. </p>
<p>Reads the desired number of processors in x, y, and z directions using PETSc options (e.g., -dm_processors_x, -dm_processors_y, -dm_processors_z). If an option is not provided for a direction, PETSC_DECIDE is used for that direction. Applies the layout using DMDASetNumProcs.</p>
<p>Also stores the retrieved/decided values in user-&gt;procs_x/y/z if user context is provided.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dm</td><td>The DMDA object to configure the layout for. </td></tr>
    <tr><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure (optional, used to store layout values).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01694">1694</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;{</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    PetscMPIInt    size, rank;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    PetscInt       px = PETSC_DECIDE, py = PETSC_DECIDE, pz = PETSC_DECIDE;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    PetscBool      px_set = PETSC_FALSE, py_set = PETSC_FALSE, pz_set = PETSC_FALSE;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a>         *simCtx = user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="comment">// Set no.of processors in direction 1</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#ac014127a43e8978a157a8a42c2f0538d">da_procs_x</a>) {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;      px_set = PETSC_TRUE;</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      px = simCtx-&gt;<a class="code" href="variables_8h.html#ac014127a43e8978a157a8a42c2f0538d">da_procs_x</a>;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="comment">// Set no.of processors in direction 2</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a44230884a9901af3992a1faf2eebdfb1">da_procs_y</a>) {</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      py_set = PETSC_TRUE;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      py = simCtx-&gt;<a class="code" href="variables_8h.html#a44230884a9901af3992a1faf2eebdfb1">da_procs_y</a>;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <span class="comment">// Set no.of processors in direction 1</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a281d10df99cab1a563bb65203f3bd823">da_procs_z</a>) {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      pz_set = PETSC_TRUE;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      pz = simCtx-&gt;<a class="code" href="variables_8h.html#a281d10df99cab1a563bb65203f3bd823">da_procs_z</a>;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    }</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160; </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    ierr = MPI_Comm_size(PetscObjectComm((PetscObject)dm), &amp;size); CHKERRQ(ierr);</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    ierr = MPI_Comm_rank(PetscObjectComm((PetscObject)dm), &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Rank %d: Configuring DMDA processor layout for %d total processes.\n&quot;</span>, rank, size);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// --- Validate User Input (Optional but Recommended) ---</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">// Check if specified processor counts multiply to the total MPI size</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> (px_set &amp;&amp; py_set &amp;&amp; pz_set) {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">if</span> (px * py * pz != size) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;             SETERRQ(PetscObjectComm((PetscObject)dm), PETSC_ERR_ARG_INCOMP,</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                     <span class="stringliteral">&quot;Specified processor layout %d x %d x %d = %d does not match MPI size %d&quot;</span>,</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                     px, py, pz, px * py * pz, size);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;         <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Using specified processor layout: %d x %d x %d\n&quot;</span>, px, py, pz);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (px_set || py_set || pz_set) {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;         <span class="comment">// If only some are set, PETSC_DECIDE will be used for others</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;         <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Using partially specified processor layout: %d x %d x %d (PETSC_DECIDE for unspecified)\n&quot;</span>, px, py, pz);</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Using fully automatic processor layout (PETSC_DECIDE x PETSC_DECIDE x PETSC_DECIDE)\n&quot;</span>);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    }</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;     <span class="comment">// Additional checks: Ensure px, py, pz are positive if set</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;     <span class="keywordflow">if</span> ((px_set &amp;&amp; px &lt;= 0) || (py_set &amp;&amp; py &lt;= 0) || (pz_set &amp;&amp; pz &lt;= 0)) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;         SETERRQ(PetscObjectComm((PetscObject)dm), PETSC_ERR_ARG_OUTOFRANGE, <span class="stringliteral">&quot;Specified processor counts must be positive.&quot;</span>);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;     }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160; </div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="comment">// --- Apply the layout to the DMDA ---</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    ierr = DMDASetNumProcs(dm, px, py, pz); CHKERRQ(ierr);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Rank %d: DMDASetNumProcs called with px=%d, py=%d, pz=%d.\n&quot;</span>, rank, px, py, pz);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="comment">// --- Store the values in UserCtx (Optional) ---</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="comment">// Note: If PETSC_DECIDE was used, PETSc calculates the actual values during DMSetUp.</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="comment">// We store the *requested* values here. To get the *actual* values used,</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="comment">// you would need to call DMDAGetInfo after DMSetUp.</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">    if (user) {</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">        user-&gt;procs_x = px;</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">        user-&gt;procs_y = py;</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">        user-&gt;procs_z = pz;</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c08bf327e1aee897c56610a89f75814"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c08bf327e1aee897c56610a89f75814">&#9670;&nbsp;</a></span>SetupDomainRankInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetupDomainRankInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets up the full rank communication infrastructure for all blocks. </p>
<p>Sets up the full rank communication infrastructure, including neighbor ranks and bounding box exchange.</p>
<p>This function orchestrates the setup of the parallel communication map. It uses the existing helper functions to sequentially gather and broadcast the bounding box information for each computational block. All ranks participate in each step, assembling the final, unified multi-block list in parallel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">simCtx</td><td>The master simulation context. After this call, simCtx-&gt;bboxlist and the relevant user-&gt;neighbors fields will be populated on all ranks. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01778">1778</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;{</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    PetscInt       nblk = simCtx-&gt;<a class="code" href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">block_number</a>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    PetscInt       size = simCtx-&gt;<a class="code" href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">size</a>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <a class="code" href="variables_8h.html#structBoundingBox">BoundingBox</a>    *final_bboxlist = NULL;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160; </div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Starting full rank communication setup for %d block(s).\n&quot;</span>, nblk);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a> *user_finest = simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>[simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <span class="comment">// --- Step 1: Compute neighbor ranks (unchanged) ---</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bi = 0; bi &lt; nblk; bi++) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        ierr = <a class="code" href="setup_8c.html#a4d7b90ec69412357cf8c38ea8f4e71f6">ComputeAndStoreNeighborRanks</a>(&amp;user_finest[bi]); CHKERRQ(ierr);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Neighbor ranks computed and stored for all blocks.\n&quot;</span>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <span class="comment">// --- Step 2: Allocate the final, unified list on ALL ranks ---</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="comment">// Every rank will build this list in parallel.</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    ierr = PetscMalloc1(size * nblk, &amp;final_bboxlist); CHKERRQ(ierr);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="comment">// --- Step 3: Loop through each block, gather then broadcast its bbox list ---</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bi = 0; bi &lt; nblk; bi++) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        <span class="comment">// This is a temporary pointer for the current block&#39;s list.</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <a class="code" href="variables_8h.html#structBoundingBox">BoundingBox</a> *block_bboxlist = NULL;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Processing bounding boxes for block %d...\n&quot;</span>, bi);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="comment">// A) GATHER: On rank 0, block_bboxlist is allocated and filled. On others, it&#39;s NULL.</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        ierr = <a class="code" href="grid_8h.html#afac52c252de784d5bcd7fe7a2e642982">GatherAllBoundingBoxes</a>(&amp;user_finest[bi], &amp;block_bboxlist); CHKERRQ(ierr);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  -&gt; Gather complete for block %d.\n&quot;</span>, bi);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="comment">// B) BROADCAST: On non-root ranks, block_bboxlist is allocated. Then, the data</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        <span class="comment">//    from rank 0 is broadcast to all ranks. After this call, ALL ranks have</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="comment">//    an identical, complete copy of the bounding boxes for the current block.</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        ierr = <a class="code" href="grid_8h.html#a325b9d5da4b9b2c79d278fb848215632">BroadcastAllBoundingBoxes</a>(&amp;user_finest[bi], &amp;block_bboxlist); CHKERRQ(ierr);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  -&gt; Broadcast complete for block %d.\n&quot;</span>, bi);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;        <span class="comment">// C) ASSEMBLE: Every rank now copies the data for this block into the</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        <span class="comment">//    correct segment of its final, unified list.</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; size; r++) {</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            <span class="comment">// The layout is [r0b0, r1b0, ..., r(size-1)b0, r0b1, r1b1, ...]</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            final_bboxlist[bi * size + r] = block_bboxlist[r];</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        }</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;  -&gt; Assembly into final list complete for block %d.\n&quot;</span>, bi);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; </div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="comment">// D) CLEANUP: Free the temporary list for this block on ALL ranks before the next iteration.</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="comment">//    Your helper functions use malloc, so we must use free.</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;        free(block_bboxlist);</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">// --- Step 4: Assign the final pointer and run the last setup step ---</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">bboxlist</a> = final_bboxlist;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Final unified bboxlist created on all ranks and stored in SimCtx.\n&quot;</span>);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    ierr = <a class="code" href="setup_8c.html#aeb77337317f41972d1c75c8d80527892">SetupDomainCellDecompositionMap</a>(&amp;user_finest[0]); CHKERRQ(ierr);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Domain Cell Composition set and broadcasted.\n&quot;</span>);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;SetupDomainRankInfo: Completed successfully.\n&quot;</span>);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_a1c08bf327e1aee897c56610a89f75814_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_a1c08bf327e1aee897c56610a89f75814_icgraph.svg" width="282" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a515c9a96eb4bcac29f79e78c8882d7aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a515c9a96eb4bcac29f79e78c8882d7aa">&#9670;&nbsp;</a></span>Contra2Cart()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode Contra2Cart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reconstructs Cartesian velocity (Ucat) at cell centers from contravariant velocity (Ucont) defined on cell faces. </p>
<p>This function performs the transformation from a contravariant velocity representation (which is natural on a curvilinear grid) to a Cartesian (x,y,z) representation. For each interior computational cell owned by the rank, it performs the following:</p>
<ol type="1">
<li>It averages the contravariant velocity components (U¹, U², U³) from the surrounding faces to get an estimate of the contravariant velocity at the cell center.</li>
<li>It averages the metric vectors (Csi, Eta, Zet) from the surrounding faces to get an estimate of the metric tensor at the cell center. This tensor forms the transformation matrix.</li>
<li>It solves the linear system <code>[MetricTensor] * [ucat] = [ucont]</code> for the Cartesian velocity vector <code>ucat = (u,v,w)</code> using Cramer's rule.</li>
<li>The computed Cartesian velocity is stored in the global <code>user-&gt;Ucat</code> vector.</li>
</ol>
<p>The function operates on local, ghosted versions of the input vectors (<code>user-&gt;lUcont</code>, <code>user-&gt;lCsi</code>, etc.) to ensure stencils are valid across processor boundaries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure. The function reads from <code>user-&gt;lUcont</code>, <code>user-&gt;lCsi</code>, <code>user-&gt;lEta</code>, <code>user-&gt;lZet</code>, <code>user-&gt;lNvert</code> and writes to the global <code>user-&gt;Ucat</code> vector.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>This function should be called AFTER <code>user-&gt;lUcont</code> and all local metric vectors (<code>user-&gt;lCsi</code>, etc.) have been populated with up-to-date ghost values via <code>UpdateLocalGhosts</code>.</li>
<li>It only computes <code>Ucat</code> for interior cells (not on physical boundaries) and for cells not marked as solid/blanked by <code>user-&gt;lNvert</code>.</li>
<li>The caller is responsible for subsequently applying boundary conditions to <code>user-&gt;Ucat</code> and calling <code>UpdateLocalGhosts(user, "Ucat")</code> to populate <code>user-&gt;lUcat</code>. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l01881">1881</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;{</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    DMDALocalInfo  info;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a>       ***lcsi_arr, ***leta_arr, ***lzet_arr; <span class="comment">// Local metric arrays</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a>       ***lucont_arr;                       <span class="comment">// Local contravariant velocity array</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a>       ***gucat_arr;                        <span class="comment">// Global Cartesian velocity array</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    PetscReal    ***lnvert_arr;                       <span class="comment">// Local Nvert array</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    PetscReal    ***laj_arr;                          <span class="comment">// Local Jacobian Determinant inverse array</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Starting Contravariant-to-Cartesian velocity transformation.\n&quot;</span>);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    <span class="comment">// --- 1. Get DMDA Info and Check for Valid Inputs ---</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="comment">// All inputs (lUcont, lCsi, etc.) and outputs (Ucat) are on DMs from the UserCtx.</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    <span class="comment">// We get local info from fda, which governs the layout of most arrays here.</span></div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    ierr = DMDAGetLocalInfo(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, &amp;info); CHKERRQ(ierr);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordflow">if</span> (!user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a> || !user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a> || !user-&gt;<a class="code" href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a> || !user-&gt;<a class="code" href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a> || !user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a> || !user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>) {</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;Contra2Cart requires lUcont, lCsi/Eta/Zet, lNvert, and Ucat to be non-NULL.&quot;</span>);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    }</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="comment">// --- 2. Get Read-Only Array Access to Local Input Vectors (with ghosts) ---</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;lucont_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>,   &amp;lcsi_arr);   CHKERRQ(ierr);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>,   &amp;leta_arr);   CHKERRQ(ierr);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>,   &amp;lzet_arr);   CHKERRQ(ierr);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;laj_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="comment">// --- 3. Get Write-Only Array Access to the Global Output Vector ---</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">// We compute for local owned cells and write into the global vector.</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// PETSc handles mapping the global indices to the correct local memory locations.</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    ierr = DMDAVecGetArray(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;gucat_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="comment">// --- 4. Define Loop Bounds for INTERIOR Cells ---</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="comment">// We use adjusted bounds to avoid calculating Ucat on the physical domain boundaries,</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="comment">// as these are typically set explicitly by boundary condition functions.</span></div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="comment">// The stencils use indices like i-1, j-1, k-1, so we must start loops at least at index 1.</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    PetscInt i_start = (info.xs == 0) ? info.xs + 1 : info.xs;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    PetscInt i_end   = (info.xs + info.xm == info.mx) ? info.xs + info.xm - 1 : info.xs + info.xm;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    PetscInt j_start = (info.ys == 0) ? info.ys + 1 : info.ys;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    PetscInt j_end   = (info.ys + info.ym == info.my) ? info.ys + info.ym - 1 : info.ys + info.ym;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; </div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    PetscInt k_start = (info.zs == 0) ? info.zs + 1 : info.zs;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    PetscInt k_end   = (info.zs + info.zm == info.mz) ? info.zs + info.zm - 1 : info.zs + info.zm;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="comment">// --- 5. Main Computation Loop ---</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="comment">// Loops over the GLOBAL indices of interior cells owned by this rank.</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">for</span> (PetscInt k_cell = k_start; k_cell &lt; k_end; ++k_cell) {</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keywordflow">for</span> (PetscInt j_cell = j_start; j_cell &lt; j_end; ++j_cell) {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            <span class="keywordflow">for</span> (PetscInt i_cell = i_start; i_cell &lt; i_end; ++i_cell) {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                <span class="comment">// Check if the cell is a fluid cell (not solid/blanked)</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;          <span class="comment">//    if (lnvert_arr[k_cell][j_cell][i_cell] &gt; 0.1) continue; // Skip solid/blanked cells</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                <span class="comment">// Transformation matrix [mat] is the metric tensor at the cell center,</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                <span class="comment">// estimated by averaging metrics from adjacent faces.</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                PetscReal mat[3][3];</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <span class="comment">//  PetscReal aj_center = laj_arr[k_cell+1][j_cell+1][i_cell+1];</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                mat[0][0] = 0.5 * (lcsi_arr[k_cell][j_cell][i_cell-1].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + lcsi_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;                mat[0][1] = 0.5 * (lcsi_arr[k_cell][j_cell][i_cell-1].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + lcsi_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                mat[0][2] = 0.5 * (lcsi_arr[k_cell][j_cell][i_cell-1].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + lcsi_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;                mat[1][0] = 0.5 * (leta_arr[k_cell][j_cell-1][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + leta_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;                mat[1][1] = 0.5 * (leta_arr[k_cell][j_cell-1][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + leta_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;                mat[1][2] = 0.5 * (leta_arr[k_cell][j_cell-1][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + leta_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160; </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                mat[2][0] = 0.5 * (lzet_arr[k_cell-1][j_cell][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + lzet_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                mat[2][1] = 0.5 * (lzet_arr[k_cell-1][j_cell][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + lzet_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                mat[2][2] = 0.5 * (lzet_arr[k_cell-1][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + lzet_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); <span class="comment">//* aj_center;</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    </div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                <span class="comment">// Contravariant velocity vector `q` at the cell center,</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                <span class="comment">// estimated by averaging face-based contravariant velocities.</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                PetscReal q[3];</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                q[0] = 0.5 * (lucont_arr[k_cell][j_cell][i_cell-1].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> + lucont_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); <span class="comment">// U¹ at cell center</span></div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                q[1] = 0.5 * (lucont_arr[k_cell][j_cell-1][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> + lucont_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); <span class="comment">// U² at cell center</span></div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                q[2] = 0.5 * (lucont_arr[k_cell-1][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> + lucont_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); <span class="comment">// U³ at cell center</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;                <span class="comment">// Solve the 3x3 system `mat * ucat = q` using Cramer&#39;s rule.</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;                PetscReal det = mat[0][0] * (mat[1][1] * mat[2][2] - mat[1][2] * mat[2][1]) -</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;                                mat[0][1] * (mat[1][0] * mat[2][2] - mat[1][2] * mat[2][0]) +</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                                mat[0][2] * (mat[1][0] * mat[2][1] - mat[1][1] * mat[2][0]);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;          <span class="keywordflow">if</span> (PetscAbsReal(det) &lt; 1.0e-18) {</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;              SETERRQ(PETSC_COMM_SELF, PETSC_ERR_FLOP_COUNT, <span class="stringliteral">&quot;Transformation matrix determinant is near zero at cell (%d,%d,%d) \n&quot;</span>, i_cell, j_cell, k_cell);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;                        }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                PetscReal det_inv = 1.0 / det;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160; </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;                PetscReal det0 = q[0] * (mat[1][1] * mat[2][2] - mat[1][2] * mat[2][1]) -</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                                 q[1] * (mat[0][1] * mat[2][2] - mat[0][2] * mat[2][1]) +</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                                 q[2] * (mat[0][1] * mat[1][2] - mat[0][2] * mat[1][1]);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                PetscReal det1 = -q[0] * (mat[1][0] * mat[2][2] - mat[1][2] * mat[2][0]) +</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                                  q[1] * (mat[0][0] * mat[2][2] - mat[0][2] * mat[2][0]) -</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                                  q[2] * (mat[0][0] * mat[1][2] - mat[0][2] * mat[1][0]);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                PetscReal det2 = q[0] * (mat[1][0] * mat[2][1] - mat[1][1] * mat[2][0]) -</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                                 q[1] * (mat[0][0] * mat[2][1] - mat[0][1] * mat[2][0]) +</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                                 q[2] * (mat[0][0] * mat[1][1] - mat[0][1] * mat[1][0]);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                <span class="comment">// Store computed Cartesian velocity in the GLOBAL Ucat array at the</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                <span class="comment">// array index corresponding to the cell&#39;s origin node.</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                gucat_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = det0 * det_inv;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                gucat_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = det1 * det_inv;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                gucat_arr[k_cell][j_cell][i_cell].<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = det2 * det_inv;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        }</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="comment">// --- 6. Restore Array Access ---</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;lucont_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>,   &amp;lcsi_arr);   CHKERRQ(ierr);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>,   &amp;leta_arr);   CHKERRQ(ierr);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>,   &amp;lzet_arr);   CHKERRQ(ierr);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;lnvert_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>,  user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;laj_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    ierr = DMDAVecRestoreArray(user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code" href="variables_8h.html#aa1823d873982755996b7335f43732af4">Ucat</a>, &amp;gucat_arr); CHKERRQ(ierr);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Completed Contravariant-to-Cartesian velocity transformation. \n&quot;</span>);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_a515c9a96eb4bcac29f79e78c8882d7aa_icgraph.svg" width="100%" height="482"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aeb77337317f41972d1c75c8d80527892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb77337317f41972d1c75c8d80527892">&#9670;&nbsp;</a></span>SetupDomainCellDecompositionMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetupDomainCellDecompositionMap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and distributes a map of the domain's cell decomposition to all ranks. </p>
<p>This function is a critical part of the simulation setup. It determines the global cell ownership for each MPI rank and makes this information available to all other ranks. This "decomposition map" is essential for the robust "Walk and Handoff" particle migration strategy, allowing any rank to quickly identify the owner of a target cell.</p>
<p>The process involves:</p><ol type="1">
<li>Each rank gets its own node ownership information from the DMDA.</li>
<li>It converts this node information into cell ownership ranges using the <code>GetOwnedCellRange</code> helper function.</li>
<li>It participates in an <code>MPI_Allgather</code> collective operation to build a complete array (<code>user-&gt;RankCellInfoMap</code>) containing the ownership information for every rank.</li>
</ol>
<p>This function should be called once during initialization after the primary DMDA (user-&gt;da) has been set up.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure. The function will allocate and populate <code>user-&gt;RankCellInfoMap</code> and set <code>user-&gt;num_ranks</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a non-zero PETSc error code on failure. Errors can occur if input pointers are NULL or if MPI communication fails. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02039">2039</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;{</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    DMDALocalInfo  local_node_info;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <a class="code" href="variables_8h.html#structRankCellInfo">RankCellInfo</a>   my_cell_info;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    PetscMPIInt    rank, size;</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="comment">// --- 1. Input Validation and MPI Info ---</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordflow">if</span> (!user) {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;UserCtx pointer is NULL in SetupDomainCellDecompositionMap.&quot;</span>);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span> (!user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>) {</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;user-&gt;da is not initialized in SetupDomainCellDecompositionMap.&quot;</span>);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    }</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; </div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD, &amp;size); CHKERRQ(ierr);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; </div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Setting up domain cell decomposition map for %d ranks.\n&quot;</span>, size);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// --- 2. Determine Local Cell Ownership ---</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <span class="comment">// Get the local node ownership information from the primary DMDA.</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    ierr = DMDAGetLocalInfo(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;local_node_info); CHKERRQ(ierr);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="comment">// Use the robust helper function to convert node ownership to cell ownership.</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="comment">// A cell&#39;s index is defined by its origin node.</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    ierr = <a class="code" href="setup_8c.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a>(&amp;local_node_info, &amp;user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>, 0, &amp;my_cell_info.<a class="code" href="variables_8h.html#a19272b97c7c160d257dbe0fc8da2f2d8">xs_cell</a>, &amp;my_cell_info.<a class="code" href="variables_8h.html#a7b338865846c21925fbb6b968cdf385f">xm_cell</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    ierr = <a class="code" href="setup_8c.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a>(&amp;local_node_info, &amp;user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>, 1, &amp;my_cell_info.<a class="code" href="variables_8h.html#a118b3648071bd642f8d066878ba920a7">ys_cell</a>, &amp;my_cell_info.<a class="code" href="variables_8h.html#a823852c48e9bdaa32c354ae7b41f29d7">ym_cell</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    ierr = <a class="code" href="setup_8c.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a>(&amp;local_node_info, &amp;user-&gt;<a class="code" href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>, 2, &amp;my_cell_info.<a class="code" href="variables_8h.html#a4d6a4d14075dd0718f49111d91c61e1d">zs_cell</a>, &amp;my_cell_info.<a class="code" href="variables_8h.html#a4b91bc588672c42d8917bf335d1a754e">zm_cell</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">    ierr = GetOwnedCellRange(&amp;local_node_info, 0, &amp;my_cell_info.xs_cell, &amp;my_cell_info.xm_cell); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">    ierr = GetOwnedCellRange(&amp;local_node_info, 1, &amp;my_cell_info.ys_cell, &amp;my_cell_info.ym_cell); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">    ierr = GetOwnedCellRange(&amp;local_node_info, 2, &amp;my_cell_info.zs_cell, &amp;my_cell_info.zm_cell); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="comment">// Log the calculated local ownership for debugging purposes.</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d] Owns cells: i[%d, %d), j[%d, %d), k[%d, %d)\n&quot;</span>,</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;              rank, my_cell_info.<a class="code" href="variables_8h.html#a19272b97c7c160d257dbe0fc8da2f2d8">xs_cell</a>, my_cell_info.<a class="code" href="variables_8h.html#a19272b97c7c160d257dbe0fc8da2f2d8">xs_cell</a> + my_cell_info.<a class="code" href="variables_8h.html#a7b338865846c21925fbb6b968cdf385f">xm_cell</a>,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;              my_cell_info.<a class="code" href="variables_8h.html#a118b3648071bd642f8d066878ba920a7">ys_cell</a>, my_cell_info.<a class="code" href="variables_8h.html#a118b3648071bd642f8d066878ba920a7">ys_cell</a> + my_cell_info.<a class="code" href="variables_8h.html#a823852c48e9bdaa32c354ae7b41f29d7">ym_cell</a>,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;              my_cell_info.<a class="code" href="variables_8h.html#a4d6a4d14075dd0718f49111d91c61e1d">zs_cell</a>, my_cell_info.<a class="code" href="variables_8h.html#a4d6a4d14075dd0718f49111d91c61e1d">zs_cell</a> + my_cell_info.<a class="code" href="variables_8h.html#a4b91bc588672c42d8917bf335d1a754e">zm_cell</a>);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160; </div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="comment">// --- 3. Allocate and Distribute the Global Map ---</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="comment">// Allocate memory for the global map that will hold information from all ranks.</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    ierr = PetscMalloc1(size, &amp;user-&gt;<a class="code" href="variables_8h.html#a7dead9b6c11ee4a34d5bb1ae46b140c9">RankCellInfoMap</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="comment">// Perform the collective communication to gather the `RankCellInfo` struct from every rank.</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    <span class="comment">// Each rank sends its `my_cell_info` and receives the complete array in `user-&gt;RankCellInfoMap`.</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="comment">// We use MPI_BYTE to ensure portability across different systems and struct padding.</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    ierr = MPI_Allgather(&amp;my_cell_info, <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structRankCellInfo">RankCellInfo</a>), MPI_BYTE,</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                         user-&gt;<a class="code" href="variables_8h.html#a7dead9b6c11ee4a34d5bb1ae46b140c9">RankCellInfoMap</a>, <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structRankCellInfo">RankCellInfo</a>), MPI_BYTE,</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                         PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160; </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Domain cell decomposition map created and distributed successfully.\n&quot;</span>);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160; </div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_aeb77337317f41972d1c75c8d80527892_cgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_aeb77337317f41972d1c75c8d80527892_icgraph.svg" width="591" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acd8d87dc85f19ba3e32811a623bf5b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd8d87dc85f19ba3e32811a623bf5b36">&#9670;&nbsp;</a></span>BinarySearchInt64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode BinarySearchInt64 </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt64&#160;</td>
          <td class="paramname"><em>arr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt64&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscBool *&#160;</td>
          <td class="paramname"><em>found</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a binary search for a key in a sorted array of PetscInt64. </p>
<p>This is a standard binary search algorithm implemented as a PETSc-style helper function. It efficiently determines if a given <code>key</code> exists within a <code>sorted</code> array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The number of elements in the array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arr</td><td>A pointer to the sorted array of PetscInt64 values to be searched. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>The PetscInt64 value to search for. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">found</td><td>A pointer to a PetscBool that will be set to PETSC_TRUE if the key is found, and PETSC_FALSE otherwise.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, or a non-zero PETSc error code on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The input array <code>arr</code> <b>must</b> be sorted in ascending order for the algorithm to work correctly. </dd></dl>

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02120">2120</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;{</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    PetscInt low = 0, high = n - 1;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="comment">// --- 1. Input Validation ---</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    <span class="keywordflow">if</span> (!found) {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Output pointer &#39;found&#39; is NULL in PetscBinarySearchInt64.&quot;</span>);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    }</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordflow">if</span> (n &gt; 0 &amp;&amp; !arr) {</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Input array &#39;arr&#39; is NULL for n &gt; 0.&quot;</span>);</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    }</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="comment">// Initialize output</span></div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    *found = PETSC_FALSE;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160; </div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="comment">// --- 2. Binary Search Algorithm ---</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordflow">while</span> (low &lt;= high) {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        <span class="comment">// Use this form to prevent potential integer overflow on very large arrays</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        PetscInt mid = low + (high - low) / 2;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        <span class="keywordflow">if</span> (arr[mid] == key) {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            *found = PETSC_TRUE; <span class="comment">// Key found!</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            <span class="keywordflow">break</span>;               <span class="comment">// Exit the loop</span></div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;        </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        <span class="keywordflow">if</span> (arr[mid] &lt; key) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            low = mid + 1; <span class="comment">// Search in the right half</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            high = mid - 1; <span class="comment">// Search in the left half</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_acd8d87dc85f19ba3e32811a623bf5b36_icgraph.svg" width="100%" height="414"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a3d538200fed5b9ee9d1ef391bb61036c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d538200fed5b9ee9d1ef391bb61036c">&#9670;&nbsp;</a></span>Gidx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static PetscInt Gidx </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02160">2160</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;{</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;  PetscInt nidx;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  DMDALocalInfo info = user-&gt;<a class="code" href="variables_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>;</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  PetscInt  mx = info.mx, my = info.my;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  AO ao;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;  DMDAGetAO(user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;ao);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  nidx=i+j*mx+k*mx*my;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  AOApplicationToPetsc(ao,1,&amp;nidx);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  <span class="keywordflow">return</span> (nidx);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="setup_8c_a3d538200fed5b9ee9d1ef391bb61036c_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="abab14dc7f20644674b043609950eefe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abab14dc7f20644674b043609950eefe2">&#9670;&nbsp;</a></span>ComputeDivergence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ComputeDivergence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="setup_8c_source.html#l02179">2179</a> of file <a class="el" href="setup_8c_source.html">setup.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;{</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  DM        da = user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, fda = user-&gt;<a class="code" href="variables_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;  DMDALocalInfo info = user-&gt;<a class="code" href="variables_8h.html#acd99423029a666652ee1f5bf573619bc">info</a>;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  PetscInt ti = user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">step</a>;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  </div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  PetscInt  xs = info.xs, xe = info.xs + info.xm;</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  PetscInt      ys = info.ys, ye = info.ys + info.ym;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  PetscInt  zs = info.zs, ze = info.zs + info.zm;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  PetscInt  mx = info.mx, my = info.my, mz = info.mz;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160; </div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  PetscInt  lxs, lys, lzs, lxe, lye, lze;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  PetscInt  i, j, k;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  Vec       Div;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  PetscReal ***div, ***aj, ***nvert,***p;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a>    ***ucont;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  PetscReal maxdiv;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160; </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;  lxs = xs; lxe = xe;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  lys = ys; lye = ye;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  lzs = zs; lze = ze;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160; </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <span class="keywordflow">if</span> (xs==0) lxs = xs+1;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <span class="keywordflow">if</span> (ys==0) lys = ys+1;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="keywordflow">if</span> (zs==0) lzs = zs+1;</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160; </div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;  <span class="keywordflow">if</span> (xe==mx) lxe = xe-1;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">if</span> (ye==my) lye = ye-1;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  <span class="keywordflow">if</span> (ze==mz) lze = ze-1;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  PetscFunctionBeginUser;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;  <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160; </div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;  DMDAVecGetArray(fda,user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;ucont);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;aj);</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  VecDuplicate(user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;Div);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;  DMDAVecGetArray(da, Div, &amp;div);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  DMDAVecGetArray(da, user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;   DMDAVecGetArray(da, user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;  <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;         <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++){</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <span class="keywordflow">if</span> (k==10 &amp;&amp; j==10 &amp;&amp; i==1){</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;          <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Pressure[10][10][1] =  %f | Pressure[10][10][0] =  %f  \n &quot;</span>,p[k][j][i],p[k][j][i-1]);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;              }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keywordflow">if</span> (k==10 &amp;&amp; j==10 &amp;&amp; i==mx-3)</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;              <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Pressure[10][10][%d] =  %f | Pressure[10][10][%d] =  %f  \n &quot;</span>,mx-2,p[k][j][mx-2],mx-1,p[k][j][mx-1]);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        }</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;    }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;   DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">P</a>, &amp;p);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160; </div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  <span class="keywordflow">for</span> (k=lzs; k&lt;lze; k++) {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <span class="keywordflow">for</span> (j=lys; j&lt;lye; j++) {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="keywordflow">for</span> (i=lxs; i&lt;lxe; i++) {</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    maxdiv = fabs((ucont[k][j][i].x - ucont[k][j][i-1].x +</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;               ucont[k][j][i].y - ucont[k][j-1][i].y +</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;               ucont[k][j][i].z - ucont[k-1][j][i].z)*aj[k][j][i]);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    <span class="keywordflow">if</span> (nvert[k][j][i] + nvert[k+1][j][i] + nvert[k-1][j][i] +</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        nvert[k][j+1][i] + nvert[k][j-1][i] +</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        nvert[k][j][i+1] + nvert[k][j][i-1] &gt; 0.1) maxdiv = 0.;</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    div[k][j][i] = maxdiv;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;      }</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  }</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordflow">if</span> (zs==0) {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    k=0;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;      }</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  }</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160; </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordflow">if</span> (ze == mz) {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;    k=mz-1;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;    }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;  }</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <span class="keywordflow">if</span> (xs==0) {</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    i=0;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;      }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;  <span class="keywordflow">if</span> (xe==mx) {</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    i=mx-1;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;      <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    div[k][j][i] = 0;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;      }</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    }</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;  }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="keywordflow">if</span> (ys==0) {</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    j=0;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;      }</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;    }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="keywordflow">if</span> (ye==my) {</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    j=my-1;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;    div[k][j][i] = 0.;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;      }</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    }</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  }</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  DMDAVecRestoreArray(da, Div, &amp;div);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  PetscInt MaxFlatIndex;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  VecMax(Div, &amp;MaxFlatIndex, &amp;maxdiv);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;[Step %d]] The Maximum Divergence is %e at flat index %d.\n&quot;</span>,ti,maxdiv,MaxFlatIndex); </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a9285c06d5e6bee00c9061c27b2b73cb8">MaxDivFlatArg</a> = MaxFlatIndex;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;  user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a768740aa4a2ae69549670ebbfea58fc0">MaxDiv</a> = maxdiv;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <span class="keywordflow">for</span> (k=zs; k&lt;ze; k++) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keywordflow">for</span> (j=ys; j&lt;ye; j++) {</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;      <span class="keywordflow">for</span> (i=xs; i&lt;xe; i++) {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="setup_8c.html#a3d538200fed5b9ee9d1ef391bb61036c">Gidx</a>(i,j,k,user) == MaxFlatIndex) {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;[Step %d] The Maximum Divergence(%e) is at location [%d][%d][%d]. \n&quot;</span>, ti, maxdiv,k,j,i);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a8b2e7f4d2e2e95e4c49aa02684e2e51d">MaxDivz</a> = k;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;      user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a8811a9a632140d00bca04337f2261d23">MaxDivy</a> = j;</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;      user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a83e58d8ef2d285dc135be286ddc67f01">MaxDivx</a> = i;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    }</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;      }</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    }</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; </div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">lNvert</a>, &amp;nvert);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160; DMDAVecRestoreArray(fda, user-&gt;<a class="code" href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">lUcont</a>, &amp;ucont);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; DMDAVecRestoreArray(da, user-&gt;<a class="code" href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">lAj</a>, &amp;aj);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160; VecDestroy(&amp;Div);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160; <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160; PetscFunctionReturn(0);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_abab14dc7f20644674b043609950eefe2_cgraph.svg" width="266" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="setup_8c_abab14dc7f20644674b043609950eefe2_icgraph.svg" width="614" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="avariables_8h_html_structUserMG"><div class="ttname"><a href="variables_8h.html#structUserMG">UserMG</a></div><div class="ttdoc">User-level context for managing the entire multigrid hierarchy.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00433">variables.h:433</a></div></div>
<div class="ttc" id="avariables_8h_html_a118b3648071bd642f8d066878ba920a7"><div class="ttname"><a href="variables_8h.html#a118b3648071bd642f8d066878ba920a7">RankCellInfo::ys_cell</a></div><div class="ttdeci">PetscInt ys_cell</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00184">variables.h:184</a></div></div>
<div class="ttc" id="avariables_8h_html_aee8a3f32f3bdc0dda2f862651708c0f4"><div class="ttname"><a href="variables_8h.html#aee8a3f32f3bdc0dda2f862651708c0f4">UserCtx::lKAj</a></div><div class="ttdeci">Vec lKAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="avariables_8h_html_a8c248c162038dffe12e38228bcd06644"><div class="ttname"><a href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">SimCtx::bboxlist</a></div><div class="ttdeci">BoundingBox * bboxlist</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00615">variables.h:615</a></div></div>
<div class="ttc" id="avariables_8h_html_ada2db2a63cf3a9fe7ad2abf01cedc818"><div class="ttname"><a href="variables_8h.html#ada2db2a63cf3a9fe7ad2abf01cedc818">UserCtx::Nvert</a></div><div class="ttdeci">Vec Nvert</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_a8f4b905ecaadd9a0fe0b36faa1e3aa53"><div class="ttname"><a href="variables_8h.html#a8f4b905ecaadd9a0fe0b36faa1e3aa53">UserCtx::Eta</a></div><div class="ttdeci">Vec Eta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_ad032e456f7f4b32b9ac0d94be05de204"><div class="ttname"><a href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">Cmpnts::y</a></div><div class="ttdeci">PetscScalar y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables_8h_html_ab6ee189c80a939393b9cfd780774966e"><div class="ttname"><a href="variables_8h.html#ab6ee189c80a939393b9cfd780774966e">SimCtx::Fluxsum</a></div><div class="ttdeci">PetscReal Fluxsum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00598">variables.h:598</a></div></div>
<div class="ttc" id="avariables_8h_html_a69c3a361d1aac3bdc14f971bda57e032"><div class="ttname"><a href="variables_8h.html#a69c3a361d1aac3bdc14f971bda57e032">UserCtx::Ucont</a></div><div class="ttdeci">Vec Ucont</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_a83e58d8ef2d285dc135be286ddc67f01"><div class="ttname"><a href="variables_8h.html#a83e58d8ef2d285dc135be286ddc67f01">SimCtx::MaxDivx</a></div><div class="ttdeci">PetscInt MaxDivx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="avariables_8h_html_aff67a9b22db3995c8a1acf0ccbcb3eb7"><div class="ttname"><a href="variables_8h.html#aff67a9b22db3995c8a1acf0ccbcb3eb7">SimCtx::wing</a></div><div class="ttdeci">PetscInt wing</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a8c2555d0e12b81177396765b584f1a14"><div class="ttname"><a href="variables_8h.html#a8c2555d0e12b81177396765b584f1a14">SimCtx::j_homo_filter</a></div><div class="ttdeci">PetscInt j_homo_filter</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00608">variables.h:608</a></div></div>
<div class="ttc" id="avariables_8h_html_aac8e0dd714804b073dbb32c0ad84b2eb"><div class="ttname"><a href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">UserMG::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00434">variables.h:434</a></div></div>
<div class="ttc" id="avariables_8h_html_a2276cb159119246bfadea1c234dee31b"><div class="ttname"><a href="variables_8h.html#a2276cb159119246bfadea1c234dee31b">UserCtx::lIEta</a></div><div class="ttdeci">Vec lIEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_ae0a7a10f0bc2adac4b621178b64aa6f6"><div class="ttname"><a href="variables_8h.html#ae0a7a10f0bc2adac4b621178b64aa6f6">UserCtx::multinullspace</a></div><div class="ttdeci">PetscBool multinullspace</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00693">variables.h:693</a></div></div>
<div class="ttc" id="avariables_8h_html_a37acd97196e51bd7e58e2d2fafc3344a"><div class="ttname"><a href="variables_8h.html#a37acd97196e51bd7e58e2d2fafc3344a">RankNeighbors::rank_xp</a></div><div class="ttdeci">PetscMPIInt rank_xp</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00177">variables.h:177</a></div></div>
<div class="ttc" id="avariables_8h_html_a768740aa4a2ae69549670ebbfea58fc0"><div class="ttname"><a href="variables_8h.html#a768740aa4a2ae69549670ebbfea58fc0">SimCtx::MaxDiv</a></div><div class="ttdeci">PetscReal MaxDiv</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00634">variables.h:634</a></div></div>
<div class="ttc" id="avariables_8h_html_a9458ae2fd01569ea1ea0e84106874485"><div class="ttname"><a href="variables_8h.html#a9458ae2fd01569ea1ea0e84106874485">UserCtx::Nu_t</a></div><div class="ttdeci">Vec Nu_t</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00707">variables.h:707</a></div></div>
<div class="ttc" id="avariables_8h_html_aeb624d13d58833ceca0dcac7855a1b65"><div class="ttname"><a href="variables_8h.html#aeb624d13d58833ceca0dcac7855a1b65">SimCtx::Pipe</a></div><div class="ttdeci">PetscInt Pipe</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_ad744b47ca3c5f3df2d1b737e432d6f07"><div class="ttname"><a href="variables_8h.html#ad744b47ca3c5f3df2d1b737e432d6f07">UserCtx::Cent</a></div><div class="ttdeci">Vec Cent</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_ac9684d6e871566d55c997416270b5b99"><div class="ttname"><a href="variables_8h.html#ac9684d6e871566d55c997416270b5b99">SimCtx::step</a></div><div class="ttdeci">PetscInt step</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00546">variables.h:546</a></div></div>
<div class="ttc" id="avariables_8h_html_a46331b4618365171b8acca414cfee348"><div class="ttname"><a href="variables_8h.html#a46331b4618365171b8acca414cfee348">SimCtx::imp_atol</a></div><div class="ttdeci">PetscReal imp_atol</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00572">variables.h:572</a></div></div>
<div class="ttc" id="avariables_8h_html_a68dffbb3717fdf0b6a79bd9169c067c5"><div class="ttname"><a href="variables_8h.html#a68dffbb3717fdf0b6a79bd9169c067c5">SimCtx::mg_idx</a></div><div class="ttdeci">PetscInt mg_idx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00573">variables.h:573</a></div></div>
<div class="ttc" id="avariables_8h_html_a3e8bcd710c619c329608b6f7da5f1ea1"><div class="ttname"><a href="variables_8h.html#a3e8bcd710c619c329608b6f7da5f1ea1">UserCtx::ksc</a></div><div class="ttdeci">PetscInt ksc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00670">variables.h:670</a></div></div>
<div class="ttc" id="avariables_8h_html_a2e1d74f612f5443c8ece068511563453"><div class="ttname"><a href="variables_8h.html#a2e1d74f612f5443c8ece068511563453">SimCtx::channelz</a></div><div class="ttdeci">PetscInt channelz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00589">variables.h:589</a></div></div>
<div class="ttc" id="avariables_8h_html_af1abb750bddbd00d7149307d4c01a218"><div class="ttname"><a href="variables_8h.html#af1abb750bddbd00d7149307d4c01a218">SimCtx::blank</a></div><div class="ttdeci">PetscInt blank</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00564">variables.h:564</a></div></div>
<div class="ttc" id="avariables_8h_html_a146d75ad33e5ba60b528cc38a0d3f7dd"><div class="ttname"><a href="variables_8h.html#a146d75ad33e5ba60b528cc38a0d3f7dd">SimCtx::poisson_tol</a></div><div class="ttdeci">PetscReal poisson_tol</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00575">variables.h:575</a></div></div>
<div class="ttc" id="avariables_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00660">variables.h:660</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="avariables_8h_html_a8420a45c7f75054e71e9d8530e52ee8e"><div class="ttname"><a href="variables_8h.html#a8420a45c7f75054e71e9d8530e52ee8e">UserCtx::user_c</a></div><div class="ttdeci">UserCtx * user_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00717">variables.h:717</a></div></div>
<div class="ttc" id="avariables_8h_html_a0e447e75b801c0a9305fcadd317159a4"><div class="ttname"><a href="variables_8h.html#a0e447e75b801c0a9305fcadd317159a4">SimCtx::pseudo_periodic</a></div><div class="ttdeci">PetscInt pseudo_periodic</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00590">variables.h:590</a></div></div>
<div class="ttc" id="avariables_8h_html_a61f9f685923b2b7b99434b6100cc10d7"><div class="ttname"><a href="variables_8h.html#a61f9f685923b2b7b99434b6100cc10d7">SimCtx::averaging</a></div><div class="ttdeci">PetscBool averaging</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables_8h_html_aef90766eec6fc6887cd39bd1d79cb6d2"><div class="ttname"><a href="variables_8h.html#aef90766eec6fc6887cd39bd1d79cb6d2">SimCtx::immersed</a></div><div class="ttdeci">PetscInt immersed</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00563">variables.h:563</a></div></div>
<div class="ttc" id="avariables_8h_html_a718a09fbedf450248eaf7019a980e139"><div class="ttname"><a href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">Cmpnts::x</a></div><div class="ttdeci">PetscScalar x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="aio_8h_html_a10269cd4ddae9d1a84b84de3e2913158"><div class="ttname"><a href="io_8h.html#a10269cd4ddae9d1a84b84de3e2913158">ParseScalingInformation</a></div><div class="ttdeci">PetscErrorCode ParseScalingInformation(SimCtx *simCtx)</div><div class="ttdoc">Parses physical scaling parameters from command-line options.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l02202">io.c:2202</a></div></div>
<div class="ttc" id="avariables_8h_html_a281d10df99cab1a563bb65203f3bd823"><div class="ttname"><a href="variables_8h.html#a281d10df99cab1a563bb65203f3bd823">SimCtx::da_procs_z</a></div><div class="ttdeci">PetscInt da_procs_z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00595">variables.h:595</a></div></div>
<div class="ttc" id="avariables_8h_html_a7b338865846c21925fbb6b968cdf385f"><div class="ttname"><a href="variables_8h.html#a7b338865846c21925fbb6b968cdf385f">RankCellInfo::xm_cell</a></div><div class="ttdeci">PetscInt xm_cell</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00185">variables.h:185</a></div></div>
<div class="ttc" id="avariables_8h_html_a5a73aa2bc6be44bc1ff8847cf0a1b6af"><div class="ttname"><a href="variables_8h.html#a5a73aa2bc6be44bc1ff8847cf0a1b6af">UserCtx::P</a></div><div class="ttdeci">Vec P</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a></div><div class="ttdeci">@ LOG_WARNING</div><div class="ttdoc">Non-critical issues that warrant attention.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00030">logging.h:30</a></div></div>
<div class="ttc" id="avariables_8h_html_af4e8e680314f5a935c26342d6dca13c8"><div class="ttname"><a href="variables_8h.html#af4e8e680314f5a935c26342d6dca13c8">SimCtx::LoggingFrequency</a></div><div class="ttdeci">PetscInt LoggingFrequency</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00632">variables.h:632</a></div></div>
<div class="ttc" id="avariables_8h_html_a6a5533a086f46652d5587ae84ec62c9f"><div class="ttname"><a href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">SimCtx::StartStep</a></div><div class="ttdeci">PetscInt StartStep</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00548">variables.h:548</a></div></div>
<div class="ttc" id="avariables_8h_html_adeb409a2b27c8f7bba53944a876cc7bc"><div class="ttname"><a href="variables_8h.html#adeb409a2b27c8f7bba53944a876cc7bc">SimCtx::logviewer</a></div><div class="ttdeci">PetscViewer logviewer</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00554">variables.h:554</a></div></div>
<div class="ttc" id="avariables_8h_html_a0d160d8dbe2ebacbdf86c7c40edf6c68"><div class="ttname"><a href="variables_8h.html#a0d160d8dbe2ebacbdf86c7c40edf6c68">UserCtx::JCsi</a></div><div class="ttdeci">Vec JCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_a1bec6eafffafc2eecc2efb4377e6fed1"><div class="ttname"><a href="variables_8h.html#a1bec6eafffafc2eecc2efb4377e6fed1">SimCtx::LV</a></div><div class="ttdeci">PetscInt LV</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a64c0b8cda05b216ac96fc09da38c3c70"><div class="ttname"><a href="variables_8h.html#a64c0b8cda05b216ac96fc09da38c3c70">SimCtx::ccc</a></div><div class="ttdeci">PetscInt ccc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00601">variables.h:601</a></div></div>
<div class="ttc" id="avariables_8h_html_a3b2b999940b9f6e1f8dc6c1f5494067f"><div class="ttname"><a href="variables_8h.html#a3b2b999940b9f6e1f8dc6c1f5494067f">SimCtx::bcs_files</a></div><div class="ttdeci">char ** bcs_files</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00597">variables.h:597</a></div></div>
<div class="ttc" id="asetup_8c_html_a3d538200fed5b9ee9d1ef391bb61036c"><div class="ttname"><a href="setup_8c.html#a3d538200fed5b9ee9d1ef391bb61036c">Gidx</a></div><div class="ttdeci">static PetscInt Gidx(PetscInt i, PetscInt j, PetscInt k, UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l02160">setup.c:2160</a></div></div>
<div class="ttc" id="avariables_8h_html_aed540f6bcccf526419b3d5ec4ec6b82f"><div class="ttname"><a href="variables_8h.html#aed540f6bcccf526419b3d5ec4ec6b82f">SimCtx::AreaInSum</a></div><div class="ttdeci">PetscReal AreaInSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00599">variables.h:599</a></div></div>
<div class="ttc" id="avariables_8h_html_a0636fa7c6553721728dc41cafb482463"><div class="ttname"><a href="variables_8h.html#a0636fa7c6553721728dc41cafb482463">SimCtx::clark</a></div><div class="ttdeci">PetscInt clark</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00606">variables.h:606</a></div></div>
<div class="ttc" id="avariables_8h_html_ae9f42dc66b074d482e5515c908519216"><div class="ttname"><a href="variables_8h.html#ae9f42dc66b074d482e5515c908519216">SimCtx::cop</a></div><div class="ttdeci">PetscInt cop</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a0ca5cdac6f3648539846966855d2b75a"><div class="ttname"><a href="variables_8h.html#a0ca5cdac6f3648539846966855d2b75a">SimCtx::moveframe</a></div><div class="ttdeci">PetscInt moveframe</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00564">variables.h:564</a></div></div>
<div class="ttc" id="avariables_8h_html_a223f70881916d4d77f5f62b1faf4547f"><div class="ttname"><a href="variables_8h.html#a223f70881916d4d77f5f62b1faf4547f">SimCtx::grid1d</a></div><div class="ttdeci">PetscInt grid1d</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00589">variables.h:589</a></div></div>
<div class="ttc" id="aMetric_8h_html_a063043da47b68702c78c7e0769325b36"><div class="ttname"><a href="Metric_8h.html#a063043da47b68702c78c7e0769325b36">CalculateAllGridMetrics</a></div><div class="ttdeci">PetscErrorCode CalculateAllGridMetrics(SimCtx *simCtx)</div><div class="ttdoc">Orchestrates the calculation of all grid metrics.</div><div class="ttdef"><b>Definition:</b> <a href="Metric_8c_source.html#l01739">Metric.c:1739</a></div></div>
<div class="ttc" id="alogging_8h_html_a2ebe7667b52c478f7ff365f296d4c8ae"><div class="ttname"><a href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a></div><div class="ttdeci">#define LOG_ALLOW_SYNC(scope, level, fmt,...)</div><div class="ttdoc">----— DEBUG ---------------------------------------— #define LOG_ALLOW(scope, level,...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00266">logging.h:266</a></div></div>
<div class="ttc" id="avariables_8h_html_aebf75baa2defdbe4f6dcce0b6620cad4"><div class="ttname"><a href="variables_8h.html#aebf75baa2defdbe4f6dcce0b6620cad4">SimCtx::vnn</a></div><div class="ttdeci">PetscReal vnn</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="avariables_8h_html_a937a59194fd0b844bc61a175d8ae6a30"><div class="ttname"><a href="variables_8h.html#a937a59194fd0b844bc61a175d8ae6a30">SimCtx::FluxInSum</a></div><div class="ttdeci">PetscReal FluxInSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00598">variables.h:598</a></div></div>
<div class="ttc" id="asetup_8c_html_aeb77337317f41972d1c75c8d80527892"><div class="ttname"><a href="setup_8c.html#aeb77337317f41972d1c75c8d80527892">SetupDomainCellDecompositionMap</a></div><div class="ttdeci">PetscErrorCode SetupDomainCellDecompositionMap(UserCtx *user)</div><div class="ttdoc">Creates and distributes a map of the domain's cell decomposition to all ranks.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l02039">setup.c:2039</a></div></div>
<div class="ttc" id="avariables_8h_html_a148acf527180f13125589c3fb8f4e816"><div class="ttname"><a href="variables_8h.html#a148acf527180f13125589c3fb8f4e816">UserCtx::Zet</a></div><div class="ttdeci">Vec Zet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00538">variables.h:538</a></div></div>
<div class="ttc" id="avariables_8h_html_a752886caf27f1ff423393206403eda22"><div class="ttname"><a href="variables_8h.html#a752886caf27f1ff423393206403eda22">SimCtx::dgf_x</a></div><div class="ttdeci">PetscInt dgf_x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00565">variables.h:565</a></div></div>
<div class="ttc" id="avariables_8h_html_ace2eeedc863d73caaf51bb83aa993e44"><div class="ttname"><a href="variables_8h.html#ace2eeedc863d73caaf51bb83aa993e44">UserCtx::lUcat</a></div><div class="ttdeci">Vec lUcat</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_ac6c6cfb6059e67c1f8ad3c1bbe7f7889"><div class="ttname"><a href="variables_8h.html#ac6c6cfb6059e67c1f8ad3c1bbe7f7889">SimCtx::i_periodic</a></div><div class="ttdeci">PetscInt i_periodic</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00590">variables.h:590</a></div></div>
<div class="ttc" id="avariables_8h_html_a96938d329a797441f228ecddd8e8e607"><div class="ttname"><a href="variables_8h.html#a96938d329a797441f228ecddd8e8e607">UserCtx::lJEta</a></div><div class="ttdeci">Vec lJEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_a41951f47cfbe9c08def29998a76dc791"><div class="ttname"><a href="variables_8h.html#a41951f47cfbe9c08def29998a76dc791">UserCtx::assignedA</a></div><div class="ttdeci">PetscBool assignedA</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00696">variables.h:696</a></div></div>
<div class="ttc" id="avariables_8h_html_a7947f7b4cd08e551b6d2a79c8b513d9c"><div class="ttname"><a href="variables_8h.html#a7947f7b4cd08e551b6d2a79c8b513d9c">SimCtx::grid_file</a></div><div class="ttdeci">char grid_file[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00594">variables.h:594</a></div></div>
<div class="ttc" id="avariables_8h_html_ac29b95b05aa4bc3539389113c408d19e"><div class="ttname"><a href="variables_8h.html#ac29b95b05aa4bc3539389113c408d19e">UserCtx::KEta</a></div><div class="ttdeci">Vec KEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="alogging_8h_html_a6c0ddc8d3a828f3ab26c557ba0aedf75"><div class="ttname"><a href="logging_8h.html#a6c0ddc8d3a828f3ab26c557ba0aedf75">LoadAllowedFunctionsFromFile</a></div><div class="ttdeci">PetscErrorCode LoadAllowedFunctionsFromFile(const char filename[], char ***funcsOut, PetscInt *nOut)</div><div class="ttdoc">Load function names from a text file.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00558">logging.c:558</a></div></div>
<div class="ttc" id="alogging_8h_html_a0c30361e55f762e47599a9e2a5999d24"><div class="ttname"><a href="logging_8h.html#a0c30361e55f762e47599a9e2a5999d24">set_allowed_functions</a></div><div class="ttdeci">void set_allowed_functions(const char **functionList, int count)</div><div class="ttdoc">Sets the global list of function names that are allowed to log.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00114">logging.c:114</a></div></div>
<div class="ttc" id="avariables_8h_html_a14137f3f169b2ebe384683ea9a8b7f6d"><div class="ttname"><a href="variables_8h.html#a14137f3f169b2ebe384683ea9a8b7f6d">UserCtx::JEta</a></div><div class="ttdeci">Vec JEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_afd3cbef00a91e3115e40ccd7b0a8cfbb"><div class="ttname"><a href="variables_8h.html#afd3cbef00a91e3115e40ccd7b0a8cfbb">SimCtx::j_periodic</a></div><div class="ttdeci">PetscInt j_periodic</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00590">variables.h:590</a></div></div>
<div class="ttc" id="avariables_8h_html_abf0fd1ca67fe0886eb53735ec3d5ed01"><div class="ttname"><a href="variables_8h.html#abf0fd1ca67fe0886eb53735ec3d5ed01">SimCtx::grid_rotation_angle</a></div><div class="ttdeci">PetscReal grid_rotation_angle</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00592">variables.h:592</a></div></div>
<div class="ttc" id="avariables_8h_html_a4a1d73fcab703005ec80b7d68674506e"><div class="ttname"><a href="variables_8h.html#a4a1d73fcab703005ec80b7d68674506e">UserCtx::lUcont_rm1</a></div><div class="ttdeci">Vec lUcont_rm1</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00688">variables.h:688</a></div></div>
<div class="ttc" id="agrid_8h_html_a7a6ee72a401708711d1bfd039627b606"><div class="ttname"><a href="grid_8h.html#a7a6ee72a401708711d1bfd039627b606">CalculateInletCenter</a></div><div class="ttdeci">PetscErrorCode CalculateInletCenter(UserCtx *user)</div><div class="ttdoc">Calculates the geometric center of the primary inlet face.</div><div class="ttdef"><b>Definition:</b> <a href="grid_8c_source.html#l01023">grid.c:1023</a></div></div>
<div class="ttc" id="avariables_8h_html_a44230884a9901af3992a1faf2eebdfb1"><div class="ttname"><a href="variables_8h.html#a44230884a9901af3992a1faf2eebdfb1">SimCtx::da_procs_y</a></div><div class="ttdeci">PetscInt da_procs_y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00595">variables.h:595</a></div></div>
<div class="ttc" id="avariables_8h_html_af2143bc1a9f6bb90236d624f4a45b4e2"><div class="ttname"><a href="variables_8h.html#af2143bc1a9f6bb90236d624f4a45b4e2">SimCtx::dgf_y</a></div><div class="ttdeci">PetscInt dgf_y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00565">variables.h:565</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="avariables_8h_html_a8946fb6518183cd18a7dc1119c4771c7"><div class="ttname"><a href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">SimCtx::particleRestartMode</a></div><div class="ttdeci">char particleRestartMode[16]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00617">variables.h:617</a></div></div>
<div class="ttc" id="avariables_8h_html_abbf9f36d259bcdf12c831721e70390ee"><div class="ttname"><a href="variables_8h.html#abbf9f36d259bcdf12c831721e70390ee">UserCtx::IAj</a></div><div class="ttdeci">Vec IAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_a5d62bb83d782192bfb7a04b985d1b8aa"><div class="ttname"><a href="variables_8h.html#a5d62bb83d782192bfb7a04b985d1b8aa">SimCtx::rstart_fsi</a></div><div class="ttdeci">PetscBool rstart_fsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00623">variables.h:623</a></div></div>
<div class="ttc" id="avariables_8h_html_afa542dfd7b8528862c1b4a96db3e35c7"><div class="ttname"><a href="variables_8h.html#afa542dfd7b8528862c1b4a96db3e35c7">UserCtx::P_o</a></div><div class="ttdeci">Vec P_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00687">variables.h:687</a></div></div>
<div class="ttc" id="avariables_8h_html_a97d71af54bbd6d215c8d3838b574d799"><div class="ttname"><a href="variables_8h.html#a97d71af54bbd6d215c8d3838b574d799">UserCtx::lGridSpace</a></div><div class="ttdeci">Vec lGridSpace</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_ab17f6375fec794f8022ab283d28fa8a0"><div class="ttname"><a href="variables_8h.html#ab17f6375fec794f8022ab283d28fa8a0">SimCtx::num_bcs_files</a></div><div class="ttdeci">PetscInt num_bcs_files</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00596">variables.h:596</a></div></div>
<div class="ttc" id="agrid_8h_html_aa0b95ab3ac28c8df985e38b888c9bb52"><div class="ttname"><a href="grid_8h.html#aa0b95ab3ac28c8df985e38b888c9bb52">InitializeAllGridDMs</a></div><div class="ttdeci">PetscErrorCode InitializeAllGridDMs(SimCtx *simCtx)</div><div class="ttdoc">Orchestrates the creation of DMDA objects for every block and multigrid level.</div><div class="ttdef"><b>Definition:</b> <a href="grid_8c_source.html#l00246">grid.c:246</a></div></div>
<div class="ttc" id="avariables_8h_html_a859022c229213fbf2166434a66ee7422"><div class="ttname"><a href="variables_8h.html#a859022c229213fbf2166434a66ee7422">SimCtx::poisson</a></div><div class="ttdeci">PetscInt poisson</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00574">variables.h:574</a></div></div>
<div class="ttc" id="avariables_8h_html_a51f095899dcd18840b729608a73c8916"><div class="ttname"><a href="variables_8h.html#a51f095899dcd18840b729608a73c8916">SimCtx::criticalFuncsFile</a></div><div class="ttdeci">char criticalFuncsFile[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00637">variables.h:637</a></div></div>
<div class="ttc" id="avariables_8h_html_a0e237daee9fc063a6563c731846eca76"><div class="ttname"><a href="variables_8h.html#a0e237daee9fc063a6563c731846eca76">SimCtx::TwoD</a></div><div class="ttdeci">PetscInt TwoD</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00564">variables.h:564</a></div></div>
<div class="ttc" id="avariables_8h_html_a9ceb6475261683f406ad2961abaa0f3d"><div class="ttname"><a href="variables_8h.html#a9ceb6475261683f406ad2961abaa0f3d">SimCtx::imp_stol</a></div><div class="ttdeci">PetscReal imp_stol</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00572">variables.h:572</a></div></div>
<div class="ttc" id="avariables_8h_html_ab03f6ae8e484ed1a626cf207aeab1382"><div class="ttname"><a href="variables_8h.html#ab03f6ae8e484ed1a626cf207aeab1382">SimCtx::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00573">variables.h:573</a></div></div>
<div class="ttc" id="avariables_8h_html_ac5eef54f719e58aacd10010fbe61f2d5"><div class="ttname"><a href="variables_8h.html#ac5eef54f719e58aacd10010fbe61f2d5">UserCtx::Ucont_rm1</a></div><div class="ttdeci">Vec Ucont_rm1</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00688">variables.h:688</a></div></div>
<div class="ttc" id="avariables_8h_html_a8e6283b2989fae5d0a235baa570e929f"><div class="ttname"><a href="variables_8h.html#a8e6283b2989fae5d0a235baa570e929f">UserCtx::lKZet</a></div><div class="ttdeci">Vec lKZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="avariables_8h_html_a358dc1518de03e8f825de1397787f513"><div class="ttname"><a href="variables_8h.html#a358dc1518de03e8f825de1397787f513">RankNeighbors::rank_ym</a></div><div class="ttdeci">PetscMPIInt rank_ym</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00178">variables.h:178</a></div></div>
<div class="ttc" id="avariables_8h_html_acdd1a65b6f7557e023f70e782c24c202"><div class="ttname"><a href="variables_8h.html#acdd1a65b6f7557e023f70e782c24c202">SimCtx::hydro</a></div><div class="ttdeci">PetscInt hydro</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_ad4296b10d8eb7b065165582f5cc85897"><div class="ttname"><a href="variables_8h.html#ad4296b10d8eb7b065165582f5cc85897">UserCtx::lEta</a></div><div class="ttdeci">Vec lEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_adb0a0adae51684c0d56ca6d8ab119fbf"><div class="ttname"><a href="variables_8h.html#adb0a0adae51684c0d56ca6d8ab119fbf">SimCtx::mg_preItr</a></div><div class="ttdeci">PetscInt mg_preItr</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00573">variables.h:573</a></div></div>
<div class="ttc" id="avariables_8h_html_a2f3825691b122a0bf2ed5728b70bc9b1"><div class="ttname"><a href="variables_8h.html#a2f3825691b122a0bf2ed5728b70bc9b1">UserCtx::Phi</a></div><div class="ttdeci">Vec Phi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_ab45ae5b28b66812e5e4b0e85a540f948"><div class="ttname"><a href="variables_8h.html#ab45ae5b28b66812e5e4b0e85a540f948">SimCtx::readFields</a></div><div class="ttdeci">PetscBool readFields</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00613">variables.h:613</a></div></div>
<div class="ttc" id="avariables_8h_html_a82348af36047097defe3692225145edc"><div class="ttname"><a href="variables_8h.html#a82348af36047097defe3692225145edc">SimCtx::STRONG_COUPLING</a></div><div class="ttdeci">PetscInt STRONG_COUPLING</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00576">variables.h:576</a></div></div>
<div class="ttc" id="aBoundaries_8h_html_ae7f472e68b4ebad054e1391e5de8c9a0"><div class="ttname"><a href="Boundaries_8h.html#ae7f472e68b4ebad054e1391e5de8c9a0">TranslateModernBCsToLegacy</a></div><div class="ttdeci">PetscErrorCode TranslateModernBCsToLegacy(UserCtx *user)</div><div class="ttdef"><b>Definition:</b> <a href="Boundaries_8c_source.html#l00413">Boundaries.c:413</a></div></div>
<div class="ttc" id="avariables_8h_html_aea06dd1e5437886745d3545e2a383172"><div class="ttname"><a href="variables_8h.html#aea06dd1e5437886745d3545e2a383172">SimCtx::ti</a></div><div class="ttdeci">PetscReal ti</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00547">variables.h:547</a></div></div>
<div class="ttc" id="avariables_8h_html_ac07ad1cd425926ccddebaca19310d090"><div class="ttname"><a href="variables_8h.html#ac07ad1cd425926ccddebaca19310d090">UserCtx::JAj</a></div><div class="ttdeci">Vec JAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_a5cd84217e8a324f6fb3ec4c1a8eecf32"><div class="ttname"><a href="variables_8h.html#a5cd84217e8a324f6fb3ec4c1a8eecf32">SimCtx::criticalFuncs</a></div><div class="ttdeci">char ** criticalFuncs</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00639">variables.h:639</a></div></div>
<div class="ttc" id="avariables_8h_html_a9419886ec15f30fb98c71804d563796c"><div class="ttname"><a href="variables_8h.html#a9419886ec15f30fb98c71804d563796c">RankNeighbors::rank_xm</a></div><div class="ttdeci">PetscMPIInt rank_xm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00177">variables.h:177</a></div></div>
<div class="ttc" id="avariables_8h_html_a6bae0e92738d6c3498ac41b67ed5b7a4"><div class="ttname"><a href="variables_8h.html#a6bae0e92738d6c3498ac41b67ed5b7a4">SimCtx::OnlySetup</a></div><div class="ttdeci">PetscBool OnlySetup</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00553">variables.h:553</a></div></div>
<div class="ttc" id="alogging_8h_html_a5fe7257f46131945aacf9a35e9de5874"><div class="ttname"><a href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a></div><div class="ttdeci">#define PROFILE_FUNCTION_END</div><div class="ttdoc">Marks the end of a profiled code block.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00731">logging.h:731</a></div></div>
<div class="ttc" id="avariables_8h_html_a12ea69c9013845d392b1a2c3036d8042"><div class="ttname"><a href="variables_8h.html#a12ea69c9013845d392b1a2c3036d8042">SimCtx::dgf_z</a></div><div class="ttdeci">PetscInt dgf_z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00565">variables.h:565</a></div></div>
<div class="ttc" id="avariables_8h_html_a22578f82210005268294944e4227473e"><div class="ttname"><a href="variables_8h.html#a22578f82210005268294944e4227473e">SimCtx::eulerianSource</a></div><div class="ttdeci">char eulerianSource[64]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00557">variables.h:557</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a></div><div class="ttdeci">@ LOG_ERROR</div><div class="ttdoc">Critical errors that may halt the program.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00029">logging.h:29</a></div></div>
<div class="ttc" id="avariables_8h_html_ac5abbee1a0f657e18deac2dbaef2ad74"><div class="ttname"><a href="variables_8h.html#ac5abbee1a0f657e18deac2dbaef2ad74">RankNeighbors::rank_zp</a></div><div class="ttdeci">PetscMPIInt rank_zp</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00179">variables.h:179</a></div></div>
<div class="ttc" id="avariables_8h_html_a4f7c5fd8843d026101b193e9236e1192"><div class="ttname"><a href="variables_8h.html#a4f7c5fd8843d026101b193e9236e1192">UserCtx::_this</a></div><div class="ttdeci">PetscInt _this</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00670">variables.h:670</a></div></div>
<div class="ttc" id="avariables_8h_html_a0d09ddf5e31ea3cfcab2c6bbc59b64cd"><div class="ttname"><a href="variables_8h.html#a0d09ddf5e31ea3cfcab2c6bbc59b64cd">UserCtx::P_nodal</a></div><div class="ttdeci">Vec P_nodal</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00729">variables.h:729</a></div></div>
<div class="ttc" id="avariables_8h_html_ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f"><div class="ttname"><a href="variables_8h.html#ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f">EXEC_MODE_POSTPROCESSOR</a></div><div class="ttdeci">@ EXEC_MODE_POSTPROCESSOR</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00512">variables.h:512</a></div></div>
<div class="ttc" id="avariables_8h_html_structUserCtx"><div class="ttname"><a href="variables_8h.html#structUserCtx">UserCtx</a></div><div class="ttdoc">User-defined context containing data specific to a single computational grid level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00657">variables.h:657</a></div></div>
<div class="ttc" id="avariables_8h_html_a091373565c3562df29b6e1dc33a78c68"><div class="ttname"><a href="variables_8h.html#a091373565c3562df29b6e1dc33a78c68">UserCtx::lCent</a></div><div class="ttdeci">Vec lCent</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_a6bbc45b8c4ff978d205c0a7b670b54f9"><div class="ttname"><a href="variables_8h.html#a6bbc45b8c4ff978d205c0a7b670b54f9">SimCtx::rotatefsi</a></div><div class="ttdeci">PetscInt rotatefsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00563">variables.h:563</a></div></div>
<div class="ttc" id="avariables_8h_html_a9d9e92084d58808e9a52a80fa9d82092"><div class="ttname"><a href="variables_8h.html#a9d9e92084d58808e9a52a80fa9d82092">UserCtx::ICsi</a></div><div class="ttdeci">Vec ICsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_acd99423029a666652ee1f5bf573619bc"><div class="ttname"><a href="variables_8h.html#acd99423029a666652ee1f5bf573619bc">UserCtx::info</a></div><div class="ttdeci">DMDALocalInfo info</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00664">variables.h:664</a></div></div>
<div class="ttc" id="avariables_8h_html_acb5123619f6844033498dbbd1f46b8d0"><div class="ttname"><a href="variables_8h.html#acb5123619f6844033498dbbd1f46b8d0">UserCtx::lAj</a></div><div class="ttdeci">Vec lAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_a8811a9a632140d00bca04337f2261d23"><div class="ttname"><a href="variables_8h.html#a8811a9a632140d00bca04337f2261d23">SimCtx::MaxDivy</a></div><div class="ttdeci">PetscInt MaxDivy</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="avariables_8h_html_a3279024cc316f957e89c05949a1ab441"><div class="ttname"><a href="variables_8h.html#a3279024cc316f957e89c05949a1ab441">SimCtx::rans</a></div><div class="ttdeci">PetscInt rans</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00605">variables.h:605</a></div></div>
<div class="ttc" id="avariables_8h_html_a8b2e7f4d2e2e95e4c49aa02684e2e51d"><div class="ttname"><a href="variables_8h.html#a8b2e7f4d2e2e95e4c49aa02684e2e51d">SimCtx::MaxDivz</a></div><div class="ttdeci">PetscInt MaxDivz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="avariables_8h_html_aaf69cd924766117c45ba60fcf2ed452e"><div class="ttname"><a href="variables_8h.html#aaf69cd924766117c45ba60fcf2ed452e">SimCtx::cfl</a></div><div class="ttdeci">PetscReal cfl</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="avariables_8h_html_af76e1d38bb7cbd24474b58fa54fd7ad5"><div class="ttname"><a href="variables_8h.html#af76e1d38bb7cbd24474b58fa54fd7ad5">SimCtx::CMx_c</a></div><div class="ttdeci">PetscReal CMx_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="avariables_8h_html_a1fb23a91520ea2d2cd06eacdae38ef13"><div class="ttname"><a href="variables_8h.html#a1fb23a91520ea2d2cd06eacdae38ef13">SimCtx::thin</a></div><div class="ttdeci">PetscInt thin</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00564">variables.h:564</a></div></div>
<div class="ttc" id="alogging_8h_html_a2358badbcda33fc9d80ebd6a59d2a2cd"><div class="ttname"><a href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a></div><div class="ttdeci">PetscBool is_function_allowed(const char *functionName)</div><div class="ttdoc">Checks if a given function is in the allow-list.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00149">logging.c:149</a></div></div>
<div class="ttc" id="avariables_8h_html_acac9c41534675c81a182fbd07ced455b"><div class="ttname"><a href="variables_8h.html#acac9c41534675c81a182fbd07ced455b">SimCtx::dgf_ay</a></div><div class="ttdeci">PetscInt dgf_ay</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00565">variables.h:565</a></div></div>
<div class="ttc" id="avariables_8h_html_acf6d729ae4d0d996d6b056ccc5438995"><div class="ttname"><a href="variables_8h.html#acf6d729ae4d0d996d6b056ccc5438995">SimCtx::pps</a></div><div class="ttdeci">PostProcessParams * pps</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00644">variables.h:644</a></div></div>
<div class="ttc" id="avariables_8h_html_ab32e253228241b5de900c4ac9c9e7452"><div class="ttname"><a href="variables_8h.html#ab32e253228241b5de900c4ac9c9e7452">SimCtx::dm_swarm</a></div><div class="ttdeci">DM dm_swarm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00614">variables.h:614</a></div></div>
<div class="ttc" id="avariables_8h_html_a292340e9970a9cd8564bfb064862730f"><div class="ttname"><a href="variables_8h.html#a292340e9970a9cd8564bfb064862730f">SimCtx::sediment</a></div><div class="ttdeci">PetscInt sediment</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00563">variables.h:563</a></div></div>
<div class="ttc" id="avariables_8h_html_aee028ea541ee28c6c777dc0ec22b9d51"><div class="ttname"><a href="variables_8h.html#aee028ea541ee28c6c777dc0ec22b9d51">SimCtx::nCriticalFuncs</a></div><div class="ttdeci">PetscInt nCriticalFuncs</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00640">variables.h:640</a></div></div>
<div class="ttc" id="avariables_8h_html_ac014127a43e8978a157a8a42c2f0538d"><div class="ttname"><a href="variables_8h.html#ac014127a43e8978a157a8a42c2f0538d">SimCtx::da_procs_x</a></div><div class="ttdeci">PetscInt da_procs_x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00595">variables.h:595</a></div></div>
<div class="ttc" id="avariables_8h_html_a22580e0e52ca8ddccc76d24c96f00e4a"><div class="ttname"><a href="variables_8h.html#a22580e0e52ca8ddccc76d24c96f00e4a">SimCtx::block_number</a></div><div class="ttdeci">PetscInt block_number</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00589">variables.h:589</a></div></div>
<div class="ttc" id="avariables_8h_html_a35819a5678c9c37c2f8b55c2091a9a05"><div class="ttname"><a href="variables_8h.html#a35819a5678c9c37c2f8b55c2091a9a05">SimCtx::FluxOutSum</a></div><div class="ttdeci">PetscReal FluxOutSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00598">variables.h:598</a></div></div>
<div class="ttc" id="avariables_8h_html_aa60ee4e3f8eca251ee470427f1ebac13"><div class="ttname"><a href="variables_8h.html#aa60ee4e3f8eca251ee470427f1ebac13">SimCtx::wallfunction</a></div><div class="ttdeci">PetscInt wallfunction</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00606">variables.h:606</a></div></div>
<div class="ttc" id="avariables_8h_html_a070c1635b3c81726e526cc8efeae4022"><div class="ttname"><a href="variables_8h.html#a070c1635b3c81726e526cc8efeae4022">SimCtx::implicit_type</a></div><div class="ttdeci">PetscInt implicit_type</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00571">variables.h:571</a></div></div>
<div class="ttc" id="avariables_8h_html_a4b91bc588672c42d8917bf335d1a754e"><div class="ttname"><a href="variables_8h.html#a4b91bc588672c42d8917bf335d1a754e">RankCellInfo::zm_cell</a></div><div class="ttdeci">PetscInt zm_cell</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00185">variables.h:185</a></div></div>
<div class="ttc" id="avariables_8h_html_a3c4eaacc19b561cba4a96aafbdb30850"><div class="ttname"><a href="variables_8h.html#a3c4eaacc19b561cba4a96aafbdb30850">SimCtx::imp_rtol</a></div><div class="ttdeci">PetscReal imp_rtol</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00572">variables.h:572</a></div></div>
<div class="ttc" id="avariables_8h_html_ada85203a98a3e4ce033b630fd6a1b695"><div class="ttname"><a href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">UserMG::mgctx</a></div><div class="ttdeci">MGCtx * mgctx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00437">variables.h:437</a></div></div>
<div class="ttc" id="avariables_8h_html_a02fd03c4c166911f067e92b36d1820a3"><div class="ttname"><a href="variables_8h.html#a02fd03c4c166911f067e92b36d1820a3">SimCtx::MHV</a></div><div class="ttdeci">PetscInt MHV</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="asetup_8c_html_acf739211501f0646c25ceb99a68a1163"><div class="ttname"><a href="setup_8c.html#acf739211501f0646c25ceb99a68a1163">AllocateContextHierarchy</a></div><div class="ttdeci">static PetscErrorCode AllocateContextHierarchy(SimCtx *simCtx)</div><div class="ttdoc">Allocates the memory for the UserMG and UserCtx hierarchy.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00491">setup.c:491</a></div></div>
<div class="ttc" id="avariables_8h_html_a6ef13ed6ab8f82c44bd8a81739ff90e2"><div class="ttname"><a href="variables_8h.html#a6ef13ed6ab8f82c44bd8a81739ff90e2">BCS::Ubcs</a></div><div class="ttdeci">Vec Ubcs</div><div class="ttdoc">Boundary condition velocity values. (Comment: &quot;An ugly hack, waste of memory&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00121">variables.h:121</a></div></div>
<div class="ttc" id="avariables_8h_html_af09e3f546ff8fa1192338e746391aa22"><div class="ttname"><a href="variables_8h.html#af09e3f546ff8fa1192338e746391aa22">SimCtx::restart_dir</a></div><div class="ttdeci">char restart_dir[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00558">variables.h:558</a></div></div>
<div class="ttc" id="alogging_8h_html_a4d4a385a6fac09d0e106eeb2dfde18ba"><div class="ttname"><a href="logging_8h.html#a4d4a385a6fac09d0e106eeb2dfde18ba">print_log_level</a></div><div class="ttdeci">PetscErrorCode print_log_level(void)</div><div class="ttdoc">Prints the current logging level to the console.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00076">logging.c:76</a></div></div>
<div class="ttc" id="avariables_8h_html_a88c4b985c5df59d8fd0ac17910dbb85c"><div class="ttname"><a href="variables_8h.html#a88c4b985c5df59d8fd0ac17910dbb85c">SimCtx::NumberOfBodies</a></div><div class="ttdeci">PetscInt NumberOfBodies</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00583">variables.h:583</a></div></div>
<div class="ttc" id="avariables_8h_html_a57b3c5733ac4acdef370e635e85df95f"><div class="ttname"><a href="variables_8h.html#a57b3c5733ac4acdef370e635e85df95f">SimCtx::inletprofile</a></div><div class="ttdeci">PetscInt inletprofile</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00589">variables.h:589</a></div></div>
<div class="ttc" id="avariables_8h_html_a2db602ea5fce7cec91f19f507f922a74"><div class="ttname"><a href="variables_8h.html#a2db602ea5fce7cec91f19f507f922a74">UserCtx::lIZet</a></div><div class="ttdeci">Vec lIZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_aa002126f8760bb0f98614b78ac70e940"><div class="ttname"><a href="variables_8h.html#aa002126f8760bb0f98614b78ac70e940">SimCtx::OutputFreq</a></div><div class="ttdeci">PetscInt OutputFreq</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00555">variables.h:555</a></div></div>
<div class="ttc" id="agrid_8h_html_ab2aef4bb6fc2d2223a52ff6a45c7c600"><div class="ttname"><a href="grid_8h.html#ab2aef4bb6fc2d2223a52ff6a45c7c600">AssignAllGridCoordinates</a></div><div class="ttdeci">PetscErrorCode AssignAllGridCoordinates(SimCtx *simCtx)</div><div class="ttdoc">Orchestrates the assignment of physical coordinates to all DMDA objects.</div><div class="ttdef"><b>Definition:</b> <a href="grid_8c_source.html#l00339">grid.c:339</a></div></div>
<div class="ttc" id="avariables_8h_html_a733ad785db194e51ad86c1613844ba31"><div class="ttname"><a href="variables_8h.html#a733ad785db194e51ad86c1613844ba31">UserCtx::JZet</a></div><div class="ttdeci">Vec JZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_aa872769b7375d16b560211774f36eab3"><div class="ttname"><a href="variables_8h.html#aa872769b7375d16b560211774f36eab3">SimCtx::rheology</a></div><div class="ttdeci">PetscInt rheology</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00563">variables.h:563</a></div></div>
<div class="ttc" id="alogging_8h_html_a672ff9c400e2307306b36415d4fefcb9"><div class="ttname"><a href="logging_8h.html#a672ff9c400e2307306b36415d4fefcb9">LOG</a></div><div class="ttdeci">#define LOG(scope, level, fmt,...)</div><div class="ttdoc">Logging macro for PETSc-based applications with scope control.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00083">logging.h:83</a></div></div>
<div class="ttc" id="asetup_8c_html_a47daae7d6e456ef74e75626c1c9d6c9a"><div class="ttname"><a href="setup_8c.html#a47daae7d6e456ef74e75626c1c9d6c9a">CreateAndInitializeAllVectors</a></div><div class="ttdeci">PetscErrorCode CreateAndInitializeAllVectors(SimCtx *simCtx)</div><div class="ttdoc">Creates and initializes all PETSc Vec objects for all fields.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00658">setup.c:658</a></div></div>
<div class="ttc" id="aio_8h_html_a048b921bc98a7354369a176193c2bd62"><div class="ttname"><a href="io_8h.html#a048b921bc98a7354369a176193c2bd62">ParsePostProcessingSettings</a></div><div class="ttdeci">PetscErrorCode ParsePostProcessingSettings(SimCtx *simCtx)</div><div class="ttdoc">Initializes post-processing settings from a config file and command-line overrides.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l02067">io.c:2067</a></div></div>
<div class="ttc" id="avariables_8h_html_a02bb9f73a617ff6f0e5d21da2bd045c6"><div class="ttname"><a href="variables_8h.html#a02bb9f73a617ff6f0e5d21da2bd045c6">RankNeighbors::rank_zm</a></div><div class="ttdeci">PetscMPIInt rank_zm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00179">variables.h:179</a></div></div>
<div class="ttc" id="avariables_8h_html_a2deb96128ed850632f645128e26e229e"><div class="ttname"><a href="variables_8h.html#a2deb96128ed850632f645128e26e229e">UserCtx::user_f</a></div><div class="ttdeci">UserCtx * user_f</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00717">variables.h:717</a></div></div>
<div class="ttc" id="avariables_8h_html_a2892b7742faefb81b542c6fdd2351e68"><div class="ttname"><a href="variables_8h.html#a2892b7742faefb81b542c6fdd2351e68">SimCtx::blkpbc</a></div><div class="ttdeci">PetscInt blkpbc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00590">variables.h:590</a></div></div>
<div class="ttc" id="agrid_8h_html_afac52c252de784d5bcd7fe7a2e642982"><div class="ttname"><a href="grid_8h.html#afac52c252de784d5bcd7fe7a2e642982">GatherAllBoundingBoxes</a></div><div class="ttdeci">PetscErrorCode GatherAllBoundingBoxes(UserCtx *user, BoundingBox **allBBoxes)</div><div class="ttdoc">Gathers local bounding boxes from all MPI processes to rank 0.</div><div class="ttdef"><b>Definition:</b> <a href="grid_8c_source.html#l00897">grid.c:897</a></div></div>
<div class="ttc" id="avariables_8h_html_ab4b123a5f980ecdaa79c5f855f751999"><div class="ttname"><a href="variables_8h.html#ab4b123a5f980ecdaa79c5f855f751999">SimCtx::useCriticalFuncsCfg</a></div><div class="ttdeci">PetscBool useCriticalFuncsCfg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00638">variables.h:638</a></div></div>
<div class="ttc" id="avariables_8h_html_ad87ed7266a1bc272ab8d4cea4e39d4d2"><div class="ttname"><a href="variables_8h.html#ad87ed7266a1bc272ab8d4cea4e39d4d2">SimCtx::les</a></div><div class="ttdeci">PetscInt les</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00605">variables.h:605</a></div></div>
<div class="ttc" id="avariables_8h_html_a4d561e219e8bc40951d121cce66d93ce"><div class="ttname"><a href="variables_8h.html#a4d561e219e8bc40951d121cce66d93ce">UserCtx::lIAj</a></div><div class="ttdeci">Vec lIAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_aee7757dd3f6e9566fc1206526625e000"><div class="ttname"><a href="variables_8h.html#aee7757dd3f6e9566fc1206526625e000">SimCtx::summationRHS</a></div><div class="ttdeci">PetscReal summationRHS</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00633">variables.h:633</a></div></div>
<div class="ttc" id="avariables_8h_html_a3791d5150655979c702ff538e0c2d0a5"><div class="ttname"><a href="variables_8h.html#a3791d5150655979c702ff538e0c2d0a5">UserCtx::IZet</a></div><div class="ttdeci">Vec IZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_a922566a9e001486fa838d96925a6f102"><div class="ttname"><a href="variables_8h.html#a922566a9e001486fa838d96925a6f102">SimCtx::log_dir</a></div><div class="ttdeci">char log_dir[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00560">variables.h:560</a></div></div>
<div class="ttc" id="avariables_8h_html_a768706b18a55a91246d847ec829faa43"><div class="ttname"><a href="variables_8h.html#a768706b18a55a91246d847ec829faa43">SimCtx::pizza</a></div><div class="ttdeci">PetscInt pizza</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a432208fc455621e01de80448272ae582"><div class="ttname"><a href="variables_8h.html#a432208fc455621e01de80448272ae582">SimCtx::allowedFile</a></div><div class="ttdeci">char allowedFile[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00628">variables.h:628</a></div></div>
<div class="ttc" id="avariables_8h_html_a8a4e2f647306f38daa0d543090647a4f"><div class="ttname"><a href="variables_8h.html#a8a4e2f647306f38daa0d543090647a4f">SimCtx::Ogrid</a></div><div class="ttdeci">PetscInt Ogrid</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00589">variables.h:589</a></div></div>
<div class="ttc" id="avariables_8h_html_a19aa807b9181b13618527d6c4eb6fa89"><div class="ttname"><a href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">SimCtx::rank</a></div><div class="ttdeci">PetscMPIInt rank</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00541">variables.h:541</a></div></div>
<div class="ttc" id="avariables_8h_html_a599be83bcac9867e2ba22fc981ae05fc"><div class="ttname"><a href="variables_8h.html#a599be83bcac9867e2ba22fc981ae05fc">SimCtx::cdisy</a></div><div class="ttdeci">PetscReal cdisy</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="avariables_8h_html_ab7a460d0a7eaa2d76d0b6267310c3184"><div class="ttname"><a href="variables_8h.html#ab7a460d0a7eaa2d76d0b6267310c3184">UserCtx::lJZet</a></div><div class="ttdeci">Vec lJZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_aaf3084979f6cafb4ec5e4eccd9129ee8"><div class="ttname"><a href="variables_8h.html#aaf3084979f6cafb4ec5e4eccd9129ee8">SimCtx::dgf_ax</a></div><div class="ttdeci">PetscInt dgf_ax</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00565">variables.h:565</a></div></div>
<div class="ttc" id="avariables_8h_html_a77c29afd999c79749fc4a0163da98d2e"><div class="ttname"><a href="variables_8h.html#a77c29afd999c79749fc4a0163da98d2e">UserCtx::Bcs</a></div><div class="ttdeci">BCS Bcs</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00678">variables.h:678</a></div></div>
<div class="ttc" id="avariables_8h_html_a2f213dcdaf9617bfb44e4f22857f2e56"><div class="ttname"><a href="variables_8h.html#a2f213dcdaf9617bfb44e4f22857f2e56">UserCtx::lNvert</a></div><div class="ttdeci">Vec lNvert</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_a4e46a0a7eb2e0ed0280df04ff25e24a8"><div class="ttname"><a href="variables_8h.html#a4e46a0a7eb2e0ed0280df04ff25e24a8">SimCtx::ibmv</a></div><div class="ttdeci">IBMVNodes * ibmv</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00621">variables.h:621</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="avariables_8h_html_a9338cb4f3fbc319695a259d0dc09c002"><div class="ttname"><a href="variables_8h.html#a9338cb4f3fbc319695a259d0dc09c002">UserCtx::lNu_t</a></div><div class="ttdeci">Vec lNu_t</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00707">variables.h:707</a></div></div>
<div class="ttc" id="avariables_8h_html_a58c51750e5a9172516dd2af41fd5fd42"><div class="ttname"><a href="variables_8h.html#a58c51750e5a9172516dd2af41fd5fd42">UserCtx::neighbors</a></div><div class="ttdeci">RankNeighbors neighbors</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00669">variables.h:669</a></div></div>
<div class="ttc" id="avariables_8h_html_ae27e734d789eb2f07918d6bae3969480"><div class="ttname"><a href="variables_8h.html#ae27e734d789eb2f07918d6bae3969480">SimCtx::exec_mode</a></div><div class="ttdeci">ExecutionMode exec_mode</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00556">variables.h:556</a></div></div>
<div class="ttc" id="avariables_8h_html_structCmpnts"><div class="ttname"><a href="variables_8h.html#structCmpnts">Cmpnts</a></div><div class="ttdoc">A 3D point or vector with PetscScalar components.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00100">variables.h:100</a></div></div>
<div class="ttc" id="avariables_8h_html_ab342b9a07bb00be469836bd6974b0c93"><div class="ttname"><a href="variables_8h.html#ab342b9a07bb00be469836bd6974b0c93">SimCtx::useCfg</a></div><div class="ttdeci">PetscBool useCfg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00629">variables.h:629</a></div></div>
<div class="ttc" id="avariables_8h_html_a63b70d5ad8338013a2888928d4106f63"><div class="ttname"><a href="variables_8h.html#a63b70d5ad8338013a2888928d4106f63">UserCtx::lJCsi</a></div><div class="ttdeci">Vec lJCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_afbf649648426b009265d74fade4665ca"><div class="ttname"><a href="variables_8h.html#afbf649648426b009265d74fade4665ca">BCS::Uch</a></div><div class="ttdeci">Vec Uch</div><div class="ttdoc">Characteristic velocity for boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00122">variables.h:122</a></div></div>
<div class="ttc" id="avariables_8h_html_a82d8c3eb7b01d4a4decdd9e3f23c152f"><div class="ttname"><a href="variables_8h.html#a82d8c3eb7b01d4a4decdd9e3f23c152f">UserCtx::Ucat_o</a></div><div class="ttdeci">Vec Ucat_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00687">variables.h:687</a></div></div>
<div class="ttc" id="avariables_8h_html_aadc4cfc6880a57f1cb68ac900e472155"><div class="ttname"><a href="variables_8h.html#aadc4cfc6880a57f1cb68ac900e472155">SimCtx::cdisx</a></div><div class="ttdeci">PetscReal cdisx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="avariables_8h_html_a1a81a690145500f4d561fb9f84c5f64b"><div class="ttname"><a href="variables_8h.html#a1a81a690145500f4d561fb9f84c5f64b">UserCtx::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00716">variables.h:716</a></div></div>
<div class="ttc" id="avariables_8h_html_a0a9771638133dcba2d6819c8ee4ea7b6"><div class="ttname"><a href="variables_8h.html#a0a9771638133dcba2d6819c8ee4ea7b6">UserCtx::GridSpace</a></div><div class="ttdeci">Vec GridSpace</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_a0d51f086ccdc81656ddea875d523173e"><div class="ttname"><a href="variables_8h.html#a0d51f086ccdc81656ddea875d523173e">UserCtx::KAj</a></div><div class="ttdeci">Vec KAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="avariables_8h_html_a3998b7b5dad8340caf395c5da62230b7"><div class="ttname"><a href="variables_8h.html#a3998b7b5dad8340caf395c5da62230b7">UserCtx::Centz</a></div><div class="ttdeci">Vec Centz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00701">variables.h:701</a></div></div>
<div class="ttc" id="avariables_8h_html_structBoundingBox"><div class="ttname"><a href="variables_8h.html#structBoundingBox">BoundingBox</a></div><div class="ttdoc">Defines a 3D axis-aligned bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00154">variables.h:154</a></div></div>
<div class="ttc" id="avariables_8h_html_a70969e8333ab8fd8eb60acc1f22f830a"><div class="ttname"><a href="variables_8h.html#a70969e8333ab8fd8eb60acc1f22f830a">UserCtx::Qcrit</a></div><div class="ttdeci">Vec Qcrit</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00731">variables.h:731</a></div></div>
<div class="ttc" id="alogging_8h_html_a9585f583c260f40a73f2490914edc689"><div class="ttname"><a href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a></div><div class="ttdeci">LogLevel get_log_level()</div><div class="ttdoc">Retrieves the current logging level from the environment variable LOG_LEVEL.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00039">logging.c:39</a></div></div>
<div class="ttc" id="avariables_8h_html_a4b2a3494bdeca82703c2b3125c81c8f6"><div class="ttname"><a href="variables_8h.html#a4b2a3494bdeca82703c2b3125c81c8f6">SimCtx::mixed</a></div><div class="ttdeci">PetscInt mixed</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00606">variables.h:606</a></div></div>
<div class="ttc" id="avariables_8h_html_a41a6127b3c012c516a7dcc56c3696a84"><div class="ttname"><a href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">SimCtx::usermg</a></div><div class="ttdeci">UserMG usermg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="avariables_8h_html_aa3e47c4956a89b33d659fe33f4814091"><div class="ttname"><a href="variables_8h.html#aa3e47c4956a89b33d659fe33f4814091">UserCtx::Ucont_o</a></div><div class="ttdeci">Vec Ucont_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00687">variables.h:687</a></div></div>
<div class="ttc" id="asetup_8c_html_a135027905841ed83f1a3ef2279d865cc"><div class="ttname"><a href="setup_8c.html#a135027905841ed83f1a3ef2279d865cc">GetOwnedCellRange</a></div><div class="ttdeci">PetscErrorCode GetOwnedCellRange(const DMDALocalInfo *info_nodes, PetscInt dim, PetscInt *xs_cell_global_out, PetscInt *xm_cell_local_out)</div><div class="ttdoc">Gets the global starting index of cells owned by this rank and the number of such cells.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01409">setup.c:1409</a></div></div>
<div class="ttc" id="avariables_8h_html_ac8ba12826d60a51ec54fa7c047d806e1"><div class="ttname"><a href="variables_8h.html#ac8ba12826d60a51ec54fa7c047d806e1">UserCtx::lUcont</a></div><div class="ttdeci">Vec lUcont</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_aecc33b61ded0b8c01e2524094af2504a"><div class="ttname"><a href="variables_8h.html#aecc33b61ded0b8c01e2524094af2504a">SimCtx::rotateframe</a></div><div class="ttdeci">PetscInt rotateframe</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00564">variables.h:564</a></div></div>
<div class="ttc" id="avariables_8h_html_a0e8eb238051c8b5f37a260a8cde481c4"><div class="ttname"><a href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">MGCtx::user</a></div><div class="ttdeci">UserCtx * user</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00427">variables.h:427</a></div></div>
<div class="ttc" id="avariables_8h_html_aa194db376ea0f68ec7090718804488ab"><div class="ttname"><a href="variables_8h.html#aa194db376ea0f68ec7090718804488ab">UserCtx::ParticleCount</a></div><div class="ttdeci">Vec ParticleCount</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00724">variables.h:724</a></div></div>
<div class="ttc" id="agrid_8h_html_a04f0887f08166a2a8d01411f39fa1a40"><div class="ttname"><a href="grid_8h.html#a04f0887f08166a2a8d01411f39fa1a40">DefineAllGridDimensions</a></div><div class="ttdeci">PetscErrorCode DefineAllGridDimensions(SimCtx *simCtx)</div><div class="ttdoc">Orchestrates the parsing and setting of grid dimensions for all blocks.</div><div class="ttdef"><b>Definition:</b> <a href="grid_8c_source.html#l00065">grid.c:65</a></div></div>
<div class="ttc" id="agrid_8h_html_a325b9d5da4b9b2c79d278fb848215632"><div class="ttname"><a href="grid_8h.html#a325b9d5da4b9b2c79d278fb848215632">BroadcastAllBoundingBoxes</a></div><div class="ttdeci">PetscErrorCode BroadcastAllBoundingBoxes(UserCtx *user, BoundingBox **bboxlist)</div><div class="ttdoc">Broadcasts the bounding box information collected on rank 0 to all other ranks.</div><div class="ttdef"><b>Definition:</b> <a href="grid_8c_source.html#l00965">grid.c:965</a></div></div>
<div class="ttc" id="avariables_8h_html_aa483a3664f2eca9684bf3efbec8da1aa"><div class="ttname"><a href="variables_8h.html#aa483a3664f2eca9684bf3efbec8da1aa">SimCtx::i_homo_filter</a></div><div class="ttdeci">PetscInt i_homo_filter</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00608">variables.h:608</a></div></div>
<div class="ttc" id="avariables_8h_html_a5fd8588302a68eca03d086e01e8972c1"><div class="ttname"><a href="variables_8h.html#a5fd8588302a68eca03d086e01e8972c1">UserCtx::jsc</a></div><div class="ttdeci">PetscInt jsc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00670">variables.h:670</a></div></div>
<div class="ttc" id="avariables_8h_html_a77888fe1930df923549faaf5951455ba"><div class="ttname"><a href="variables_8h.html#a77888fe1930df923549faaf5951455ba">UserCtx::Centx</a></div><div class="ttdeci">Vec Centx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00701">variables.h:701</a></div></div>
<div class="ttc" id="avariables_8h_html_a1c09604af49856ddc75bb32cd1b2a836"><div class="ttname"><a href="variables_8h.html#a1c09604af49856ddc75bb32cd1b2a836">SimCtx::angle</a></div><div class="ttdeci">PetscReal angle</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00584">variables.h:584</a></div></div>
<div class="ttc" id="avariables_8h_html_a5eedf611da6dd4f59cc65753b777b957"><div class="ttname"><a href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">SimCtx::np</a></div><div class="ttdeci">PetscInt np</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00612">variables.h:612</a></div></div>
<div class="ttc" id="avariables_8h_html_ab98a3518e774e7d3778c82c8d4e06e67"><div class="ttname"><a href="variables_8h.html#ab98a3518e774e7d3778c82c8d4e06e67">SimCtx::Croty</a></div><div class="ttdeci">PetscReal Croty</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00593">variables.h:593</a></div></div>
<div class="ttc" id="avariables_8h_html_a9285c06d5e6bee00c9061c27b2b73cb8"><div class="ttname"><a href="variables_8h.html#a9285c06d5e6bee00c9061c27b2b73cb8">SimCtx::MaxDivFlatArg</a></div><div class="ttdeci">PetscInt MaxDivFlatArg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00635">variables.h:635</a></div></div>
<div class="ttc" id="asetup_8c_html_a3766d23bad255474ff61d06fbb6f63f7"><div class="ttname"><a href="setup_8c.html#a3766d23bad255474ff61d06fbb6f63f7">SetupSolverParameters</a></div><div class="ttdeci">static PetscErrorCode SetupSolverParameters(SimCtx *simCtx)</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00588">setup.c:588</a></div></div>
<div class="ttc" id="avariables_8h_html_a98a90e3a55a0a0da6e392f44ebf50dad"><div class="ttname"><a href="variables_8h.html#a98a90e3a55a0a0da6e392f44ebf50dad">SimCtx::generate_grid</a></div><div class="ttdeci">PetscBool generate_grid</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00591">variables.h:591</a></div></div>
<div class="ttc" id="avariables_8h_html_a7dead9b6c11ee4a34d5bb1ae46b140c9"><div class="ttname"><a href="variables_8h.html#a7dead9b6c11ee4a34d5bb1ae46b140c9">UserCtx::RankCellInfoMap</a></div><div class="ttdeci">RankCellInfo * RankCellInfoMap</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00723">variables.h:723</a></div></div>
<div class="ttc" id="avariables_8h_html_af8df0703ce4dab73db61fa500a7c5f2b"><div class="ttname"><a href="variables_8h.html#af8df0703ce4dab73db61fa500a7c5f2b">UserCtx::Psi</a></div><div class="ttdeci">Vec Psi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00725">variables.h:725</a></div></div>
<div class="ttc" id="avariables_8h_html_ad6b708fb886f2f7b49f28d4466af5fa0"><div class="ttname"><a href="variables_8h.html#ad6b708fb886f2f7b49f28d4466af5fa0">UserCtx::KZet</a></div><div class="ttdeci">Vec KZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="avariables_8h_html_a090892cd5c5a867ca95c239ee24568be"><div class="ttname"><a href="variables_8h.html#a090892cd5c5a867ca95c239ee24568be">SimCtx::movefsi</a></div><div class="ttdeci">PetscInt movefsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00563">variables.h:563</a></div></div>
<div class="ttc" id="avariables_8h_html_a7a3f92059ddd489f41cd89dbcd2a1763"><div class="ttname"><a href="variables_8h.html#a7a3f92059ddd489f41cd89dbcd2a1763">SimCtx::max_cs</a></div><div class="ttdeci">PetscReal max_cs</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00607">variables.h:607</a></div></div>
<div class="ttc" id="asetup_8c_html_a4d7b90ec69412357cf8c38ea8f4e71f6"><div class="ttname"><a href="setup_8c.html#a4d7b90ec69412357cf8c38ea8f4e71f6">ComputeAndStoreNeighborRanks</a></div><div class="ttdeci">PetscErrorCode ComputeAndStoreNeighborRanks(UserCtx *user)</div><div class="ttdoc">Computes and stores the Cartesian neighbor ranks for the DMDA decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01567">setup.c:1567</a></div></div>
<div class="ttc" id="avariables_8h_html_abf6c288c1dbfb0530acf9490fd947f3b"><div class="ttname"><a href="variables_8h.html#abf6c288c1dbfb0530acf9490fd947f3b">SimCtx::dynamic_freq</a></div><div class="ttdeci">PetscInt dynamic_freq</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00606">variables.h:606</a></div></div>
<div class="ttc" id="avariables_8h_html_a7b2f9183b911937f0e19f2fbd6915c3f"><div class="ttname"><a href="variables_8h.html#a7b2f9183b911937f0e19f2fbd6915c3f">SimCtx::allowedFuncs</a></div><div class="ttdeci">char ** allowedFuncs</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00630">variables.h:630</a></div></div>
<div class="ttc" id="avariables_8h_html_a99a88d89d58073bd134175f62213c528"><div class="ttname"><a href="variables_8h.html#a99a88d89d58073bd134175f62213c528">UserCtx::thislevel</a></div><div class="ttdeci">PetscInt thislevel</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00716">variables.h:716</a></div></div>
<div class="ttc" id="avariables_8h_html_adb95ee773b807cc6ec5e19c725f72afb"><div class="ttname"><a href="variables_8h.html#adb95ee773b807cc6ec5e19c725f72afb">UserCtx::lNvert_o</a></div><div class="ttdeci">Vec lNvert_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00687">variables.h:687</a></div></div>
<div class="ttc" id="avariables_8h_html_ae7ba91fbb3aedec394bb9bf821740584"><div class="ttname"><a href="variables_8h.html#ae7ba91fbb3aedec394bb9bf821740584">SimCtx::imp_MAX_IT</a></div><div class="ttdeci">PetscInt imp_MAX_IT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00571">variables.h:571</a></div></div>
<div class="ttc" id="aio_8h_html_a5cc5e40cd538efc87ebd94ebdbb2a8e8"><div class="ttname"><a href="io_8h.html#a5cc5e40cd538efc87ebd94ebdbb2a8e8">ParseAllBoundaryConditions</a></div><div class="ttdeci">PetscErrorCode ParseAllBoundaryConditions(UserCtx *user, const char *bcs_input_filename)</div><div class="ttdoc">Parses the boundary conditions file to configure the type, handler, and any associated parameters for...</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00399">io.c:399</a></div></div>
<div class="ttc" id="avariables_8h_html_a494c23ca7d8b99ea8bdcd34d6c2b81a3"><div class="ttname"><a href="variables_8h.html#a494c23ca7d8b99ea8bdcd34d6c2b81a3">SimCtx::Crotz</a></div><div class="ttdeci">PetscReal Crotz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00593">variables.h:593</a></div></div>
<div class="ttc" id="avariables_8h_html_ad09da84b8a2e17ea5eae96dcb66c38aa"><div class="ttname"><a href="variables_8h.html#ad09da84b8a2e17ea5eae96dcb66c38aa">SimCtx::size</a></div><div class="ttdeci">PetscMPIInt size</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00542">variables.h:542</a></div></div>
<div class="ttc" id="avariables_8h_html_a3ff353812541b8ebba309e8d3ba6674b"><div class="ttname"><a href="variables_8h.html#a3ff353812541b8ebba309e8d3ba6674b">SimCtx::st</a></div><div class="ttdeci">PetscReal st</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="avariables_8h_html_a69966d928601d61d4f526636f84396c5"><div class="ttname"><a href="variables_8h.html#a69966d928601d61d4f526636f84396c5">UserCtx::fda</a></div><div class="ttdeci">DM fda</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00663">variables.h:663</a></div></div>
<div class="ttc" id="avariables_8h_html_a805f30aa6b217daa5ec56481577f71f8"><div class="ttname"><a href="variables_8h.html#a805f30aa6b217daa5ec56481577f71f8">SimCtx::mg_poItr</a></div><div class="ttdeci">PetscInt mg_poItr</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00573">variables.h:573</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00199">logging.h:199</a></div></div>
<div class="ttc" id="avariables_8h_html_aece7be3444e8a4a29db12c10e070dd9c"><div class="ttname"><a href="variables_8h.html#aece7be3444e8a4a29db12c10e070dd9c">SimCtx::ibm</a></div><div class="ttdeci">IBMNodes * ibm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00620">variables.h:620</a></div></div>
<div class="ttc" id="avariables_8h_html_a463c0299584d32311b5f290ee5f9597c"><div class="ttname"><a href="variables_8h.html#a463c0299584d32311b5f290ee5f9597c">SimCtx::testfilter_1d</a></div><div class="ttdeci">PetscInt testfilter_1d</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00608">variables.h:608</a></div></div>
<div class="ttc" id="avariables_8h_html_ae8527c7cba1c5764994053481722eb01"><div class="ttname"><a href="variables_8h.html#ae8527c7cba1c5764994053481722eb01">UserCtx::lJAj</a></div><div class="ttdeci">Vec lJAj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00703">variables.h:703</a></div></div>
<div class="ttc" id="avariables_8h_html_af05e9e68e0acf99ae030d44b905e33fb"><div class="ttname"><a href="variables_8h.html#af05e9e68e0acf99ae030d44b905e33fb">SimCtx::PostprocessingControlFile</a></div><div class="ttdeci">char PostprocessingControlFile[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00643">variables.h:643</a></div></div>
<div class="ttc" id="avariables_8h_html_structMGCtx"><div class="ttname"><a href="variables_8h.html#structMGCtx">MGCtx</a></div><div class="ttdoc">Context for Multigrid operations.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00426">variables.h:426</a></div></div>
<div class="ttc" id="avariables_8h_html_a0f1542afb8462493ca6e37c0285b3436"><div class="ttname"><a href="variables_8h.html#a0f1542afb8462493ca6e37c0285b3436">SimCtx::fish_c</a></div><div class="ttdeci">PetscInt fish_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a9f0c002a2c7cde3b6ac843ab9185f4d4"><div class="ttname"><a href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">Cmpnts::z</a></div><div class="ttdeci">PetscScalar z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables_8h_html_a508de73c1c5929cbee04a94091f2799e"><div class="ttname"><a href="variables_8h.html#a508de73c1c5929cbee04a94091f2799e">UserCtx::lKEta</a></div><div class="ttdeci">Vec lKEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="avariables_8h_html_structRankCellInfo"><div class="ttname"><a href="variables_8h.html#structRankCellInfo">RankCellInfo</a></div><div class="ttdoc">A lean struct to hold the global cell ownership range for a single MPI rank.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00183">variables.h:183</a></div></div>
<div class="ttc" id="avariables_8h_html_a1b08cdba1a7d4de048fbf472edfd5850"><div class="ttname"><a href="variables_8h.html#a1b08cdba1a7d4de048fbf472edfd5850">SimCtx::fish</a></div><div class="ttdeci">PetscInt fish</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a3bd5fc05f2098708e4e8fb142161add3"><div class="ttname"><a href="variables_8h.html#a3bd5fc05f2098708e4e8fb142161add3">SimCtx::max_angle</a></div><div class="ttdeci">PetscReal max_angle</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00584">variables.h:584</a></div></div>
<div class="ttc" id="avariables_8h_html_a413be1a878e86c9e5d54d52380822d2d"><div class="ttname"><a href="variables_8h.html#a413be1a878e86c9e5d54d52380822d2d">SimCtx::implicit</a></div><div class="ttdeci">PetscInt implicit</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00571">variables.h:571</a></div></div>
<div class="ttc" id="avariables_8h_html_a439159b21d7cef43314ba3334fa8383d"><div class="ttname"><a href="variables_8h.html#a439159b21d7cef43314ba3334fa8383d">UserCtx::Csi</a></div><div class="ttdeci">Vec Csi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_ae3ce8967b15c2e6be9e829b745da4090"><div class="ttname"><a href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">SimCtx::ParticleInitialization</a></div><div class="ttdeci">PetscInt ParticleInitialization</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00616">variables.h:616</a></div></div>
<div class="ttc" id="avariables_8h_html_a34e33d9993af3306ede1e2b45093c4b9"><div class="ttname"><a href="variables_8h.html#a34e33d9993af3306ede1e2b45093c4b9">SimCtx::dgf_az</a></div><div class="ttdeci">PetscInt dgf_az</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00565">variables.h:565</a></div></div>
<div class="ttc" id="avariables_8h_html_a52b4bfae9bf1813f3280faecb20cab0d"><div class="ttname"><a href="variables_8h.html#a52b4bfae9bf1813f3280faecb20cab0d">SimCtx::output_dir</a></div><div class="ttdeci">char output_dir[PETSC_MAX_PATH_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00559">variables.h:559</a></div></div>
<div class="ttc" id="avariables_8h_html_a4897d17394963da4ac73b9856fac48c5"><div class="ttname"><a href="variables_8h.html#a4897d17394963da4ac73b9856fac48c5">SimCtx::ren</a></div><div class="ttdeci">PetscReal ren</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="avariables_8h_html_acca07088dd652f1f01ed1f4eb8b1d4cc"><div class="ttname"><a href="variables_8h.html#acca07088dd652f1f01ed1f4eb8b1d4cc">SimCtx::testfilter_ik</a></div><div class="ttdeci">PetscInt testfilter_ik</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00608">variables.h:608</a></div></div>
<div class="ttc" id="avariables_8h_html_a3bfdfbc3022c8bc7f58ec9113275586f"><div class="ttname"><a href="variables_8h.html#a3bfdfbc3022c8bc7f58ec9113275586f">UserCtx::IEta</a></div><div class="ttdeci">Vec IEta</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_aa8f85a4a159853045094b4a018ac36dd"><div class="ttname"><a href="variables_8h.html#aa8f85a4a159853045094b4a018ac36dd">SimCtx::Flux_in</a></div><div class="ttdeci">PetscReal Flux_in</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00584">variables.h:584</a></div></div>
<div class="ttc" id="avariables_8h_html_a1efe628456af87df55800c7ffce30a24"><div class="ttname"><a href="variables_8h.html#a1efe628456af87df55800c7ffce30a24">RankNeighbors::rank_yp</a></div><div class="ttdeci">PetscMPIInt rank_yp</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00178">variables.h:178</a></div></div>
<div class="ttc" id="avariables_8h_html_aa1823d873982755996b7335f43732af4"><div class="ttname"><a href="variables_8h.html#aa1823d873982755996b7335f43732af4">UserCtx::Ucat</a></div><div class="ttdeci">Vec Ucat</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_a4d6a4d14075dd0718f49111d91c61e1d"><div class="ttname"><a href="variables_8h.html#a4d6a4d14075dd0718f49111d91c61e1d">RankCellInfo::zs_cell</a></div><div class="ttdeci">PetscInt zs_cell</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00184">variables.h:184</a></div></div>
<div class="ttc" id="avariables_8h_html_a823852c48e9bdaa32c354ae7b41f29d7"><div class="ttname"><a href="variables_8h.html#a823852c48e9bdaa32c354ae7b41f29d7">RankCellInfo::ym_cell</a></div><div class="ttdeci">PetscInt ym_cell</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00185">variables.h:185</a></div></div>
<div class="ttc" id="avariables_8h_html_a707859093eedbfdbcd1b61c3e58bd73d"><div class="ttname"><a href="variables_8h.html#a707859093eedbfdbcd1b61c3e58bd73d">SimCtx::cdisz</a></div><div class="ttdeci">PetscReal cdisz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00577">variables.h:577</a></div></div>
<div class="ttc" id="avariables_8h_html_a55ce12cdec83e590169b333b5dc84009"><div class="ttname"><a href="variables_8h.html#a55ce12cdec83e590169b333b5dc84009">SimCtx::StepsToRun</a></div><div class="ttdeci">PetscInt StepsToRun</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00549">variables.h:549</a></div></div>
<div class="ttc" id="avariables_8h_html_a912b5bb58c3db258fa468d66ead8d6fd"><div class="ttname"><a href="variables_8h.html#a912b5bb58c3db258fa468d66ead8d6fd">SimCtx::eel</a></div><div class="ttdeci">PetscInt eel</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a53b044b8b0e4a4dc8c8fa05387af564c"><div class="ttname"><a href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">SimCtx::dt</a></div><div class="ttdeci">PetscReal dt</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00552">variables.h:552</a></div></div>
<div class="ttc" id="avariables_8h_html_a95078248cc49ce19d5d05b14e1701888"><div class="ttname"><a href="variables_8h.html#a95078248cc49ce19d5d05b14e1701888">UserCtx::lP</a></div><div class="ttdeci">Vec lP</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_a6a60d593b5ef4747e9c7eb086e91c75a"><div class="ttname"><a href="variables_8h.html#a6a60d593b5ef4747e9c7eb086e91c75a">SimCtx::mg_MAX_IT</a></div><div class="ttdeci">PetscInt mg_MAX_IT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00573">variables.h:573</a></div></div>
<div class="ttc" id="avariables_8h_html_a7a1cf0e107351a96b27ae00160e60271"><div class="ttname"><a href="variables_8h.html#a7a1cf0e107351a96b27ae00160e60271">UserCtx::lPhi</a></div><div class="ttdeci">Vec lPhi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00684">variables.h:684</a></div></div>
<div class="ttc" id="avariables_8h_html_a05c02891978b9f09aff6f2f6b0a636fe"><div class="ttname"><a href="variables_8h.html#a05c02891978b9f09aff6f2f6b0a636fe">SimCtx::fishcyl</a></div><div class="ttdeci">PetscInt fishcyl</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_aa0f10efbfba88094aa07cee1cdb0baff"><div class="ttname"><a href="variables_8h.html#aa0f10efbfba88094aa07cee1cdb0baff">UserCtx::lKCsi</a></div><div class="ttdeci">Vec lKCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="avariables_8h_html_a677188b3aedc7e7d0331e43f8f37ad02"><div class="ttname"><a href="variables_8h.html#a677188b3aedc7e7d0331e43f8f37ad02">SimCtx::ratio</a></div><div class="ttdeci">PetscReal ratio</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00602">variables.h:602</a></div></div>
<div class="ttc" id="avariables_8h_html_a9d4d4331609e84f21e3668e6f4746d2c"><div class="ttname"><a href="variables_8h.html#a9d4d4331609e84f21e3668e6f4746d2c">SimCtx::nAllowed</a></div><div class="ttdeci">PetscInt nAllowed</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00631">variables.h:631</a></div></div>
<div class="ttc" id="avariables_8h_html_a414751d7a391a78834cdce87b52a066f"><div class="ttname"><a href="variables_8h.html#a414751d7a391a78834cdce87b52a066f">UserCtx::lZet</a></div><div class="ttdeci">Vec lZet</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_a04b7e7d757be63c56b7b26068f24dda6"><div class="ttname"><a href="variables_8h.html#a04b7e7d757be63c56b7b26068f24dda6">UserCtx::Aj</a></div><div class="ttdeci">Vec Aj</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="avariables_8h_html_a7af448f97fbebfd44e5989614b982a93"><div class="ttname"><a href="variables_8h.html#a7af448f97fbebfd44e5989614b982a93">SimCtx::invicid</a></div><div class="ttdeci">PetscInt invicid</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00564">variables.h:564</a></div></div>
<div class="ttc" id="avariables_8h_html_a4020eb5a53d6a827a93f000bfb09cd6f"><div class="ttname"><a href="variables_8h.html#a4020eb5a53d6a827a93f000bfb09cd6f">SimCtx::tiout</a></div><div class="ttdeci">PetscInt tiout</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00550">variables.h:550</a></div></div>
<div class="ttc" id="avariables_8h_html_a585521a5dbb55ae244e34a354ac93e3f"><div class="ttname"><a href="variables_8h.html#a585521a5dbb55ae244e34a354ac93e3f">UserCtx::Ucat_nodal</a></div><div class="ttdeci">Vec Ucat_nodal</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00730">variables.h:730</a></div></div>
<div class="ttc" id="avariables_8h_html_a97b91f798c877756e4a9aae26853bb2c"><div class="ttname"><a href="variables_8h.html#a97b91f798c877756e4a9aae26853bb2c">SimCtx::CMz_c</a></div><div class="ttdeci">PetscReal CMz_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="avariables_8h_html_a361610227b8cc6afe449d5faf982a347"><div class="ttname"><a href="variables_8h.html#a361610227b8cc6afe449d5faf982a347">SimCtx::CMy_c</a></div><div class="ttdeci">PetscReal CMy_c</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="avariables_8h_html_ac12eb831808e07c80a03e393a986f93f"><div class="ttname"><a href="variables_8h.html#ac12eb831808e07c80a03e393a986f93f">SimCtx::U_bc</a></div><div class="ttdeci">PetscReal U_bc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00600">variables.h:600</a></div></div>
<div class="ttc" id="avariables_8h_html_addaea1781031d3f9ff945d87e8c5b728"><div class="ttname"><a href="variables_8h.html#addaea1781031d3f9ff945d87e8c5b728">UserCtx::Centy</a></div><div class="ttdeci">Vec Centy</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00701">variables.h:701</a></div></div>
<div class="ttc" id="avariables_8h_html_a337c3a9a9bf061e10d71ba990aa6ed29"><div class="ttname"><a href="variables_8h.html#a337c3a9a9bf061e10d71ba990aa6ed29">SimCtx::StartTime</a></div><div class="ttdeci">PetscReal StartTime</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00551">variables.h:551</a></div></div>
<div class="ttc" id="avariables_8h_html_a19272b97c7c160d257dbe0fc8da2f2d8"><div class="ttname"><a href="variables_8h.html#a19272b97c7c160d257dbe0fc8da2f2d8">RankCellInfo::xs_cell</a></div><div class="ttdeci">PetscInt xs_cell</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00184">variables.h:184</a></div></div>
<div class="ttc" id="avariables_8h_html_a9693ebf5c9ea601d5ebaf6d24cc60721"><div class="ttname"><a href="variables_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">UserCtx::lCsi</a></div><div class="ttdeci">Vec lCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00700">variables.h:700</a></div></div>
<div class="ttc" id="asetup_8c_html_a25ce912d8aafa319a8c915cd350c7322"><div class="ttname"><a href="setup_8c.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a></div><div class="ttdeci">PetscErrorCode GetGhostedCellRange(const DMDALocalInfo *info_nodes, const RankNeighbors *neighbors, PetscInt dim, PetscInt *xs_cell_global_out, PetscInt *xm_cell_local_out)</div><div class="ttdoc">Gets the global cell range for a rank, including boundary cells.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01522">setup.c:1522</a></div></div>
<div class="ttc" id="avariables_8h_html_ada60dbb4f918fda297a992a4228b1166"><div class="ttname"><a href="variables_8h.html#ada60dbb4f918fda297a992a4228b1166">UserCtx::KCsi</a></div><div class="ttdeci">Vec KCsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00704">variables.h:704</a></div></div>
<div class="ttc" id="alogging_8h_html_ac4f5428199f6cd908056ad3e0ead934f"><div class="ttname"><a href="logging_8h.html#ac4f5428199f6cd908056ad3e0ead934f">ProfilingInitialize</a></div><div class="ttdeci">PetscErrorCode ProfilingInitialize(SimCtx *simCtx)</div><div class="ttdoc">Initializes the custom profiling system using configuration from SimCtx.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00974">logging.c:974</a></div></div>
<div class="ttc" id="avariables_8h_html_a04c849d5fadc93b99bd328df1b90adce"><div class="ttname"><a href="variables_8h.html#a04c849d5fadc93b99bd328df1b90adce">SimCtx::turbine</a></div><div class="ttdeci">PetscInt turbine</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00568">variables.h:568</a></div></div>
<div class="ttc" id="avariables_8h_html_a7be157e6d32861b8732814e08ce17ae2"><div class="ttname"><a href="variables_8h.html#a7be157e6d32861b8732814e08ce17ae2">UserCtx::lUcont_o</a></div><div class="ttdeci">Vec lUcont_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00687">variables.h:687</a></div></div>
<div class="ttc" id="avariables_8h_html_acbf784310453bd7aec02838cdef24a66"><div class="ttname"><a href="variables_8h.html#acbf784310453bd7aec02838cdef24a66">UserCtx::lICsi</a></div><div class="ttdeci">Vec lICsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00702">variables.h:702</a></div></div>
<div class="ttc" id="avariables_8h_html_aca7ff63d94b0fbd2d541734b7200b0e2"><div class="ttname"><a href="variables_8h.html#aca7ff63d94b0fbd2d541734b7200b0e2">SimCtx::AreaOutSum</a></div><div class="ttdeci">PetscReal AreaOutSum</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00599">variables.h:599</a></div></div>
<div class="ttc" id="avariables_8h_html_a57873ffd9532be40cdf7aa76955b5d61"><div class="ttname"><a href="variables_8h.html#a57873ffd9532be40cdf7aa76955b5d61">SimCtx::k_periodic</a></div><div class="ttdeci">PetscInt k_periodic</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00590">variables.h:590</a></div></div>
<div class="ttc" id="avariables_8h_html_a6174aa2a9e98d6a6aa1d332aa58f0ffe"><div class="ttname"><a href="variables_8h.html#a6174aa2a9e98d6a6aa1d332aa58f0ffe">MGCtx::thislevel</a></div><div class="ttdeci">PetscInt thislevel</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00428">variables.h:428</a></div></div>
<div class="ttc" id="avariables_8h_html_a86567855ecf1fbc638287ad7040ab55a"><div class="ttname"><a href="variables_8h.html#a86567855ecf1fbc638287ad7040ab55a">SimCtx::k_homo_filter</a></div><div class="ttdeci">PetscInt k_homo_filter</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00608">variables.h:608</a></div></div>
<div class="ttc" id="avariables_8h_html_afff98e471314dce8cc7a2b55e536431f"><div class="ttname"><a href="variables_8h.html#afff98e471314dce8cc7a2b55e536431f">SimCtx::fsi</a></div><div class="ttdeci">FSInfo * fsi</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00622">variables.h:622</a></div></div>
<div class="ttc" id="avariables_8h_html_ac503944447b87fc650e0ffa74a780b36"><div class="ttname"><a href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">SimCtx::InitialConstantContra</a></div><div class="ttdeci">Cmpnts InitialConstantContra</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00579">variables.h:579</a></div></div>
<div class="ttc" id="avariables_8h_html_a03772da847da737415fd5a86a97147bd"><div class="ttname"><a href="variables_8h.html#a03772da847da737415fd5a86a97147bd">UserCtx::isc</a></div><div class="ttdeci">PetscInt isc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00670">variables.h:670</a></div></div>
<div class="ttc" id="alogging_8h_html_ace99f3e207ccb2e46e9b782f9e57732e"><div class="ttname"><a href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a></div><div class="ttdeci">#define PROFILE_FUNCTION_BEGIN</div><div class="ttdoc">Marks the beginning of a profiled code block (typically a function).</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00722">logging.h:722</a></div></div>
<div class="ttc" id="avariables_8h_html_a483945572b5ab1461a864ee1e3eb1d37"><div class="ttname"><a href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">SimCtx::FieldInitialization</a></div><div class="ttdeci">PetscInt FieldInitialization</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00578">variables.h:578</a></div></div>
<div class="ttc" id="avariables_8h_html_ab7d6dffd5a35c03211c65aca209c909e"><div class="ttname"><a href="variables_8h.html#ab7d6dffd5a35c03211c65aca209c909e">UserCtx::Nvert_o</a></div><div class="ttdeci">Vec Nvert_o</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00687">variables.h:687</a></div></div>
<div class="ttc" id="avariables_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00663">variables.h:663</a></div></div>
<div class="ttc" id="avariables_8h_html_a4008d732ef13f23af3139d500f629624"><div class="ttname"><a href="variables_8h.html#a4008d732ef13f23af3139d500f629624">SimCtx::duplicate</a></div><div class="ttdeci">PetscInt duplicate</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00624">variables.h:624</a></div></div>
<div class="ttc" id="avariables_8h_html_ab4811dc3ebc8ea1154e75c8c38639259"><div class="ttname"><a href="variables_8h.html#ab4811dc3ebc8ea1154e75c8c38639259">SimCtx::central</a></div><div class="ttdeci">PetscInt central</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00576">variables.h:576</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="setup_8c.html">setup.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
