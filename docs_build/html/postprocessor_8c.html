<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PICurv: postprocessor.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PICurv
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">A Parallel Particle-In-Cell Solver for Curvilinear LES</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('postprocessor_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">postprocessor.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Phase 2 implementation of the post-processing tool.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="postprocessor_8h_source.html">postprocessor.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for postprocessor.c:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="postprocessor_8c__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="postprocessor_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;SetupPostProcessSwarm&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;EulerianDataProcessingPipeline&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;WriteEulerianFile&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;ParticleDataProcessingPipeline&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;WriteParticleFile&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ae60511a9aa5cbf216a00a1bb81006bc5">__FUNCT__</a>&#160;&#160;&#160;&quot;main&quot;</td></tr>
<tr class="separator:ae60511a9aa5cbf216a00a1bb81006bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3854bbfeab13a489af2f23b95b456d2"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#ac3854bbfeab13a489af2f23b95b456d2">SetupPostProcessSwarm</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *pps)</td></tr>
<tr class="memdesc:ac3854bbfeab13a489af2f23b95b456d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new, dedicated DMSwarm for post-processing tasks.  <a href="postprocessor_8c.html#ac3854bbfeab13a489af2f23b95b456d2">More...</a><br /></td></tr>
<tr class="separator:ac3854bbfeab13a489af2f23b95b456d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059ce04ba04e66a5f1ef982fdf375e80"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#a059ce04ba04e66a5f1ef982fdf375e80">EulerianDataProcessingPipeline</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *pps)</td></tr>
<tr class="memdesc:a059ce04ba04e66a5f1ef982fdf375e80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the processing pipeline string from the config and executes the requested kernels in sequence.  <a href="postprocessor_8c.html#a059ce04ba04e66a5f1ef982fdf375e80">More...</a><br /></td></tr>
<tr class="separator:a059ce04ba04e66a5f1ef982fdf375e80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06bd0048200cbc80db1d02bc5d276a8f"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#a06bd0048200cbc80db1d02bc5d276a8f">WriteEulerianFile</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *pps, PetscInt ti)</td></tr>
<tr class="memdesc:a06bd0048200cbc80db1d02bc5d276a8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Orchestrates the writing of a combined, multi-field VTK file for a single time step.  <a href="postprocessor_8c.html#a06bd0048200cbc80db1d02bc5d276a8f">More...</a><br /></td></tr>
<tr class="separator:a06bd0048200cbc80db1d02bc5d276a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5866209129dc3d2532fb7905777079af"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#a5866209129dc3d2532fb7905777079af">ParticleDataProcessingPipeline</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *pps)</td></tr>
<tr class="memdesc:a5866209129dc3d2532fb7905777079af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses and executes the particle pipeline using a robust two-pass approach.  <a href="postprocessor_8c.html#a5866209129dc3d2532fb7905777079af">More...</a><br /></td></tr>
<tr class="separator:a5866209129dc3d2532fb7905777079af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90f52cd32d5560474c4892cf669c6ef8"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#a90f52cd32d5560474c4892cf669c6ef8">WriteParticleFile</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, <a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *pps, PetscInt ti)</td></tr>
<tr class="memdesc:a90f52cd32d5560474c4892cf669c6ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes particle data to a VTP file using the Prepare-Write-Cleanup pattern.  <a href="postprocessor_8c.html#a90f52cd32d5560474c4892cf669c6ef8">More...</a><br /></td></tr>
<tr class="separator:a90f52cd32d5560474c4892cf669c6ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="postprocessor_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Phase 2 implementation of the post-processing tool. </p>
<p>This phase introduces a dedicated configuration system and performs a single-step data load to verify the I/O and data structures. </p>

<p class="definition">Definition in file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;SetupPostProcessSwarm&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00603">603</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;EulerianDataProcessingPipeline&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00603">603</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;WriteEulerianFile&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00603">603</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;ParticleDataProcessingPipeline&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00603">603</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;WriteParticleFile&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00603">603</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>

</div>
</div>
<a id="ae60511a9aa5cbf216a00a1bb81006bc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60511a9aa5cbf216a00a1bb81006bc5">&#9670;&nbsp;</a></span>__FUNCT__ <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FUNCT__&#160;&#160;&#160;&quot;main&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00603">603</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac3854bbfeab13a489af2f23b95b456d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3854bbfeab13a489af2f23b95b456d2">&#9670;&nbsp;</a></span>SetupPostProcessSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetupPostProcessSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *&#160;</td>
          <td class="paramname"><em>pps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new, dedicated DMSwarm for post-processing tasks. </p>
<p>This function is called once at startup. It creates an empty DMSwarm and associates it with the same grid DM as the primary swarm and registers all the required fields. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> where user-&gt;post_swarm will be created. </td></tr>
    <tr><td class="paramname">pps</td><td>The <a class="el" href="variables_8h.html#structPostProcessParams" title="Holds all configuration parameters for a post-processing run.">PostProcessParams</a> containing the particle_pipeline string for field registration. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00023">23</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">char</span> *pipeline_copy, *step_token, *step_saveptr;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    PetscBool finalize_needed = PETSC_FALSE;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    ierr = DMCreate(PETSC_COMM_WORLD, &amp;user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    ierr = DMSetType(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>, DMSWARM); CHKERRQ(ierr);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    ierr = DMSetDimension(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>, 3); CHKERRQ(ierr);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    ierr = DMSwarmSetType(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>, DMSWARM_BASIC); CHKERRQ(ierr);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// Associate it with the same grid as the solver&#39;s swarm</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;     <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      ierr = DMSwarmSetCellDM(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>, user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Associated DMSwarm with Cell DM (user-&gt;da).\n&quot;</span>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="comment">// If user-&gt;da is essential for your simulation logic with particles, this should be a fatal error.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;user-&gt;da (Cell DM for Swarm) is NULL. Cell-based swarm operations might fail.\n&quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="comment">// SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONGSTATE, &quot;CreateParticleSwarm - user-&gt;da (Cell DM) is NULL but required.&quot;);</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Created dedicated DMSwarm for post-processing.\n&quot;</span>);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot; --- Setting up Post-Processing Pipeline fields-- \n&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    ierr = PetscStrallocpy(pps-&gt;<a class="code" href="variables_8h.html#a99bf6d0fb65651a6049015b2b4fe12a8">particle_pipeline</a>, &amp;pipeline_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    step_token = strtok_r(pipeline_copy, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">while</span> (step_token) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(step_token);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordflow">if</span> (strlen(step_token) == 0) { step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordtype">char</span> *keyword = strtok(step_token, <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordtype">char</span> *args_str = strtok(NULL, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(keyword);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        PetscInt output_field_dimensions = 1; <span class="comment">// Default to scalar output fields</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">if</span> (strcasecmp(keyword, <span class="stringliteral">&quot;ComputeSpecificKE&quot;</span>) == 0) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">if</span> (!args_str) SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;Error (ComputeSpecificKE): Missing arguments.&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <span class="keywordtype">char</span> *inputs_str = strtok(args_str, <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            <span class="keywordtype">char</span> *output_field = strtok(NULL, <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            output_field_dimensions = 1;  <span class="comment">// SKE is scalar</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keywordflow">if</span> (!output_field) SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;Error (ComputeSpecificKE): Missing output field in &#39;in&gt;out&#39; syntax.&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(output_field);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="comment">// Register the output field</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            ierr = <a class="code" href="ParticleSwarm_8h.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>, output_field, output_field_dimensions,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Registered particle field &#39;%s&#39; (ComputeSpecificKE).\n&quot;</span>, output_field);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            finalize_needed = PETSC_TRUE;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Warning: Unknown particle transformation keyword &#39;%s&#39;. Skipping.\n&quot;</span>, keyword);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">// Add other &#39;else if&#39; blocks here for other kernels that create output fields</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    } <span class="comment">// while step_token</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    ierr = PetscFree(pipeline_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// --- FINALIZE STEP ---</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span> (finalize_needed) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Finalizing new field registrations for particle pipeline.\n&quot;</span>);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        ierr = DMSwarmFinalizeFieldRegister(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Post-Processing DMSwarm setup complete.\n&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_ac3854bbfeab13a489af2f23b95b456d2_cgraph.svg" width="392" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_ac3854bbfeab13a489af2f23b95b456d2_icgraph.svg" width="296" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a059ce04ba04e66a5f1ef982fdf375e80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a059ce04ba04e66a5f1ef982fdf375e80">&#9670;&nbsp;</a></span>EulerianDataProcessingPipeline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode EulerianDataProcessingPipeline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *&#160;</td>
          <td class="paramname"><em>pps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the processing pipeline string from the config and executes the requested kernels in sequence. </p>
<p>Parses the processing pipeline string and executes the requested kernels.</p>
<p>This function uses a general-purpose parser to handle a syntax of the form: "Keyword1:in1&gt;out1; Keyword2:in1,in2&gt;out2; Keyword3:arg1;"</p>
<p>It tokenizes the pipeline string and dispatches to the appropriate kernel function from processing_kernels.c with the specified field name arguments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> containing the data to be transformed. </td></tr>
    <tr><td class="paramname">pps</td><td>The <a class="el" href="variables_8h.html#structPostProcessParams" title="Holds all configuration parameters for a post-processing run.">PostProcessParams</a> struct containing the pipeline string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00110">110</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">char</span> *pipeline_copy, *step_token, *step_saveptr;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Starting Data Transformation Pipeline ---\n&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// Do nothing if the pipeline string is empty</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (pps-&gt;<a class="code" href="variables_8h.html#ab589b17f1c36d62817d4b17ec0a53f4a">process_pipeline</a>[0] == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Processing pipeline is empty. No transformations will be run.\n&quot;</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Pipeline string: [%s]\n&quot;</span>, pps-&gt;<a class="code" href="variables_8h.html#ab589b17f1c36d62817d4b17ec0a53f4a">process_pipeline</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// Make a writable copy for strtok_r, as it modifies the string</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ierr = PetscStrallocpy(pps-&gt;<a class="code" href="variables_8h.html#ab589b17f1c36d62817d4b17ec0a53f4a">process_pipeline</a>, &amp;pipeline_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// --- Outer Loop: Tokenize by Semicolon (;) to get each processing step ---</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    step_token = strtok_r(pipeline_copy, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">while</span> (step_token) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(step_token);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (strlen(step_token) == 0) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordtype">char</span> *keyword = strtok(step_token, <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordtype">char</span> *args_str = strtok(NULL, <span class="stringliteral">&quot;&quot;</span>); <span class="comment">// Get the rest of the string as arguments</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span> (!keyword) { <span class="comment">// Should not happen with TrimWhitespace, but is a safe check</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(keyword);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (args_str) <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(args_str);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Executing Transformation: &#39;%s&#39; on args: &#39;%s&#39;\n&quot;</span>, keyword, args_str ? args_str : <span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// --- DISPATCHER: Route to the correct kernel based on the keyword ---</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (strcasecmp(keyword, <span class="stringliteral">&quot;CellToNodeAverage&quot;</span>) == 0) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">if</span> (!args_str) SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;CellToNodeAverage requires arguments in &#39;in_field&gt;out_field&#39; format.&quot;</span>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordtype">char</span> *in_field = strtok(args_str, <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordtype">char</span> *out_field = strtok(NULL, <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">if</span> (!in_field || !out_field) SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;CellToNodeAverage requires &#39;in&gt;out&#39; syntax (e.g., P&gt;P_nodal).&quot;</span>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(in_field); <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(out_field);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            ierr = <a class="code" href="postprocessing__kernels_8h.html#ad5b0c0f1721b13944b83a57f2471cd02">ComputeNodalAverage</a>(user, in_field, out_field); CHKERRQ(ierr);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(keyword, <span class="stringliteral">&quot;ComputeQCriterion&quot;</span>) == 0) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            ierr = <a class="code" href="postprocessing__kernels_8h.html#a303c5afb89d6fdaab3e40f9371d8f1b2">ComputeQCriterion</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(keyword, <span class="stringliteral">&quot;NormalizeRelativeField&quot;</span>) == 0) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (!args_str) SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;NormalizePressure requires the pressure field name (e.g., &#39;P&#39;) as an argument.&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            ierr = <a class="code" href="postprocessing__kernels_8h.html#a86d13bca79c1355ce808509a999a1d88">NormalizeRelativeField</a>(user, args_str); CHKERRQ(ierr);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">// *** Add new kernels here in the future using &#39;else if&#39; ***</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// else if (strcasecmp(keyword, &quot;ComputeVorticity&quot;) == 0) { ... }</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown transformation keyword &#39;%s&#39;. Skipping.\n&quot;</span>, keyword);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    ierr = PetscFree(pipeline_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Data Transformation Pipeline Complete ---\n&quot;</span>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a059ce04ba04e66a5f1ef982fdf375e80_cgraph.svg" width="100%" height="442"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a059ce04ba04e66a5f1ef982fdf375e80_icgraph.svg" width="342" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a06bd0048200cbc80db1d02bc5d276a8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06bd0048200cbc80db1d02bc5d276a8f">&#9670;&nbsp;</a></span>WriteEulerianFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteEulerianFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *&#160;</td>
          <td class="paramname"><em>pps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Orchestrates the writing of a combined, multi-field VTK file for a single time step. </p>
<p>This function is the primary driver for generating output. It performs these steps:</p><ol type="1">
<li>Prepares the subsampled coordinate array required for the legacy grid format.</li>
<li>Parses the user-requested list of fields from the configuration.</li>
<li>For each field, prepares a corresponding subsampled data array.</li>
<li>Assembles all prepared arrays into a single <a class="el" href="variables_8h.html#structVTKMetaData">VTKMetaData</a> struct.</li>
<li>Calls the low-level VTK writer to generate the final .vts file.</li>
<li>Frees all temporary memory allocated during the preparation phase.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> for the finest grid level. </td></tr>
    <tr><td class="paramname">pps</td><td>The post-processing configuration struct. </td></tr>
    <tr><td class="paramname">ti</td><td>The current time step index. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00186">186</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="variables_8h.html#structVTKMetaData">VTKMetaData</a>    meta;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">char</span>           filename[<a class="code" href="variables_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">if</span> (pps-&gt;<a class="code" href="variables_8h.html#a835edfe1a83c23f4e7708f5134ff02fb">output_fields_instantaneous</a>[0] == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;No instantaneous fields requested for output at ti=%&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;. Skipping.\n&quot;</span>, ti);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Starting VTK File Writing for ti = %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; ---\n&quot;</span>, ti);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">/* 1) Metadata init */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    ierr = PetscMemzero(&amp;meta, <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structVTKMetaData">VTKMetaData</a>)); CHKERRQ(ierr);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    meta.<a class="code" href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">fileType</a> = <a class="code" href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">/* 2) Coordinates (subsampled interior) */</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    ierr = <a class="code" href="vtk__io_8h.html#a53beb8d06e750522a2381c7666c5011c">PrepareOutputCoordinates</a>(user, &amp;meta.<a class="code" href="variables_8h.html#aac5e5bdffa985d12e89f4d6f742a2442">coords</a>, &amp;meta.<a class="code" href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">mx</a>, &amp;meta.<a class="code" href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">my</a>, &amp;meta.<a class="code" href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">mz</a>, &amp;meta.<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Using coords linearization order: fast=i mid=j slow=k  (sizes: %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; x %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; x %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;)\n&quot;</span>,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;              meta.<a class="code" href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">mx</a>, meta.<a class="code" href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">my</a>, meta.<a class="code" href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">mz</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">/* 3) Fields (rank 0) */</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a> == 0) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <span class="keywordtype">char</span> *fields_copy, *field_name;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        ierr = PetscStrallocpy(pps-&gt;<a class="code" href="variables_8h.html#a835edfe1a83c23f4e7708f5134ff02fb">output_fields_instantaneous</a>, &amp;fields_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        field_name = strtok(fields_copy, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">while</span> (field_name) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(field_name);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">if</span> (!*field_name) { field_name = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Preparing field &#39;%s&#39; for output.\n&quot;</span>, field_name);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            Vec       field_vec = NULL;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            PetscInt  num_components = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> (!strcasecmp(field_name, <span class="stringliteral">&quot;P_nodal&quot;</span>)) {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                field_vec = user-&gt;<a class="code" href="variables_8h.html#a0d09ddf5e31ea3cfcab2c6bbc59b64cd">P_nodal</a>; num_components = 1;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(field_name, <span class="stringliteral">&quot;Ucat_nodal&quot;</span>)) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                field_vec = user-&gt;<a class="code" href="variables_8h.html#a585521a5dbb55ae244e34a354ac93e3f">Ucat_nodal</a>; num_components = 3;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcasecmp(field_name, <span class="stringliteral">&quot;Qcrit&quot;</span>)) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                field_vec = user-&gt;<a class="code" href="variables_8h.html#a70969e8333ab8fd8eb60acc1f22f830a">Qcrit</a>;    num_components = 1;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Field &#39;%s&#39; not recognized. Skipping.\n&quot;</span>, field_name);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                field_name = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">if</span> (meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a> &gt;= <a class="code" href="variables_8h.html#a10a62bce766452804bad64d119e127f7">MAX_POINT_DATA_FIELDS</a>) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;MAX_POINT_DATA_FIELDS reached. Cannot add &#39;%s&#39;.\n&quot;</span>, field_name);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                field_name = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">// --- Add field to metadata ---</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <a class="code" href="variables_8h.html#structVTKFieldInfo">VTKFieldInfo</a>* current_field = &amp;meta.<a class="code" href="variables_8h.html#abaea0779cfa9cbf3b161de4eb5d49898">point_data_fields</a>[meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a>];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            strncpy(current_field-&gt;<a class="code" href="variables_8h.html#aa9925ca2ed729970c0fe25a333c6087e">name</a>, field_name, <a class="code" href="variables_8h.html#af429c472ad06c2094bc8d598231b2e0a">MAX_VTK_FIELD_NAME_LENGTH</a>-1);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            current_field-&gt;<a class="code" href="variables_8h.html#aa9925ca2ed729970c0fe25a333c6087e">name</a>[<a class="code" href="variables_8h.html#af429c472ad06c2094bc8d598231b2e0a">MAX_VTK_FIELD_NAME_LENGTH</a>-1] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            current_field-&gt;<a class="code" href="variables_8h.html#a1676e73c74586290cada1e0b922cb7fc">num_components</a> = num_components;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">/* Build interior AoS from NATURAL gathered Vec */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            ierr = <a class="code" href="vtk__io_8h.html#a20704fac26a2ed14228875d307f002aa">PrepareOutputEulerianFieldData</a>(user, field_vec, num_components, &amp;current_field-&gt;<a class="code" href="variables_8h.html#a877a36998969b27c4dee8db5c746b76c">data</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">            // *** DEBUG: Dump Ucat_nodal details and add scalar companions Ux, Uy, Uz for easier visualization ***</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">            </span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">            // If this is Ucat_nodal, dump a few tuples and add scalar companions </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">            if (!strcasecmp(field_name, &quot;Ucat_nodal&quot;)) {</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">                const PetscInt npts = meta.npoints;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">                const PetscScalar *a = (const PetscScalar*)current_field-&gt;data;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">                LOG_ALLOW(GLOBAL, LOG_INFO, &quot;DBG Ucat_nodal: ptr=%p  npoints=%&quot; PetscInt_FMT &quot;  num_components=%&quot; PetscInt_FMT &quot;\n&quot;,</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">                          (void*)a, npts, current_field-&gt;num_components);</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">                if (a &amp;&amp; current_field-&gt;num_components == 3 &amp;&amp; npts &gt; 0) {</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">                    const PetscInt nshow = (npts &lt; 5) ? npts : 5;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">                    LOG_ALLOW(GLOBAL, LOG_INFO, &quot;DBG Ucat_nodal: showing first %d of %&quot; PetscInt_FMT &quot; tuples (AoS x,y,z):\n&quot;,</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">                              (int)nshow, npts);</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">                    for (PetscInt t = 0; t &lt; nshow; ++t) {</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">                        LOG_ALLOW(GLOBAL, LOG_INFO, &quot;  Ucat_nodal[%3&quot; PetscInt_FMT &quot;] = (%g, %g, %g)\n&quot;,</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">                                  t, (double)a[3*t+0], (double)a[3*t+1], (double)a[3*t+2]);</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">                    }</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">                    if (npts &gt; 10) {</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">                        PetscInt mid = npts / 2;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">                        LOG_ALLOW(GLOBAL, LOG_INFO, &quot;  Ucat_nodal[mid=%&quot; PetscInt_FMT &quot;] = (%g, %g, %g)\n&quot;,</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">                                  mid, (double)a[3*mid+0], (double)a[3*mid+1], (double)a[3*mid+2]);</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">                    }</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">                    // Add scalar companions from the AoS we just created </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">                    PetscScalar *Ux=NULL,*Uy=NULL,*Uz=NULL;</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">                    ierr = PetscMalloc1(meta.npoints, &amp;Ux); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">                    ierr = PetscMalloc1(meta.npoints, &amp;Uy); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">                    ierr = PetscMalloc1(meta.npoints, &amp;Uz); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">                    for (PetscInt i = 0; i &lt; meta.npoints; ++i) {</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">                        Ux[i] = a[3*i+0]; Uy[i] = a[3*i+1]; Uz[i] = a[3*i+2];</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">                    }</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">                    if (meta.num_point_data_fields + 3 &lt;= MAX_POINT_DATA_FIELDS) {</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">                        VTKFieldInfo *fx = &amp;meta.point_data_fields[++meta.num_point_data_fields];</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">                        strncpy(fx-&gt;name, &quot;Ux_debug&quot;, MAX_VTK_FIELD_NAME_LENGTH-1);</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">                        fx-&gt;name[MAX_VTK_FIELD_NAME_LENGTH-1] = &#39;\0&#39;;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">                        fx-&gt;num_components = 1; fx-&gt;data = Ux;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">                        VTKFieldInfo *fy = &amp;meta.point_data_fields[++meta.num_point_data_fields];</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">                        strncpy(fy-&gt;name, &quot;Uy_debug&quot;, MAX_VTK_FIELD_NAME_LENGTH-1);</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">                        fy-&gt;name[MAX_VTK_FIELD_NAME_LENGTH-1] = &#39;\0&#39;;</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">                        fy-&gt;num_components = 1; fy-&gt;data = Uy;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">                        VTKFieldInfo *fz = &amp;meta.point_data_fields[++meta.num_point_data_fields];</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">                        strncpy(fz-&gt;name, &quot;Uz_debug&quot;, MAX_VTK_FIELD_NAME_LENGTH-1);</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">                        fz-&gt;name[MAX_VTK_FIELD_NAME_LENGTH-1] = &#39;\0&#39;;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">                        fz-&gt;num_components = 1; fz-&gt;data = Uz;</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">                        LOG_ALLOW(GLOBAL, LOG_INFO, &quot;DBG: Added scalar companions Ux_debug, Uy_debug, Uz_debug.\n&quot;);</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">                    } else {</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">                        LOG_ALLOW(GLOBAL, LOG_WARNING, &quot;DBG: Not enough slots to add Ux/Uy/Uz debug fields.\n&quot;);</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">                        PetscFree(Ux); PetscFree(Uy); PetscFree(Uz);</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">                    }</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">                    // Mid-plane CSV + AoS vs NATURAL compare (component X) </span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">                    </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">                    // Gather NATURAL again (small cost, but isolated and clear) </span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">                    PetscInt   Ng = 0;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">                    double    *nat_d = NULL;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">                    DM         dmU = NULL;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">                    DMDALocalInfo infU;</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">                    ierr = VecGetDM(field_vec, &amp;dmU); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">                    ierr = DMDAGetLocalInfo(dmU, &amp;infU); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">                    const PetscInt M=infU.mx, N=infU.my, P=infU.mz;</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">                    const PetscInt mx = meta.mx, my = meta.my, mz = meta.mz;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">                    const PetscInt iInnerMid = mx/2; // interior index [0..mx-1] </span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">                    const PetscInt iGlob     = iInnerMid;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">                    ierr = VecToArrayOnRank0(field_vec, &amp;Ng, &amp;nat_d); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">                    if (nat_d) {</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">                        const PetscScalar *nar = (const PetscScalar*)nat_d;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">                        const char *base = pps-&gt;output_prefix;</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">                        char fn[512], fnc[512];</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">                        snprintf(fn,  sizeof(fn),  &quot;%s_%05&quot; PetscInt_FMT &quot;_iMid.csv&quot;,       base, ti);</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">                        snprintf(fnc, sizeof(fnc), &quot;%s_%05&quot; PetscInt_FMT &quot;_iMid_compare.csv&quot;, base, ti);</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">                        FILE *fp  = fopen(fn,  &quot;w&quot;);</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">                        FILE *fpc = fopen(fnc, &quot;w&quot;);</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">                        if (fp)  fprintf(fp,  &quot;jInner,kInner,Ux,Uy,Uz\n&quot;);</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">                        if (fpc) fprintf(fpc, &quot;jInner,kInner,Ux_AoS,Ux_NAT,abs_diff\n&quot;);</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">                        double maxAbsDiff = 0.0, sumAbs = 0.0;</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">                        PetscInt count = 0;</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">                        for (PetscInt kInner = 0; kInner &lt; mz; ++kInner) {</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">                            const PetscInt k = kInner;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">                            for (PetscInt jInner = 0; jInner &lt; my; ++jInner) {</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">                                const PetscInt j = jInner;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">                                // AoS tuple index </span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">                                const PetscInt t = iInnerMid + mx * (jInner + my * kInner);</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">                                const PetscScalar ux = a[3*t+0], uy = a[3*t+1], uz = a[3*t+2];</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">                                if (fp) fprintf(fp, &quot;%d,%d,%.15e,%.15e,%.15e\n&quot;,</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">                                                (int)jInner,(int)kInner,(double)ux,(double)uy,(double)uz);</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">                                // NATURAL base for (iGlob,j,k) </span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">                                const PetscInt baseNat = 3 * (((k)*N + j)*M + iGlob);</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">                                const PetscScalar uxN = nar[baseNat + 0];</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">                                const double diff = fabs((double)ux - (double)uxN);</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">                                if (diff &gt; maxAbsDiff) maxAbsDiff = diff;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">                                sumAbs += diff; ++count;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">                                if (fpc) fprintf(fpc, &quot;%d,%d,%.15e,%.15e,%.15e\n&quot;,</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">                                                    (int)jInner,(int)kInner,(double)ux,(double)uxN,diff);</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">                            } // for jInner</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">                        } // for kInner</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">                        if (fp)  fclose(fp);</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">                        if (fpc) fclose(fpc);</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">                        if (count &gt; 0) {</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">                            const double meanAbs = sumAbs / (double)count;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">                            LOG_ALLOW(GLOBAL, LOG_INFO,</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">                                        &quot;PETSc-Vec vs AoS (i-mid, Ux): max||=%.6e, mean||=%.6e  -&gt; CSV: %s\n&quot;,</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">                                        maxAbsDiff, meanAbs, fnc);</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">                            LOG_ALLOW(GLOBAL, LOG_INFO, &quot;Wrote i-mid plane CSV: %s\n&quot;, fn);</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">                        } // if count&gt;0</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">                        ierr = PetscFree(nat_d); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">                        </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">                        </span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">                    } // if nat_d</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">                } // if a &amp;&amp; num_components==3 &amp;&amp; npts&gt;0</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">            } // if Ucat_nodal        </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">            // --- END DEBUG BLOCK (Ucat_nodal) ---</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a>++; <span class="comment">/* count the main field we just added */</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            field_name = strtok(NULL, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        ierr = PetscFree(fields_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// --- DEBUG: Add sanity fields i_idx, j_idx, k_idx and x_pos, y_pos, z_pos ---</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">// These are the logical indices and physical coordinates of each point in the subsampled grid.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// They can be used to verify the grid structure and orientation in visualization tools.</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// They are added as scalar fields with names &quot;i_idx&quot;, &quot;j_idx&quot;, &quot;k_idx&quot; and &quot;x_pos&quot;, &quot;y_pos&quot;, &quot;z_pos&quot;.</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">// Note: these are only added if there is room in the MAX_POINT_DATA_FIELDS limit.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">// They are allocated and owned here, and will be freed below.</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// They are in the same linearization order as meta.coords (AoS x,y,z by point).</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">        // Append sanity fields i/j/k indices and coordinates </span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">        // Build i/j/k and x/y/z (length = npoints); these match the same linearization as coords </span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">        const PetscInt n = meta.npoints;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">        PetscScalar *i_idx=NULL,*j_idx=NULL,*k_idx=NULL,*x_pos=NULL,*y_pos=NULL,*z_pos=NULL;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">        ierr = PetscMalloc1(n, &amp;i_idx); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">        ierr = PetscMalloc1(n, &amp;j_idx); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">        ierr = PetscMalloc1(n, &amp;k_idx); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">        ierr = PetscMalloc1(n, &amp;x_pos); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">        ierr = PetscMalloc1(n, &amp;y_pos); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">        ierr = PetscMalloc1(n, &amp;z_pos); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">        // coords is length 3*n, AoS: (x,y,z) by point </span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">        const PetscScalar *c = (const PetscScalar*)meta.coords;</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">        for (PetscInt k = 0; k &lt; meta.mz; ++k) {</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">            for (PetscInt j = 0; j &lt; meta.my; ++j) {</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">                for (PetscInt i = 0; i &lt; meta.mx; ++i) {</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">                    const PetscInt t = i + meta.mx * (j + meta.my * k);</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">                    i_idx[t] = (PetscScalar)i;</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">                    j_idx[t] = (PetscScalar)j;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">                    k_idx[t] = (PetscScalar)k;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">                    x_pos[t] = c[3*t+0];</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">                    y_pos[t] = c[3*t+1];</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">                    z_pos[t] = c[3*t+2];</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">                }</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">        const char *nf[6] = {&quot;i_idx&quot;,&quot;j_idx&quot;,&quot;k_idx&quot;,&quot;x_pos&quot;,&quot;y_pos&quot;,&quot;z_pos&quot;};</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">        PetscScalar *arrs[6] = {i_idx,j_idx,k_idx,x_pos,y_pos,z_pos};</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">        for (int s=0; s&lt;6; ++s) {</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">            if (meta.num_point_data_fields &lt; MAX_POINT_DATA_FIELDS) {</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">                VTKFieldInfo *f = &amp;meta.point_data_fields[meta.num_point_data_fields++];</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">                strncpy(f-&gt;name, nf[s], MAX_VTK_FIELD_NAME_LENGTH-1);</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">                f-&gt;name[MAX_VTK_FIELD_NAME_LENGTH-1] = &#39;\0&#39;;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">                f-&gt;num_components = 1;</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">                f-&gt;data = arrs[s];</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">            } else {</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">                LOG_ALLOW(GLOBAL, LOG_WARNING, &quot;Sanity field &#39;%s&#39; dropped: MAX_POINT_DATA_FIELDS reached.\n&quot;, nf[s]);</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">                PetscFree(arrs[s]);</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">        LOG_ALLOW(GLOBAL, LOG_INFO, &quot;DBG: Added sanity fields i_idx/j_idx/k_idx and x_pos/y_pos/z_pos.\n&quot;);</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="comment">// --- END DEBUG BLOCK (sanity fields) ---</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">/* Field summary */</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;PointData fields to write: %d\n&quot;</span>, (<span class="keywordtype">int</span>)meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">for</span> (PetscInt ii=0; ii&lt;meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a>; ++ii) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  # %2&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;  Field Name = %s  Components = %d\n&quot;</span>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                      ii, meta.<a class="code" href="variables_8h.html#abaea0779cfa9cbf3b161de4eb5d49898">point_data_fields</a>[ii].<a class="code" href="variables_8h.html#aa9925ca2ed729970c0fe25a333c6087e">name</a>, (<span class="keywordtype">int</span>)meta.<a class="code" href="variables_8h.html#abaea0779cfa9cbf3b161de4eb5d49898">point_data_fields</a>[ii].<a class="code" href="variables_8h.html#a1676e73c74586290cada1e0b922cb7fc">num_components</a>);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    } <span class="comment">// if rank 0</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">/* 4) Write the VTS */</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;%s_%05&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;.vts&quot;</span>, pps-&gt;<a class="code" href="variables_8h.html#a3a5ab7e0a0271c6cec0e2150f9beb1d4">output_prefix</a>, ti);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    ierr = <a class="code" href="io_8h.html#ad4eeaada0c8227f332499bf5fc4d3bc0">CreateVTKFileFromMetadata</a>(filename, &amp;meta, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Eulerian File Writing for ti = %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; Complete ---\n&quot;</span>, ti);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a06bd0048200cbc80db1d02bc5d276a8f_cgraph.svg" width="624" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a06bd0048200cbc80db1d02bc5d276a8f_icgraph.svg" width="246" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5866209129dc3d2532fb7905777079af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5866209129dc3d2532fb7905777079af">&#9670;&nbsp;</a></span>ParticleDataProcessingPipeline()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ParticleDataProcessingPipeline </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *&#160;</td>
          <td class="paramname"><em>pps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses and executes the particle pipeline using a robust two-pass approach. </p>
<p>This function ensures correctness and efficiency by separating field registration from kernel execution.</p>
<p>PASS 1 (Registration): The pipeline string is parsed to identify all new fields that will be created. These fields are registered with the DMSwarm.</p>
<p>Finalize: After Pass 1, DMSwarmFinalizeFieldRegister is called exactly once if any new fields were added, preparing the swarm's memory layout.</p>
<p>PASS 2 (Execution): The pipeline string is parsed again, and this time the actual compute kernels are executed, filling the now-valid fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> containing the DMSwarm. </td></tr>
    <tr><td class="paramname">pps</td><td>The <a class="el" href="variables_8h.html#structPostProcessParams" title="Holds all configuration parameters for a post-processing run.">PostProcessParams</a> struct containing the particle_pipeline string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00486">486</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;{</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordtype">char</span> *pipeline_copy, *step_token, *step_saveptr;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// --- Timestep Setup: Synchronize post_swarm size ---</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    PetscInt n_global_source;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    ierr = DMSwarmGetSize(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, &amp;n_global_source); CHKERRQ(ierr);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// Resize post_swarm to match source swarm</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    ierr = <a class="code" href="ParticleMotion_8h.html#a38b5e7348bc556d505e2c4b31c29b086">ResizeSwarmGlobally</a>(user-&gt;<a class="code" href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">post_swarm</a>, n_global_source); CHKERRQ(ierr);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (pps-&gt;<a class="code" href="variables_8h.html#a99bf6d0fb65651a6049015b2b4fe12a8">particle_pipeline</a>[0] == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Starting Particle Data Transformation Pipeline ---\n&quot;</span>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Particle Pipeline string: [%s]\n&quot;</span>, pps-&gt;<a class="code" href="variables_8h.html#a99bf6d0fb65651a6049015b2b4fe12a8">particle_pipeline</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Executing compute kernels...\n&quot;</span>);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    ierr = PetscStrallocpy(pps-&gt;<a class="code" href="variables_8h.html#a99bf6d0fb65651a6049015b2b4fe12a8">particle_pipeline</a>, &amp;pipeline_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    step_token = strtok_r(pipeline_copy, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">while</span> (step_token) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(step_token);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span> (strlen(step_token) == 0) { step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr); <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">char</span> *keyword = strtok(step_token, <span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordtype">char</span> *args_str = strtok(NULL, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(keyword);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">if</span> (args_str) <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(args_str);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Executing Particle Transformation: &#39;%s&#39; on args: &#39;%s&#39;\n&quot;</span>, keyword, args_str ? args_str : <span class="stringliteral">&quot;None&quot;</span>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">if</span> (strcasecmp(keyword, <span class="stringliteral">&quot;ComputeSpecificKE&quot;</span>) == 0) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordtype">char</span> *velocity_field = strtok(args_str, <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="keywordtype">char</span> *ske_field = strtok(NULL, <span class="stringliteral">&quot;&gt;&quot;</span>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(velocity_field); <a class="code" href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a>(ske_field);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            ierr = <a class="code" href="postprocessing__kernels_8h.html#a37ee1aa2e642bbfd24a6faf33a92568c">ComputeSpecificKE</a>(user, velocity_field, ske_field); CHKERRQ(ierr);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;             <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Unknown particle transformation keyword &#39;%s&#39;. Skipping.\n&quot;</span>, keyword);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        step_token = strtok_r(NULL, <span class="stringliteral">&quot;;&quot;</span>, &amp;step_saveptr);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    ierr = PetscFree(pipeline_copy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Particle Data Transformation Pipeline Complete ---\n&quot;</span>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a5866209129dc3d2532fb7905777079af_cgraph.svg" width="447" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a5866209129dc3d2532fb7905777079af_icgraph.svg" width="338" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a90f52cd32d5560474c4892cf669c6ef8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90f52cd32d5560474c4892cf669c6ef8">&#9670;&nbsp;</a></span>WriteParticleFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode WriteParticleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *&#160;</td>
          <td class="paramname"><em>pps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>ti</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes particle data to a VTP file using the Prepare-Write-Cleanup pattern. </p>

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00549">549</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;{</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="variables_8h.html#structVTKMetaData">VTKMetaData</a>    part_meta;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">char</span>           filename[<a class="code" href="variables_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a>];</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    PetscInt       n_total_particles_before_subsample;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// These checks can be done on all ranks</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (!pps-&gt;<a class="code" href="variables_8h.html#ab954ff749a6b034b8cef53a508787b24">outputParticles</a> || pps-&gt;<a class="code" href="variables_8h.html#ab90d5feaf7cfd59b75da0132d620bf25">particle_fields</a>[0] == <span class="charliteral">&#39;\0&#39;</span>) {</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    PetscInt n_global;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    ierr = DMSwarmGetSize(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, &amp;n_global); CHKERRQ(ierr);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> (n_global == 0) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Swarm is empty for ti=%&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;. Skipping particle file write.\n&quot;</span>, ti);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        PetscFunctionReturn(0);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    ierr = PetscMemzero(&amp;part_meta, <span class="keyword">sizeof</span>(<a class="code" href="variables_8h.html#structVTKMetaData">VTKMetaData</a>)); CHKERRQ(ierr);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="comment">// --- 1. PREPARE (Collective Call) ---</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    ierr = <a class="code" href="vtk__io_8h.html#af1bf47e0b45318d43a97d2bdbf766888">PrepareOutputParticleData</a>(user, pps, &amp;part_meta, &amp;n_total_particles_before_subsample); CHKERRQ(ierr);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// --- 2. WRITE and CLEANUP (Rank 0 only) ---</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a> == 0) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span> (part_meta.<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a> &gt; 0) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Starting VTP Particle File Writing for ti = %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; (writing %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; of %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; particles) ---\n&quot;</span>,</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                      ti, part_meta.<a class="code" href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">npoints</a>, n_total_particles_before_subsample);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="comment">/* Field summary */</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Particle Data fields to write: %d\n&quot;</span>, (<span class="keywordtype">int</span>)part_meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">for</span> (PetscInt ii=0; ii&lt;part_meta.<a class="code" href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">num_point_data_fields</a>; ++ii) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;  # %2&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;  Field Name = %s  Components = %d\n&quot;</span>,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                          ii, part_meta.<a class="code" href="variables_8h.html#abaea0779cfa9cbf3b161de4eb5d49898">point_data_fields</a>[ii].<a class="code" href="variables_8h.html#aa9925ca2ed729970c0fe25a333c6087e">name</a>, (<span class="keywordtype">int</span>)part_meta.<a class="code" href="variables_8h.html#abaea0779cfa9cbf3b161de4eb5d49898">point_data_fields</a>[ii].<a class="code" href="variables_8h.html#a1676e73c74586290cada1e0b922cb7fc">num_components</a>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;%s_%05&quot;</span> PetscInt_FMT <span class="stringliteral">&quot;.vtp&quot;</span>, pps-&gt;<a class="code" href="variables_8h.html#a191105bdbbd1711ea3f5fd59b0d1b582">particle_output_prefix</a>, ti);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            ierr = <a class="code" href="io_8h.html#ad4eeaada0c8227f332499bf5fc4d3bc0">CreateVTKFileFromMetadata</a>(filename, &amp;part_meta, PETSC_COMM_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;No particles to write at ti=%&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; after subsampling. Skipping.\n&quot;</span>, ti);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        }</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Particle File Writing for ti = %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; Complete ---\n&quot;</span>, ti);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a90f52cd32d5560474c4892cf669c6ef8_cgraph.svg" width="648" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a90f52cd32d5560474c4892cf669c6ef8_icgraph.svg" width="242" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="postprocessor_8c_source.html#l00604">604</a> of file <a class="el" href="postprocessor_8c_source.html">postprocessor.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    PetscErrorCode    ierr;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a>            *simCtx = NULL;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// === I. INITIALIZE PETSC &amp; MPI ===========================================</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    ierr = PetscInitialize(&amp;argc, &amp;argv, (<span class="keywordtype">char</span> *)0, <span class="stringliteral">&quot;Unified Post-Processing Tool&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// === II. CONFIGURE SIMULATION &amp; POST-PROCESSING CONTEXTS =================</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    ierr = <a class="code" href="setup_8h.html#a977df65dac293c1308451334cb198693">CreateSimulationContext</a>(argc, argv, &amp;simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// === IIA. SET EXECUTION MODE (SOLVER vs POST-PROCESSOR) =====</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    simCtx-&gt;<a class="code" href="variables_8h.html#ae27e734d789eb2f07918d6bae3969480">exec_mode</a> = <a class="code" href="variables_8h.html#ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f">EXEC_MODE_POSTPROCESSOR</a>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// === III. SETUP GRID &amp; DATA STRUCTURES ===================================</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    ierr = <a class="code" href="setup_8h.html#a2be2815aeb79afe9b95caf39c7b3312c">SetupGridAndSolvers</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// === IV. SETUP DOMAIN DECOMPOSITION INFORMATION =========================</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    ierr = <a class="code" href="setup_8h.html#a1c08bf327e1aee897c56610a89f75814">SetupDomainRankInfo</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// === V. SETUP BOUNDARY CONDITIONS ====================================</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    ierr = <a class="code" href="setup_8h.html#ad9f399b16547eba3244159f7136a1eb9">SetupBoundaryConditions</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// === VI. SETUP USER CONTEXT &amp; DATA STRUCTURES ============================</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="comment">// Get the finest-level user context, as this is where we&#39;ll load data</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a> *user = simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>[simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a>-1].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <a class="code" href="variables_8h.html#structPostProcessParams">PostProcessParams</a> *pps = simCtx-&gt;<a class="code" href="variables_8h.html#acf6d729ae4d0d996d6b056ccc5438995">pps</a>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">// === VI. PARTICLE INITIALIZATION (if needed) ============================</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span>(pps-&gt;<a class="code" href="variables_8h.html#ab954ff749a6b034b8cef53a508787b24">outputParticles</a>) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a> &gt; 0){</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            ierr = <a class="code" href="ParticleSwarm_8h.html#ada215a5db25227a8fd2cd2596e7d3e57">InitializeParticleSwarm</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="comment">// Create a post-processing specific DMSwarm</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            ierr = <a class="code" href="postprocessor_8c.html#ac3854bbfeab13a489af2f23b95b456d2">SetupPostProcessSwarm</a>(user,pps); CHKERRQ(ierr);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            SETERRQ(PETSC_COMM_SELF,1,<span class="stringliteral">&quot;Particle output requested but np=0. Please set np&gt;0 to enable particle output.&quot;</span>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;=============================================================\n&quot;</span>);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// === VII. MAIN POST-PROCESSING LOOP ======================================</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">for</span> (PetscInt ti = pps-&gt;<a class="code" href="variables_8h.html#ae3da627fc17587b06d6c2a737ff6442c">startTime</a>; ti &lt;= pps-&gt;endTime; ti += pps-&gt;<a class="code" href="variables_8h.html#a5dca17e57a0f1464e2442f0c2452d497">timeStep</a>) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;--- Processing Time Step %&quot;</span> PetscInt_FMT <span class="stringliteral">&quot; ---\n&quot;</span>, ti);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <span class="comment">// 1. Load Data (UpdateLocalGhosts is called inside the kernels)</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        ierr = <a class="code" href="io_8h.html#a3a009dabc71ccfa59f196e1bc045de45">ReadSimulationFields</a>(user, ti); CHKERRQ(ierr);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="comment">// 2. Transform Data</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        ierr = <a class="code" href="postprocessor_8c.html#a059ce04ba04e66a5f1ef982fdf375e80">EulerianDataProcessingPipeline</a>(user, pps); CHKERRQ(ierr);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="comment">// 3. Write Output</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        ierr = <a class="code" href="postprocessor_8c.html#a06bd0048200cbc80db1d02bc5d276a8f">WriteEulerianFile</a>(user, pps, ti); CHKERRQ(ierr);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">if</span>(pps-&gt;<a class="code" href="variables_8h.html#ab954ff749a6b034b8cef53a508787b24">outputParticles</a>) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="comment">// 1. Resize swarm based on particle count in this timestep&#39;s file</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            ierr = <a class="code" href="ParticleMotion_8h.html#ae0c7489fc52fda6c92cd1f22c3f50c38">PreCheckAndResizeSwarm</a>(user, ti, pps-&gt;<a class="code" href="variables_8h.html#ad573ddfd2513e325b1e795bc81ed38a0">particleExt</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="comment">// 2. Load particle data into the correctly sized swarm</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            ierr = <a class="code" href="io_8h.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a>(user, ti); CHKERRQ(ierr);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;            <span class="comment">// 3. Transform particle data</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            ierr = <a class="code" href="postprocessor_8c.html#a5866209129dc3d2532fb7905777079af">ParticleDataProcessingPipeline</a>(user, pps); CHKERRQ(ierr);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;            <span class="comment">// 4. Write particle output</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;           ierr = <a class="code" href="postprocessor_8c.html#a90f52cd32d5560474c4892cf669c6ef8">WriteParticleFile</a>(user, pps, ti); CHKERRQ(ierr);            </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a> == 0){</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;            PetscInt StepsToRun = pps-&gt;<a class="code" href="variables_8h.html#a76d29089d00d89348f32bbf0e2981497">endTime</a> - pps-&gt;<a class="code" href="variables_8h.html#ae3da627fc17587b06d6c2a737ff6442c">startTime</a>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            PetscReal currentTime = (PetscReal)ti*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            <a class="code" href="logging_8h.html#a7d73ab7b1517a3c8256b2447f88b633e">PrintProgressBar</a>(ti-1,pps-&gt;<a class="code" href="variables_8h.html#ae3da627fc17587b06d6c2a737ff6442c">startTime</a>,StepsToRun,currentTime);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a>()&gt;<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>)PetscPrintf(PETSC_COMM_SELF,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// After the loop, print the 100% complete bar on rank 0 and add a newline</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// to ensure subsequent terminal output starts on a fresh line.</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">rank</a> == 0) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        PetscInt endTime = pps-&gt;<a class="code" href="variables_8h.html#a76d29089d00d89348f32bbf0e2981497">endTime</a>-1; <span class="comment">// needs to be verified.</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        PetscInt StepsToRun = pps-&gt;<a class="code" href="variables_8h.html#a76d29089d00d89348f32bbf0e2981497">endTime</a> - pps-&gt;<a class="code" href="variables_8h.html#ae3da627fc17587b06d6c2a737ff6442c">startTime</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        PetscReal endTimeValue = (PetscReal)pps-&gt;<a class="code" href="variables_8h.html#a76d29089d00d89348f32bbf0e2981497">endTime</a>*simCtx-&gt;<a class="code" href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">dt</a>;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="logging_8h.html#a7d73ab7b1517a3c8256b2447f88b633e">PrintProgressBar</a>(endTime, pps-&gt;<a class="code" href="variables_8h.html#ae3da627fc17587b06d6c2a737ff6442c">startTime</a>, StepsToRun, endTimeValue);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        PetscPrintf(PETSC_COMM_SELF, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        fflush(stdout);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;=============================================================\n&quot;</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Post-processing finished successfully.\n&quot;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// === VIII. FINALIZE =========================================================</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;   <span class="comment">// ierr = FinalizeSimulation(simCtx); CHKERRQ(ierr);</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    ierr = <a class="code" href="logging_8h.html#a626ae56f8d677ce7fb2234056b47cc0a">ProfilingFinalize</a>(simCtx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    ierr = PetscFinalize();</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">return</span> ierr;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="postprocessor_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="avariables_8h_html_ae3da627fc17587b06d6c2a737ff6442c"><div class="ttname"><a href="variables_8h.html#ae3da627fc17587b06d6c2a737ff6442c">PostProcessParams::startTime</a></div><div class="ttdeci">PetscInt startTime</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00457">variables.h:457</a></div></div>
<div class="ttc" id="avariables_8h_html_aa9925ca2ed729970c0fe25a333c6087e"><div class="ttname"><a href="variables_8h.html#aa9925ca2ed729970c0fe25a333c6087e">VTKFieldInfo::name</a></div><div class="ttdeci">char name[64]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00485">variables.h:485</a></div></div>
<div class="ttc" id="avariables_8h_html_aac8e0dd714804b073dbb32c0ad84b2eb"><div class="ttname"><a href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">UserMG::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00434">variables.h:434</a></div></div>
<div class="ttc" id="avariables_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00660">variables.h:660</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="aParticleMotion_8h_html_a38b5e7348bc556d505e2c4b31c29b086"><div class="ttname"><a href="ParticleMotion_8h.html#a38b5e7348bc556d505e2c4b31c29b086">ResizeSwarmGlobally</a></div><div class="ttdeci">PetscErrorCode ResizeSwarmGlobally(DM swarm, PetscInt N_target)</div><div class="ttdef"><b>Definition:</b> <a href="ParticleMotion_8c_source.html#l00749">ParticleMotion.c:749</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a></div><div class="ttdeci">@ LOG_WARNING</div><div class="ttdoc">Non-critical issues that warrant attention.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00030">logging.h:30</a></div></div>
<div class="ttc" id="alogging_8h_html_a626ae56f8d677ce7fb2234056b47cc0a"><div class="ttname"><a href="logging_8h.html#a626ae56f8d677ce7fb2234056b47cc0a">ProfilingFinalize</a></div><div class="ttdeci">PetscErrorCode ProfilingFinalize(SimCtx *simCtx)</div><div class="ttdoc">the profiling excercise and build a profiling summary which is then printed to a log file.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l01082">logging.c:1082</a></div></div>
<div class="ttc" id="avariables_8h_html_ab90d5feaf7cfd59b75da0132d620bf25"><div class="ttname"><a href="variables_8h.html#ab90d5feaf7cfd59b75da0132d620bf25">PostProcessParams::particle_fields</a></div><div class="ttdeci">char particle_fields[1024]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00468">variables.h:468</a></div></div>
<div class="ttc" id="avariables_8h_html_a99bf6d0fb65651a6049015b2b4fe12a8"><div class="ttname"><a href="variables_8h.html#a99bf6d0fb65651a6049015b2b4fe12a8">PostProcessParams::particle_pipeline</a></div><div class="ttdeci">char particle_pipeline[1024]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00467">variables.h:467</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00538">variables.h:538</a></div></div>
<div class="ttc" id="avariables_8h_html_ab954ff749a6b034b8cef53a508787b24"><div class="ttname"><a href="variables_8h.html#ab954ff749a6b034b8cef53a508787b24">PostProcessParams::outputParticles</a></div><div class="ttdeci">PetscBool outputParticles</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00460">variables.h:460</a></div></div>
<div class="ttc" id="avariables_8h_html_a191105bdbbd1711ea3f5fd59b0d1b582"><div class="ttname"><a href="variables_8h.html#a191105bdbbd1711ea3f5fd59b0d1b582">PostProcessParams::particle_output_prefix</a></div><div class="ttdeci">char particle_output_prefix[256]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00469">variables.h:469</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="avariables_8h_html_ab589b17f1c36d62817d4b17ec0a53f4a"><div class="ttname"><a href="variables_8h.html#ab589b17f1c36d62817d4b17ec0a53f4a">PostProcessParams::process_pipeline</a></div><div class="ttdeci">char process_pipeline[1024]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00463">variables.h:463</a></div></div>
<div class="ttc" id="avariables_8h_html_a1284d7ce4801cbe00fa3068be7682014"><div class="ttname"><a href="variables_8h.html#a1284d7ce4801cbe00fa3068be7682014">VTKMetaData::npoints</a></div><div class="ttdeci">PetscInt npoints</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00499">variables.h:499</a></div></div>
<div class="ttc" id="avariables_8h_html_ad573ddfd2513e325b1e795bc81ed38a0"><div class="ttname"><a href="variables_8h.html#ad573ddfd2513e325b1e795bc81ed38a0">PostProcessParams::particleExt</a></div><div class="ttdeci">char particleExt[8]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00474">variables.h:474</a></div></div>
<div class="ttc" id="avariables_8h_html_a3a5ab7e0a0271c6cec0e2150f9beb1d4"><div class="ttname"><a href="variables_8h.html#a3a5ab7e0a0271c6cec0e2150f9beb1d4">PostProcessParams::output_prefix</a></div><div class="ttdeci">char output_prefix[256]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00466">variables.h:466</a></div></div>
<div class="ttc" id="aio_8h_html_ad4eeaada0c8227f332499bf5fc4d3bc0"><div class="ttname"><a href="io_8h.html#ad4eeaada0c8227f332499bf5fc4d3bc0">CreateVTKFileFromMetadata</a></div><div class="ttdeci">PetscInt CreateVTKFileFromMetadata(const char *filename, const VTKMetaData *meta, MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="vtk__io_8c_source.html#l00128">vtk_io.c:128</a></div></div>
<div class="ttc" id="avariables_8h_html_afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9"><div class="ttname"><a href="variables_8h.html#afef259795cd298f0d543f574536e4dd7a5ff970d3dd377697deacd371681babd9">VTK_STRUCTURED</a></div><div class="ttdeci">@ VTK_STRUCTURED</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00492">variables.h:492</a></div></div>
<div class="ttc" id="alogging_8h_html_a5fe7257f46131945aacf9a35e9de5874"><div class="ttname"><a href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a></div><div class="ttdeci">#define PROFILE_FUNCTION_END</div><div class="ttdoc">Marks the end of a profiled code block.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00731">logging.h:731</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a></div><div class="ttdeci">@ LOG_ERROR</div><div class="ttdoc">Critical errors that may halt the program.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00029">logging.h:29</a></div></div>
<div class="ttc" id="aio_8h_html_a61850e757fea41eb461a930936c34401"><div class="ttname"><a href="io_8h.html#a61850e757fea41eb461a930936c34401">TrimWhitespace</a></div><div class="ttdeci">void TrimWhitespace(char *str)</div><div class="ttdoc">Helper function to trim leading/trailing whitespace from a string.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00036">io.c:36</a></div></div>
<div class="ttc" id="avariables_8h_html_a5dca17e57a0f1464e2442f0c2452d497"><div class="ttname"><a href="variables_8h.html#a5dca17e57a0f1464e2442f0c2452d497">PostProcessParams::timeStep</a></div><div class="ttdeci">PetscInt timeStep</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00459">variables.h:459</a></div></div>
<div class="ttc" id="avariables_8h_html_a2377e3556c5d9c4d9b208e8e4d66d04b"><div class="ttname"><a href="variables_8h.html#a2377e3556c5d9c4d9b208e8e4d66d04b">VTKMetaData::num_point_data_fields</a></div><div class="ttdeci">PetscInt num_point_data_fields</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00502">variables.h:502</a></div></div>
<div class="ttc" id="apostprocessor_8c_html_a90f52cd32d5560474c4892cf669c6ef8"><div class="ttname"><a href="postprocessor_8c.html#a90f52cd32d5560474c4892cf669c6ef8">WriteParticleFile</a></div><div class="ttdeci">PetscErrorCode WriteParticleFile(UserCtx *user, PostProcessParams *pps, PetscInt ti)</div><div class="ttdoc">Writes particle data to a VTP file using the Prepare-Write-Cleanup pattern.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessor_8c_source.html#l00549">postprocessor.c:549</a></div></div>
<div class="ttc" id="avariables_8h_html_a0d09ddf5e31ea3cfcab2c6bbc59b64cd"><div class="ttname"><a href="variables_8h.html#a0d09ddf5e31ea3cfcab2c6bbc59b64cd">UserCtx::P_nodal</a></div><div class="ttdeci">Vec P_nodal</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00729">variables.h:729</a></div></div>
<div class="ttc" id="avariables_8h_html_ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f"><div class="ttname"><a href="variables_8h.html#ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f">EXEC_MODE_POSTPROCESSOR</a></div><div class="ttdeci">@ EXEC_MODE_POSTPROCESSOR</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00512">variables.h:512</a></div></div>
<div class="ttc" id="avariables_8h_html_structUserCtx"><div class="ttname"><a href="variables_8h.html#structUserCtx">UserCtx</a></div><div class="ttdoc">User-defined context containing data specific to a single computational grid level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00657">variables.h:657</a></div></div>
<div class="ttc" id="alogging_8h_html_a7d73ab7b1517a3c8256b2447f88b633e"><div class="ttname"><a href="logging_8h.html#a7d73ab7b1517a3c8256b2447f88b633e">PrintProgressBar</a></div><div class="ttdeci">void PrintProgressBar(PetscInt step, PetscInt startStep, PetscInt totalSteps, PetscReal currentTime)</div><div class="ttdoc">Prints a progress bar to the console.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l01183">logging.c:1183</a></div></div>
<div class="ttc" id="avtk__io_8h_html_a53beb8d06e750522a2381c7666c5011c"><div class="ttname"><a href="vtk__io_8h.html#a53beb8d06e750522a2381c7666c5011c">PrepareOutputCoordinates</a></div><div class="ttdeci">PetscErrorCode PrepareOutputCoordinates(UserCtx *user, PetscScalar **out_coords, PetscInt *out_nx, PetscInt *out_ny, PetscInt *out_nz, PetscInt *out_npoints)</div><div class="ttdoc">Creates a C array of coordinates corresponding to a subsampled (legacy-style) grid.</div><div class="ttdef"><b>Definition:</b> <a href="vtk__io_8c_source.html#l00223">vtk_io.c:223</a></div></div>
<div class="ttc" id="avariables_8h_html_structVTKMetaData"><div class="ttname"><a href="variables_8h.html#structVTKMetaData">VTKMetaData</a></div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00496">variables.h:496</a></div></div>
<div class="ttc" id="asetup_8h_html_a1c08bf327e1aee897c56610a89f75814"><div class="ttname"><a href="setup_8h.html#a1c08bf327e1aee897c56610a89f75814">SetupDomainRankInfo</a></div><div class="ttdeci">PetscErrorCode SetupDomainRankInfo(SimCtx *simCtx)</div><div class="ttdoc">Sets up the full rank communication infrastructure, including neighbor ranks and bounding box exchang...</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01778">setup.c:1778</a></div></div>
<div class="ttc" id="avariables_8h_html_acf6d729ae4d0d996d6b056ccc5438995"><div class="ttname"><a href="variables_8h.html#acf6d729ae4d0d996d6b056ccc5438995">SimCtx::pps</a></div><div class="ttdeci">PostProcessParams * pps</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00644">variables.h:644</a></div></div>
<div class="ttc" id="avariables_8h_html_a10a62bce766452804bad64d119e127f7"><div class="ttname"><a href="variables_8h.html#a10a62bce766452804bad64d119e127f7">MAX_POINT_DATA_FIELDS</a></div><div class="ttdeci">#define MAX_POINT_DATA_FIELDS</div><div class="ttdoc">Defines the maximum number of data fields for VTK point data.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00446">variables.h:446</a></div></div>
<div class="ttc" id="aio_8h_html_a64286adf953993b2a0c5c3fbee40d5a2"><div class="ttname"><a href="io_8h.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a></div><div class="ttdeci">PetscErrorCode ReadAllSwarmFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads multiple fields (positions, velocity, CellID, and weight) into a DMSwarm.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01239">io.c:1239</a></div></div>
<div class="ttc" id="apostprocessing__kernels_8h_html_a86d13bca79c1355ce808509a999a1d88"><div class="ttname"><a href="postprocessing__kernels_8h.html#a86d13bca79c1355ce808509a999a1d88">NormalizeRelativeField</a></div><div class="ttdeci">PetscErrorCode NormalizeRelativeField(UserCtx *user, const char *relative_field_name)</div><div class="ttdoc">Normalizes a relative field by subtracting a reference value.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessing__kernels_8c_source.html#l00398">postprocessing_kernels.c:398</a></div></div>
<div class="ttc" id="avariables_8h_html_structPostProcessParams"><div class="ttname"><a href="variables_8h.html#structPostProcessParams">PostProcessParams</a></div><div class="ttdoc">Holds all configuration parameters for a post-processing run.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00452">variables.h:452</a></div></div>
<div class="ttc" id="asetup_8h_html_a977df65dac293c1308451334cb198693"><div class="ttname"><a href="setup_8h.html#a977df65dac293c1308451334cb198693">CreateSimulationContext</a></div><div class="ttdeci">PetscErrorCode CreateSimulationContext(int argc, char **argv, SimCtx **p_simCtx)</div><div class="ttdoc">Allocates and populates the master SimulationContext object.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00044">setup.c:44</a></div></div>
<div class="ttc" id="apostprocessor_8c_html_a5866209129dc3d2532fb7905777079af"><div class="ttname"><a href="postprocessor_8c.html#a5866209129dc3d2532fb7905777079af">ParticleDataProcessingPipeline</a></div><div class="ttdeci">PetscErrorCode ParticleDataProcessingPipeline(UserCtx *user, PostProcessParams *pps)</div><div class="ttdoc">Parses and executes the particle pipeline using a robust two-pass approach.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessor_8c_source.html#l00486">postprocessor.c:486</a></div></div>
<div class="ttc" id="avariables_8h_html_ada85203a98a3e4ce033b630fd6a1b695"><div class="ttname"><a href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">UserMG::mgctx</a></div><div class="ttdeci">MGCtx * mgctx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00437">variables.h:437</a></div></div>
<div class="ttc" id="aParticleSwarm_8h_html_ada215a5db25227a8fd2cd2596e7d3e57"><div class="ttname"><a href="ParticleSwarm_8h.html#ada215a5db25227a8fd2cd2596e7d3e57">InitializeParticleSwarm</a></div><div class="ttdeci">PetscErrorCode InitializeParticleSwarm(SimCtx *simCtx)</div><div class="ttdoc">Perform particle swarm initialization, particle-grid interaction, and related operations.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l01168">ParticleSwarm.c:1168</a></div></div>
<div class="ttc" id="avariables_8h_html_a76d29089d00d89348f32bbf0e2981497"><div class="ttname"><a href="variables_8h.html#a76d29089d00d89348f32bbf0e2981497">PostProcessParams::endTime</a></div><div class="ttdeci">PetscInt endTime</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00458">variables.h:458</a></div></div>
<div class="ttc" id="avariables_8h_html_af429c472ad06c2094bc8d598231b2e0a"><div class="ttname"><a href="variables_8h.html#af429c472ad06c2094bc8d598231b2e0a">MAX_VTK_FIELD_NAME_LENGTH</a></div><div class="ttdeci">#define MAX_VTK_FIELD_NAME_LENGTH</div><div class="ttdoc">Maximum length for VTK field names.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00447">variables.h:447</a></div></div>
<div class="ttc" id="avariables_8h_html_aedca60f0134d0716305127acad94d9d1"><div class="ttname"><a href="variables_8h.html#aedca60f0134d0716305127acad94d9d1">VTKMetaData::mx</a></div><div class="ttdeci">PetscInt mx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00498">variables.h:498</a></div></div>
<div class="ttc" id="avariables_8h_html_structVTKFieldInfo"><div class="ttname"><a href="variables_8h.html#structVTKFieldInfo">VTKFieldInfo</a></div><div class="ttdoc">Stores all necessary information for a single data array in a VTK file.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00484">variables.h:484</a></div></div>
<div class="ttc" id="avariables_8h_html_a19aa807b9181b13618527d6c4eb6fa89"><div class="ttname"><a href="variables_8h.html#a19aa807b9181b13618527d6c4eb6fa89">SimCtx::rank</a></div><div class="ttdeci">PetscMPIInt rank</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00541">variables.h:541</a></div></div>
<div class="ttc" id="avariables_8h_html_a877a36998969b27c4dee8db5c746b76c"><div class="ttname"><a href="variables_8h.html#a877a36998969b27c4dee8db5c746b76c">VTKFieldInfo::data</a></div><div class="ttdeci">PetscScalar * data</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00487">variables.h:487</a></div></div>
<div class="ttc" id="avariables_8h_html_a6773b93f3093658c3dcb569de3b4bdb2"><div class="ttname"><a href="variables_8h.html#a6773b93f3093658c3dcb569de3b4bdb2">MAX_FILENAME_LENGTH</a></div><div class="ttdeci">#define MAX_FILENAME_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00444">variables.h:444</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="avariables_8h_html_ae27e734d789eb2f07918d6bae3969480"><div class="ttname"><a href="variables_8h.html#ae27e734d789eb2f07918d6bae3969480">SimCtx::exec_mode</a></div><div class="ttdeci">ExecutionMode exec_mode</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00556">variables.h:556</a></div></div>
<div class="ttc" id="avariables_8h_html_aac5e5bdffa985d12e89f4d6f742a2442"><div class="ttname"><a href="variables_8h.html#aac5e5bdffa985d12e89f4d6f742a2442">VTKMetaData::coords</a></div><div class="ttdeci">PetscScalar * coords</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00500">variables.h:500</a></div></div>
<div class="ttc" id="apostprocessor_8c_html_a06bd0048200cbc80db1d02bc5d276a8f"><div class="ttname"><a href="postprocessor_8c.html#a06bd0048200cbc80db1d02bc5d276a8f">WriteEulerianFile</a></div><div class="ttdeci">PetscErrorCode WriteEulerianFile(UserCtx *user, PostProcessParams *pps, PetscInt ti)</div><div class="ttdoc">Orchestrates the writing of a combined, multi-field VTK file for a single time step.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessor_8c_source.html#l00186">postprocessor.c:186</a></div></div>
<div class="ttc" id="aio_8h_html_a3a009dabc71ccfa59f196e1bc045de45"><div class="ttname"><a href="io_8h.html#a3a009dabc71ccfa59f196e1bc045de45">ReadSimulationFields</a></div><div class="ttdeci">PetscErrorCode ReadSimulationFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads binary field data for velocity, pressure, and other required vectors.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l00959">io.c:959</a></div></div>
<div class="ttc" id="avtk__io_8h_html_af1bf47e0b45318d43a97d2bdbf766888"><div class="ttname"><a href="vtk__io_8h.html#af1bf47e0b45318d43a97d2bdbf766888">PrepareOutputParticleData</a></div><div class="ttdeci">PetscErrorCode PrepareOutputParticleData(UserCtx *user, PostProcessParams *pps, VTKMetaData *meta, PetscInt *p_n_total)</div><div class="ttdoc">Gathers, subsamples, and prepares all particle data for VTK output.</div><div class="ttdef"><b>Definition:</b> <a href="vtk__io_8c_source.html#l00421">vtk_io.c:421</a></div></div>
<div class="ttc" id="avariables_8h_html_a70969e8333ab8fd8eb60acc1f22f830a"><div class="ttname"><a href="variables_8h.html#a70969e8333ab8fd8eb60acc1f22f830a">UserCtx::Qcrit</a></div><div class="ttdeci">Vec Qcrit</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00731">variables.h:731</a></div></div>
<div class="ttc" id="alogging_8h_html_a9585f583c260f40a73f2490914edc689"><div class="ttname"><a href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a></div><div class="ttdeci">LogLevel get_log_level()</div><div class="ttdoc">Retrieves the current logging level from the environment variable LOG_LEVEL.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00039">logging.c:39</a></div></div>
<div class="ttc" id="avariables_8h_html_a41a6127b3c012c516a7dcc56c3696a84"><div class="ttname"><a href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">SimCtx::usermg</a></div><div class="ttdeci">UserMG usermg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="avariables_8h_html_a0e8eb238051c8b5f37a260a8cde481c4"><div class="ttname"><a href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">MGCtx::user</a></div><div class="ttdeci">UserCtx * user</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00427">variables.h:427</a></div></div>
<div class="ttc" id="avariables_8h_html_a5eedf611da6dd4f59cc65753b777b957"><div class="ttname"><a href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">SimCtx::np</a></div><div class="ttdeci">PetscInt np</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00612">variables.h:612</a></div></div>
<div class="ttc" id="apostprocessor_8c_html_ac3854bbfeab13a489af2f23b95b456d2"><div class="ttname"><a href="postprocessor_8c.html#ac3854bbfeab13a489af2f23b95b456d2">SetupPostProcessSwarm</a></div><div class="ttdeci">PetscErrorCode SetupPostProcessSwarm(UserCtx *user, PostProcessParams *pps)</div><div class="ttdoc">Creates a new, dedicated DMSwarm for post-processing tasks.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessor_8c_source.html#l00023">postprocessor.c:23</a></div></div>
<div class="ttc" id="avariables_8h_html_a1676e73c74586290cada1e0b922cb7fc"><div class="ttname"><a href="variables_8h.html#a1676e73c74586290cada1e0b922cb7fc">VTKFieldInfo::num_components</a></div><div class="ttdeci">PetscInt num_components</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00486">variables.h:486</a></div></div>
<div class="ttc" id="apostprocessor_8c_html_a059ce04ba04e66a5f1ef982fdf375e80"><div class="ttname"><a href="postprocessor_8c.html#a059ce04ba04e66a5f1ef982fdf375e80">EulerianDataProcessingPipeline</a></div><div class="ttdeci">PetscErrorCode EulerianDataProcessingPipeline(UserCtx *user, PostProcessParams *pps)</div><div class="ttdoc">Parses the processing pipeline string from the config and executes the requested kernels in sequence.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessor_8c_source.html#l00110">postprocessor.c:110</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00199">logging.h:199</a></div></div>
<div class="ttc" id="apostprocessing__kernels_8h_html_a303c5afb89d6fdaab3e40f9371d8f1b2"><div class="ttname"><a href="postprocessing__kernels_8h.html#a303c5afb89d6fdaab3e40f9371d8f1b2">ComputeQCriterion</a></div><div class="ttdeci">PetscErrorCode ComputeQCriterion(UserCtx *user)</div><div class="ttdoc">Computes the Q-Criterion, a scalar value identifying vortex cores.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessing__kernels_8c_source.html#l00262">postprocessing_kernels.c:262</a></div></div>
<div class="ttc" id="avariables_8h_html_a7f393eb4fff178f989abb357f98b35a8"><div class="ttname"><a href="variables_8h.html#a7f393eb4fff178f989abb357f98b35a8">VTKMetaData::fileType</a></div><div class="ttdeci">VTKFileType fileType</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00497">variables.h:497</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="avariables_8h_html_a1675749ea3b2429f00405a1ee3203d18"><div class="ttname"><a href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">UserCtx::swarm</a></div><div class="ttdeci">DM swarm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00722">variables.h:722</a></div></div>
<div class="ttc" id="aParticleSwarm_8h_html_adcaec962a8ff017ba9f859716405f51a"><div class="ttname"><a href="ParticleSwarm_8h.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a></div><div class="ttdeci">PetscErrorCode RegisterSwarmField(DM swarm, const char *fieldName, PetscInt fieldDim, PetscDataType dtype)</div><div class="ttdoc">Registers a swarm field without finalizing registration.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00050">ParticleSwarm.c:50</a></div></div>
<div class="ttc" id="avariables_8h_html_abaea0779cfa9cbf3b161de4eb5d49898"><div class="ttname"><a href="variables_8h.html#abaea0779cfa9cbf3b161de4eb5d49898">VTKMetaData::point_data_fields</a></div><div class="ttdeci">VTKFieldInfo point_data_fields[20]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00501">variables.h:501</a></div></div>
<div class="ttc" id="avariables_8h_html_a53b044b8b0e4a4dc8c8fa05387af564c"><div class="ttname"><a href="variables_8h.html#a53b044b8b0e4a4dc8c8fa05387af564c">SimCtx::dt</a></div><div class="ttdeci">PetscReal dt</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00552">variables.h:552</a></div></div>
<div class="ttc" id="avariables_8h_html_a835edfe1a83c23f4e7708f5134ff02fb"><div class="ttname"><a href="variables_8h.html#a835edfe1a83c23f4e7708f5134ff02fb">PostProcessParams::output_fields_instantaneous</a></div><div class="ttdeci">char output_fields_instantaneous[1024]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00464">variables.h:464</a></div></div>
<div class="ttc" id="avariables_8h_html_ae8abc82ec45317291825e3ffeeba80ac"><div class="ttname"><a href="variables_8h.html#ae8abc82ec45317291825e3ffeeba80ac">VTKMetaData::my</a></div><div class="ttdeci">PetscInt my</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00498">variables.h:498</a></div></div>
<div class="ttc" id="avariables_8h_html_acd88a3cbaf780ca17e0f8da6ef455f4f"><div class="ttname"><a href="variables_8h.html#acd88a3cbaf780ca17e0f8da6ef455f4f">VTKMetaData::mz</a></div><div class="ttdeci">PetscInt mz</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00498">variables.h:498</a></div></div>
<div class="ttc" id="apostprocessing__kernels_8h_html_ad5b0c0f1721b13944b83a57f2471cd02"><div class="ttname"><a href="postprocessing__kernels_8h.html#ad5b0c0f1721b13944b83a57f2471cd02">ComputeNodalAverage</a></div><div class="ttdeci">PetscErrorCode ComputeNodalAverage(UserCtx *user, const char *in_field_name, const char *out_field_name)</div><div class="ttdoc">Computes node-centered data by averaging 8 surrounding cell-centered values, exactly replicating the ...</div><div class="ttdef"><b>Definition:</b> <a href="postprocessing__kernels_8c_source.html#l00166">postprocessing_kernels.c:166</a></div></div>
<div class="ttc" id="avtk__io_8h_html_a20704fac26a2ed14228875d307f002aa"><div class="ttname"><a href="vtk__io_8h.html#a20704fac26a2ed14228875d307f002aa">PrepareOutputEulerianFieldData</a></div><div class="ttdeci">PetscErrorCode PrepareOutputEulerianFieldData(UserCtx *user, Vec field_vec, PetscInt num_components, PetscScalar **out_data)</div><div class="ttdoc">Creates a C array of field data corresponding to a subsampled (legacy-style) grid.</div><div class="ttdef"><b>Definition:</b> <a href="vtk__io_8c_source.html#l00287">vtk_io.c:287</a></div></div>
<div class="ttc" id="avariables_8h_html_a585521a5dbb55ae244e34a354ac93e3f"><div class="ttname"><a href="variables_8h.html#a585521a5dbb55ae244e34a354ac93e3f">UserCtx::Ucat_nodal</a></div><div class="ttdeci">Vec Ucat_nodal</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00730">variables.h:730</a></div></div>
<div class="ttc" id="aParticleMotion_8h_html_ae0c7489fc52fda6c92cd1f22c3f50c38"><div class="ttname"><a href="ParticleMotion_8h.html#ae0c7489fc52fda6c92cd1f22c3f50c38">PreCheckAndResizeSwarm</a></div><div class="ttdeci">PetscErrorCode PreCheckAndResizeSwarm(UserCtx *user, PetscInt ti, const char *ext)</div><div class="ttdoc">Checks particle count in the reference file and resizes the swarm if needed.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleMotion_8c_source.html#l00848">ParticleMotion.c:848</a></div></div>
<div class="ttc" id="apostprocessing__kernels_8h_html_a37ee1aa2e642bbfd24a6faf33a92568c"><div class="ttname"><a href="postprocessing__kernels_8h.html#a37ee1aa2e642bbfd24a6faf33a92568c">ComputeSpecificKE</a></div><div class="ttdeci">PetscErrorCode ComputeSpecificKE(UserCtx *user, const char *velocity_field, const char *ske_field)</div><div class="ttdoc">Computes the specific kinetic energy (KE per unit mass) for each particle.</div><div class="ttdef"><b>Definition:</b> <a href="postprocessing__kernels_8c_source.html#l00491">postprocessing_kernels.c:491</a></div></div>
<div class="ttc" id="asetup_8h_html_ad9f399b16547eba3244159f7136a1eb9"><div class="ttname"><a href="setup_8h.html#ad9f399b16547eba3244159f7136a1eb9">SetupBoundaryConditions</a></div><div class="ttdeci">PetscErrorCode SetupBoundaryConditions(SimCtx *simCtx)</div><div class="ttdoc">(Orchestrator) Sets up all boundary conditions for the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l01091">setup.c:1091</a></div></div>
<div class="ttc" id="asetup_8h_html_a2be2815aeb79afe9b95caf39c7b3312c"><div class="ttname"><a href="setup_8h.html#a2be2815aeb79afe9b95caf39c7b3312c">SetupGridAndSolvers</a></div><div class="ttdeci">PetscErrorCode SetupGridAndSolvers(SimCtx *simCtx)</div><div class="ttdoc">The main orchestrator for setting up all grid-related components.</div><div class="ttdef"><b>Definition:</b> <a href="setup_8c_source.html#l00618">setup.c:618</a></div></div>
<div class="ttc" id="avariables_8h_html_a49a63fad0d45e1bfc78e69a022c9a9e5"><div class="ttname"><a href="variables_8h.html#a49a63fad0d45e1bfc78e69a022c9a9e5">UserCtx::post_swarm</a></div><div class="ttdeci">DM post_swarm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00728">variables.h:728</a></div></div>
<div class="ttc" id="alogging_8h_html_ace99f3e207ccb2e46e9b782f9e57732e"><div class="ttname"><a href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a></div><div class="ttdeci">#define PROFILE_FUNCTION_BEGIN</div><div class="ttdoc">Marks the beginning of a profiled code block (typically a function).</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00722">logging.h:722</a></div></div>
<div class="ttc" id="avariables_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00663">variables.h:663</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="postprocessor_8c.html">postprocessor.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
