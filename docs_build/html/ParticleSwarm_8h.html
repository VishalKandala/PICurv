<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PICurv: ParticleSwarm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PICurv
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">A Parallel Particle-In-Cell Solver for Curvilinear LES</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ParticleSwarm_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ParticleSwarm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Motion and migration related functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;petsc.h&gt;</code><br />
<code>#include &lt;petscdmswarm.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="variables_8h_source.html">variables.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="walkingsearch_8h_source.html">walkingsearch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Metric_8h_source.html">Metric.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="io_8h_source.html">io.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ParticleSwarm.h:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h__dep__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="ParticleSwarm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a063f4fd13a24b248fabd0268c49fd38c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#a063f4fd13a24b248fabd0268c49fd38c">CreateParticleSwarm</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, PetscInt numParticles, PetscInt *particlesPerProcess, <a class="el" href="variables_8h.html#structBoundingBox">BoundingBox</a> *bboxlist)</td></tr>
<tr class="memdesc:a063f4fd13a24b248fabd0268c49fd38c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and initializes a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Swarm.  <a href="ParticleSwarm_8h.html#a063f4fd13a24b248fabd0268c49fd38c">More...</a><br /></td></tr>
<tr class="separator:a063f4fd13a24b248fabd0268c49fd38c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3566e0b51587686bc6c1366a67c44af"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#ac3566e0b51587686bc6c1366a67c44af">InitializeSwarm</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user)</td></tr>
<tr class="memdesc:ac3566e0b51587686bc6c1366a67c44af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the DMSwarm object within the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure.  <a href="ParticleSwarm_8h.html#ac3566e0b51587686bc6c1366a67c44af">More...</a><br /></td></tr>
<tr class="separator:ac3566e0b51587686bc6c1366a67c44af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcaec962a8ff017ba9f859716405f51a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a> (DM swarm, const char *fieldName, PetscInt fieldDim, PetscDataType dtype)</td></tr>
<tr class="memdesc:adcaec962a8ff017ba9f859716405f51a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers a swarm field without finalizing registration.  <a href="ParticleSwarm_8h.html#adcaec962a8ff017ba9f859716405f51a">More...</a><br /></td></tr>
<tr class="separator:adcaec962a8ff017ba9f859716405f51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae3fd559e91d7379302acb6ccd13011"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#aeae3fd559e91d7379302acb6ccd13011">RegisterParticleFields</a> (DM swarm)</td></tr>
<tr class="memdesc:aeae3fd559e91d7379302acb6ccd13011"><td class="mdescLeft">&#160;</td><td class="mdescRight">Registers necessary particle fields within the DMSwarm.  <a href="ParticleSwarm_8h.html#aeae3fd559e91d7379302acb6ccd13011">More...</a><br /></td></tr>
<tr class="separator:aeae3fd559e91d7379302acb6ccd13011"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fa0cca0aa8b05f2705cdd0e7d37658"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#a26fa0cca0aa8b05f2705cdd0e7d37658">InitializeRandomGenerators</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, PetscRandom *randx, PetscRandom *randy, PetscRandom *randz)</td></tr>
<tr class="memdesc:a26fa0cca0aa8b05f2705cdd0e7d37658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes random number generators for assigning particle properties.  <a href="ParticleSwarm_8h.html#a26fa0cca0aa8b05f2705cdd0e7d37658">More...</a><br /></td></tr>
<tr class="separator:a26fa0cca0aa8b05f2705cdd0e7d37658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab723e91906e01ec26aab97de6623000c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#ab723e91906e01ec26aab97de6623000c">InitializeLogicalSpaceRNGs</a> (PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</td></tr>
<tr class="memdesc:ab723e91906e01ec26aab97de6623000c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes random number generators for logical space operations [0.0, 1.0).  <a href="ParticleSwarm_8h.html#ab723e91906e01ec26aab97de6623000c">More...</a><br /></td></tr>
<tr class="separator:ab723e91906e01ec26aab97de6623000c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b3080ee0e5c8e0175ac594a2c497b5"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#af2b3080ee0e5c8e0175ac594a2c497b5">AssignInitialPropertiesToSwarm</a> (<a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *user, PetscInt particlesPerProcess, PetscRandom *rand_phys_x, PetscRandom *rand_phys_y, PetscRandom *rand_phys_z, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, <a class="el" href="variables_8h.html#structBoundingBox">BoundingBox</a> *bboxlist)</td></tr>
<tr class="memdesc:af2b3080ee0e5c8e0175ac594a2c497b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes all particle properties in the swarm.  <a href="ParticleSwarm_8h.html#af2b3080ee0e5c8e0175ac594a2c497b5">More...</a><br /></td></tr>
<tr class="separator:af2b3080ee0e5c8e0175ac594a2c497b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cc0975a3eec2e2f817d0e3a09040620"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#a1cc0975a3eec2e2f817d0e3a09040620">DistributeParticles</a> (PetscInt numParticles, PetscMPIInt rank, PetscMPIInt size, PetscInt *particlesPerProcess, PetscInt *remainder)</td></tr>
<tr class="memdesc:a1cc0975a3eec2e2f817d0e3a09040620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distributes particles evenly across MPI processes, handling any remainders.  <a href="ParticleSwarm_8h.html#a1cc0975a3eec2e2f817d0e3a09040620">More...</a><br /></td></tr>
<tr class="separator:a1cc0975a3eec2e2f817d0e3a09040620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a075e674353bc5b06344aa4c17063babf"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#a075e674353bc5b06344aa4c17063babf">FinalizeSwarmSetup</a> (PetscRandom *randx, PetscRandom *randy, PetscRandom *randz, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</td></tr>
<tr class="memdesc:a075e674353bc5b06344aa4c17063babf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalizes the swarm setup by destroying random generators and logging completion.  <a href="ParticleSwarm_8h.html#a075e674353bc5b06344aa4c17063babf">More...</a><br /></td></tr>
<tr class="separator:a075e674353bc5b06344aa4c17063babf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa353055e357151aab1542bbad367c657"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#aa353055e357151aab1542bbad367c657">UnpackSwarmFields</a> (PetscInt i, const PetscInt64 *PIDs, const PetscReal *weights, const PetscReal *positions, const PetscInt *cellIndices, PetscReal *velocities, PetscInt *LocStatus, <a class="el" href="variables_8h.html#structParticle">Particle</a> *particle)</td></tr>
<tr class="memdesc:aa353055e357151aab1542bbad367c657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct with data from DMSwarm fields.  <a href="ParticleSwarm_8h.html#aa353055e357151aab1542bbad367c657">More...</a><br /></td></tr>
<tr class="separator:aa353055e357151aab1542bbad367c657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac52b9e4afa9d1f2ba3bf59dc45b610d1"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#ac52b9e4afa9d1f2ba3bf59dc45b610d1">UpdateSwarmFields</a> (PetscInt i, const <a class="el" href="variables_8h.html#structParticle">Particle</a> *particle, PetscReal *weights, PetscInt *cellIndices, PetscInt *status_field)</td></tr>
<tr class="memdesc:ac52b9e4afa9d1f2ba3bf59dc45b610d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates DMSwarm fields with data from a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct.  <a href="ParticleSwarm_8h.html#ac52b9e4afa9d1f2ba3bf59dc45b610d1">More...</a><br /></td></tr>
<tr class="separator:ac52b9e4afa9d1f2ba3bf59dc45b610d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412856be59df7252e66bcbdd13cf1718"><td class="memItemLeft" align="right" valign="top">PetscBool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#a412856be59df7252e66bcbdd13cf1718">IsParticleInsideBoundingBox</a> (const <a class="el" href="variables_8h.html#structBoundingBox">BoundingBox</a> *bbox, const <a class="el" href="variables_8h.html#structParticle">Particle</a> *particle)</td></tr>
<tr class="memdesc:a412856be59df7252e66bcbdd13cf1718"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if a particle's location is within a specified bounding box.  <a href="ParticleSwarm_8h.html#a412856be59df7252e66bcbdd13cf1718">More...</a><br /></td></tr>
<tr class="separator:a412856be59df7252e66bcbdd13cf1718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0001e483238e2b600cb9aa23a6e5338c"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#a0001e483238e2b600cb9aa23a6e5338c">UpdateParticleWeights</a> (PetscReal *d, <a class="el" href="variables_8h.html#structParticle">Particle</a> *particle)</td></tr>
<tr class="memdesc:a0001e483238e2b600cb9aa23a6e5338c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a particle's interpolation weights based on distances to cell faces.  <a href="ParticleSwarm_8h.html#a0001e483238e2b600cb9aa23a6e5338c">More...</a><br /></td></tr>
<tr class="separator:a0001e483238e2b600cb9aa23a6e5338c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada215a5db25227a8fd2cd2596e7d3e57"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ParticleSwarm_8h.html#ada215a5db25227a8fd2cd2596e7d3e57">InitializeParticleSwarm</a> (<a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx)</td></tr>
<tr class="memdesc:ada215a5db25227a8fd2cd2596e7d3e57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform particle swarm initialization, particle-grid interaction, and related operations.  <a href="ParticleSwarm_8h.html#ada215a5db25227a8fd2cd2596e7d3e57">More...</a><br /></td></tr>
<tr class="separator:ada215a5db25227a8fd2cd2596e7d3e57"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Motion and migration related functions. </p>
<p>Header file for <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Swarm management functions.</p>
<p>This file contains declarations of functions responsible for moving and migrating particle swarms within a simulation using PETSc's DMSwarm.</p>
<p>This file contains declarations of functions responsible for creating, managing, initializing, migrating, and printing particle swarms within a simulation using PETSc's DMSwarm. </p>

<p class="definition">Definition in file <a class="el" href="ParticleSwarm_8h_source.html">ParticleSwarm.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a063f4fd13a24b248fabd0268c49fd38c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a063f4fd13a24b248fabd0268c49fd38c">&#9670;&nbsp;</a></span>CreateParticleSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode CreateParticleSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>numParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bboxlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and initializes a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> Swarm. </p>
<p>This function sets up a DMSwarm within the provided <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure, initializes particle fields, and distributes particles across MPI processes. It ensures that the number of particles is evenly divided among the available MPI ranks. If the total number of particles isn't divisible by the number of processes, the remainder is distributed to the first few ranks.</p>
<p>Additionally, it now takes a 'bboxlist' array as an input parameter and passes it on to AssignInitialProperties(), enabling particle initialization at the midpoint of each rank's bounding box if ParticleInitialization is set to 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numParticles</td><td>Total number of particles to create across all MPI processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Pointer to an array of <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures, one per rank.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure that <code>numParticles</code> is a positive integer.</li>
<li>The <code>control.dat</code> file should contain necessary PETSc options.</li>
<li><p class="startli">The <code>bboxlist</code> array should be properly populated before calling this function.</p>
<p class="startli">This function sets up a DMSwarm within the provided <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure, initializes particle fields, and distributes particles across MPI processes. It ensures that the number of particles is evenly divided among the available MPI ranks. If the total number of particles isn't divisible by the number of processes, the remainder is distributed to the first few ranks.</p>
</li>
</ul>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing the simulation context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numParticles</td><td>Total number of particles to create across all MPI processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Pointer to an array of <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures, one per rank.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particlesPerProcess</td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure that <code>numParticles</code> is a positive integer.</li>
<li>The <code>control.dat</code> file should contain necessary PETSc options.</li>
<li>The <code>bboxlist</code> array should be properly populated before calling this function. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00826">826</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                                                                                                               {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    PetscErrorCode ierr;                      <span class="comment">// PETSc error handling variable</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    PetscMPIInt rank, size;                   <span class="comment">// Variables to store MPI rank and size</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    PetscInt remainder = 0;                   <span class="comment">// Remainder of particles after division</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// Validate input parameters</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> (numParticles &lt;= 0) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Number of particles must be positive. Given: %d\n&quot;</span>, numParticles);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">return</span> PETSC_ERR_ARG_OUTOFRANGE;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Domain dimensions: Min_X=%.2f, Max_X=%.2f,Min_Y=%.2f, Max_Y=%.2f,Min_Z=%.2f, Max_Z=%.2f \n&quot;</span>, </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        user-&gt;<a class="code" href="variables_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">Min_X</a>,user-&gt;<a class="code" href="variables_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">Max_X</a>,user-&gt;<a class="code" href="variables_8h.html#ac6633daab270004cd266f6e6ac05f588">Min_Y</a>,user-&gt;<a class="code" href="variables_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">Max_Y</a>, user-&gt;<a class="code" href="variables_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">Min_Z</a>,user-&gt;<a class="code" href="variables_8h.html#aecbc2de7a281e906efe25a773b76866c">Max_Z</a>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Retrieve MPI rank and size</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    ierr = MPI_Comm_size(PETSC_COMM_WORLD, &amp;size); CHKERRQ(ierr);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Rank %d out of %d processes.\n&quot;</span>, rank, size);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// Distribute particles among MPI processes</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a1cc0975a3eec2e2f817d0e3a09040620">DistributeParticles</a>(numParticles, rank, size, particlesPerProcess, &amp;remainder); CHKERRQ(ierr);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="comment">// Initialize the DMSwarm - creates the swarm, sets the type and dimension</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#ac3566e0b51587686bc6c1366a67c44af">InitializeSwarm</a>(user); CHKERRQ(ierr);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordflow">if</span> (user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>) {</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    ierr = DMSwarmSetCellDM(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, user-&gt;<a class="code" href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;CreateParticleSwarm - Associated DMSwarm with Cell DM (user-&gt;da).\n&quot;</span>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// If user-&gt;da is essential for your simulation logic with particles, this should be a fatal error.</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;CreateParticleSwarm - user-&gt;da (Cell DM for Swarm) is NULL. Cell-based swarm operations might fail.\n&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONGSTATE, &quot;CreateParticleSwarm - user-&gt;da (Cell DM) is NULL but required.&quot;);</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// Register particle fields (position, velocity, CellID, weight, etc.)</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#aeae3fd559e91d7379302acb6ccd13011">RegisterParticleFields</a>(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// Set the local number of particles for this rank and additional buffer for particle migration</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    ierr = DMSwarmSetLocalSizes(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, *particlesPerProcess, numParticles); CHKERRQ(ierr);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Set local swarm size: %d particles.\n&quot;</span>, *particlesPerProcess);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="comment">// Optionally, LOG_ALLOW detailed DM info in debug mode</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a>() == <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a> &amp;&amp; <a class="code" href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a>(__func__)) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;CreateParticleSwarm - Viewing DMSwarm:\n&quot;</span>);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        ierr = DMView(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, PETSC_VIEWER_STDOUT_WORLD); CHKERRQ(ierr);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160; </div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;CreateParticleSwarm - Particle swarm creation and initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_a063f4fd13a24b248fabd0268c49fd38c_cgraph.svg" width="579" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_a063f4fd13a24b248fabd0268c49fd38c_icgraph.svg" width="492" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac3566e0b51587686bc6c1366a67c44af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3566e0b51587686bc6c1366a67c44af">&#9670;&nbsp;</a></span>InitializeSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the DMSwarm object within the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure. </p>
<p>This function creates the DMSwarm, sets its type and dimension, and configures basic swarm properties.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00018">18</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                              {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    PetscErrorCode ierr;  <span class="comment">// Error code for PETSc functions</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// Create the DMSwarm object for particle management</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    ierr = DMCreate(PETSC_COMM_WORLD, &amp;user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    ierr = DMSetType(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, DMSWARM); CHKERRQ(ierr);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    ierr = DMSetDimension(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, 3); CHKERRQ(ierr);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    ierr = DMSwarmSetType(user-&gt;<a class="code" href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">swarm</a>, DMSWARM_BASIC); CHKERRQ(ierr);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;InitializeSwarm - DMSwarm created and configured.\n&quot;</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_ac3566e0b51587686bc6c1366a67c44af_icgraph.svg" width="663" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adcaec962a8ff017ba9f859716405f51a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcaec962a8ff017ba9f859716405f51a">&#9670;&nbsp;</a></span>RegisterSwarmField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode RegisterSwarmField </td>
          <td>(</td>
          <td class="paramtype">DM&#160;</td>
          <td class="paramname"><em>swarm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>fieldDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscDataType&#160;</td>
          <td class="paramname"><em>dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers a swarm field without finalizing registration. </p>
<p>This function calls DMSwarmRegisterPetscDatatypeField for the given field, but does not finalize the registration. The finalization is deferred until all fields have been registered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">swarm</td><td>[in] The DMSwarm object. </td></tr>
    <tr><td class="paramname">fieldName</td><td>[in] Name of the field to register. </td></tr>
    <tr><td class="paramname">fieldDim</td><td>[in] Dimension of the field (1 for scalar, 3 for vector, etc.). </td></tr>
    <tr><td class="paramname">dtype</td><td>[in] The datatype of the swarm field being registered. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00050">50</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    ierr = DMSwarmRegisterPetscDatatypeField(swarm, fieldName, fieldDim, dtype); CHKERRQ(ierr);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// PetscDataTypes is an extern char* [] defined in petscsystypes.h that gives string names for PetscDataType enums</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;RegisterSwarmField - Registered field &#39;%s&#39; with dimension=%d, type=%s.\n&quot;</span>,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            fieldName, fieldDim, PetscDataTypes[dtype]);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_adcaec962a8ff017ba9f859716405f51a_icgraph.svg" width="100%" height="366"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="aeae3fd559e91d7379302acb6ccd13011"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae3fd559e91d7379302acb6ccd13011">&#9670;&nbsp;</a></span>RegisterParticleFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode RegisterParticleFields </td>
          <td>(</td>
          <td class="paramtype">DM&#160;</td>
          <td class="paramname"><em>swarm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Registers necessary particle fields within the DMSwarm. </p>
<p>This function registers fields such as position, velocity, CellID, and weight for each particle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">swarm</td><td>The DMSwarm object managing the particle swarm.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00076">76</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Register each field using the helper function</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;position&quot;</span>, 3 ,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Registered field &#39;position&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;velocity&quot;</span>, 3, PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;velocity&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;DMSwarm_CellID&quot;</span>, 3, PETSC_INT); CHKERRQ(ierr);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;DMSwarm_CellID&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(swarm, <span class="stringliteral">&quot;weight&quot;</span>, 3,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;weight&#39;.\n&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(swarm,<span class="stringliteral">&quot;Psi&quot;</span>, 1,PETSC_REAL); CHKERRQ(ierr);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;Psi&#39; - Scalar.\n&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    ierr =  <a class="code" href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a>(swarm,<span class="stringliteral">&quot;DMSwarm_location_status&quot;</span>,1,PETSC_INT);CHKERRQ(ierr);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Registered field &#39;DMSwarm_location_status&#39; - Status of Location of Particle(located,lost etc).\n&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// Finalize the field registration after all fields have been added</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    ierr = DMSwarmFinalizeFieldRegister(swarm); CHKERRQ(ierr);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;RegisterParticleFields - Finalized field registration.\n&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_aeae3fd559e91d7379302acb6ccd13011_cgraph.svg" width="372" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_aeae3fd559e91d7379302acb6ccd13011_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a26fa0cca0aa8b05f2705cdd0e7d37658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26fa0cca0aa8b05f2705cdd0e7d37658">&#9670;&nbsp;</a></span>InitializeRandomGenerators()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeRandomGenerators </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes random number generators for assigning particle properties. </p>
<p>This function creates and configures separate PETSc random number generators for the x, y, and z coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing simulation context. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">randx</td><td>Pointer to store the RNG for the x-coordinate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">randy</td><td>Pointer to store the RNG for the y-coordinate. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">randz</td><td>Pointer to store the RNG for the z-coordinate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00122">122</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                                                                                     {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    PetscErrorCode ierr;  <span class="comment">// Error code for PETSc functions</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    PetscMPIInt rank;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// Initialize RNG for x-coordinate</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, randx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    ierr = PetscRandomSetType((*randx), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    ierr = PetscRandomSetInterval(*randx, user-&gt;<a class="code" href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, user-&gt;<a class="code" href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    ierr = PetscRandomSetSeed(*randx, rank + 12345); CHKERRQ(ierr);  <span class="comment">// Unique seed per rank</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    ierr = PetscRandomSeed(*randx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeRandomGenerators - Initialized RNG for X-axis.\n&quot;</span>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// Initialize RNG for y-coordinate</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, randy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    ierr = PetscRandomSetType((*randy), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    ierr = PetscRandomSetInterval(*randy, user-&gt;<a class="code" href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, user-&gt;<a class="code" href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ierr = PetscRandomSetSeed(*randy, rank + 67890); CHKERRQ(ierr);  <span class="comment">// Unique seed per rank</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    ierr = PetscRandomSeed(*randy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeRandomGenerators - Initialized RNG for Y-axis.\n&quot;</span>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// Initialize RNG for z-coordinate</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    ierr = PetscRandomSetType((*randz), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    ierr = PetscRandomSetInterval(*randz, user-&gt;<a class="code" href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, user-&gt;<a class="code" href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">bbox</a>.<a class="code" href="variables_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ierr = PetscRandomSetSeed(*randz, rank + 54321); CHKERRQ(ierr);  <span class="comment">// Unique seed per rank</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    ierr = PetscRandomSeed(*randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeRandomGenerators - Initialized RNG for Z-axis.\n&quot;</span>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_a26fa0cca0aa8b05f2705cdd0e7d37658_icgraph.svg" width="538" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab723e91906e01ec26aab97de6623000c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab723e91906e01ec26aab97de6623000c">&#9670;&nbsp;</a></span>InitializeLogicalSpaceRNGs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeLogicalSpaceRNGs </td>
          <td>(</td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes random number generators for logical space operations [0.0, 1.0). </p>
<p>This function creates and configures three separate PETSc random number generators, one for each logical dimension (i, j, k or xi, eta, zeta equivalent). Each RNG is configured to produce uniformly distributed real numbers in the interval [0.0, 1.0). These are typically used for selecting owned cells or generating intra-cell logical coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">rand_logic_i</td><td>Pointer to store the RNG for the i-logical dimension. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rand_logic_j</td><td>Pointer to store the RNG for the j-logical dimension. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rand_logic_k</td><td>Pointer to store the RNG for the k-logical dimension.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00173">173</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                                                                                           {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    PetscMPIInt rank;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD, &amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// --- RNG for i-logical dimension ---</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, rand_logic_i); CHKERRQ(ierr);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    ierr = PetscRandomSetType((*rand_logic_i), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    ierr = PetscRandomSetInterval(*rand_logic_i, 0.0, 1.0); CHKERRQ(ierr); <span class="comment">// Key change: [0,1)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    ierr = PetscRandomSetSeed(*rand_logic_i, rank + 202401); CHKERRQ(ierr); <span class="comment">// Unique seed</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    ierr = PetscRandomSeed(*rand_logic_i); CHKERRQ(ierr);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeLogicalSpaceRNGs - Initialized RNG for i-logical dimension [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// --- RNG for j-logical dimension ---</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, rand_logic_j); CHKERRQ(ierr);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    ierr = PetscRandomSetType((*rand_logic_j), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    ierr = PetscRandomSetInterval(*rand_logic_j, 0.0, 1.0); CHKERRQ(ierr); <span class="comment">// Key change: [0,1)</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    ierr = PetscRandomSetSeed(*rand_logic_j, rank + 202402); CHKERRQ(ierr);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    ierr = PetscRandomSeed(*rand_logic_j); CHKERRQ(ierr);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeLogicalSpaceRNGs - Initialized RNG for j-logical dimension [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// --- RNG for k-logical dimension ---</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    ierr = PetscRandomCreate(PETSC_COMM_SELF, rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    ierr = PetscRandomSetType((*rand_logic_k), PETSCRAND48); CHKERRQ(ierr);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    ierr = PetscRandomSetInterval(*rand_logic_k, 0.0, 1.0); CHKERRQ(ierr); <span class="comment">// Key change: [0,1)</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    ierr = PetscRandomSetSeed(*rand_logic_k, rank + 202403); CHKERRQ(ierr);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    ierr = PetscRandomSeed(*rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;InitializeLogicalSpaceRNGs - Initialized RNG for k-logical dimension [0,1).\n&quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_ab723e91906e01ec26aab97de6623000c_icgraph.svg" width="100%" height="404"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="af2b3080ee0e5c8e0175ac594a2c497b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b3080ee0e5c8e0175ac594a2c497b5">&#9670;&nbsp;</a></span>AssignInitialPropertiesToSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode AssignInitialPropertiesToSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_phys_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_phys_y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_phys_z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bboxlist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes all particle properties in the swarm. </p>
<p>This function orchestrates the initialization of particle properties. It first determines the inlet face if surface initialization (Mode 0) is selected by parsing "bcs.dat". Then, it initializes basic particle properties (physical position, <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> ID, and placeholder <a class="el" href="variables_8h.html#structCell" title="Defines the vertices of a single hexahedral grid cell.">Cell</a> IDs) by calling <code>InitializeParticleBasicProperties</code>. This call uses the provided <code>rand_logic_i/j/k</code> RNGs, which must be pre-initialized for [0,1). The <code>rand_phys_x/y/z</code> RNGs (physically bounded) are passed but may not be used by <code>InitializeParticleBasicProperties</code> for position setting if all initialization paths use logical-to-physical mapping. Finally, it calls helper functions to initialize other registered swarm fields like "velocity", "weight", and "P" (pressure) to default values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <code><a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particlesPerProcess</td><td>Number of particles assigned to this MPI process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_x</td><td>RNG for physical x-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_y</td><td>RNG for physical y-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_z</td><td>RNG for physical z-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_i</td><td>RNG for i-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_j</td><td>RNG for j-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_k</td><td>RNG for k-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Array of <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures (potentially unused by IPBP).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<p>This function orchestrates the initialization of particle properties. It first determines the inlet face if surface initialization (Mode 0) is selected by parsing "bcs.dat". Then, it initializes basic particle properties (physical position, <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> ID, and placeholder <a class="el" href="variables_8h.html#structCell" title="Defines the vertices of a single hexahedral grid cell.">Cell</a> IDs) by calling <code>InitializeParticleBasicProperties</code>. This call uses the provided <code>rand_logic_i/j/k</code> RNGs, which must be pre-initialized for [0,1). The <code>rand_phys_x/y/z</code> RNGs (physically bounded) are passed but may not be used by <code>InitializeParticleBasicProperties</code> for position setting if all initialization paths use logical-to-physical mapping. Finally, it calls helper functions to initialize other registered swarm fields like "velocity", "weight", and "Psi" (scalar) to default values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <code><a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a></code> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particlesPerProcess</td><td>Number of particles assigned to this MPI process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_x</td><td>RNG for physical x-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_y</td><td>RNG for physical y-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_phys_z</td><td>RNG for physical z-coordinates (from <code>InitializeRandomGenerators</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_i</td><td>RNG for i-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_j</td><td>RNG for j-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_k</td><td>RNG for k-logical dimension tasks [0,1) (from <code>InitializeLogicalSpaceRNGs</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Array of <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures (potentially unused by IPBP).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00653">653</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code" href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="comment">// --- 0. Input Validation ---</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (!user || !bboxlist || !rand_logic_i || !rand_logic_j || !rand_logic_k || !rand_phys_x || !rand_phys_y || !rand_phys_z) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">// Check all RNGs now as they are passed in</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Null user, bboxlist, or RNG pointer.\n&quot;</span>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Null input detected.&quot;</span>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing swarm with %d particles per process. Mode: %d.\n&quot;</span>,</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            particlesPerProcess, simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a>);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// --- 1. Parse BCS File for Inlet Information (if Mode 0) ---</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">ParticleInitialization</a> == 0) {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span>(user-&gt;<a class="code" href="variables_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">inletFaceDefined</a> == PETSC_FALSE){</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - ParticleInitialization Mode 0 (Surface Init) selected, but no INLET face was identified from bcs.dat. Cannot proceed.\n&quot;</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        SETERRQ(PETSC_COMM_WORLD, PETSC_ERR_ARG_WRONGSTATE, <span class="stringliteral">&quot;ParticleInitialization Mode 0 requires an INLET face to be defined in bcs.dat.&quot;</span>);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - After ParseBCSFileForInlet, identifiedInletBCFace = %d\n&quot;</span>, user-&gt;<a class="code" href="variables_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// --- 2. Initialize Basic Particle Properties (Position, PID, Cell IDs placeholder) ---</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// The rand_logic_i/j/k are now passed directly.</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// The rand_phys_x/y/z are passed but InitializeParticleBasicProperties (refactored version)</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">// will not use them for setting positions if all its paths use logical-to-physical mapping.</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Calling InitializeParticleBasicProperties.\n&quot;</span>);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a95efc9f04a0187f2a1d920952bd610e0">InitializeParticleBasicProperties</a>(user, particlesPerProcess,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                            rand_logic_i, rand_logic_j, rand_logic_k,</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                            bboxlist); <span class="comment">// bboxlist passed along</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    CHKERRQ(ierr);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Successfully initialized basic particle properties.\n&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="comment">// Note: The logical RNGs (rand_logic_i/j/k) are NOT destroyed here.</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// They were created externally (e.g., by InitializeLogicalSpaceRNGs) and</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// should be destroyed externally (e.g., in FinalizeSwarmSetup).</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// Same for rand_phys_x/y/z.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">// --- 3. Initialize Other Swarm Fields (Velocity, Weight, Pressure, etc.) ---</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing &#39;velocity&#39; field.\n&quot;</span>);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a>(user, <span class="stringliteral">&quot;velocity&quot;</span>, 3); CHKERRQ(ierr);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - &#39;velocity&#39; field initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing &#39;weight&#39; field.\n&quot;</span>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a>(user, <span class="stringliteral">&quot;weight&quot;</span>, 3); CHKERRQ(ierr); <span class="comment">// Assuming weight is vec3</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - &#39;weight&#39; field initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Initializing &#39;P&#39; (Pressure) field.\n&quot;</span>);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a>(user, <span class="stringliteral">&quot;Psi&quot;</span>, 1); CHKERRQ(ierr);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - &#39;P&#39; field initialization complete.\n&quot;</span>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;AssignInitialPropertiesToSwarm - Successfully completed all swarm property initialization.\n&quot;</span>);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_af2b3080ee0e5c8e0175ac594a2c497b5_cgraph.svg" width="100%" height="511"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_af2b3080ee0e5c8e0175ac594a2c497b5_icgraph.svg" width="516" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a1cc0975a3eec2e2f817d0e3a09040620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cc0975a3eec2e2f817d0e3a09040620">&#9670;&nbsp;</a></span>DistributeParticles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode DistributeParticles </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>numParticles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscMPIInt&#160;</td>
          <td class="paramname"><em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscMPIInt&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>particlesPerProcess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>remainder</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distributes particles evenly across MPI processes, handling any remainders. </p>
<p>This function calculates the number of particles each MPI process should handle, distributing the remainder particles to the first few ranks if necessary.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numParticles</td><td>Total number of particles to create across all MPI processes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rank</td><td>MPI rank of the current process. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Total number of MPI processes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particlesPerProcess</td><td>Number of particles assigned to the current MPI process. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">remainder</td><td>Remainder particles when dividing numParticles by size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00744">744</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                                                                                                                                  {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">// Calculate the base number of particles per process</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    *particlesPerProcess = numParticles / size;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    *remainder = numParticles % size;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="comment">// Distribute the remainder particles to the first &#39;remainder&#39; ranks</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span> (rank &lt; *remainder) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        *particlesPerProcess += 1;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;DistributeParticles - Rank %d receives an extra particle. Total: %d\n&quot;</span>, rank, *particlesPerProcess);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;DistributeParticles - Rank %d receives %d particles.\n&quot;</span>, rank, *particlesPerProcess);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_a1cc0975a3eec2e2f817d0e3a09040620_icgraph.svg" width="100%" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a075e674353bc5b06344aa4c17063babf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a075e674353bc5b06344aa4c17063babf">&#9670;&nbsp;</a></span>FinalizeSwarmSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode FinalizeSwarmSetup </td>
          <td>(</td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>randz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscRandom *&#160;</td>
          <td class="paramname"><em>rand_logic_k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finalizes the swarm setup by destroying random generators and logging completion. </p>
<p>This function cleans up resources by destroying random number generators and LOG_ALLOWs the completion of swarm setup.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">randx</td><td>Random number generator for the x-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randy</td><td>Random number generator for the y-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">randz</td><td>Random number generator for the z-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_i</td><td>Random number generator for the xi-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_j</td><td>Random number generator for the eta-coordinate. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rand_logic_k</td><td>Random number generator for the zeta-coordinate.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00782">782</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                                                                                                                                                                               {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    PetscErrorCode ierr;  <span class="comment">// Error code for PETSc functions</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="comment">// Destroy random number generators to free resources</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="comment">// Physical space</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    ierr = PetscRandomDestroy(randx); CHKERRQ(ierr);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    ierr = PetscRandomDestroy(randy); CHKERRQ(ierr);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    ierr = PetscRandomDestroy(randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="comment">// Logical space</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    ierr = PetscRandomDestroy(rand_logic_i); CHKERRQ(ierr);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    ierr = PetscRandomDestroy(rand_logic_j); CHKERRQ(ierr);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    ierr = PetscRandomDestroy(rand_logic_k); CHKERRQ(ierr);      </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;FinalizeSwarmSetup - Destroyed all random number generators.\n&quot;</span>);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_a075e674353bc5b06344aa4c17063babf_icgraph.svg" width="487" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa353055e357151aab1542bbad367c657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa353055e357151aab1542bbad367c657">&#9670;&nbsp;</a></span>UnpackSwarmFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UnpackSwarmFields </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt64 *&#160;</td>
          <td class="paramname"><em>PIDs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscReal *&#160;</td>
          <td class="paramname"><em>positions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const PetscInt *&#160;</td>
          <td class="paramname"><em>cellIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>velocities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>LocStatus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct with data from DMSwarm fields. </p>
<p>This helper function populates a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure using data retrieved from DMSwarm fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Index of the particle in the DMSwarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PIDs</td><td>Pointer to the array of particle IDs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Pointer to the array of particle weights. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">positions</td><td>Pointer to the array of particle positions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellIndices</td><td>Pointer to the array of particle cell indices. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">velocities</td><td>Pointer to the array of particle velocities. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LocStatus</td><td>Pointer to the array of cell location status indicators. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct to initialize.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns <code>0</code> on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00901">901</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                                                              {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    PetscMPIInt rank;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    ierr = MPI_Comm_rank(PETSC_COMM_WORLD,&amp;rank); CHKERRQ(ierr);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (particle == NULL) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Output Particle pointer is NULL. \n&quot;</span>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// logging the start of particle initialization</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;[Rank %d]Unpacking Particle [%d] with PID: %ld.\n&quot;</span>,rank, i, PIDs[i]);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="comment">// Initialize PID</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a> = PIDs[i];</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] PID set to: %ld.\n&quot;</span>, rank,i, particle-&gt;<a class="code" href="variables_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">// Initialize weights</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = weights[3 * i];</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = weights[3 * i + 1];</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = weights[3 * i + 2];</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] weights set to: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        rank,i, particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="comment">// Initialize locations</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = positions[3 * i];</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = positions[3 * i + 1];</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = positions[3 * i + 2];</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] location set to: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        rank,i, particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="comment">// Initialize velocities (assuming default zero; modify if necessary)</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = velocities[3 * i];</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = velocities[3 * i + 1];</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = velocities[3 * i + 2];</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d]Particle [%d] velocities unpacked to: [%.6f,%.6f,%.6f].\n&quot;</span>,rank, i,particle-&gt;<a class="code" href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>,particle-&gt;<a class="code" href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>,particle-&gt;<a class="code" href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">vel</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// Initialize cell indices</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[0] = cellIndices[3 * i];</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[1] = cellIndices[3 * i + 1];</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[2] = cellIndices[3 * i + 2];</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;[Rank %d]Particle [%d] cell indices set to: [%d, %d, %d].\n&quot;</span>,rank,i, particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[0], particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[1], particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[2]);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a88a45e3c57c861d03160f28aaa786414">location_status</a> = (<a class="code" href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a>)LocStatus[i];</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;[Rank %d]Particle [%d] Status set to: %d.\n&quot;</span>,rank, i, particle-&gt;<a class="code" href="variables_8h.html#a88a45e3c57c861d03160f28aaa786414">location_status</a>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// The destination_rank is only set by the location search, not read from the swarm,</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// so we initialize it to a known invalid state.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#a76cdf3edbcd6aa56f5a2ba8645e999ea">destination_rank</a> = MPI_PROC_NULL;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="comment">// logging the completion of particle initialization</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;[Rank %d]Completed initialization of Particle [%d]. \n&quot;</span>, rank,i);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_aa353055e357151aab1542bbad367c657_icgraph.svg" width="100%" height="414"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ac52b9e4afa9d1f2ba3bf59dc45b610d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac52b9e4afa9d1f2ba3bf59dc45b610d1">&#9670;&nbsp;</a></span>UpdateSwarmFields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UpdateSwarmFields </td>
          <td>(</td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>cellIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt *&#160;</td>
          <td class="paramname"><em>status_field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates DMSwarm fields with data from a <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct. </p>
<p>This helper function writes back the modified <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> data to the corresponding DMSwarm fields.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">i</td><td>Index of the particle in the DMSwarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> struct containing updated data. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">weights</td><td>Pointer to the array of particle weights. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cellIndices</td><td>Pointer to the array of particle cell indices. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">LocStatus</td><td>Pointer to the array of cell location status indicators.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns <code>0</code> on success, non-zero on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l00983">983</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">if</span> (particle == NULL) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL, <span class="stringliteral">&quot;Input Particle pointer is NULL.\n&quot;</span>);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">// logging the start of swarm fields update</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Updating DMSwarm fields for Particle [%d].\n&quot;</span>, i);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">// Update weights</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    weights[3 * i]     = particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    weights[3 * i + 1] = particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    weights[3 * i + 2] = particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Updated weights for Particle [%d]: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        i, weights[3 * i], weights[3 * i + 1], weights[3 * i + 2]);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="comment">// Update cell indices</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    cellIndices[3 * i]     = particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[0];</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    cellIndices[3 * i + 1] = particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[1];</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    cellIndices[3 * i + 2] = particle-&gt;<a class="code" href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">cell</a>[2];</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Updated cell indices for Particle [%d]: [%d, %d, %d].\n&quot;</span>, </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        i, cellIndices[3 * i], cellIndices[3 * i + 1], cellIndices[3 * i + 2]);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    status_field[i] = particle-&gt;<a class="code" href="variables_8h.html#a88a45e3c57c861d03160f28aaa786414">location_status</a>;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Updated location status for Particle [%d]: [%d].\n&quot;</span>, </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        i, status_field[i]);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    </div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">// logging the completion of swarm fields update</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>,<span class="stringliteral">&quot;Completed updating DMSwarm fields for Particle [%d].\n&quot;</span>, i);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; </div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_ac52b9e4afa9d1f2ba3bf59dc45b610d1_icgraph.svg" width="100%" height="414"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="a412856be59df7252e66bcbdd13cf1718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a412856be59df7252e66bcbdd13cf1718">&#9670;&nbsp;</a></span>IsParticleInsideBoundingBox()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscBool IsParticleInsideBoundingBox </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structBoundingBox">BoundingBox</a> *&#160;</td>
          <td class="paramname"><em>bbox</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="variables_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if a particle's location is within a specified bounding box. </p>
<p>This function determines whether the given particle's location lies inside the provided bounding box. It performs an axis-aligned bounding box (AABB) check by comparing the particle's coordinates to the minimum and maximum coordinates of the bounding box in each dimension (x, y, z).</p>
<p>Logging statements are included to provide detailed information about the function's execution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bbox</td><td>Pointer to the <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structure containing minimum and maximum coordinates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure containing the particle's location and identifier.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscBool Returns <code>PETSC_TRUE</code> if the particle is inside the bounding box, <code>PETSC_FALSE</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function assumes that the <code>bbox</code> and <code>particle</code> pointers are valid and non-NULL.</li>
<li>The function includes logging statements that start with the function name.</li>
<li>Be cautious when logging in performance-critical code sections, especially if the function is called frequently.</li>
</ul>
</dd></dl>
<p>This function determines whether the given particle's location lies inside the provided bounding box. It performs an axis-aligned bounding box (AABB) check by comparing the particle's coordinates to the minimum and maximum coordinates of the bounding box in each dimension (x, y, z).</p>
<p>logging statements are included to provide detailed information about the function's execution.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bbox</td><td>Pointer to the <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structure containing minimum and maximum coordinates. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure containing the particle's location and identifier.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscBool Returns <code>PETSC_TRUE</code> if the particle is inside the bounding box, <code>PETSC_FALSE</code> otherwise.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The function assumes that the <code>bbox</code> and <code>particle</code> pointers are valid and non-NULL.</li>
<li>The function includes logging statements that start with the function name.</li>
<li>The <code>LOG_ALLOW_SCOPE</code> variable is used to distinguish between <code>GLOBAL</code> and <code>LOCAL</code> LOG_ALLOW outputs.</li>
<li>Be cautious when logging in performance-critical code sections, especially if the function is called frequently. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l01044">1044</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;{</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">// Validate input pointers</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">if</span> (!bbox) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="comment">// LOG_ALLOW error message and return PETSC_FALSE</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>, <span class="stringliteral">&quot;Error - &#39;bbox&#39; pointer is NULL.&quot;</span>);</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordflow">return</span> PETSC_FALSE;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    }</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">if</span> (!particle) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a>,<span class="stringliteral">&quot;Error - &#39;particle&#39; pointer is NULL.&quot;</span>);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">return</span> PETSC_FALSE;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="comment">// Extract particle location and bounding box coordinates</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> loc = particle-&gt;<a class="code" href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">loc</a>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> min_coords = bbox-&gt;<a class="code" href="variables_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">min_coords</a>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keyword">const</span> <a class="code" href="variables_8h.html#structCmpnts">Cmpnts</a> max_coords = bbox-&gt;<a class="code" href="variables_8h.html#a4d66dc20efb64cf45770997139fae524">max_coords</a>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// LOG_ALLOW the particle location and bounding box coordinates for debugging</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Particle PID %ld location: (%.6f, %.6f, %.6f).\n&quot;</span>,particle-&gt;<a class="code" href="variables_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>, loc.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, loc.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, loc.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;BoundingBox min_coords: (%.6f, %.6f, %.6f), max_coords: (%.6f, %.6f, %.6f).\n&quot;</span>, </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    min_coords.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, min_coords.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, min_coords.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, max_coords.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, max_coords.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, max_coords.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">// Check if the particle&#39;s location is within the bounding box</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> ((loc.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> &gt;= min_coords.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> &amp;&amp; loc.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> &lt;= max_coords.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>) &amp;&amp;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        (loc.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> &gt;= min_coords.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> &amp;&amp; loc.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> &lt;= max_coords.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>) &amp;&amp;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        (loc.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> &gt;= min_coords.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> &amp;&amp; loc.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> &lt;= max_coords.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>)) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="comment">// Particle is inside the bounding box</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Particle PID %ld is inside the bounding box.\n&quot;</span>,particle-&gt;<a class="code" href="variables_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordflow">return</span> PETSC_TRUE;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// Particle is outside the bounding box</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;Particle PID %ld is outside the bounding box.\n&quot;</span>,particle-&gt;<a class="code" href="variables_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">PID</a>);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> PETSC_FALSE;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0001e483238e2b600cb9aa23a6e5338c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0001e483238e2b600cb9aa23a6e5338c">&#9670;&nbsp;</a></span>UpdateParticleWeights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode UpdateParticleWeights </td>
          <td>(</td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structParticle">Particle</a> *&#160;</td>
          <td class="paramname"><em>particle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates a particle's interpolation weights based on distances to cell faces. </p>
<p>This function computes interpolation weights using distances to the six cell faces (<code>d</code>) and updates the <code>weight</code> field of the provided particle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to an array of distances to the six cell faces. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">particle</td><td>Pointer to the <a class="el" href="variables_8h.html#structParticle" title="Defines a particle&#39;s core properties for Lagrangian tracking.">Particle</a> structure whose weights are to be updated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, or a non-zero error code on failure. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l01102">1102</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                                                                       {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="comment">// Validate input pointers</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span> (!d || !particle) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_NULL,</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                <span class="stringliteral">&quot;UpdateParticleWeights - Null pointer argument (d or particle).&quot;</span>);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">// Validate distances</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">for</span> (PetscInt i = <a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>; i &lt; <a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a>; i++) {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">if</span> (d[i] &lt;= <a class="code" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>) {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                <span class="stringliteral">&quot;UpdateParticleWeights - face distance d[%d] = %f &lt;= %f; &quot;</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="stringliteral">&quot;clamping to 1e-14 to avoid zero/negative.\n&quot;</span>,</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                i, (<span class="keywordtype">double</span>)d[i], <a class="code" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            d[i] = <a class="code" href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        }</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="comment">// LOG_ALLOW the input distances</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="stringliteral">&quot;UpdateParticleWeights - Calculating weights with distances: &quot;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        <span class="stringliteral">&quot;[LEFT=%f, RIGHT=%f, BOTTOM=%f, TOP=%f, FRONT=%f, BACK=%f].\n&quot;</span>,</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>], d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>]);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">// Compute and update the particle&#39;s weights</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>] / (d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a>] + d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a>]);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>] / (d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a>] + d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a>]);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>] / (d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a>] + d[<a class="code" href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a>]);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="comment">// LOG_ALLOW the updated weights</span></div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>,<a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <span class="stringliteral">&quot;UpdateParticleWeights - Updated particle weights: x=%f, y=%f, z=%f.\n&quot;</span>,</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, particle-&gt;<a class="code" href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">weights</a>.<a class="code" href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160; </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160; </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_a0001e483238e2b600cb9aa23a6e5338c_icgraph.svg" width="100%" height="414"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>

</div>
</div>
<a id="ada215a5db25227a8fd2cd2596e7d3e57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada215a5db25227a8fd2cd2596e7d3e57">&#9670;&nbsp;</a></span>InitializeParticleSwarm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode InitializeParticleSwarm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables_8h.html#structSimCtx">SimCtx</a> *&#160;</td>
          <td class="paramname"><em>simCtx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform particle swarm initialization, particle-grid interaction, and related operations. </p>
<p>This function handles the following tasks:</p><ol type="1">
<li>Initializes the particle swarm using the provided bounding box list (bboxlist) to determine initial placement if ParticleInitialization is 0.</li>
<li>Locates particles within the computational grid.</li>
<li>Updates particle positions based on grid interactions (if such logic exists elsewhere in the code).</li>
<li>Interpolates particle velocities from grid points using trilinear interpolation.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing grid and particle swarm information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np</td><td>Number of particles to initialize in the swarm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bboxlist</td><td>Pointer to an array of <a class="el" href="variables_8h.html#structBoundingBox" title="Defines a 3D axis-aligned bounding box.">BoundingBox</a> structures, one per MPI rank.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success, non-zero on failure.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Ensure that <code>np</code> (number of particles) is positive.</li>
<li>The <code>bboxlist</code> array must be correctly computed and passed in before calling this function.</li>
<li>If ParticleInitialization == 0, particles will be placed at the midpoint of the local bounding box. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="ParticleSwarm_8c_source.html#l01168">1168</a> of file <a class="el" href="ParticleSwarm_8c_source.html">ParticleSwarm.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;{</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    PetscInt       particlesPerProcess = 0;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <a class="code" href="variables_8h.html#structUserCtx">UserCtx</a>       *user = simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">mgctx</a>[simCtx-&gt;<a class="code" href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">usermg</a>.<a class="code" href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">mglevels</a> - 1].<a class="code" href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">user</a>;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    PetscFunctionBeginUser;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <a class="code" href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Starting particle swarm setup for %d particles.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// --- Phase 1: Create the DMSwarm Object (Always required) ---</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// This creates the container and registers the fields. It does not add particles yet.</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    ierr = <a class="code" href="ParticleSwarm_8c.html#a063f4fd13a24b248fabd0268c49fd38c">CreateParticleSwarm</a>(user, simCtx-&gt;<a class="code" href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">np</a>, &amp;particlesPerProcess, simCtx-&gt;<a class="code" href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">bboxlist</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;DMSwarm object and fields created successfully.\n&quot;</span>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="comment">// --- Phase 2: Decide whether to Initialize new particles or Load existing ones ---</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    PetscBool should_initialize_new_particles = PETSC_FALSE;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="keywordflow">if</span>(simCtx-&gt;<a class="code" href="variables_8h.html#ae27e734d789eb2f07918d6bae3969480">exec_mode</a> == <a class="code" href="variables_8h.html#ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f">EXEC_MODE_POSTPROCESSOR</a>){</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        should_initialize_new_particles = PETSC_TRUE;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">if</span> (simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a> == 0) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            should_initialize_new_particles = PETSC_TRUE; <span class="comment">// Standard fresh start</span></div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <span class="comment">// It&#39;s a restart, so check the user&#39;s requested particle mode.</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordflow">if</span> (strcmp(simCtx-&gt;<a class="code" href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">particleRestartMode</a>, <span class="stringliteral">&quot;init&quot;</span>) == 0) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                should_initialize_new_particles = PETSC_TRUE; <span class="comment">// User wants to re-initialize particles in a restarted flow.</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160; </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="comment">// --- Phase 3: Execute the chosen particle setup path ---</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">if</span> (should_initialize_new_particles) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <span class="comment">// --- PATH A: Generate a fresh population of particles ---</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Mode: INITIALIZE. Generating new particle population.\n&quot;</span>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        PetscRandom randx, randy, randz;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        PetscRandom rand_logic_i, rand_logic_j, rand_logic_k;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        ierr = <a class="code" href="ParticleSwarm_8c.html#a26fa0cca0aa8b05f2705cdd0e7d37658">InitializeRandomGenerators</a>(user, &amp;randx, &amp;randy, &amp;randz); CHKERRQ(ierr);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        ierr = <a class="code" href="ParticleSwarm_8c.html#ab723e91906e01ec26aab97de6623000c">InitializeLogicalSpaceRNGs</a>(&amp;rand_logic_i, &amp;rand_logic_j, &amp;rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        ierr = <a class="code" href="ParticleSwarm_8c.html#af2b3080ee0e5c8e0175ac594a2c497b5">AssignInitialPropertiesToSwarm</a>(user, particlesPerProcess, &amp;randx, &amp;randy, &amp;randz, &amp;rand_logic_i, &amp;rand_logic_j, &amp;rand_logic_k, simCtx-&gt;<a class="code" href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">bboxlist</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        ierr = <a class="code" href="ParticleSwarm_8c.html#a075e674353bc5b06344aa4c17063babf">FinalizeSwarmSetup</a>(&amp;randx, &amp;randy, &amp;randz, &amp;rand_logic_i, &amp;rand_logic_j, &amp;rand_logic_k); CHKERRQ(ierr);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="comment">// --- PATH B: Load particle population from restart files ---</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <span class="comment">// This path is only taken if simCtx-&gt;StartStep &gt; 0 AND simCtx-&gt;particleRestartMode == &quot;load&quot;</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Mode: LOAD. Loading particle population from files for step %d.\n&quot;</span>, simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160; </div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        ierr = <a class="code" href="ParticleMotion_8h.html#ae0c7489fc52fda6c92cd1f22c3f50c38">PreCheckAndResizeSwarm</a>(user, simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>, <span class="stringliteral">&quot;dat&quot;</span>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        ierr = <a class="code" href="io_8h.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a>(user, simCtx-&gt;<a class="code" href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">StartStep</a>); CHKERRQ(ierr);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        <span class="comment">// Note: We check for file-open errors inside ReadAllSwarmFields now.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <a class="code" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Particle data loaded. CellID and status are preserved from file.\n&quot;</span>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a>(<a class="code" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Particle swarm setup complete.\n&quot;</span>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <a class="code" href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    PetscFunctionReturn(0);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_ada215a5db25227a8fd2cd2596e7d3e57_cgraph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="ParticleSwarm_8h_ada215a5db25227a8fd2cd2596e7d3e57_icgraph.svg" width="286" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="avariables_8h_html_a8c248c162038dffe12e38228bcd06644"><div class="ttname"><a href="variables_8h.html#a8c248c162038dffe12e38228bcd06644">SimCtx::bboxlist</a></div><div class="ttdeci">BoundingBox * bboxlist</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00615">variables.h:615</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_ac3566e0b51587686bc6c1366a67c44af"><div class="ttname"><a href="ParticleSwarm_8c.html#ac3566e0b51587686bc6c1366a67c44af">InitializeSwarm</a></div><div class="ttdeci">PetscErrorCode InitializeSwarm(UserCtx *user)</div><div class="ttdoc">Initializes the DMSwarm object within the UserCtx structure.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00018">ParticleSwarm.c:18</a></div></div>
<div class="ttc" id="avariables_8h_html_ad032e456f7f4b32b9ac0d94be05de204"><div class="ttname"><a href="variables_8h.html#ad032e456f7f4b32b9ac0d94be05de204">Cmpnts::y</a></div><div class="ttdeci">PetscScalar y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables_8h_html_aac8e0dd714804b073dbb32c0ad84b2eb"><div class="ttname"><a href="variables_8h.html#aac8e0dd714804b073dbb32c0ad84b2eb">UserMG::mglevels</a></div><div class="ttdeci">PetscInt mglevels</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00434">variables.h:434</a></div></div>
<div class="ttc" id="avariables_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00660">variables.h:660</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa8c371f4e766fb2c49c219bbc88989461">BOTTOM</a></div><div class="ttdeci">@ BOTTOM</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables_8h_html_a718a09fbedf450248eaf7019a980e139"><div class="ttname"><a href="variables_8h.html#a718a09fbedf450248eaf7019a980e139">Cmpnts::x</a></div><div class="ttdeci">PetscScalar x</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a></div><div class="ttdeci">@ LOG_WARNING</div><div class="ttdoc">Non-critical issues that warrant attention.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00030">logging.h:30</a></div></div>
<div class="ttc" id="avariables_8h_html_a6a5533a086f46652d5587ae84ec62c9f"><div class="ttname"><a href="variables_8h.html#a6a5533a086f46652d5587ae84ec62c9f">SimCtx::StartStep</a></div><div class="ttdeci">PetscInt StartStep</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00548">variables.h:548</a></div></div>
<div class="ttc" id="avariables_8h_html_a27bce072860da2f1a8a54d94b2b9497f"><div class="ttname"><a href="variables_8h.html#a27bce072860da2f1a8a54d94b2b9497f">UserCtx::identifiedInletBCFace</a></div><div class="ttdeci">BCFace identifiedInletBCFace</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00677">variables.h:677</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a075e674353bc5b06344aa4c17063babf"><div class="ttname"><a href="ParticleSwarm_8c.html#a075e674353bc5b06344aa4c17063babf">FinalizeSwarmSetup</a></div><div class="ttdeci">PetscErrorCode FinalizeSwarmSetup(PetscRandom *randx, PetscRandom *randy, PetscRandom *randz, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</div><div class="ttdoc">Finalizes the swarm setup by destroying random generators and logging completion.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00782">ParticleSwarm.c:782</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fadb45120aafd37a973140edee24708065">LEFT</a></div><div class="ttdeci">@ LEFT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faec8379af7490bb9eaaf579cf17876f38">RIGHT</a></div><div class="ttdeci">@ RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="alogging_8h_html_a2ebe7667b52c478f7ff365f296d4c8ae"><div class="ttname"><a href="logging_8h.html#a2ebe7667b52c478f7ff365f296d4c8ae">LOG_ALLOW_SYNC</a></div><div class="ttdeci">#define LOG_ALLOW_SYNC(scope, level, fmt,...)</div><div class="ttdoc">---- DEBUG --------------------------------------- #define LOG_ALLOW(scope, level,...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00266">logging.h:266</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00538">variables.h:538</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fac921ff2cfc571c1d19b0485d7f6926ee">BACK</a></div><div class="ttdeci">@ BACK</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables_8h_html_a347829443e8a679209e21f7f04f51581"><div class="ttname"><a href="variables_8h.html#a347829443e8a679209e21f7f04f51581">ParticleLocationStatus</a></div><div class="ttdeci">ParticleLocationStatus</div><div class="ttdoc">Defines the state of a particle with respect to its location and migration status during the iterativ...</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00135">variables.h:135</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="avariables_8h_html_a8946fb6518183cd18a7dc1119c4771c7"><div class="ttname"><a href="variables_8h.html#a8946fb6518183cd18a7dc1119c4771c7">SimCtx::particleRestartMode</a></div><div class="ttdeci">char particleRestartMode[16]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00617">variables.h:617</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a38c3c55ea49021ac59eea87b61e942d1"><div class="ttname"><a href="ParticleSwarm_8c.html#a38c3c55ea49021ac59eea87b61e942d1">AssignInitialFieldToSwarm</a></div><div class="ttdeci">static PetscErrorCode AssignInitialFieldToSwarm(UserCtx *user, const char *fieldName, PetscInt fieldDim)</div><div class="ttdoc">Initializes a generic swarm field with point-level updates.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00583">ParticleSwarm.c:583</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_aeae3fd559e91d7379302acb6ccd13011"><div class="ttname"><a href="ParticleSwarm_8c.html#aeae3fd559e91d7379302acb6ccd13011">RegisterParticleFields</a></div><div class="ttdeci">PetscErrorCode RegisterParticleFields(DM swarm)</div><div class="ttdoc">Registers necessary particle fields within the DMSwarm.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00076">ParticleSwarm.c:76</a></div></div>
<div class="ttc" id="avariables_8h_html_a88a45e3c57c861d03160f28aaa786414"><div class="ttname"><a href="variables_8h.html#a88a45e3c57c861d03160f28aaa786414">Particle::location_status</a></div><div class="ttdeci">ParticleLocationStatus location_status</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00171">variables.h:171</a></div></div>
<div class="ttc" id="alogging_8h_html_a5fe7257f46131945aacf9a35e9de5874"><div class="ttname"><a href="logging_8h.html#a5fe7257f46131945aacf9a35e9de5874">PROFILE_FUNCTION_END</a></div><div class="ttdeci">#define PROFILE_FUNCTION_END</div><div class="ttdoc">Marks the end of a profiled code block.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00731">logging.h:731</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a063f4fd13a24b248fabd0268c49fd38c"><div class="ttname"><a href="ParticleSwarm_8c.html#a063f4fd13a24b248fabd0268c49fd38c">CreateParticleSwarm</a></div><div class="ttdeci">PetscErrorCode CreateParticleSwarm(UserCtx *user, PetscInt numParticles, PetscInt *particlesPerProcess, BoundingBox *bboxlist)</div><div class="ttdoc">Creates and initializes a Particle Swarm.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00826">ParticleSwarm.c:826</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a230506cce5c68c3bac5a821c42ed3473">LOG_ERROR</a></div><div class="ttdeci">@ LOG_ERROR</div><div class="ttdoc">Critical errors that may halt the program.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00029">logging.h:29</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa0ad44897a70fba309c24a5b6007de3e3">TOP</a></div><div class="ttdeci">@ TOP</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables_8h_html_a2b65d08959f82092f0802feecbf46bee"><div class="ttname"><a href="variables_8h.html#a2b65d08959f82092f0802feecbf46bee">Particle::cell</a></div><div class="ttdeci">PetscInt cell[3]</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00167">variables.h:167</a></div></div>
<div class="ttc" id="avariables_8h_html_ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f"><div class="ttname"><a href="variables_8h.html#ad14b0c6d4ed8fcadff6dcf39c5cf17fdabc2af4413f44e1c8a92f2f9e99649e1f">EXEC_MODE_POSTPROCESSOR</a></div><div class="ttdeci">@ EXEC_MODE_POSTPROCESSOR</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00512">variables.h:512</a></div></div>
<div class="ttc" id="avariables_8h_html_structUserCtx"><div class="ttname"><a href="variables_8h.html#structUserCtx">UserCtx</a></div><div class="ttdoc">User-defined context containing data specific to a single computational grid level.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00657">variables.h:657</a></div></div>
<div class="ttc" id="alogging_8h_html_a2358badbcda33fc9d80ebd6a59d2a2cd"><div class="ttname"><a href="logging_8h.html#a2358badbcda33fc9d80ebd6a59d2a2cd">is_function_allowed</a></div><div class="ttdeci">PetscBool is_function_allowed(const char *functionName)</div><div class="ttdoc">Checks if a given function is in the allow-list.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00149">logging.c:149</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294fa76bd5ec6ea9d8a1b582d8d5e43102a02">FRONT</a></div><div class="ttdeci">@ FRONT</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="aio_8h_html_a64286adf953993b2a0c5c3fbee40d5a2"><div class="ttname"><a href="io_8h.html#a64286adf953993b2a0c5c3fbee40d5a2">ReadAllSwarmFields</a></div><div class="ttdeci">PetscErrorCode ReadAllSwarmFields(UserCtx *user, PetscInt ti)</div><div class="ttdoc">Reads multiple fields (positions, velocity, CellID, and weight) into a DMSwarm.</div><div class="ttdef"><b>Definition:</b> <a href="io_8c_source.html#l01239">io.c:1239</a></div></div>
<div class="ttc" id="avariables_8h_html_ae85e7171c483d180ffe8759fd13b4312"><div class="ttname"><a href="variables_8h.html#ae85e7171c483d180ffe8759fd13b4312">UserCtx::bbox</a></div><div class="ttdeci">BoundingBox bbox</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00668">variables.h:668</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a95efc9f04a0187f2a1d920952bd610e0"><div class="ttname"><a href="ParticleSwarm_8c.html#a95efc9f04a0187f2a1d920952bd610e0">InitializeParticleBasicProperties</a></div><div class="ttdeci">static PetscErrorCode InitializeParticleBasicProperties(UserCtx *user, PetscInt particlesPerProcess, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, BoundingBox *bboxlist)</div><div class="ttdoc">Initializes basic properties for particles on the local process.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00370">ParticleSwarm.c:370</a></div></div>
<div class="ttc" id="avariables_8h_html_ada85203a98a3e4ce033b630fd6a1b695"><div class="ttname"><a href="variables_8h.html#ada85203a98a3e4ce033b630fd6a1b695">UserMG::mgctx</a></div><div class="ttdeci">MGCtx * mgctx</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00437">variables.h:437</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f"><div class="ttname"><a href="variables_8h.html#ad3fc1d97a3c41ea9d58d0ab14f75294faea9f55d94d5c6f9337119ed01805d36f">NUM_FACES</a></div><div class="ttdeci">@ NUM_FACES</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00145">variables.h:145</a></div></div>
<div class="ttc" id="avariables_8h_html_a3c5226c112cabe2fc24230877bf7cc3c"><div class="ttname"><a href="variables_8h.html#a3c5226c112cabe2fc24230877bf7cc3c">UserCtx::Min_X</a></div><div class="ttdeci">PetscReal Min_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00667">variables.h:667</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a3b8cd77851de92f44b3821c6d15fb725"><div class="ttname"><a href="ParticleSwarm_8c.html#a3b8cd77851de92f44b3821c6d15fb725">INTERPOLATION_DISTANCE_TOLERANCE</a></div><div class="ttdeci">#define INTERPOLATION_DISTANCE_TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00005">ParticleSwarm.c:5</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a1cc0975a3eec2e2f817d0e3a09040620"><div class="ttname"><a href="ParticleSwarm_8c.html#a1cc0975a3eec2e2f817d0e3a09040620">DistributeParticles</a></div><div class="ttdeci">PetscErrorCode DistributeParticles(PetscInt numParticles, PetscMPIInt rank, PetscMPIInt size, PetscInt *particlesPerProcess, PetscInt *remainder)</div><div class="ttdoc">Distributes particles evenly across MPI processes, handling any remainders.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00744">ParticleSwarm.c:744</a></div></div>
<div class="ttc" id="avariables_8h_html_ae27e734d789eb2f07918d6bae3969480"><div class="ttname"><a href="variables_8h.html#ae27e734d789eb2f07918d6bae3969480">SimCtx::exec_mode</a></div><div class="ttdeci">ExecutionMode exec_mode</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00556">variables.h:556</a></div></div>
<div class="ttc" id="avariables_8h_html_aaeef1864bb110c26e4b30a9e2c8c116d"><div class="ttname"><a href="variables_8h.html#aaeef1864bb110c26e4b30a9e2c8c116d">UserCtx::Min_Z</a></div><div class="ttdeci">PetscReal Min_Z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00667">variables.h:667</a></div></div>
<div class="ttc" id="avariables_8h_html_structCmpnts"><div class="ttname"><a href="variables_8h.html#structCmpnts">Cmpnts</a></div><div class="ttdoc">A 3D point or vector with PetscScalar components.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00100">variables.h:100</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_af2b3080ee0e5c8e0175ac594a2c497b5"><div class="ttname"><a href="ParticleSwarm_8c.html#af2b3080ee0e5c8e0175ac594a2c497b5">AssignInitialPropertiesToSwarm</a></div><div class="ttdeci">PetscErrorCode AssignInitialPropertiesToSwarm(UserCtx *user, PetscInt particlesPerProcess, PetscRandom *rand_phys_x, PetscRandom *rand_phys_y, PetscRandom *rand_phys_z, PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k, BoundingBox *bboxlist)</div><div class="ttdoc">Initializes all particle properties in the swarm.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00653">ParticleSwarm.c:653</a></div></div>
<div class="ttc" id="avariables_8h_html_a60bfc6b6d761a90da39b0f053bebcb31"><div class="ttname"><a href="variables_8h.html#a60bfc6b6d761a90da39b0f053bebcb31">UserCtx::Max_Y</a></div><div class="ttdeci">PetscReal Max_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00667">variables.h:667</a></div></div>
<div class="ttc" id="alogging_8h_html_a9585f583c260f40a73f2490914edc689"><div class="ttname"><a href="logging_8h.html#a9585f583c260f40a73f2490914edc689">get_log_level</a></div><div class="ttdeci">LogLevel get_log_level()</div><div class="ttdoc">Retrieves the current logging level from the environment variable LOG_LEVEL.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8c_source.html#l00039">logging.c:39</a></div></div>
<div class="ttc" id="avariables_8h_html_a41a6127b3c012c516a7dcc56c3696a84"><div class="ttname"><a href="variables_8h.html#a41a6127b3c012c516a7dcc56c3696a84">SimCtx::usermg</a></div><div class="ttdeci">UserMG usermg</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00627">variables.h:627</a></div></div>
<div class="ttc" id="avariables_8h_html_a4d66dc20efb64cf45770997139fae524"><div class="ttname"><a href="variables_8h.html#a4d66dc20efb64cf45770997139fae524">BoundingBox::max_coords</a></div><div class="ttdeci">Cmpnts max_coords</div><div class="ttdoc">Maximum x, y, z coordinates of the bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00156">variables.h:156</a></div></div>
<div class="ttc" id="avariables_8h_html_a0e8eb238051c8b5f37a260a8cde481c4"><div class="ttname"><a href="variables_8h.html#a0e8eb238051c8b5f37a260a8cde481c4">MGCtx::user</a></div><div class="ttdeci">UserCtx * user</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00427">variables.h:427</a></div></div>
<div class="ttc" id="avariables_8h_html_a6b5da58d79c9c0ed6e9368c9677d5260"><div class="ttname"><a href="variables_8h.html#a6b5da58d79c9c0ed6e9368c9677d5260">BoundingBox::min_coords</a></div><div class="ttdeci">Cmpnts min_coords</div><div class="ttdoc">Minimum x, y, z coordinates of the bounding box.</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00155">variables.h:155</a></div></div>
<div class="ttc" id="avariables_8h_html_a76cdf3edbcd6aa56f5a2ba8645e999ea"><div class="ttname"><a href="variables_8h.html#a76cdf3edbcd6aa56f5a2ba8645e999ea">Particle::destination_rank</a></div><div class="ttdeci">PetscMPIInt destination_rank</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00172">variables.h:172</a></div></div>
<div class="ttc" id="avariables_8h_html_a5eedf611da6dd4f59cc65753b777b957"><div class="ttname"><a href="variables_8h.html#a5eedf611da6dd4f59cc65753b777b957">SimCtx::np</a></div><div class="ttdeci">PetscInt np</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00612">variables.h:612</a></div></div>
<div class="ttc" id="avariables_8h_html_ac3ea6849d6d1556f240ace7a6d9a3347"><div class="ttname"><a href="variables_8h.html#ac3ea6849d6d1556f240ace7a6d9a3347">UserCtx::Max_X</a></div><div class="ttdeci">PetscReal Max_X</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00667">variables.h:667</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_adcaec962a8ff017ba9f859716405f51a"><div class="ttname"><a href="ParticleSwarm_8c.html#adcaec962a8ff017ba9f859716405f51a">RegisterSwarmField</a></div><div class="ttdeci">PetscErrorCode RegisterSwarmField(DM swarm, const char *fieldName, PetscInt fieldDim, PetscDataType dtype)</div><div class="ttdoc">Registers a swarm field without finalizing registration.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00050">ParticleSwarm.c:50</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_ab723e91906e01ec26aab97de6623000c"><div class="ttname"><a href="ParticleSwarm_8c.html#ab723e91906e01ec26aab97de6623000c">InitializeLogicalSpaceRNGs</a></div><div class="ttdeci">PetscErrorCode InitializeLogicalSpaceRNGs(PetscRandom *rand_logic_i, PetscRandom *rand_logic_j, PetscRandom *rand_logic_k)</div><div class="ttdoc">Initializes random number generators for logical space operations [0.0, 1.0).</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00173">ParticleSwarm.c:173</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00199">logging.h:199</a></div></div>
<div class="ttc" id="avariables_8h_html_a71cca12cd9fb0796634a7076eeb9b50b"><div class="ttname"><a href="variables_8h.html#a71cca12cd9fb0796634a7076eeb9b50b">Particle::loc</a></div><div class="ttdeci">Cmpnts loc</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00168">variables.h:168</a></div></div>
<div class="ttc" id="avariables_8h_html_a0dedc7a71f2bf127463d9bfd4ed41103"><div class="ttname"><a href="variables_8h.html#a0dedc7a71f2bf127463d9bfd4ed41103">Particle::vel</a></div><div class="ttdeci">Cmpnts vel</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00169">variables.h:169</a></div></div>
<div class="ttc" id="avariables_8h_html_a9f0c002a2c7cde3b6ac843ab9185f4d4"><div class="ttname"><a href="variables_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">Cmpnts::z</a></div><div class="ttdeci">PetscScalar z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables_8h_html_ad3cf9af789ad3875d496c48112ade0ec"><div class="ttname"><a href="variables_8h.html#ad3cf9af789ad3875d496c48112ade0ec">Particle::weights</a></div><div class="ttdeci">Cmpnts weights</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00170">variables.h:170</a></div></div>
<div class="ttc" id="avariables_8h_html_ae3ce8967b15c2e6be9e829b745da4090"><div class="ttname"><a href="variables_8h.html#ae3ce8967b15c2e6be9e829b745da4090">SimCtx::ParticleInitialization</a></div><div class="ttdeci">PetscInt ParticleInitialization</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00616">variables.h:616</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="avariables_8h_html_a1675749ea3b2429f00405a1ee3203d18"><div class="ttname"><a href="variables_8h.html#a1675749ea3b2429f00405a1ee3203d18">UserCtx::swarm</a></div><div class="ttdeci">DM swarm</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00722">variables.h:722</a></div></div>
<div class="ttc" id="avariables_8h_html_aecbc2de7a281e906efe25a773b76866c"><div class="ttname"><a href="variables_8h.html#aecbc2de7a281e906efe25a773b76866c">UserCtx::Max_Z</a></div><div class="ttdeci">PetscReal Max_Z</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00667">variables.h:667</a></div></div>
<div class="ttc" id="aParticleMotion_8h_html_ae0c7489fc52fda6c92cd1f22c3f50c38"><div class="ttname"><a href="ParticleMotion_8h.html#ae0c7489fc52fda6c92cd1f22c3f50c38">PreCheckAndResizeSwarm</a></div><div class="ttdeci">PetscErrorCode PreCheckAndResizeSwarm(UserCtx *user, PetscInt ti, const char *ext)</div><div class="ttdoc">Checks particle count in the reference file and resizes the swarm if needed.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleMotion_8c_source.html#l00848">ParticleMotion.c:848</a></div></div>
<div class="ttc" id="avariables_8h_html_ac6633daab270004cd266f6e6ac05f588"><div class="ttname"><a href="variables_8h.html#ac6633daab270004cd266f6e6ac05f588">UserCtx::Min_Y</a></div><div class="ttdeci">PetscReal Min_Y</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00667">variables.h:667</a></div></div>
<div class="ttc" id="avariables_8h_html_aecd4cd7f1da07e3f3d6e1fb6cf71a44b"><div class="ttname"><a href="variables_8h.html#aecd4cd7f1da07e3f3d6e1fb6cf71a44b">Particle::PID</a></div><div class="ttdeci">PetscInt64 PID</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00166">variables.h:166</a></div></div>
<div class="ttc" id="aParticleSwarm_8c_html_a26fa0cca0aa8b05f2705cdd0e7d37658"><div class="ttname"><a href="ParticleSwarm_8c.html#a26fa0cca0aa8b05f2705cdd0e7d37658">InitializeRandomGenerators</a></div><div class="ttdeci">PetscErrorCode InitializeRandomGenerators(UserCtx *user, PetscRandom *randx, PetscRandom *randy, PetscRandom *randz)</div><div class="ttdoc">Initializes random number generators for assigning particle properties.</div><div class="ttdef"><b>Definition:</b> <a href="ParticleSwarm_8c_source.html#l00122">ParticleSwarm.c:122</a></div></div>
<div class="ttc" id="avariables_8h_html_a1300c167a3006a58c71fe8759ebf5ef1"><div class="ttname"><a href="variables_8h.html#a1300c167a3006a58c71fe8759ebf5ef1">UserCtx::inletFaceDefined</a></div><div class="ttdeci">PetscBool inletFaceDefined</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00676">variables.h:676</a></div></div>
<div class="ttc" id="alogging_8h_html_ace99f3e207ccb2e46e9b782f9e57732e"><div class="ttname"><a href="logging_8h.html#ace99f3e207ccb2e46e9b782f9e57732e">PROFILE_FUNCTION_BEGIN</a></div><div class="ttdeci">#define PROFILE_FUNCTION_BEGIN</div><div class="ttdoc">Marks the beginning of a profiled code block (typically a function).</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00722">logging.h:722</a></div></div>
<div class="ttc" id="avariables_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdef"><b>Definition:</b> <a href="variables_8h_source.html#l00663">variables.h:663</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="ParticleSwarm_8h.html">ParticleSwarm.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
