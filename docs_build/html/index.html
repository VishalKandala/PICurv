<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PICurv: PICurv Solver Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PICurv
   &#160;<span id="projectnumber">0.1.0</span>
   </div>
   <div id="projectbrief">A Parallel Particle-In-Cell Solver for Curvilinear LES</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PICurv Solver Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<h1><a class="anchor" id="autotoc_md16"></a>
ðŸŒ€ PICurv: A Hybrid Eulerian-Lagrangian Framework for Scalar Transport</h1>
<p>Welcome to the documentation for <b>PICurv</b>, a high-performance, parallel framework for simulating turbulent flows with actively coupled scalar fields using a hybrid Eulerian-Lagrangian method.</p>
<p>PICurv is designed to tackle complex scalar transport problems where traditional grid-based methods suffer from numerical diffusion. It couples a curvilinear immersed boundary (CurvIB) fluid dynamics solver with a parallel Lagrangian particle method. In this framework, the "particles" act as moving computational points that carry and evolve scalar properties. These properties are then projected back onto the Eulerian grid, creating a powerful two-way coupling. This makes PICurv an ideal platform for advanced simulations in turbulent mixing and combustion, such as transported Probability Density Function (t-PDF) or Flamelet/Progress Variable (FPV) models.</p>
<h1><a class="anchor" id="methodology_sec"></a>
Core Methodology</h1>
<p>PICurv's methodology is a tightly integrated, two-way coupled hybrid Eulerian-Lagrangian scheme. It solves for the fluid mechanics on a stationary grid while tracking the evolution of scalar fields on a vast number of moving Lagrangian markers.</p>
<h3><a class="anchor" id="autotoc_md17"></a>
1. The Eulerian Phase (The Grid)</h3>
<p>The background fluid flow and the grid-based representation of scalar fields are handled in the Eulerian frame.</p><ul>
<li><b>Flow Solver:</b> The velocity field is solved using the <b>CurvIB solver</b>, which employs a pressure-based <b>fractional-step projection method</b> for the incompressible Navier-Stokes equations on a structured, body-fitted curvilinear grid.</li>
<li><b>Turbulence Modeling:</b> Large Eddy Simulation (LES) with a dynamic Smagorinsky sub-grid scale model is used to efficiently capture turbulent flow dynamics.</li>
<li><b>Eulerian Scalar Fields (<code>phi_field</code>):** The grid also hosts Eulerian fields for the scalars being tracked (e.g., mixture fraction, temperature). These fields are not directly advected but are instead constructed from the properties of the Lagrangian markers.</b></li>
</ul>
<p><b></b></p>
<h3><a class="anchor" id="autotoc_md18"></a>
2. The Lagrangian Phase (The Markers)</h3>
<p><b> The core of the scalar transport model resides in the Lagrangian phase, which consists of millions of computational markers.</p><ul>
<li><b>Computational Markers:</b> These are abstract, massless markers that act as carriers of scalar information (<code>phi_particle</code>). Each marker represents a statistical sample of the flow.</li>
<li><b>Scalar Evolution:</b> An evolution equation (e.g., a transport or reaction equation) is solved for the scalar properties along each marker's trajectory: <code>d(phi_particle)/dt = S(phi_particle, ...)</code>. The source term <code>S</code> can depend on local fluid properties interpolated from the grid.</li>
<li>**Parallel Management: Marker data and evolution are managed by PETSc's <code>DMSwarm</code>, handling memory, data layout, and automatic migration between MPI ranks.</li>
</ul>
<p></b></p>
<p><b></b></p>
<h3><a class="anchor" id="autotoc_md19"></a>
3. The Two-Way Coupling Mechanism</h3>
<p><b> The true power of PICurv lies in the continuous, two-way exchange of information between the grid and the markers, using specific numerical schemes.</b></p>
<p><b></p><ul>
<li><b>Grid â†’ Marker (Interpolation):</b><ol type="1">
<li>The fluid velocity <code>**u**</code> is interpolated to each marker's location using a <b>trilinear interpolation</b> scheme to advect it accurately.</li>
<li>Other necessary Eulerian field variables (e.g., velocity gradients, turbulent dissipation) are also interpolated to the markers using the same method to evaluate the source terms in the scalar evolution equation.</li>
</ol>
</li>
<li><b>Marker â†’ Grid (Projection/Deposition):</b><ol type="1">
<li>The Eulerian scalar field (<code>phi_field</code>) is reconstructed from the Lagrangian marker properties using <b>cell averaging</b>. The value of <code>phi_field</code> for a given grid cell is computed as the average of the <code>phi_particle</code> values from all markers currently residing within that cell's volume.</li>
<li>This projection step allows the high-resolution, non-diffusive information evolved in the Lagrangian frame to directly influence the Eulerian field, which can then be used for visualization or to affect other physics in the simulation.</li>
</ol>
</li>
</ul>
<p></b></p>
<p><b></b></p>
<h1><a class="anchor" id="features_sec"></a>
Key Features</h1>
<p><b></p><ul>
<li><b>Hybrid Eulerian-Lagrangian Solver:</b> A modern framework for high-fidelity scalar transport in turbulent flows.</li>
<li><b>Advanced CFD for Transport:</b> Employs a pressure-based fractional-step method and LES to provide an accurate velocity field for Lagrangian advection.</li>
<li><b>Two-Way Scalar Coupling:</b> Implements a robust mechanism for projecting Lagrangian scalar information back onto the Eulerian grid.</li>
<li><b>Flexible Scalar Evolution:</b> The framework is designed to solve arbitrary user-defined transport equations on the Lagrangian markers.</li>
<li><b>Efficient Coupling Kernels:</b> Employs <b>trilinear interpolation</b> for grid-to-marker data transfer and <b>cell averaging</b> for marker-to-grid projection, ensuring accurate and robust data exchange.</li>
<li><b>Parallel by Design:</b> Built on PETSc's <code>DMDA</code> and <code>DMSwarm</code> to ensure excellent performance and scalability on HPC systems.</li>
</ul>
<p></b></p>
<p><b></b></p>
<h1><a class="anchor" id="arch_sec"></a>
Architecture and Program Flow</h1>
<p><b> The solver follows a clear, five-stage execution path: <b>Initialize, Configure, Setup, Execute, and Finalize</b>, orchestrated by <code><a class="el" href="picsolver_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a></code>. All simulation data is managed by a central <code>SimulationContext</code> object.</b></p>
<p><b></p><div class="image">
<img src="high_level_architecture.png" alt="" width="800px"/>
<div class="caption">
High-Level Simulation Workflow</div></div>
<p></b></p>
<p><b></b></p>
<h1><a class="anchor" id="nav_links"></a>
Next Steps</h1>
<p><b></p><ul>
<li><b>getting_started</b>: Compile the code and run your first simulation.</li>
<li><b>user_guide</b>: Learn how to configure simulations, use command-line options, and interpret results.</li>
<li><b>developer_guide</b>: Understand the code's architecture and learn how to extend it with new models.</li>
<li><b>theory_and_numerics</b>: Read the detailed description of the governing equations and numerical methods. </li>
</ul>
<p></b></p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
